<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>地图API示例 - 亿图 YtGis</title>
    <link rel="stylesheet" type="text/css" href="/demo/res/codemirror.css">
    <link rel="stylesheet" type="text/css" href="/demo/res/base.css">
</head>
<body style="zoom: 1;">
    <div id="header">
        <a class="logo">
            <img src="/demo/res/logo.png">
        </a>
    </div>
    <div id="content">
        <div id="menu">
            <ul>
                <li id="list_item1">
                    <a class="one_head open clickState" listid="1"><i class="t_open"></i>地图加载</a>
                    <div id="submenu1" class="submenu" style="display: block;">
                        <dl>
                            <dd><a href="/demo/a1.html" target="container">经纬度地图</a></dd>
                            <dd><a href="/demo/a2.html" target="container">球面墨卡托地图</a></dd>
                            <dd><a href="/demo/a3.html" target="container">加载单图层</a></dd>
                        </dl>
                    </div>
                </li>
                <li id="list_item2">
                    <a class="one_head" listid="2"><i class="t_close"></i>地图基本操作</a>
                    <div id="submenu2" class="submenu">
                        <dl>
                            <dd><a href="/demo/b1.html" target="container">切换投影</a></dd>
                            <dd><a href="/demo/b4.html" target="container">切换地图类型</a></dd>
                            <dd><a href="/demo/b2.html" target="container">放大、缩小</a></dd>
                            <dd><a href="/demo/b3.html" target="container">地图平移</a></dd>
                        </dl>
                    </div>
                </li>
                <li id="list_item3">
                    <a class="one_head" listid="3"><i class="t_close"></i>地图参数设置</a>
                    <div id="submenu3" class="submenu">
                        <dl>
                            <dd><a href="/demo/c1.html" target="container">设置中心点及级别</a></dd>
                            <dd><a href="/demo/c2.html" target="container">保存当前地图</a></dd>
                            <dd><a href="/demo/c3.html" target="container">双击放大</a></dd>
                            <dd><a href="/demo/c4.html" target="container">滚轮缩放</a></dd>
                            <dd><a href="/demo/c5.html" target="container">惯性拖拽</a></dd>
                            <dd><a href="/demo/c6.html" target="container">键盘操作</a></dd>
                            <dd><a href="/demo/c7.html" target="container">设置等级</a></dd>
                            <dd><a href="/demo/c8.html" target="container">设置范围</a></dd>
                        </dl>
                    </div>
                </li>
                <li id="list_item4">
                    <a class="one_head" listid="4"><i class="t_close"></i>地图信息获取</a>
                    <div id="submenu4" class="submenu">
                        <dl>

                            <dd><a href="/demo/d1.html" target="container">当前中心坐标</a></dd>
                            <dd><a href="/demo/d2.html" target="container">当前缩放级别</a></dd>
                            <dd><a href="/demo/d3.html" target="container">可视范围</a></dd>
                        </dl>
                    </div>
                </li>
                <li id="list_item5">
                    <a class="one_head" listid="5"><i class="t_close"></i>自定义图层</a>
                    <div id="submenu5" class="submenu">
                        <dl>
                            <dd><a href="/demo/e1.html" target="container">添加自定义图层</a></dd>
                            <dd><a href="/demo/e2.html" target="container">获取WMS图层属性值</a></dd>
                            <dd><a href="/demo/e3.html" target="container">叠加WMS图层</a></dd>
                        </dl>
                    </div>
                </li>
                <li id="list_item6">
                    <a class="one_head" listid="6"><i class="t_close"></i>控件加载</a>
                    <div id="submenu6" class="submenu">
                        <dl>
                            <dd><a href="/demo/f1.html" target="container">缩放平移控件</a></dd>
                            <dd><a href="/demo/f2.html" target="container">比例尺控件</a></dd>
                            <dd><a href="/demo/f3.html" target="container">鹰眼控件</a></dd>
                            <dd><a href="/demo/f4.html" target="container">版权控件</a></dd>
                            <dd><a href="/demo/f5.html" target="container">自定义控件</a></dd>
                        </dl>
                    </div>
                </li>
                <li id="list_item7">
                    <a class="one_head" listid="7"><i class="t_close"></i>右击菜单</a>
                    <div id="submenu7" class="submenu">
                        <dl>
                            <dd><a href="/demo/g1.html" target="container">简单右键菜单</a></dd>
                            <dd><a href="/demo/g2.html" target="container">带分隔线</a></dd>
                            <dd><a href="/demo/g3.html" target="container">获取点击坐标</a></dd>
                        </dl>
                    </div>
                </li>
                <li id="list_item8">
                    <a class="one_head" listid="8"><i class="t_close"></i>覆盖物</a>
                    <div id="submenu8" class="submenu">
                        <dl>
                            <dd><a href="/demo/h1.html" target="container">添加标注</a></dd>
                            <dd><a href="/demo/h2.html" target="container">添加标注图片</a></dd>
                            <dd><a href="/demo/h3.html" target="container">添加文字</a></dd>
                            <dd><a href="/demo/h4.html" target="container">添加线</a></dd>
                            <dd><a href="/demo/h5.html" target="container">添加多边形</a></dd>
                            <dd><a href="/demo/h6.html" target="container">添加矩形</a></dd>
                            <dd><a href="/demo/h7.html" target="container">添加椭圆</a></dd>
                            <dd><a href="/demo/h8.html" target="container">添加圆</a></dd>
                            <dd><a href="/demo/h9.html" target="container">添加信息窗口</a></dd>
                            <dd><a href="/demo/h10.html" target="container">自定义信息窗口</a></dd>
                            <dd><a href="/demo/h11.html" target="container">编辑线</a></dd>
                            <dd><a href="/demo/h12.html" target="container">编辑面</a></dd>
                        </dl>
                    </div>
                </li>
                <li id="list_item9">
                    <a class="one_head" listid="9"><i class="t_close"></i>地图工具</a>
                    <div id="submenu9" class="submenu">
                        <dl>
                            <dd><a href="/demo/i1.html" target="container">标注工具</a></dd>
                            <dd><a href="/demo/i2.html" target="container">矩形工具</a></dd>
                            <dd><a href="/demo/i3.html" target="container">测距工具</a></dd>
                            <dd><a href="/demo/i4.html" target="container">测面工具</a></dd>
                            <dd><a href="/demo/i5.html" target="container">画圆工具</a></dd>
                        </dl>
                    </div>
                </li>
                <li id="list_item10">
                    <a class="one_head" listid="10"><i class="t_close"></i>事件</a>
                    <div id="submenu10" class="submenu">
                        <dl>
                            <dd><a href="/demo/j1.html" target="container">地图点击事件</a></dd>
                            <dd><a href="/demo/j2.html" target="container">鼠标滑过地图事件</a></dd>
                            <dd><a href="/demo/j3.html" target="container">标注点击事件</a></dd>
                            <dd><a href="/demo/j4.html" target="container">线点击事件</a></dd>
                            <dd><a href="/demo/j5.html" target="container">面点击事件</a></dd>
                        </dl>
                    </div>
                </li>
                <li id="list_item11">
                    <a class="one_head" listid="11"><i class="t_close"></i>组件</a>
                    <div id="submenu11" class="submenu">
                        <dl>
                            <dd><a href="/demo/k1.html" target="container">坐标拾取器</a></dd>
                            <dd><a href="/demo/k2.html" target="container">点聚合</a></dd>
                        </dl>
                    </div>
                </li>
            </ul>
        </div>
        <div id="code_area" unselectable="on">
            <div id="openbar" unselectable="on">
                <div id="d_menu">
                    <div id="d_clip_container"><a id="d_clip_button" class="copy" style="z-index: 1000;" onclick="copy()">复制</a></div>
                    <div id="d_run_container"><a id="d_run_button" onclick="run();" class="run">运行</a></div>
                    <div id="d_refresh_container"><a id="d_refresh_button" onclick="refresh();">刷新</a></div>
                </div>
                <p>源代码编辑器</p>
            </div>
            <textarea id="myresource" class="clearfix" onchange="clip.setText(this.value)" style="display: none;"></textarea>
            <div id="code_close" class="code_switch" style="display: block;"></div>
        </div>
        <div id="drag"></div>
        <div id="mapContent" class="clearfix">
            <div id="code_open" class="code_switch" style="display: none;"></div>
            <div id="overiframe" style="background:url(about:_blank);" unselectable="on"></div>
            <iframe class="" unselectable="on" name="container" id="container" src="a1.html" width="100%" height="100%"></iframe>
        </div>
    </div>
    <script type="text/javascript" src="/demo/res/codemirror.min.js"></script>
    <script type="text/javascript" src="/demo/res/ZeroClipboard.js"></script>
    <script src="/res/js/jquery.min.js"></script>
    <script type="text/javascript">
        var clip = null;
        var editor = null;

        $(function () {
            clipinit();
            navigation();
            initEditor();
            $(".code_switch").click(function () {
                $("#code_area").toggle();
                $("#code_open").toggle();
            });
            $(".submenu a").click(function () {
                jQuery.get($(this).attr("href"), function (d) {
                    editor.setValue(d);
                })
            });
            $(".submenu:eq(0) a:eq(0)").click();
        })

        /**初始化文本编辑器**/
        function initEditor() {
            if (!editor) {
                editor = CodeMirror.fromTextArea(document.getElementById("myresource"), {
                    lineWrapping: true, //是否显示scroll
                    lineNumbers: false, //是否显示number
                    styleActiveLine: true,
                    matchBrackets: true,
                    mode: "htmlmixed",
                    viewportMargin: Infinity
                });
            } else {
                editor.setValue($("#myresource").val());
            }
        }

        function clipinit() {
            clip = new ZeroClipboard.Client();
            clip.setHandCursor(true);
            clip.addEventListener('load', function (client) {
                console.log("Flash movie loaded and ready.");
            });
            clip.addEventListener('mouseOver', function (client) {
                $("#d_clip_button").css({ fontWeight: "bold" });
                var iframeContent = $("#myresource").val();
                if (editor) {
                    iframeContent = editor.getValue();
                }
                clip.setText(iframeContent);
            });
            clip.addEventListener('mouseOut', function (client) {
                $("#d_clip_button").css({ fontWeight: "normal" });
            });
            clip.addEventListener('complete', function (client, text) {
                alert("内容已成功复制到剪贴板")
            });
            clip.glue('d_clip_button');
        }

        function navigation() {
            var menu_head = $('#menu ul>li>a');
            var menu_body = $('#menu ul>li>.submenu');
            var menu_i = $('#menu ul>li>a>i');
            var flag = 0;
            menu_head.on('click', function (event) {
                if (!$(this).hasClass("open clickState")) {
                    var des = ($(this).attr("listid") - 1) * 52;
                    $("#menu").animate({ scrollTop: des }, 200);
                    //slideToggle
                    menu_body.slideUp('fast');
                    $(this).next().stop(true, true).slideToggle('fast');
                    menu_head.removeClass('open clickState');
                    menu_i.removeClass('t_open');
                    menu_i.addClass('t_close');
                    $(this).addClass('open clickState');
                    $(this).find('i').addClass('t_open');
                } else {
                    if (flag == $(this).attr("listid")) {
                        $(this).removeClass('open');
                    } else {
                        $(this).removeClass('open clickState');
                    }
                    $(this).find("i").removeClass('t_open').addClass('t_close');
                    $(this).parents("li").find(".submenu").slideUp('fast');
                }
            });
        }

        function copy() {
            $("#myresource").change();
        }

        function run() {
            var view = $("#container")[0].contentDocument;
            view.open();
            view.write(editor.getValue());
            view.close();
        }

        function refresh() {
            $("#container")[0].contentDocument.location.reload();
        }

    </script>
</body>
</html>