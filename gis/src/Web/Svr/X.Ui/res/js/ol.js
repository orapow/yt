var OpenLayers={VERSION_NUMBER:"Release 2.13.1",singleFile:true,_getScriptLocation:(function(){var A=new RegExp("(^|(.*?\\/))(OpenLayers[^\\/]*?\\.js)(\\?|$)",'i'),B=document.getElementsByTagName("script"),G,E,D="";for(var C=0,F=B.length;C<F;C++){G=B[C].getAttribute("src");if(G){E=G.match(A);if(E){D=E[1];break}}}return(function(){return D})})(),ImgPath:""};OpenLayers.Class=function(){var D=arguments.length;var B=arguments[0];var A=arguments[D-1];var G=typeof A.initialize=="function"?A.initialize:function(){B.prototype.initialize.apply(this,arguments)};if(D>1){var E=[G,B].concat(Array.prototype.slice.call(arguments).slice(1,D-1),A);OpenLayers.inherit.apply(null,E)}else{G.prototype=A}return G};OpenLayers.inherit=function(H,E){var A=function(){};A.prototype=E.prototype;H.prototype=new A;var B,G,D;for(B=2,G=arguments.length;B<G;B++){D=arguments[B];if(typeof D==="function"){D=D.prototype}OpenLayers.Util.extend(H.prototype,D)}};OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.extend=function(A,B){A=A||{};if(B){for(var C in B){var D=B[C];if(D!==undefined){A[C]=D}}var E=typeof window.Event=="function"&&B instanceof window.Event;if(!E&&B.hasOwnProperty&&B.hasOwnProperty("toString")){A.toString=B.toString}}return A};OpenLayers.String={startsWith:function(B,A){return(B.indexOf(A)==0)},contains:function(B,A){return(B.indexOf(A)!=-1)},trim:function(A){return A.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(D){var C=D.split("-");var F=C[0];for(var A=1,E=C.length;A<E;A++){var B=C[A];F+=B.charAt(0).toUpperCase()+B.substring(1)}return F},format:function(C,A,D){if(!A){A=window}var B=function(H,G){var I;var E=G.split(/\.+/);for(var F=0;F<E.length;F++){if(F==0){I=A}if(I===undefined){break}I=I[E[F]]}if(typeof I=="function"){I=D?I.apply(null,D):I()}if(typeof I=="undefined"){return"undefined"}else{return I}};return C.replace(OpenLayers.String.tokenRegEx,B)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(A){return OpenLayers.String.numberRegEx.test(A)},numericIf:function(B,C){var A=B;if(C===true&&B!=null&&B.replace){B=B.replace(/^\s*|\s*$/g,"")}return OpenLayers.String.isNumeric(B)?parseFloat(B):A}};OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(A,B){var C=0;if(B>0){C=parseFloat(A.toPrecision(B))}return C},format:function(E,G,B,C){G=(typeof G!="undefined")?G:0;B=(typeof B!="undefined")?B:OpenLayers.Number.thousandsSeparator;C=(typeof C!="undefined")?C:OpenLayers.Number.decimalSeparator;if(G!=null){E=parseFloat(E.toFixed(G))}var F=E.toString().split(".");if(F.length==1&&G==null){G=0}var I=F[0];if(B){var A=/(-?[0-9]+)([0-9]{3})/;while(A.test(I)){I=I.replace(A,"$1"+B+"$2")}}var D;if(G==0){D=I}else{var H=F.length>1?F[1]:"0";if(G!=null){H=H+new Array(G-H.length+1).join("0")}D=I+C+H}return D},zeroPad:function(B,C,D){var A=B.toString(D||10);while(A.length<C){A="0"+A}return A}};OpenLayers.Function={bind:function(A,B){var C=Array.prototype.slice.apply(arguments,[2]);return function(){var D=C.concat(Array.prototype.slice.apply(arguments,[0]));return A.apply(B,D)}},bindAsEventListener:function(A,B){return function(C){return A.call(B,C||window.event)}},False:function(){return false},True:function(){return true},Void:function(){}};OpenLayers.Array={filter:function(B,A,F){var G=[];if(Array.prototype.filter){G=B.filter(A,F)}else{var D=B.length;if(typeof A!="function"){throw new TypeError()}for(var C=0;C<D;C++){if(C in B){var E=B[C];if(A.call(F,E,C,B)){G.push(E)}}}}return G}};OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(B,D,A,C){if(OpenLayers.Util.isArray(B)){C=B[3];A=B[2];D=B[1];B=B[0]}if(B!=null){this.left=OpenLayers.Util.toFloat(B)}if(D!=null){this.bottom=OpenLayers.Util.toFloat(D)}if(A!=null){this.right=OpenLayers.Util.toFloat(A)}if(C!=null){this.top=OpenLayers.Util.toFloat(C)}},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(A){var B=false;if(A!=null){B=((this.left==A.left)&&(this.right==A.right)&&(this.top==A.top)&&(this.bottom==A.bottom))}return B},toString:function(){return[this.left,this.bottom,this.right,this.top].join(",")},toArray:function(A){if(A===true){return[this.bottom,this.left,this.top,this.right]}else{return[this.left,this.bottom,this.right,this.top]}},toBBOX:function(G,D){if(G==null){G=6}var A=Math.pow(10,G);var C=Math.round(this.left*A)/A;var B=Math.round(this.bottom*A)/A;var F=Math.round(this.right*A)/A;var E=Math.round(this.top*A)/A;if(D===true){return B+","+C+","+E+","+F}else{return C+","+B+","+F+","+E}},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return(this.right-this.left)},getHeight:function(){return(this.top-this.bottom)},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){if(!this.centerLonLat){this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2)}return this.centerLonLat},scale:function(A,E){if(E==null){E=this.getCenterLonLat()}var G,H;if(E.CLASS_NAME=="OpenLayers.LonLat"){G=E.lon;H=E.lat}else{G=E.x;H=E.y}var D=(this.left-G)*A+G;var F=(this.bottom-H)*A+H;var B=(this.right-G)*A+G;var C=(this.top-H)*A+H;return new OpenLayers.Bounds(D,F,B,C)},add:function(A,B){if((A==null)||(B==null)){throw new TypeError("Bounds.add cannot receive null values")}return new OpenLayers.Bounds(this.left+A,this.bottom+B,this.right+A,this.top+B)},extend:function(A){if(A){switch(A.CLASS_NAME){case"OpenLayers.LonLat":this.extendXY(A.lon,A.lat);break;case"OpenLayers.Geometry.Point":this.extendXY(A.x,A.y);break;case"OpenLayers.Bounds":this.centerLonLat=null;if((this.left==null)||(A.left<this.left)){this.left=A.left}if((this.bottom==null)||(A.bottom<this.bottom)){this.bottom=A.bottom}if((this.right==null)||(A.right>this.right)){this.right=A.right}if((this.top==null)||(A.top>this.top)){this.top=A.top}break}}},extendXY:function(A,B){this.centerLonLat=null;if((this.left==null)||(A<this.left)){this.left=A}if((this.bottom==null)||(B<this.bottom)){this.bottom=B}if((this.right==null)||(A>this.right)){this.right=A}if((this.top==null)||(B>this.top)){this.top=B}},containsLonLat:function(B,E){if(typeof E==="boolean"){E={inclusive:E}}E=E||{};var F=this.contains(B.lon,B.lat,E.inclusive),G=E.worldBounds;if(G&&!F){var A=G.getWidth();var D=(G.left+G.right)/2;var C=Math.round((B.lon-D)/A);F=this.containsLonLat({lon:B.lon-C*A,lat:B.lat},{inclusive:E.inclusive})}return F},containsPixel:function(B,A){return this.contains(B.x,B.y,A)},contains:function(B,C,A){if(A==null){A=true}if(B==null||C==null){return false}B=OpenLayers.Util.toFloat(B);C=OpenLayers.Util.toFloat(C);var D=false;if(A){D=((B>=this.left)&&(B<=this.right)&&(C>=this.bottom)&&(C<=this.top))}else{D=((B>this.left)&&(B<this.right)&&(C>this.bottom)&&(C<this.top))}return D},intersectsBounds:function(C,H){if(typeof H==="boolean"){H={inclusive:H}}H=H||{};if(H.worldBounds){var J=this.wrapDateLine(H.worldBounds);C=C.wrapDateLine(H.worldBounds)}else{J=this}if(H.inclusive==null){H.inclusive=true}var D=false;var E=(J.left==C.right||J.right==C.left||J.top==C.bottom||J.bottom==C.top);if(H.inclusive||!E){var B=(((C.bottom>=J.bottom)&&(C.bottom<=J.top))||((J.bottom>=C.bottom)&&(J.bottom<=C.top)));var M=(((C.top>=J.bottom)&&(C.top<=J.top))||((J.top>C.bottom)&&(J.top<C.top)));var K=(((C.left>=J.left)&&(C.left<=J.right))||((J.left>=C.left)&&(J.left<=C.right)));var A=(((C.right>=J.left)&&(C.right<=J.right))||((J.right>=C.left)&&(J.right<=C.right)));D=((B||M)&&(K||A))}if(H.worldBounds&&!D){var L=H.worldBounds;var I=L.getWidth();var F=!L.containsBounds(J);var G=!L.containsBounds(C);if(F&&!G){C=C.add(-I,0);D=J.intersectsBounds(C,{inclusive:H.inclusive})}else{if(G&&!F){J=J.add(-I,0);D=C.intersectsBounds(J,{inclusive:H.inclusive})}}}return D},containsBounds:function(C,F,A){if(F==null){F=false}if(A==null){A=true}var E=this.contains(C.left,C.bottom,A);var D=this.contains(C.right,C.bottom,A);var G=this.contains(C.left,C.top,A);var B=this.contains(C.right,C.top,A);return(F)?(E||D||G||B):(E&&D&&G&&B)},determineQuadrant:function(A){var C="";var B=this.getCenterLonLat();C+=(A.lat<B.lat)?"b":"t";C+=(A.lon<B.lon)?"l":"r";return C},transform:function(C,B){this.centerLonLat=null;var D=OpenLayers.Projection.transform({"x":this.left,"y":this.bottom},C,B);var A=OpenLayers.Projection.transform({"x":this.right,"y":this.bottom},C,B);var E=OpenLayers.Projection.transform({"x":this.left,"y":this.top},C,B);var F=OpenLayers.Projection.transform({"x":this.right,"y":this.top},C,B);this.left=Math.min(D.x,E.x);this.bottom=Math.min(D.y,A.y);this.right=Math.max(A.x,F.x);this.top=Math.max(E.y,F.y);return this},wrapDateLine:function(D,E){E=E||{};var C=E.leftTolerance||0;var B=E.rightTolerance||0;var A=this.clone();if(D){var F=D.getWidth();while(A.left<D.left&&A.right-B<=D.left){A=A.add(F,0)}while(A.left+C>=D.right&&A.right>D.right){A=A.add(-F,0)}var G=A.left+C;if(G<D.right&&G>D.left&&A.right-B>D.right){A=A.add(-F,0)}}return A},CLASS_NAME:"OpenLayers.Bounds"});OpenLayers.Bounds.fromString=function(C,B){var A=C.split(",");return OpenLayers.Bounds.fromArray(A,B)};OpenLayers.Bounds.fromArray=function(B,A){return A===true?new OpenLayers.Bounds(B[1],B[0],B[3],B[2]):new OpenLayers.Bounds(B[0],B[1],B[2],B[3])};OpenLayers.Bounds.fromSize=function(A){return new OpenLayers.Bounds(0,A.h,A.w,0)};OpenLayers.Bounds.oppositeQuadrant=function(B){var A="";A+=(B.charAt(0)=="t")?"b":"t";A+=(B.charAt(1)=="l")?"r":"l";return A};OpenLayers.Element={visible:function(A){return OpenLayers.Util.getElement(A).style.display!="none"},toggle:function(){for(var A=0,C=arguments.length;A<C;A++){var D=OpenLayers.Util.getElement(arguments[A]);var B=OpenLayers.Element.visible(D)?"none":"";D.style.display=B}},remove:function(A){A=OpenLayers.Util.getElement(A);A.parentNode.removeChild(A)},getHeight:function(A){A=OpenLayers.Util.getElement(A);return A.offsetHeight},hasClass:function(B,A){var C=B.className;return(!!C&&new RegExp("(^|\\s)"+A+"(\\s|$)").test(C))},addClass:function(B,A){if(!OpenLayers.Element.hasClass(B,A)){B.className+=(B.className?" ":"")+A}return B},removeClass:function(B,A){var C=B.className;if(C){B.className=OpenLayers.String.trim(C.replace(new RegExp("(^|\\s+)"+A+"(\\s+|$)")," "))}return B},toggleClass:function(B,A){if(OpenLayers.Element.hasClass(B,A)){OpenLayers.Element.removeClass(B,A)}else{OpenLayers.Element.addClass(B,A)}return B},getStyle:function(D,B){D=OpenLayers.Util.getElement(D);var C=null;if(D&&D.style){C=D.style[OpenLayers.String.camelize(B)];if(!C){if(document.defaultView&&document.defaultView.getComputedStyle){var E=document.defaultView.getComputedStyle(D,null);C=E?E.getPropertyValue(B):null}else{if(D.currentStyle){C=D.currentStyle[OpenLayers.String.camelize(B)]}}}var A=["left","top","right","bottom"];if(window.opera&&(OpenLayers.Util.indexOf(A,B)!=-1)&&(OpenLayers.Element.getStyle(D,"position")=="static")){C="auto"}}return C=="auto"?null:C}};OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(A,B){if(OpenLayers.Util.isArray(A)){B=A[1];A=A[0]}this.lon=OpenLayers.Util.toFloat(A);this.lat=OpenLayers.Util.toFloat(B)},toString:function(){return("lon="+this.lon+",lat="+this.lat)},toShortString:function(){return(this.lon+", "+this.lat)},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(A,B){if((A==null)||(B==null)){throw new TypeError("LonLat.add cannot receive null values")}return new OpenLayers.LonLat(this.lon+OpenLayers.Util.toFloat(A),this.lat+OpenLayers.Util.toFloat(B))},equals:function(A){var B=false;if(A!=null){B=((this.lon==A.lon&&this.lat==A.lat)||(isNaN(this.lon)&&isNaN(this.lat)&&isNaN(A.lon)&&isNaN(A.lat)))}return B},transform:function(C,B){var A=OpenLayers.Projection.transform({"x":this.lon,"y":this.lat},C,B);this.lon=A.x;this.lat=A.y;return this},wrapDateLine:function(A){var B=this.clone();if(A){while(B.lon<A.left){B.lon+=A.getWidth()}while(B.lon>A.right){B.lon-=A.getWidth()}}return B},CLASS_NAME:"OpenLayers.LonLat"});OpenLayers.LonLat.fromString=function(B){var A=B.split(",");return new OpenLayers.LonLat(A[0],A[1])};OpenLayers.LonLat.fromArray=function(D){var B=OpenLayers.Util.isArray(D),A=B&&D[0],C=B&&D[1];return new OpenLayers.LonLat(A,C)};OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(A,B){this.x=parseFloat(A);this.y=parseFloat(B)},toString:function(){return("x="+this.x+",y="+this.y)},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(B){var A=false;if(B!=null){A=((this.x==B.x&&this.y==B.y)||(isNaN(this.x)&&isNaN(this.y)&&isNaN(B.x)&&isNaN(B.y)))}return A},distanceTo:function(A){return Math.sqrt(Math.pow(this.x-A.x,2)+Math.pow(this.y-A.y,2))},add:function(A,B){if((A==null)||(B==null)){throw new TypeError("Pixel.add cannot receive null values")}return new OpenLayers.Pixel(this.x+A,this.y+B)},offset:function(B){var A=this.clone();if(B){A=this.add(B.x,B.y)}return A},CLASS_NAME:"OpenLayers.Pixel"});OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(B,A){this.w=parseFloat(B);this.h=parseFloat(A)},toString:function(){return("w="+this.w+",h="+this.h)},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(A){var B=false;if(A!=null){B=((this.w==A.w&&this.h==A.h)||(isNaN(this.w)&&isNaN(this.h)&&isNaN(A.w)&&isNaN(A.h)))}return B},CLASS_NAME:"OpenLayers.Size"});OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(A){alert(A)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"};(function(){var B=document.getElementsByTagName("script");for(var A=0,C=B.length;A<C;++A){if(B[A].src.indexOf("firebug.js")!=-1){if(console){OpenLayers.Util.extend(OpenLayers.Console,console);break}}}})();OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){if(!OpenLayers.Lang.code){OpenLayers.Lang.setCode()}return OpenLayers.Lang.code},setCode:function(B){var D;if(!B){B=(OpenLayers.BROWSER_NAME=="msie")?navigator.userLanguage:navigator.language}var A=B.split("-");A[0]=A[0].toLowerCase();if(typeof OpenLayers.Lang[A[0]]=="object"){D=A[0]}if(A[1]){var C=A[0]+"-"+A[1].toUpperCase();if(typeof OpenLayers.Lang[C]=="object"){D=C}}if(!D){OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+A.join("-")+" dictionary, falling back to default language");D=OpenLayers.Lang.defaultCode}OpenLayers.Lang.code=D},translate:function(B,A){var D=OpenLayers.Lang[OpenLayers.Lang.getCode()];var C=D&&D[B];if(!C){C=B}if(A){C=OpenLayers.String.format(C,A)}return C}};OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.getElement=function(){var B=[];for(var A=0,C=arguments.length;A<C;A++){var D=arguments[A];if(typeof D=="string"){D=document.getElementById(D)}if(arguments.length==1){return D}B.push(D)}return B};OpenLayers.Util.isElement=function(A){return !!(A&&A.nodeType===1)};OpenLayers.Util.isArray=function(A){return(Object.prototype.toString.call(A)==="[object Array]")};OpenLayers.Util.removeItem=function(A,C){for(var B=A.length-1;B>=0;B--){if(A[B]==C){A.splice(B,1)}}return A};OpenLayers.Util.indexOf=function(A,B){if(typeof A.indexOf=="function"){return A.indexOf(B)}else{for(var C=0,D=A.length;C<D;C++){if(A[C]==B){return C}}return -1}};OpenLayers.Util.dotless=/\./g;OpenLayers.Util.modifyDOMElement=function(B,F,G,A,E,H,C,D){if(F){B.id=F.replace(OpenLayers.Util.dotless,"_")}if(G){B.style.left=G.x+"px";B.style.top=G.y+"px"}if(A){B.style.width=A.w+"px";B.style.height=A.h+"px"}if(E){B.style.position=E}if(H){B.style.border=H}if(C){B.style.overflow=C}if(parseFloat(D)>=0&&parseFloat(D)<1){B.style.filter="alpha(opacity="+(D*100)+")";B.style.opacity=D}else{if(parseFloat(D)==1){B.style.filter="";B.style.opacity=""}}};OpenLayers.Util.createDiv=function(G,H,A,D,F,I,C,E){var B=document.createElement("div");if(D){B.style.backgroundImage="url("+D+")"}if(!G){G=OpenLayers.Util.createUniqueID("OpenLayersDiv")}if(!F){F="absolute"}OpenLayers.Util.modifyDOMElement(B,G,H,A,F,I,C,E);return B};OpenLayers.Util.createImage=function(H,I,A,E,G,J,F,C){var B=document.createElement("img");if(!H){H=OpenLayers.Util.createUniqueID("OpenLayersDiv")}if(!G){G="relative"}OpenLayers.Util.modifyDOMElement(B,H,I,A,G,J,null,F);if(C){B.style.display="none";function D(){B.style.display="";OpenLayers.Event.stopObservingElement(B)}OpenLayers.Event.observe(B,"load",D);OpenLayers.Event.observe(B,"error",D)}B.style.alt=H;B.galleryImg="no";if(E){B.src=E}return B};OpenLayers.IMAGE_RELOAD_ATTEMPTS=0;OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var A=navigator.appVersion.split("MSIE");var D=parseFloat(A[1]);var C=false;try{C=!!(document.body.filters)}catch(B){}OpenLayers.Util.alphaHackNeeded=(C&&(D>=5.5)&&(D<7))}return OpenLayers.Util.alphaHackNeeded};OpenLayers.Util.modifyAlphaImageDiv=function(J,G,H,A,C,F,I,E,D){OpenLayers.Util.modifyDOMElement(J,G,H,A,F,null,null,D);var B=J.childNodes[0];if(C){B.src=C}OpenLayers.Util.modifyDOMElement(B,J.id+"_innerImage",null,A,"relative",I);if(OpenLayers.Util.alphaHack()){if(J.style.display!="none"){J.style.display="inline-block"}if(E==null){E="scale"}J.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+B.src+"', sizingMethod='"+E+"')";if(parseFloat(J.style.opacity)>=0&&parseFloat(J.style.opacity)<1){J.style.filter+=" alpha(opacity="+J.style.opacity*100+")"}B.style.filter="alpha(opacity=0)"}};OpenLayers.Util.createAlphaImageDiv=function(H,I,A,D,G,J,F,E,C){var K=OpenLayers.Util.createDiv();var B=OpenLayers.Util.createImage(null,null,null,null,null,null,null,C);B.className="olAlphaImg";K.appendChild(B);OpenLayers.Util.modifyAlphaImageDiv(K,H,I,A,D,G,J,F,E);return K};OpenLayers.Util.upperCaseObject=function(B){var C={};for(var A in B){C[A.toUpperCase()]=B[A]}return C};OpenLayers.Util.applyDefaults=function(C,B){C=C||{};var D=typeof window.Event=="function"&&B instanceof window.Event;for(var A in B){if(C[A]===undefined||(!D&&B.hasOwnProperty&&B.hasOwnProperty(A)&&!C.hasOwnProperty(A))){C[A]=B[A]}}if(!D&&B&&B.hasOwnProperty&&B.hasOwnProperty("toString")&&!C.hasOwnProperty("toString")){C.toString=B.toString}return C};OpenLayers.Util.getParameterString=function(D){var A=[];for(var F in D){var C=D[F];if((C!=null)&&(typeof C!="function")){var E;if(typeof C=="object"&&C.constructor==Array){var H=[];var I;for(var G=0,B=C.length;G<B;G++){I=C[G];H.push(encodeURIComponent((I===null||I===undefined)?"":I))}E=H.join(",")}else{E=encodeURIComponent(C)}A.push(encodeURIComponent(F)+"="+E)}}return A.join("&")};OpenLayers.Util.urlAppend=function(C,A){var D=C;if(A){var B=(C+" ").split(/[?&]/);D+=(B.pop()===" "?A:B.length?"&"+A:"?"+A)}return D};OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||(OpenLayers._getScriptLocation()+"img/")};OpenLayers.Util.getImageLocation=function(A){return OpenLayers.Util.getImagesLocation()+A};OpenLayers.Util.Try=function(){var A=null;for(var B=0,D=arguments.length;B<D;B++){var E=arguments[B];try{A=E();break}catch(C){}}return A};OpenLayers.Util.getXmlNodeValue=function(A){var B=null;OpenLayers.Util.Try(function(){B=A.text;if(!B){B=A.textContent}if(!B){B=A.firstChild.nodeValue}},function(){B=A.textContent});return B};OpenLayers.Util.mouseLeft=function(A,B){var C=(A.relatedTarget)?A.relatedTarget:A.toElement;while(C!=B&&C!=null){C=C.parentNode}return(C!=B)};OpenLayers.Util.DEFAULT_PRECISION=14;OpenLayers.Util.toFloat=function(B,A){if(A==null){A=OpenLayers.Util.DEFAULT_PRECISION}if(typeof B!=="number"){B=parseFloat(B)}return A===0?B:parseFloat(B.toPrecision(A))};OpenLayers.Util.rad=function(A){return A*Math.PI/180};OpenLayers.Util.deg=function(A){return A*180/Math.PI};OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563};OpenLayers.Util.distVincenty=function(m,F){var G=OpenLayers.Util.VincentyConstants;var P=G.a,N=G.b,Q=G.f;var W=OpenLayers.Util.rad(F.lon-m.lon);var O=Math.atan((1-Q)*Math.tan(OpenLayers.Util.rad(m.lat)));var S=Math.atan((1-Q)*Math.tan(OpenLayers.Util.rad(F.lat)));var c=Math.sin(O),e=Math.cos(O);var Z=Math.sin(S),Y=Math.cos(S);var g=W,T=2*Math.PI;var J=20;while(Math.abs(g-T)>1e-12&&--J>0){var j=Math.sin(g),i=Math.cos(g);var K=Math.sqrt((Y*j)*(Y*j)+(e*Z-c*Y*i)*(e*Z-c*Y*i));if(K==0){return 0}var I=c*Z+e*Y*i;var H=Math.atan2(K,I);var V=Math.asin(e*Y*j/K);var M=Math.cos(V)*Math.cos(V);var k=I-2*c*Z/M;var l=Q/16*M*(4+Q*(4-3*M));T=g;g=W+(1-l)*Q*Math.sin(V)*(H+l*K*(k+l*I*(-1+2*k*k)))}if(J==0){return NaN}var E=M*(P*P-N*N)/(N*N);var U=1+E/16384*(4096+E*(-768+E*(320-175*E)));var X=E/1024*(256+E*(-128+E*(74-47*E)));var h=X*K*(k+X/4*(I*(-1+2*k*k)-X/6*k*(-3+4*K*K)*(-3+4*k*k)));var D=N*U*(H-h);var R=D.toFixed(3)/1000;return R};OpenLayers.Util.destinationVincenty=function(M,Q,Z){var k=OpenLayers.Util;var H=k.VincentyConstants;var o=H.a,n=H.b,p=H.f;var F=M.lon;var G=M.lat;var K=Z;var W=k.rad(Q);var m=Math.sin(W);var h=Math.cos(W);var N=(1-p)*Math.tan(k.rad(G));var V=1/Math.sqrt((1+N*N)),l=N*V;var U=Math.atan2(N,h);var I=V*m;var S=1-I*I;var j=S*(o*o-n*n)/(n*n);var c=1+j/16384*(4096+j*(-768+j*(320-175*j)));var Y=j/1024*(256+j*(-128+j*(74-47*j)));var e=K/(n*c),T=2*Math.PI;while(Math.abs(e-T)>1e-12){var g=Math.cos(2*U+e);var E=Math.sin(e);var R=Math.cos(e);var O=Y*E*(g+Y/4*(R*(-1+2*g*g)-Y/6*g*(-3+4*E*E)*(-3+4*g*g)));T=e;e=K/(n*c)+O}var i=l*E-V*R*h;var J=Math.atan2(l*R+V*E*h,(1-p)*Math.sqrt(I*I+i*i));var D=Math.atan2(E*m,V*R-l*E*h);var d=p/16*S*(4+p*(4-3*S));var X=D-(1-d)*p*I*(e+d*E*(g+d*R*(-1+2*g*g)));var P=Math.atan2(I,-i);return new OpenLayers.LonLat(F+k.deg(X),k.deg(J))};OpenLayers.Util.getParameters=function(A,K){K=K||{};A=(A===null||A===undefined)?window.location.href:A;var M="";if(OpenLayers.String.contains(A,"?")){var C=A.indexOf("?")+1;var E=OpenLayers.String.contains(A,"#")?A.indexOf("#"):A.length;M=A.substring(C,E)}var L={};var J=M.split(/[&;]/);for(var I=0,B=J.length;I<B;++I){var G=J[I].split("=");if(G[0]){var F=G[0];try{F=decodeURIComponent(F)}catch(H){F=unescape(F)}var D=(G[1]||"").replace(/\+/g," ");try{D=decodeURIComponent(D)}catch(H){D=unescape(D)}if(K.splitArgs!==false){D=D.split(",")}if(D.length==1){D=D[0]}L[F]=D}}return L};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(A){if(A==null){A="id_"}else{A=A.replace(OpenLayers.Util.dotless,"_")}OpenLayers.Util.lastSeqID+=1;return A+OpenLayers.Util.lastSeqID};OpenLayers.INCHES_PER_UNIT={"inches":1,"ft":12,"mi":63360,"m":39.37,"km":39370,"dd":4374754,"yd":36};OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT["degrees"]=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT["nmi"]=1852*OpenLayers.INCHES_PER_UNIT.m;OpenLayers.METERS_PER_INCH=0.0254000508001016;OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{"Inch":OpenLayers.INCHES_PER_UNIT.inches,"Meter":1/OpenLayers.METERS_PER_INCH,"Foot":0.304800609601219/OpenLayers.METERS_PER_INCH,"IFoot":0.3048/OpenLayers.METERS_PER_INCH,"ClarkeFoot":0.3047972651151/OpenLayers.METERS_PER_INCH,"SearsFoot":0.304799471538676/OpenLayers.METERS_PER_INCH,"GoldCoastFoot":0.304799710181509/OpenLayers.METERS_PER_INCH,"IInch":0.0254/OpenLayers.METERS_PER_INCH,"MicroInch":2.54e-05/OpenLayers.METERS_PER_INCH,"Mil":2.54e-08/OpenLayers.METERS_PER_INCH,"Centimeter":0.01/OpenLayers.METERS_PER_INCH,"Kilometer":1000/OpenLayers.METERS_PER_INCH,"Yard":0.914401828803658/OpenLayers.METERS_PER_INCH,"SearsYard":0.914398414616029/OpenLayers.METERS_PER_INCH,"IndianYard":0.914398530744441/OpenLayers.METERS_PER_INCH,"IndianYd37":0.91439523/OpenLayers.METERS_PER_INCH,"IndianYd62":0.9143988/OpenLayers.METERS_PER_INCH,"IndianYd75":0.9143985/OpenLayers.METERS_PER_INCH,"IndianFoot":0.30479951/OpenLayers.METERS_PER_INCH,"IndianFt37":0.30479841/OpenLayers.METERS_PER_INCH,"IndianFt62":0.3047996/OpenLayers.METERS_PER_INCH,"IndianFt75":0.3047995/OpenLayers.METERS_PER_INCH,"Mile":1609.34721869444/OpenLayers.METERS_PER_INCH,"IYard":0.9144/OpenLayers.METERS_PER_INCH,"IMile":1609.344/OpenLayers.METERS_PER_INCH,"NautM":1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.316488933/OpenLayers.METERS_PER_INCH,"Lat-83":110946.257368722/OpenLayers.METERS_PER_INCH,"Decimeter":0.1/OpenLayers.METERS_PER_INCH,"Millimeter":0.001/OpenLayers.METERS_PER_INCH,"Dekameter":10/OpenLayers.METERS_PER_INCH,"Decameter":10/OpenLayers.METERS_PER_INCH,"Hectometer":100/OpenLayers.METERS_PER_INCH,"GermanMeter":1.0000135965/OpenLayers.METERS_PER_INCH,"CaGrid":0.999738/OpenLayers.METERS_PER_INCH,"ClarkeChain":20.1166194976/OpenLayers.METERS_PER_INCH,"GunterChain":20.1168402336805/OpenLayers.METERS_PER_INCH,"BenoitChain":20.1167824943759/OpenLayers.METERS_PER_INCH,"SearsChain":20.11676512155/OpenLayers.METERS_PER_INCH,"ClarkeLink":0.201166194976/OpenLayers.METERS_PER_INCH,"GunterLink":0.201168402336805/OpenLayers.METERS_PER_INCH,"BenoitLink":0.201167824943759/OpenLayers.METERS_PER_INCH,"SearsLink":0.2011676512155/OpenLayers.METERS_PER_INCH,"Rod":5.02921005842012/OpenLayers.METERS_PER_INCH,"IntnlChain":20.1168/OpenLayers.METERS_PER_INCH,"IntnlLink":0.201168/OpenLayers.METERS_PER_INCH,"Perch":5.02921005842012/OpenLayers.METERS_PER_INCH,"Pole":5.02921005842012/OpenLayers.METERS_PER_INCH,"Furlong":201.168402336805/OpenLayers.METERS_PER_INCH,"Rood":3.778266898/OpenLayers.METERS_PER_INCH,"CapeFoot":0.3047972615/OpenLayers.METERS_PER_INCH,"Brealey":375/OpenLayers.METERS_PER_INCH,"ModAmFt":0.304812252984506/OpenLayers.METERS_PER_INCH,"Fathom":1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":50000/OpenLayers.METERS_PER_INCH,"150kilometers":150000/OpenLayers.METERS_PER_INCH});OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{"mm":OpenLayers.INCHES_PER_UNIT["Meter"]/1000,"cm":OpenLayers.INCHES_PER_UNIT["Meter"]/100,"dm":OpenLayers.INCHES_PER_UNIT["Meter"]*100,"km":OpenLayers.INCHES_PER_UNIT["Meter"]*1000,"kmi":OpenLayers.INCHES_PER_UNIT["nmi"],"fath":OpenLayers.INCHES_PER_UNIT["Fathom"],"ch":OpenLayers.INCHES_PER_UNIT["IntnlChain"],"link":OpenLayers.INCHES_PER_UNIT["IntnlLink"],"us-in":OpenLayers.INCHES_PER_UNIT["inches"],"us-ft":OpenLayers.INCHES_PER_UNIT["Foot"],"us-yd":OpenLayers.INCHES_PER_UNIT["Yard"],"us-ch":OpenLayers.INCHES_PER_UNIT["GunterChain"],"us-mi":OpenLayers.INCHES_PER_UNIT["Mile"],"ind-yd":OpenLayers.INCHES_PER_UNIT["IndianYd37"],"ind-ft":OpenLayers.INCHES_PER_UNIT["IndianFt37"],"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(B){var A=(B>1)?(1/B):B;return A};OpenLayers.Util.getResolutionFromScale=function(D,B){var C;if(D){if(B==null){B="degrees"}var A=OpenLayers.Util.normalizeScale(D);C=1/(A*OpenLayers.INCHES_PER_UNIT[B]*OpenLayers.DOTS_PER_INCH)}return C};OpenLayers.Util.getScaleFromResolution=function(B,C){if(C==null){C="degrees"}var A=B*OpenLayers.INCHES_PER_UNIT[C]*OpenLayers.DOTS_PER_INCH;return A};OpenLayers.Util.pagePosition=function(A){var H=[0,0];var G=OpenLayers.Util.getViewportElement();if(!A||A==window||A==G){return H}var I=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&OpenLayers.Element.getStyle(A,"position")=="absolute"&&(A.style.top==""||A.style.left=="");var J=null;var E;if(A.getBoundingClientRect){E=A.getBoundingClientRect();var C=window.pageYOffset||G.scrollTop;var F=window.pageXOffset||G.scrollLeft;H[0]=E.left+F;H[1]=E.top+C}else{if(document.getBoxObjectFor&&!I){E=document.getBoxObjectFor(A);var B=document.getBoxObjectFor(G);H[0]=E.screenX-B.screenX;H[1]=E.screenY-B.screenY}else{H[0]=A.offsetLeft;H[1]=A.offsetTop;J=A.offsetParent;if(J!=A){while(J){H[0]+=J.offsetLeft;H[1]+=J.offsetTop;J=J.offsetParent}}var D=OpenLayers.BROWSER_NAME;if(D=="opera"||(D=="safari"&&OpenLayers.Element.getStyle(A,"position")=="absolute")){H[1]-=document.body.offsetTop}J=A.offsetParent;while(J&&J!=document.body){H[0]-=J.scrollLeft;if(D!="opera"||J.tagName!="TR"){H[1]-=J.scrollTop}J=J.offsetParent}}}return H};OpenLayers.Util.getViewportElement=function(){var A=arguments.callee.viewportElement;if(A==undefined){A=(OpenLayers.BROWSER_NAME=="msie"&&document.compatMode!="CSS1Compat")?document.body:document.documentElement;arguments.callee.viewportElement=A}return A};OpenLayers.Util.isEquivalentUrl=function(B,C,E){E=E||{};OpenLayers.Util.applyDefaults(E,{ignoreCase:true,ignorePort80:true,ignoreHash:true,splitArgs:false});var A=OpenLayers.Util.createUrlObject(B,E);var D=OpenLayers.Util.createUrlObject(C,E);for(var F in A){if(F!=="args"){if(A[F]!=D[F]){return false}}}for(var F in A.args){if(A.args[F]!=D.args[F]){return false}delete D.args[F]}for(var F in D.args){return false}return true};OpenLayers.Util.createUrlObject=function(I,G){G=G||{};if(!(/^\w+:\/\//).test(I)){var C=window.location;var F=C.port?":"+C.port:"";var A=C.protocol+"//"+C.host.split(":").shift()+F;if(I.indexOf("/")===0){I=A+I}else{var H=C.pathname.split("/");H.pop();I=A+H.join("/")+"/"+I}}if(G.ignoreCase){I=I.toLowerCase()}var J=document.createElement("a");J.href=I;var E={};E.host=J.host.split(":").shift();E.protocol=J.protocol;if(G.ignorePort80){E.port=(J.port=="80"||J.port=="0")?"":J.port}else{E.port=(J.port==""||J.port=="0")?"80":J.port}E.hash=(G.ignoreHash||J.hash==="#")?"":J.hash;var B=J.search;if(!B){var D=I.indexOf("?");B=(D!=-1)?I.substr(D):""}E.args=OpenLayers.Util.getParameters(B,{splitArgs:G.splitArgs});E.pathname=(J.pathname.charAt(0)=="/")?J.pathname:"/"+J.pathname;return E};OpenLayers.Util.removeTail=function(A){var C=null;var D=A.indexOf("?");var B=A.indexOf("#");if(D==-1){C=(B!=-1)?A.substr(0,B):A}else{C=(B!=-1)?A.substr(0,Math.min(D,B)):A.substr(0,D)}return C};OpenLayers.IS_GECKO=(function(){var A=navigator.userAgent.toLowerCase();return A.indexOf("webkit")==-1&&A.indexOf("gecko")!=-1})();OpenLayers.CANVAS_SUPPORTED=(function(){var A=document.createElement("canvas");return !!(A.getContext&&A.getContext("2d"))})();OpenLayers.BROWSER_NAME=(function(){var A="";var B=navigator.userAgent.toLowerCase();if(B.indexOf("opera")!=-1){A="opera"}else{if(B.indexOf("msie")!=-1){A="msie"}else{if(B.indexOf("safari")!=-1){A="safari"}else{if(B.indexOf("mozilla")!=-1){if(B.indexOf("firefox")!=-1){A="firefox"}else{A="mozilla"}}}}}return A})();OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME};OpenLayers.Util.getRenderedDimensions=function(F,B,G){var C,E;var I=document.createElement("div");I.style.visibility="hidden";var L=(G&&G.containerElement)?G.containerElement:document.body;var A=false;var D=null;var M=L;while(M&&M.tagName.toLowerCase()!="body"){var J=OpenLayers.Element.getStyle(M,"position");if(J=="absolute"){A=true;break}else{if(J&&J!="static"){break}}M=M.parentNode}if(A&&(L.clientHeight===0||L.clientWidth===0)){D=document.createElement("div");D.style.visibility="hidden";D.style.position="absolute";D.style.overflow="visible";D.style.width=document.body.clientWidth+"px";D.style.height=document.body.clientHeight+"px";D.appendChild(I)}I.style.position="absolute";if(B){if(B.w){C=B.w;I.style.width=C+"px"}else{if(B.h){E=B.h;I.style.height=E+"px"}}}if(G&&G.displayClass){I.className=G.displayClass}var N=document.createElement("div");N.innerHTML=F;N.style.overflow="visible";if(N.childNodes){for(var H=0,K=N.childNodes.length;H<K;H++){if(!N.childNodes[H].style){continue}N.childNodes[H].style.overflow="visible"}}I.appendChild(N);if(D){L.appendChild(D)}else{L.appendChild(I)}if(!C){C=parseInt(N.scrollWidth);I.style.width=C+"px"}if(!E){E=parseInt(N.scrollHeight)}I.removeChild(N);if(D){D.removeChild(I);L.removeChild(D)}else{L.removeChild(I)}return new OpenLayers.Size(C,E)};OpenLayers.Util.getScrollbarWidth=function(){var C=OpenLayers.Util._scrollbarWidth;if(C==null){var B=null;var E=null;var A=0;var D=0;B=document.createElement("div");B.style.position="absolute";B.style.top="-1000px";B.style.left="-1000px";B.style.width="100px";B.style.height="50px";B.style.overflow="hidden";E=document.createElement("div");E.style.width="100%";E.style.height="200px";B.appendChild(E);document.body.appendChild(B);A=E.offsetWidth;B.style.overflow="scroll";D=E.offsetWidth;document.body.removeChild(document.body.lastChild);OpenLayers.Util._scrollbarWidth=(A-D);C=OpenLayers.Util._scrollbarWidth}return C};OpenLayers.Util.getFormattedLonLat=function(E,B,I){if(!I){I="dms"}E=(E+540)%360-180;var C=Math.abs(E);var G=Math.floor(C);var H=(C-G)/(1/60);var A=H;H=Math.floor(H);var F=(A-H)/(1/60);F=Math.round(F*10);F/=10;if(F>=60){F-=60;H+=1;if(H>=60){H-=60;G+=1}}if(G<10){G="0"+G}var D=G+"\u00B0";if(I.indexOf("dm")>=0){if(H<10){H="0"+H}D+=H+"'";if(I.indexOf("dms")>=0){if(F<10){F="0"+F}D+=F+'"'}}if(B=="lon"){D+=E<0?OpenLayers.i18n("W"):OpenLayers.i18n("E")}else{D+=E<0?OpenLayers.i18n("S"):OpenLayers.i18n("N")}return D};OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:false,initialize:function(A){OpenLayers.Util.extend(this,A);this.options=A},destroy:function(){},read:function(A){throw new Error("Read not implemented.")},write:function(A){throw new Error("Write not implemented.")},CLASS_NAME:"OpenLayers.Format"});OpenLayers.Format.CSWGetRecords=function(B){B=OpenLayers.Util.applyDefaults(B,OpenLayers.Format.CSWGetRecords.DEFAULTS);var A=OpenLayers.Format.CSWGetRecords["v"+B.version.replace(/\./g,"_")];if(!A){throw"Unsupported CSWGetRecords version: "+B.version}return new A(B)};OpenLayers.Format.CSWGetRecords.DEFAULTS={"version":"2.0.2"};OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:false,displayClass:"",title:"",autoActivate:false,active:null,handlerOptions:null,handler:null,eventListeners:null,events:null,initialize:function(A){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,"");OpenLayers.Util.extend(this,A);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")}},destroy:function(){if(this.events){if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy();this.events=null}this.eventListeners=null;if(this.handler){this.handler.destroy();this.handler=null}if(this.handlers){for(var A in this.handlers){if(this.handlers.hasOwnProperty(A)&&typeof this.handlers[A].destroy=="function"){this.handlers[A].destroy()}}this.handlers=null}if(this.map){this.map.removeControl(this);this.map=null}this.div=null},setMap:function(A){this.map=A;if(this.handler){this.handler.setMap(A)}},draw:function(A){if(this.div==null){this.div=OpenLayers.Util.createDiv(this.id);this.div.className=this.displayClass;if(!this.allowSelection){this.div.className+=" olControlNoSelect";this.div.setAttribute("unselectable","on",0);this.div.onselectstart=OpenLayers.Function.False}if(this.title!=""){this.div.title=this.title}}if(A!=null){this.position=A.clone()}this.moveTo(this.position);return this.div},moveTo:function(A){if((A!=null)&&(this.div!=null)){this.div.style.left=A.x+"px";this.div.style.top=A.y+"px"}},activate:function(){if(this.active){return false}if(this.handler){this.handler.activate()}this.active=true;if(this.map){OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active")}this.events.triggerEvent("activate");return true},deactivate:function(){if(this.active){if(this.handler){this.handler.deactivate()}this.active=false;if(this.map){OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active")}this.events.triggerEvent("deactivate");return true}return false},CLASS_NAME:"OpenLayers.Control"});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;OpenLayers.Event={observers:false,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(A){return A.target||A.srcElement},isSingleTouch:function(A){return A.touches&&A.touches.length==1},isMultiTouch:function(A){return A.touches&&A.touches.length>1},isLeftClick:function(A){return(((A.which)&&(A.which==1))||((A.button)&&(A.button==1)))},isRightClick:function(A){return(((A.which)&&(A.which==3))||((A.button)&&(A.button==2)))},stop:function(B,A){if(!A){OpenLayers.Event.preventDefault(B)}if(B.stopPropagation){B.stopPropagation()}else{B.cancelBubble=true}},preventDefault:function(A){if(A.preventDefault){A.preventDefault()}else{A.returnValue=false}},findElement:function(B,A){var C=OpenLayers.Event.element(B);while(C.parentNode&&(!C.tagName||(C.tagName.toUpperCase()!=A.toUpperCase()))){C=C.parentNode}return C},observe:function(B,C,G,E){var F=OpenLayers.Util.getElement(B);E=E||false;if(C=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||F.attachEvent)){C="keydown"}if(!this.observers){this.observers={}}if(!F._eventCacheID){var D="eventCacheID_";if(F.id){D=F.id+"_"+D}F._eventCacheID=OpenLayers.Util.createUniqueID(D)}var A=F._eventCacheID;if(!this.observers[A]){this.observers[A]=[]}this.observers[A].push({"element":F,"name":C,"observer":G,"useCapture":E});if(F.addEventListener){F.addEventListener(C,G,E)}else{if(F.attachEvent){F.attachEvent("on"+C,G)}}},stopObservingElement:function(B){var C=OpenLayers.Util.getElement(B);var A=C._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[A])},_removeElementObservers:function(C){if(C){for(var A=C.length-1;A>=0;A--){var B=C[A];OpenLayers.Event.stopObserving.apply(this,[B.element,B.name,B.observer,B.useCapture])}}},stopObserving:function(C,B,G,I){I=I||false;var A=OpenLayers.Util.getElement(C);var F=A._eventCacheID;if(B=="keypress"){if(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||A.detachEvent){B="keydown"}}var J=false;var D=OpenLayers.Event.observers[F];if(D){var E=0;while(!J&&E<D.length){var H=D[E];if((H.name==B)&&(H.observer==G)&&(H.useCapture==I)){D.splice(E,1);if(D.length==0){delete OpenLayers.Event.observers[F]}J=true;break}E++}}if(J){if(A.removeEventListener){A.removeEventListener(B,G,I)}else{if(A&&A.detachEvent){A.detachEvent("on"+B,G)}}}return J},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var A in OpenLayers.Event.observers){var B=OpenLayers.Event.observers[A];OpenLayers.Event._removeElementObservers.apply(this,[B])}OpenLayers.Event.observers=false}},CLASS_NAME:"OpenLayers.Event"};OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,false);OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown"],listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:false,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(A,C,E,D,B){OpenLayers.Util.extend(this,B);this.object=A;this.fallThrough=D;this.listeners={};this.extensions={};this.extensionCount={};this._msTouches=[];if(C!=null){this.attachToElement(C)}},destroy:function(){for(var A in this.extensions){if(typeof this.extensions[A]!=="boolean"){this.extensions[A].destroy()}}this.extensions=null;if(this.element){OpenLayers.Event.stopObservingElement(this.element);if(this.element.hasScrollEvent){OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)}}this.element=null;this.listeners=null;this.object=null;this.fallThrough=null;this.eventHandler=null},addEventType:function(A){},attachToElement:function(D){if(this.element){OpenLayers.Event.stopObservingElement(this.element)}else{this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this);this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this)}this.element=D;var E=!!window.navigator.msMaxTouchPoints;var A;for(var B=0,C=this.BROWSER_EVENTS.length;B<C;B++){A=this.BROWSER_EVENTS[B];OpenLayers.Event.observe(D,A,this.eventHandler);if(E&&A.indexOf("touch")===0){this.addMsTouchListener(D,A,this.eventHandler)}}OpenLayers.Event.observe(D,"dragstart",OpenLayers.Event.stop)},on:function(B){for(var A in B){if(A!="scope"&&B.hasOwnProperty(A)){this.register(A,B.scope,B[A])}}},register:function(A,B,C,E){if(A in OpenLayers.Events&&!this.extensions[A]){this.extensions[A]=new OpenLayers.Events[A](this)}if(C!=null){if(B==null){B=this.object}var F=this.listeners[A];if(!F){F=[];this.listeners[A]=F;this.extensionCount[A]=0}var D={obj:B,func:C};if(E){F.splice(this.extensionCount[A],0,D);if(typeof E==="object"&&E.extension){this.extensionCount[A]++}}else{F.push(D)}}},registerPriority:function(A,B,C){this.register(A,B,C,true)},un:function(B){for(var A in B){if(A!="scope"&&B.hasOwnProperty(A)){this.unregister(A,B.scope,B[A])}}},unregister:function(A,C,D){if(C==null){C=this.object}var F=this.listeners[A];if(F!=null){for(var B=0,E=F.length;B<E;B++){if(F[B].obj==C&&F[B].func==D){F.splice(B,1);break}}}},remove:function(A){if(this.listeners[A]!=null){this.listeners[A]=[]}},triggerEvent:function(A,C){var E=this.listeners[A];if(!E||E.length==0){return undefined}if(C==null){C={}}C.object=this.object;C.element=this.element;if(!C.type){C.type=A}E=E.slice();var G;for(var B=0,D=E.length;B<D;B++){var F=E[B];G=F.func.apply(F.obj,[C]);if((G!=undefined)&&(G==false)){break}}if(!this.fallThrough){OpenLayers.Event.stop(C,true)}return G},handleBrowserEvent:function(B){var C=B.type,F=this.listeners[C];if(!F||F.length==0){return}var E=B.touches;if(E&&E[0]){var G=0;var H=0;var D=E.length;var A;for(var I=0;I<D;++I){A=this.getTouchClientXY(E[I]);G+=A.clientX;H+=A.clientY}B.clientX=G/D;B.clientY=H/D}if(this.includeXY){B.xy=this.getMousePosition(B)}this.triggerEvent(C,B)},getTouchClientXY:function(C){var B=window.olMockWin||window,A=B.pageXOffset,F=B.pageYOffset,D=C.clientX,E=C.clientY;if(C.pageY===0&&Math.floor(E)>Math.floor(C.pageY)||C.pageX===0&&Math.floor(D)>Math.floor(C.pageX)){D=D-A;E=E-F}else{if(E<(C.pageY-F)||D<(C.pageX-A)){D=C.pageX-A;E=C.pageY-F}}C.olClientX=D;C.olClientY=E;return{clientX:D,clientY:E}},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;this.element.offsets=null},getMousePosition:function(B){if(!this.includeXY){this.clearMouseCache()}else{if(!this.element.hasScrollEvent){OpenLayers.Event.observe(window,"scroll",this.clearMouseListener);this.element.hasScrollEvent=true}}if(!this.element.scrolls){var A=OpenLayers.Util.getViewportElement();this.element.scrolls=[window.pageXOffset||A.scrollLeft,window.pageYOffset||A.scrollTop]}if(!this.element.lefttop){this.element.lefttop=[(document.documentElement.clientLeft||0),(document.documentElement.clientTop||0)]}if(!this.element.offsets){this.element.offsets=OpenLayers.Util.pagePosition(this.element)}return new OpenLayers.Pixel((B.clientX+this.element.scrolls[0])-this.element.offsets[0]-this.element.lefttop[0],(B.clientY+this.element.scrolls[1])-this.element.offsets[1]-this.element.lefttop[1])},addMsTouchListener:function(E,A,D){var F=this.eventHandler;var C=this._msTouches;function B(G){D(OpenLayers.Util.applyDefaults({stopPropagation:function(){for(var H=C.length-1;H>=0;--H){C[H].stopPropagation()}},preventDefault:function(){for(var H=C.length-1;H>=0;--H){C[H].preventDefault()}},type:A},G))}switch(A){case"touchstart":return this.addMsTouchListenerStart(E,A,B);case"touchend":return this.addMsTouchListenerEnd(E,A,B);case"touchmove":return this.addMsTouchListenerMove(E,A,B);default:throw"Unknown touch event type"}},addMsTouchListenerStart:function(F,A,C){var B=this._msTouches;var D=function(H){var I=false;for(var G=0,J=B.length;G<J;++G){if(B[G].pointerId==H.pointerId){I=true;break}}if(!I){B.push(H)}H.touches=B.slice();C(H)};OpenLayers.Event.observe(F,"MSPointerDown",D);var E=function(H){for(var G=0,I=B.length;G<I;++G){if(B[G].pointerId==H.pointerId){B.splice(G,1);break}}};OpenLayers.Event.observe(F,"MSPointerUp",E)},addMsTouchListenerMove:function(E,A,C){var B=this._msTouches;var D=function(G){if(G.pointerType==G.MSPOINTER_TYPE_MOUSE&&G.buttons==0){return}if(B.length==1&&B[0].pageX==G.pageX&&B[0].pageY==G.pageY){return}for(var F=0,H=B.length;F<H;++F){if(B[F].pointerId==G.pointerId){B[F]=G;break}}G.touches=B.slice();C(G)};OpenLayers.Event.observe(E,"MSPointerMove",D)},addMsTouchListenerEnd:function(E,A,C){var B=this._msTouches;var D=function(G){for(var F=0,H=B.length;F<H;++F){if(B[F].pointerId==G.pointerId){B.splice(F,1);break}}G.touches=B.slice();C(G)};OpenLayers.Event.observe(E,"MSPointerUp",D)},CLASS_NAME:"OpenLayers.Events"});OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:["mousedown","mouseup","click","dblclick","touchstart","touchmove","touchend","keydown"],startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(B){this.target=B;for(var A=this.events.length-1;A>=0;--A){this.target.register(this.events[A],this,this.buttonClick,{extension:true})}},destroy:function(){for(var A=this.events.length-1;A>=0;--A){this.target.unregister(this.events[A],this,this.buttonClick)}delete this.target},getPressedButton:function(C){var B=3,A;do{if(OpenLayers.Element.hasClass(C,"olButton")){A=C;break}C=C.parentNode}while(--B>0&&C);return A},ignore:function(C){var A=3,B=false;do{if(C.nodeName.toLowerCase()==="a"){B=true;break}C=C.parentNode}while(--A>0&&C);return B},buttonClick:function(C){var H=true,A=OpenLayers.Event.element(C);if(A&&(OpenLayers.Event.isLeftClick(C)||!~C.type.indexOf("mouse"))){var D=this.getPressedButton(A);if(D){if(C.type==="keydown"){switch(C.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:D});OpenLayers.Event.stop(C);H=false;break}}else{if(this.startEvt){if(this.completeRegEx.test(C.type)){var G=OpenLayers.Util.pagePosition(D);var F=OpenLayers.Util.getViewportElement();var B=window.pageYOffset||F.scrollTop;var E=window.pageXOffset||F.scrollLeft;G[0]=G[0]-E;G[1]=G[1]-B;this.target.triggerEvent("buttonclick",{buttonElement:D,buttonXY:{x:this.startEvt.clientX-G[0],y:this.startEvt.clientY-G[1]}})}if(this.cancelRegEx.test(C.type)){delete this.startEvt}OpenLayers.Event.stop(C);H=false}}if(this.startRegEx.test(C.type)){this.startEvt=C;OpenLayers.Event.stop(C);H=false}}else{H=!this.ignore(OpenLayers.Event.element(C));delete this.startEvt}}return H}});OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.vendorPrefix=(function(){var A=["","O","ms","Moz","Webkit"],F=document.createElement("div").style,H={},C={};function B(I){if(!I){return null}return I.replace(/([A-Z])/g,function(J){return"-"+J.toLowerCase()}).replace(/^ms-/,"-ms-")}function D(J){if(H[J]===undefined){var I=J.replace(/(-[\s\S])/g,function(L){return L.charAt(1).toUpperCase()});var K=E(I);H[J]=B(K)}return H[J]}function G(K,N){if(C[N]===undefined){var J,L=0,M=A.length,O,I=(typeof K.cssText!=="undefined");C[N]=null;for(;L<M;L++){O=A[L];if(O){if(!I){O=O.toLowerCase()}J=O+N.charAt(0).toUpperCase()+N.slice(1)}else{J=N}if(K[J]!==undefined){C[N]=J;break}}}return C[N]}function E(I){return G(F,I)}return{css:D,js:G,style:E,cssCache:H,jsCache:C}}());OpenLayers.Animation=(function(E){var H=OpenLayers.Util.vendorPrefix.js(E,"requestAnimationFrame");var A=!!(H);var F=(function(){var I=E[H]||function(J,K){E.setTimeout(J,16)};return function(J,K){I.apply(E,[J,K])}})();var D=0;var G={};function C(I,J,K){J=J>0?J:Number.POSITIVE_INFINITY;var M=++D;var L=+new Date;G[M]=function(){if(G[M]&&+new Date-L<=J){I();if(G[M]){F(G[M],K)}}else{delete G[M]}};F(G[M],K);return M}function B(I){delete G[I]}return{isNative:A,requestFrame:F,start:C,stop:B}})(window);OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,minFrameRate:null,startTime:null,animationId:null,playing:false,initialize:function(A){this.easing=(A)?A:OpenLayers.Easing.Expo.easeOut},start:function(A,D,C,B){this.playing=true;this.begin=A;this.finish=D;this.duration=C;this.callbacks=B.callbacks;this.minFrameRate=B.minFrameRate||30;this.time=0;this.startTime=new Date().getTime();OpenLayers.Animation.stop(this.animationId);this.animationId=null;if(this.callbacks&&this.callbacks.start){this.callbacks.start.call(this,this.begin)}this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,this))},stop:function(){if(!this.playing){return}if(this.callbacks&&this.callbacks.done){this.callbacks.done.call(this,this.finish)}OpenLayers.Animation.stop(this.animationId);this.animationId=null;this.playing=false},play:function(){var C={};for(var A in this.begin){var B=this.begin[A];var E=this.finish[A];if(B==null||E==null||isNaN(B)||isNaN(E)){throw new TypeError("invalid value for Tween")}var D=E-B;C[A]=this.easing.apply(this,[this.time,B,D,this.duration])}this.time++;if(this.callbacks&&this.callbacks.eachStep){if((new Date().getTime()-this.startTime)/this.time<=1000/this.minFrameRate){this.callbacks.eachStep.call(this,C)}}if(this.time>this.duration){this.stop()}},CLASS_NAME:"OpenLayers.Tween"});OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"};OpenLayers.Easing.Linear={easeIn:function(C,B,D,A){return D*C/A+B},easeOut:function(C,B,D,A){return D*C/A+B},easeInOut:function(C,B,D,A){return D*C/A+B},CLASS_NAME:"OpenLayers.Easing.Linear"};OpenLayers.Easing.Expo={easeIn:function(C,B,D,A){return(C==0)?B:D*Math.pow(2,10*(C/A-1))+B},easeOut:function(C,B,D,A){return(C==A)?B+D:D*(-Math.pow(2,-10*C/A)+1)+B},easeInOut:function(C,B,D,A){if(C==0){return B}if(C==A){return B+D}if((C/=A/2)<1){return D/2*Math.pow(2,10*(C-1))+B}return D/2*(-Math.pow(2,-10*--C)+2)+B},CLASS_NAME:"OpenLayers.Easing.Expo"};OpenLayers.Easing.Quad={easeIn:function(C,B,D,A){return D*(C/=A)*C+B},easeOut:function(C,B,D,A){return -D*(C/=A)*(C-2)+B},easeInOut:function(C,B,D,A){if((C/=A/2)<1){return D/2*C*C+B}return -D/2*((--C)*(C-2)-1)+B},CLASS_NAME:"OpenLayers.Easing.Quad"};OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(A,B){OpenLayers.Util.extend(this,B);this.projCode=A;if(typeof Proj4js=="object"){this.proj=new Proj4js.Proj(A)}},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(A){var B=A,D=false;if(B){if(!(B instanceof OpenLayers.Projection)){B=new OpenLayers.Projection(B)}if((typeof Proj4js=="object")&&this.proj.defData&&B.proj.defData){D=this.proj.defData.replace(this.titleRegEx,"")==B.proj.defData.replace(this.titleRegEx,"")}else{if(B.getCode){var C=this.getCode(),E=B.getCode();D=C==E||!!OpenLayers.Projection.transforms[C]&&OpenLayers.Projection.transforms[C][E]===OpenLayers.Projection.nullTransform}}}return D},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"OpenLayers.Projection"});OpenLayers.Projection.transforms={};OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:true},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-20037508.34,-20037508.34,20037508.34,20037508.34]}};OpenLayers.Projection.addTransform=function(A,B,C){if(C===OpenLayers.Projection.nullTransform){var D=OpenLayers.Projection.defaults[A];if(D&&!OpenLayers.Projection.defaults[B]){OpenLayers.Projection.defaults[B]=D}}if(!OpenLayers.Projection.transforms[A]){OpenLayers.Projection.transforms[A]={}}OpenLayers.Projection.transforms[A][B]=C};OpenLayers.Projection.transform=function(B,C,A){if(C&&A){if(!(C instanceof OpenLayers.Projection)){C=new OpenLayers.Projection(C)}if(!(A instanceof OpenLayers.Projection)){A=new OpenLayers.Projection(A)}if(C.proj&&A.proj){B=Proj4js.transform(C.proj,A.proj,B)}else{var D=C.getCode();var E=A.getCode();var F=OpenLayers.Projection.transforms;if(F[D]&&F[D][E]){F[D][E](B)}}}return B};OpenLayers.Projection.nullTransform=function(A){return A};(function(){var A=20037508.34;function C(H){H.x=180*H.x/A;H.y=180/Math.PI*(2*Math.atan(Math.exp((H.y/A)*Math.PI))-Math.PI/2);return H}function F(H){H.x=H.x*A/180;var I=Math.log(Math.tan((90+H.y)*Math.PI/360))/Math.PI*A;H.y=Math.max(-20037508.34,Math.min(I,20037508.34));return H}function G(H,J){var L=OpenLayers.Projection.addTransform;var I=OpenLayers.Projection.nullTransform;var M,O,K,P,N;for(M=0,O=J.length;M<O;++M){K=J[M];L(H,K,F);L(K,H,C);for(N=M+1;N<O;++N){P=J[N];L(K,P,I);L(P,K,I)}}}var D=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],E=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326","EPSG:4326"],B;for(B=D.length-1;B>=0;--B){G(D[B],E)}for(B=E.length-1;B>=0;--B){G(E[B],D)}})();OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1000},poiMrk:null,id:null,fractionalZoom:false,events:null,allOverlays:false,div:null,dragging:false,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:false,autoUpdateSize:true,eventListeners:null,panTween:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,zoomTween:null,zoomMethod:OpenLayers.Easing.Quad.easeOut,zoomDuration:20,paddingForPopups:null,layerContainerOriginPx:null,minPx:null,maxPx:null,initialize:function(I,E){if(arguments.length===1&&typeof I==="object"){E=I;I=E&&E.div}this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css";this.options=OpenLayers.Util.extend({},E);OpenLayers.Util.extend(this,E);var B=this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection;OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[B]);if(this.maxExtent&&!(this.maxExtent instanceof OpenLayers.Bounds)){this.maxExtent=new OpenLayers.Bounds(this.maxExtent)}if(this.minExtent&&!(this.minExtent instanceof OpenLayers.Bounds)){this.minExtent=new OpenLayers.Bounds(this.minExtent)}if(this.restrictedExtent&&!(this.restrictedExtent instanceof OpenLayers.Bounds)){this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent)}if(this.center&&!(this.center instanceof OpenLayers.LonLat)){this.center=new OpenLayers.LonLat(this.center)}this.layers=[];this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_");this.div=OpenLayers.Util.getElement(I);if(!this.div){this.div=document.createElement("div");this.div.style.height="1px";this.div.style.width="1px"}OpenLayers.Element.addClass(this.div,"olMap");var G=this.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(G,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:true});if(OpenLayers.TileManager&&this.tileManager!==null){if(!(this.tileManager instanceof OpenLayers.TileManager)){this.tileManager=new OpenLayers.TileManager(this.tileManager)}this.tileManager.addMap(this)}G=this.id+"_OpenLayers_Container";this.layerContainerDiv=OpenLayers.Util.createDiv(G);this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE["Popup"]-1;this.layerContainerOriginPx={x:0,y:0};this.applyTransform();this.viewPortDiv.appendChild(this.layerContainerDiv);this.updateSize();if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}if(this.autoUpdateSize===true){this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this);OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy)}if(this.theme){var F=true;var H=document.getElementsByTagName("link");for(var D=0,A=H.length;D<A;++D){if(OpenLayers.Util.isEquivalentUrl(H.item(D).href,this.theme)){F=false;break}}if(F){var C=document.createElement("link");C.setAttribute("rel","stylesheet");C.setAttribute("type","text/css");C.setAttribute("href",this.theme);document.getElementsByTagName("head")[0].appendChild(C)}}if(this.controls==null){this.controls=[];if(OpenLayers.Control!=null){if(OpenLayers.Control.Navigation){this.controls.push(new OpenLayers.Control.Navigation())}else{if(OpenLayers.Control.TouchNavigation){this.controls.push(new OpenLayers.Control.TouchNavigation())}}if(OpenLayers.Control.Zoom){this.controls.push(new OpenLayers.Control.Zoom())}else{if(OpenLayers.Control.PanZoom){this.controls.push(new OpenLayers.Control.PanZoom())}}if(OpenLayers.Control.ArgParser){this.controls.push(new OpenLayers.Control.ArgParser())}if(OpenLayers.Control.Attribution){this.controls.push(new OpenLayers.Control.Attribution())}}}for(var D=0,A=this.controls.length;D<A;D++){this.addControlToMap(this.controls[D])}this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,"unload",this.unloadDestroy);if(E&&E.layers){delete this.center;delete this.zoom;this.addLayers(E.layers);if(E.center&&!this.getCenter()){this.setCenter(E.center,E.zoom)}}if(this.panMethod){this.panTween=new OpenLayers.Tween(this.panMethod)}if(this.zoomMethod&&this.applyTransform.transform){this.zoomTween=new OpenLayers.Tween(this.zoomMethod)}},getViewport:function(){return this.viewPortDiv},render:function(A){this.div=OpenLayers.Util.getElement(A);OpenLayers.Element.addClass(this.div,"olMap");this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy){return false}if(this.panTween){this.panTween.stop();this.panTween=null}if(this.zoomTween){this.zoomTween.stop();this.zoomTween=null}OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;if(this.updateSizeDestroy){OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy)}this.paddingForPopups=null;if(this.controls!=null){for(var A=this.controls.length-1;A>=0;--A){this.controls[A].destroy()}this.controls=null}if(this.layers!=null){for(var A=this.layers.length-1;A>=0;--A){this.layers[A].destroy(false)}this.layers=null}if(this.viewPortDiv&&this.viewPortDiv.parentNode){this.viewPortDiv.parentNode.removeChild(this.viewPortDiv)}this.viewPortDiv=null;if(this.tileManager){this.tileManager.removeMap(this);this.tileManager=null}if(this.eventListeners){this.events.un(this.eventListeners);this.eventListeners=null}this.events.destroy();this.events=null;this.options=null},setOptions:function(B){var A=this.minPx&&B.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,B);A&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:true})},getTileSize:function(){return this.tileSize},getBy:function(A,D,B){var C=(typeof B.test=="function");var E=OpenLayers.Array.filter(this[A],function(F){return F[D]==B||(C&&B.test(F[D]))});return E},getLayersBy:function(B,A){return this.getBy("layers",B,A)},getLayersByName:function(A){return this.getLayersBy("name",A)},getLayersByClass:function(A){return this.getLayersBy("CLASS_NAME",A)},getControlsBy:function(B,A){return this.getBy("controls",B,A)},getControlsByClass:function(A){return this.getControlsBy("CLASS_NAME",A)},getLayer:function(E){var D=null;for(var A=0,C=this.layers.length;A<C;A++){var B=this.layers[A];if(B.id==E){D=B;break}}return D},setLayerZIndex:function(A,B){A.setZIndex(this.Z_INDEX_BASE[A.isBaseLayer?"BaseLayer":"Overlay"]+B*5)},resetLayersZIndex:function(){for(var A=0,C=this.layers.length;A<C;A++){var B=this.layers[A];this.setLayerZIndex(B,A)}},addLayer:function(B){for(var A=0,C=this.layers.length;A<C;A++){if(this.layers[A]==B){return false}}if(this.events.triggerEvent("preaddlayer",{layer:B})===false){return false}if(this.allOverlays){B.isBaseLayer=false}B.div.className="olLayerDiv";B.div.style.overflow="";this.setLayerZIndex(B,this.layers.length);if(B.isFixed){this.viewPortDiv.appendChild(B.div)}else{this.layerContainerDiv.appendChild(B.div)}this.layers.push(B);B.setMap(this);if(B.isBaseLayer||(this.allOverlays&&!this.baseLayer)){if(this.baseLayer==null){this.setBaseLayer(B)}else{B.setVisibility(false)}}else{B.redraw()}this.events.triggerEvent("addlayer",{layer:B});B.events.triggerEvent("added",{map:this,layer:B});B.afterAdd();return true},addLayers:function(B){for(var A=0,C=B.length;A<C;A++){this.addLayer(B[A])}},removeLayer:function(D,C){if(this.events.triggerEvent("preremovelayer",{layer:D})===false){return}if(C==null){C=true}if(D.isFixed){this.viewPortDiv.removeChild(D.div)}else{this.layerContainerDiv.removeChild(D.div)}OpenLayers.Util.removeItem(this.layers,D);D.removeMap(this);D.map=null;if(this.baseLayer==D){this.baseLayer=null;if(C){for(var A=0,E=this.layers.length;A<E;A++){var B=this.layers[A];if(B.isBaseLayer||this.allOverlays){this.setBaseLayer(B);break}}}}this.resetLayersZIndex();this.events.triggerEvent("removelayer",{layer:D});D.events.triggerEvent("removed",{map:this,layer:D})},getNumLayers:function(){return this.layers.length},getLayerIndex:function(A){return OpenLayers.Util.indexOf(this.layers,A)},setLayerIndex:function(B,D){var E=this.getLayerIndex(B);if(D<0){D=0}else{if(D>this.layers.length){D=this.layers.length}}if(E!=D){this.layers.splice(E,1);this.layers.splice(D,0,B);for(var A=0,C=this.layers.length;A<C;A++){this.setLayerZIndex(this.layers[A],A)}this.events.triggerEvent("changelayer",{layer:B,property:"order"});if(this.allOverlays){if(D===0){this.setBaseLayer(B)}else{if(this.baseLayer!==this.layers[0]){this.setBaseLayer(this.layers[0])}}}}},raiseLayer:function(B,A){var C=this.getLayerIndex(B)+A;this.setLayerIndex(B,C)},setBaseLayer:function(A){if(A!=this.baseLayer){if(OpenLayers.Util.indexOf(this.layers,A)!=-1){var C=this.getCachedCenter();var B=OpenLayers.Util.getResolutionFromScale(this.getScale(),A.units);if(this.baseLayer!=null&&!this.allOverlays){this.baseLayer.setVisibility(false)}this.baseLayer=A;if(!this.allOverlays||this.baseLayer.visibility){this.baseLayer.setVisibility(true);if(this.baseLayer.inRange===false){this.baseLayer.redraw()}}if(C!=null){var D=this.getZoomForResolution(B||this.resolution,true);this.setCenter(C,D,false,true)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}}},addControl:function(B,A){this.controls.push(B);this.addControlToMap(B,A)},addControls:function(D,C){var A=(arguments.length===1)?[]:C;for(var B=0,G=D.length;B<G;B++){var F=D[B];var E=(A[B])?A[B]:null;this.addControl(F,E)}},addControlToMap:function(C,A){C.outsideViewport=(C.div!=null);if(this.displayProjection&&!C.displayProjection){C.displayProjection=this.displayProjection}C.setMap(this);var B=C.draw(A);if(B){if(!C.outsideViewport){B.style.zIndex=this.Z_INDEX_BASE["Control"]+this.controls.length;this.viewPortDiv.appendChild(B)}}if(C.autoActivate){C.activate()}},getControl:function(E){var B=null;for(var A=0,C=this.controls.length;A<C;A++){var D=this.controls[A];if(D.id==E){B=D;break}}return B},removeControl:function(A){if((A)&&(A==this.getControl(A.id))){if(A.div&&(A.div.parentNode==this.viewPortDiv)){this.viewPortDiv.removeChild(A.div)}OpenLayers.Util.removeItem(this.controls,A)}},addPopup:function(D,A){if(A){for(var B=this.popups.length-1;B>=0;--B){this.removePopup(this.popups[B])}}D.map=this;this.popups.push(D);var C=D.draw();if(C){C.style.zIndex=this.Z_INDEX_BASE["Popup"]+this.popups.length;this.layerContainerDiv.appendChild(C)}},removePopup:function(B){OpenLayers.Util.removeItem(this.popups,B);if(B&&B.div){try{this.layerContainerDiv.removeChild(B.div)}catch(A){}}B.map=null},getSize:function(){var A=null;if(this.size!=null){A=this.size.clone()}return A},updateSize:function(){var D=this.getCurrentSize();if(D&&!isNaN(D.h)&&!isNaN(D.w)){this.events.clearMouseCache();var A=this.getSize();if(A==null){this.size=A=D}if(!D.equals(A)){this.size=D;for(var B=0,E=this.layers.length;B<E;B++){this.layers[B].onMapResize()}var C=this.getCachedCenter();if(this.baseLayer!=null&&C!=null){var F=this.getZoom();this.zoom=null;this.setCenter(C,F)}}}this.events.triggerEvent("updatesize")},getCurrentSize:function(){var A=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(A.w==0&&A.h==0||isNaN(A.w)&&isNaN(A.h)){A.w=this.div.offsetWidth;A.h=this.div.offsetHeight}if(A.w==0&&A.h==0||isNaN(A.w)&&isNaN(A.h)){A.w=parseInt(this.div.style.width);A.h=parseInt(this.div.style.height)}return A},calculateBounds:function(B,C){var E=null;if(B==null){B=this.getCachedCenter()}if(C==null){C=this.getResolution()}if((B!=null)&&(C!=null)){var A=(this.size.w*C)/2;var D=(this.size.h*C)/2;E=new OpenLayers.Bounds(B.lon-A,B.lat-D,B.lon+A,B.lat+D)}return E},getCenter:function(){var B=null;var A=this.getCachedCenter();if(A){B=A.clone()}return B},getCachedCenter:function(){if(!this.center&&this.size){this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2})}return this.center},getZoom:function(){return this.zoom},pan:function(C,E,D){D=OpenLayers.Util.applyDefaults(D,{animate:true,dragging:false});if(D.dragging){if(C!=0||E!=0){this.moveByPx(C,E)}}else{var A=this.getViewPortPxFromLonLat(this.getCachedCenter());var F=A.add(C,E);if(this.dragging||!F.equals(A)){var B=this.getLonLatFromViewPortPx(F);if(D.animate){this.panTo(B)}else{this.moveTo(B);if(this.dragging){this.dragging=false;this.events.triggerEvent("moveend")}}}}},panTo:function(A){if(this.panTween&&this.getExtent().scale(this.panRatio).containsLonLat(A)){var D=this.getCachedCenter();if(A.equals(D)){return}var B=this.getPixelFromLonLat(D);var C=this.getPixelFromLonLat(A);var F={x:C.x-B.x,y:C.y-B.y};var E={x:0,y:0};this.panTween.start({x:0,y:0},F,this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(G){var H=G.x-E.x,I=G.y-E.y;this.moveByPx(H,I);E.x=Math.round(G.x);E.y=Math.round(G.y)},this),done:OpenLayers.Function.bind(function(G){this.moveTo(A);this.dragging=false;this.events.triggerEvent("moveend")},this)}})}else{this.setCenter(A)}},setCenter:function(A,D,C,B){if(this.panTween){this.panTween.stop()}if(this.zoomTween){this.zoomTween.stop()}this.moveTo(A,D,{"dragging":C,"forceZoomChange":B})},moveByPx:function(I,H){var G=this.size.w/2;var B=this.size.h/2;var J=G+I;var K=B+H;var C=this.baseLayer.wrapDateLine;var E=0;var D=0;if(this.restrictedExtent){E=G;D=B;C=false}I=C||J<=this.maxPx.x-E&&J>=this.minPx.x+E?Math.round(I):0;H=K<=this.maxPx.y-D&&K>=this.minPx.y+D?Math.round(H):0;if(I||H){if(!this.dragging){this.dragging=true;this.events.triggerEvent("movestart")}this.center=null;if(I){this.layerContainerOriginPx.x-=I;this.minPx.x-=I;this.maxPx.x-=I}if(H){this.layerContainerOriginPx.y-=H;this.minPx.y-=H;this.maxPx.y-=H}this.applyTransform();var L,F,A;for(F=0,A=this.layers.length;F<A;++F){L=this.layers[F];if(L.visibility&&(L===this.baseLayer||L.inRange)){L.moveByPx(I,H);L.events.triggerEvent("move")}}this.events.triggerEvent("move")}},adjustZoom:function(F){if(this.baseLayer&&this.baseLayer.wrapDateLine){var D,E=this.baseLayer.resolutions,C=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(F)>C){if(this.fractionalZoom){F=this.getZoomForResolution(C)}else{for(var A=F|0,B=E.length;A<B;++A){if(E[A]<=C){F=A;break}}}}}return F},getMinZoom:function(){return this.adjustZoom(0)},moveTo:function(S,Q,R){if(S!=null&&!(S instanceof OpenLayers.LonLat)){S=new OpenLayers.LonLat(S)}if(!R){R={}}if(Q!=null){Q=parseFloat(Q);if(!this.fractionalZoom){Q=Math.round(Q)}}var G=Q;Q=this.adjustZoom(Q);if(Q!==G){S=this.getCenter()}var L=R.dragging||this.dragging;var B=R.forceZoomChange;if(!this.getCachedCenter()&&!this.isValidLonLat(S)){S=this.maxExtent.getCenterLonLat();this.center=S.clone()}if(this.restrictedExtent!=null){if(S==null){S=this.center}if(Q==null){Q=this.getZoom()}var N=this.getResolutionForZoom(Q);var O=this.calculateBounds(S,N);if(!this.restrictedExtent.containsBounds(O)){var P=this.restrictedExtent.getCenterLonLat();if(O.getWidth()>this.restrictedExtent.getWidth()){S=new OpenLayers.LonLat(P.lon,S.lat)}else{if(O.left<this.restrictedExtent.left){S=S.add(this.restrictedExtent.left-O.left,0)}else{if(O.right>this.restrictedExtent.right){S=S.add(this.restrictedExtent.right-O.right,0)}}}if(O.getHeight()>this.restrictedExtent.getHeight()){S=new OpenLayers.LonLat(S.lon,P.lat)}else{if(O.bottom<this.restrictedExtent.bottom){S=S.add(0,this.restrictedExtent.bottom-O.bottom)}else{if(O.top>this.restrictedExtent.top){S=S.add(0,this.restrictedExtent.top-O.top)}}}}}var H=B||((this.isValidZoomLevel(Q))&&(Q!=this.getZoom()));var V=(this.isValidLonLat(S))&&(!S.equals(this.center));if(H||V||L){L||this.events.triggerEvent("movestart",{zoomChanged:H});if(V){if(!H&&this.center){this.centerLayerContainer(S)}this.center=S.clone()}var U=H?this.getResolutionForZoom(Q):this.getResolution();if(H||this.layerContainerOrigin==null){this.layerContainerOrigin=this.getCachedCenter();this.layerContainerOriginPx.x=0;this.layerContainerOriginPx.y=0;this.applyTransform();var M=this.getMaxExtent({restricted:true});var K=M.getCenterLonLat();var W=this.center.lon-K.lon;var C=K.lat-this.center.lat;var J=Math.round(M.getWidth()/U);var F=Math.round(M.getHeight()/U);this.minPx={x:(this.size.w-J)/2-W/U,y:(this.size.h-F)/2-C/U};this.maxPx={x:this.minPx.x+Math.round(M.getWidth()/U),y:this.minPx.y+Math.round(M.getHeight()/U)}}if(H){this.zoom=Q;this.resolution=U}var D=this.getExtent();if(this.baseLayer.visibility){this.baseLayer.moveTo(D,H,R.dragging);R.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:H})}D=this.baseLayer.getExtent();for(var T=this.layers.length-1;T>=0;--T){var I=this.layers[T];if(I!==this.baseLayer&&!I.isBaseLayer){var E=I.calculateInRange();if(I.inRange!=E){I.inRange=E;if(!E){I.display(false)}this.events.triggerEvent("changelayer",{layer:I,property:"visibility"})}if(E&&I.visibility){I.moveTo(D,H,R.dragging);R.dragging||I.events.triggerEvent("moveend",{zoomChanged:H})}}}this.events.triggerEvent("move");L||this.events.triggerEvent("moveend");if(H){for(var T=0,A=this.popups.length;T<A;T++){this.popups[T].updatePosition()}this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(G){var D=this.getViewPortPxFromLonLat(this.layerContainerOrigin);var A=this.getViewPortPxFromLonLat(G);if((D!=null)&&(A!=null)){var C=this.layerContainerOriginPx.x;var B=this.layerContainerOriginPx.y;var H=Math.round(D.x-A.x);var I=Math.round(D.y-A.y);this.applyTransform((this.layerContainerOriginPx.x=H),(this.layerContainerOriginPx.y=I));var E=C-H;var F=B-I;this.minPx.x-=E;this.maxPx.x-=E;this.minPx.y-=F;this.maxPx.y-=F}},isValidZoomLevel:function(A){return((A!=null)&&(A>=0)&&(A<this.getNumZoomLevels()))},isValidLonLat:function(A){var C=false;if(A!=null){var B=this.getMaxExtent();var D=this.baseLayer.wrapDateLine&&B;C=B.containsLonLat(A,{worldBounds:D})}return C},getProjection:function(){var A=this.getProjectionObject();return A?A.getCode():null},getProjectionObject:function(){var A=null;if(this.baseLayer!=null){A=this.baseLayer.projection}return A},getMaxResolution:function(){var A=null;if(this.baseLayer!=null){A=this.baseLayer.maxResolution}return A},getMaxExtent:function(B){var A=null;if(B&&B.restricted&&this.restrictedExtent){A=this.restrictedExtent}else{if(this.baseLayer!=null){A=this.baseLayer.maxExtent}}return A},getNumZoomLevels:function(){var A=null;if(this.baseLayer!=null){A=this.baseLayer.numZoomLevels}return A},getExtent:function(){var A=null;if(this.baseLayer!=null){A=this.baseLayer.getExtent()}return A},getResolution:function(){var A=null;if(this.baseLayer!=null){A=this.baseLayer.getResolution()}else{if(this.allOverlays===true&&this.layers.length>0){A=this.layers[0].getResolution()}}return A},getUnits:function(){var A=null;if(this.baseLayer!=null){A=this.baseLayer.units}return A},getScale:function(){var C=null;if(this.baseLayer!=null){var B=this.getResolution();var A=this.baseLayer.units;C=OpenLayers.Util.getScaleFromResolution(B,A)}return C},getZoomForExtent:function(B,A){var C=null;if(this.baseLayer!=null){C=this.baseLayer.getZoomForExtent(B,A)}return C},getResolutionForZoom:function(B){var A=null;if(this.baseLayer){A=this.baseLayer.getResolutionForZoom(B)}return A},getZoomForResolution:function(B,A){var C=null;if(this.baseLayer!=null){C=this.baseLayer.getZoomForResolution(B,A)}return C},zoomTo:function(C,E){var H=this;if(H.isValidZoomLevel(C)){if(H.baseLayer.wrapDateLine){C=H.adjustZoom(C)}if(H.zoomTween){var I=H.getResolution(),G=H.getResolutionForZoom(C),B={scale:1},D={scale:I/G};if(H.zoomTween.playing&&H.zoomTween.duration<3*H.zoomDuration){H.zoomTween.finish={scale:H.zoomTween.finish.scale*D.scale}}else{if(!E){var F=H.getSize();E={x:F.w/2,y:F.h/2}}H.zoomTween.start(B,D,H.zoomDuration,{minFrameRate:50,callbacks:{eachStep:function(N){var J=H.layerContainerOriginPx,M=N.scale,K=((M-1)*(J.x-E.x))|0,L=((M-1)*(J.y-E.y))|0;H.applyTransform(J.x+K,J.y+L,M)},done:function(L){H.applyTransform();var J=H.getResolution()/L.scale,K=H.getZoomForResolution(J,true);H.moveTo(H.getZoomTargetCenter(E,J),K,true)}}})}}else{var A=E?H.getZoomTargetCenter(E,H.getResolutionForZoom(C)):null;H.setCenter(A,C)}}},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(B,A){if(!(B instanceof OpenLayers.Bounds)){B=new OpenLayers.Bounds(B)}var D=B.getCenterLonLat();if(this.baseLayer.wrapDateLine){var C=this.getMaxExtent();B=B.clone();while(B.right<B.left){B.right+=C.getWidth()}D=B.getCenterLonLat().wrapDateLine(C)}this.setCenter(D,this.getZoomForExtent(B,A))},zoomToMaxExtent:function(B){var C=(B)?B.restricted:true;var A=this.getMaxExtent({"restricted":C});this.zoomToExtent(A)},zoomToScale:function(E,B){var D=OpenLayers.Util.getResolutionFromScale(E,this.baseLayer.units);var A=(this.size.w*D)/2;var C=(this.size.h*D)/2;var G=this.getCachedCenter();var F=new OpenLayers.Bounds(G.lon-A,G.lat-C,G.lon+A,G.lat+C);this.zoomToExtent(F,B)},getLonLatFromViewPortPx:function(B){var A=null;if(this.baseLayer!=null){A=this.baseLayer.getLonLatFromViewPortPx(B)}return A},getViewPortPxFromLonLat:function(A){var B=null;if(this.baseLayer!=null){B=this.baseLayer.getViewPortPxFromLonLat(A)}return B},getZoomTargetCenter:function(A,G){var B=null,D=this.getSize(),E=D.w/2-A.x,F=A.y-D.h/2,C=this.getLonLatFromPixel(A);if(C){B=new OpenLayers.LonLat(C.lon+E*G,C.lat+F*G)}return B},getLonLatFromPixel:function(A){return this.getLonLatFromViewPortPx(A)},getPixelFromLonLat:function(A){var B=this.getViewPortPxFromLonLat(A);B.x=Math.round(B.x);B.y=Math.round(B.y);return B},getGeodesicPixelSize:function(I){var A=I?this.getLonLatFromPixel(I):(this.getCachedCenter()||new OpenLayers.LonLat(0,0));var C=this.getResolution();var E=A.add(-C/2,0);var B=A.add(C/2,0);var G=A.add(0,-C/2);var D=A.add(0,C/2);var H=new OpenLayers.Projection("EPSG:4326");var F=this.getProjectionObject()||H;if(!F.equals(H)){E.transform(F,H);B.transform(F,H);G.transform(F,H);D.transform(F,H)}return new OpenLayers.Size(OpenLayers.Util.distVincenty(E,B),OpenLayers.Util.distVincenty(G,D))},getViewPortPxFromLayerPx:function(C){var A=null;if(C!=null){var D=this.layerContainerOriginPx.x;var B=this.layerContainerOriginPx.y;A=C.add(D,B)}return A},getLayerPxFromViewPortPx:function(A){var C=null;if(A!=null){var D=-this.layerContainerOriginPx.x;var B=-this.layerContainerOriginPx.y;C=A.add(D,B);if(isNaN(C.x)||isNaN(C.y)){C=null}}return C},getLonLatFromLayerPx:function(A){A=this.getViewPortPxFromLayerPx(A);return this.getLonLatFromViewPortPx(A)},getLayerPxFromLonLat:function(A){var B=this.getPixelFromLonLat(A);return this.getLayerPxFromViewPortPx(B)},applyTransform:function(G,H,B){B=B||1;var A=this.layerContainerOriginPx,E=B!==1;G=G||A.x;H=H||A.y;var D=this.layerContainerDiv.style,I=this.applyTransform.transform,C=this.applyTransform.template;if(I===undefined){I=OpenLayers.Util.vendorPrefix.style("transform");this.applyTransform.transform=I;if(I){var F=OpenLayers.Element.getStyle(this.viewPortDiv,OpenLayers.Util.vendorPrefix.css("transform"));if(!F||F!=="none"){C=["translate3d(",",0) ","scale3d(",",1)"];D[I]=[C[0],"0,0",C[1]].join("")}if(!C||!~D[I].indexOf(C[0])){C=["translate(",") ","scale(",")"]}this.applyTransform.template=C}}if(I!==null&&(C[0]==="translate3d("||E===true)){if(E===true&&C[0]==="translate("){G-=A.x;H-=A.y;D.left=A.x+"px";D.top=A.y+"px"}D[I]=[C[0],G,"px,",H,"px",C[1],C[2],B,",",B,C[3]].join("")}else{D.left=G+"px";D.top=H+"px";if(I!==null){D[I]=""}}},CLASS_NAME:"OpenLayers.Map"});OpenLayers.Map.TILE_WIDTH=256;OpenLayers.Map.TILE_HEIGHT=256;OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:false,evt:null,touch:false,initialize:function(C,D,B){OpenLayers.Util.extend(this,B);this.control=C;this.callbacks=D;var A=this.map||C.map;if(A){this.setMap(A)}this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(A){this.map=A},checkModifiers:function(A){if(this.keyMask==null){return true}var B=(A.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(A.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(A.altKey?OpenLayers.Handler.MOD_ALT:0)|(A.metaKey?OpenLayers.Handler.MOD_META:0);return(B==this.keyMask)},activate:function(){if(this.active){return false}var C=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var A=0,B=C.length;A<B;A++){if(this[C[A]]){this.register(C[A],this[C[A]])}}this.active=true;return true},deactivate:function(){if(!this.active){return false}var C=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var A=0,B=C.length;A<B;A++){if(this[C[A]]){this.unregister(C[A],this[C[A]])}}this.touch=false;this.active=false;return true},startTouch:function(){if(!this.touch){this.touch=true;var C=["mousedown","mouseup","mousemove","click","dblclick","mouseout"];for(var A=0,B=C.length;A<B;A++){if(this[C[A]]){this.unregister(C[A],this[C[A]])}}}},callback:function(A,B){if(A&&this.callbacks[A]){this.callbacks[A].apply(this.control,B)}},register:function(A,B){this.map.events.registerPriority(A,this,B);this.map.events.registerPriority(A,this,this.setEvent)},unregister:function(A,B){this.map.events.unregister(A,this,B);this.map.events.unregister(A,this,this.setEvent)},setEvent:function(A){this.evt=A;return true},destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;OpenLayers.Handler.MOD_META=8;OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:true,"double":false,pixelTolerance:0,dblclickTolerance:13,stopSingle:false,stopDouble:false,timerId:null,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(A){this.startTouch();this.down=this.getEventInfo(A);this.last=this.getEventInfo(A);return true},touchmove:function(A){this.last=this.getEventInfo(A);return true},touchend:function(A){if(this.down){A.xy=this.last.xy;A.lastTouches=this.last.touches;this.handleSingle(A);this.down=null}return true},mousedown:function(A){this.down=this.getEventInfo(A);this.last=this.getEventInfo(A);return true},mouseup:function(B){var A=true;if(this.checkModifiers(B)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(B)){A=this.rightclick(B)}return A},rightclick:function(B){if(this.passesTolerance(B)){if(this.rightclickTimerId!=null){this.clearTimer();this.callback("dblrightclick",[B]);return !this.stopDouble}else{var A=this["double"]?OpenLayers.Util.extend({},B):this.callback("rightclick",[B]);var C=OpenLayers.Function.bind(this.delayedRightCall,this,A);this.rightclickTimerId=window.setTimeout(C,this.delay)}}return !this.stopSingle},delayedRightCall:function(A){this.rightclickTimerId=null;if(A){this.callback("rightclick",[A])}},click:function(A){if(!this.last){this.last=this.getEventInfo(A)}this.handleSingle(A);return !this.stopSingle},dblclick:function(A){this.handleDouble(A);return !this.stopDouble},handleDouble:function(A){if(this.passesDblclickTolerance(A)){if(this["double"]){this.callback("dblclick",[A])}this.clearTimer()}},handleSingle:function(B){if(this.passesTolerance(B)){if(this.timerId!=null){if(this.last.touches&&this.last.touches.length===1){if(this["double"]){OpenLayers.Event.preventDefault(B)}this.handleDouble(B)}if(!this.last.touches||this.last.touches.length!==2){this.clearTimer()}}else{this.first=this.getEventInfo(B);var A=this.single?OpenLayers.Util.extend({},B):null;this.queuePotentialClick(A)}}},queuePotentialClick:function(A){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,A),this.delay)},passesTolerance:function(C){var A=true;if(this.pixelTolerance!=null&&this.down&&this.down.xy){A=this.pixelTolerance>=this.down.xy.distanceTo(C.xy);if(A&&this.touch&&this.down.touches.length===this.last.touches.length){for(var B=0,D=this.down.touches.length;B<D;++B){if(this.getTouchDistance(this.down.touches[B],this.last.touches[B])>this.pixelTolerance){A=false;break}}}}return A},getTouchDistance:function(A,B){return Math.sqrt(Math.pow(A.clientX-B.clientX,2)+Math.pow(A.clientY-B.clientY,2))},passesDblclickTolerance:function(B){var A=true;if(this.down&&this.first){A=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance}return A},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null}if(this.rightclickTimerId!=null){window.clearTimeout(this.rightclickTimerId);this.rightclickTimerId=null}},delayedCall:function(A){this.timerId=null;if(A){this.callback("click",[A])}},getEventInfo:function(C){var B;if(C.touches){var D=C.touches.length;B=new Array(D);var E;for(var A=0;A<D;A++){E=C.touches[A];B[A]={clientX:E.olClientX,clientY:E.olClientY}}}return{xy:C.xy,touches:B}},deactivate:function(){var A=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();this.down=null;this.first=null;this.last=null;A=true}return A},CLASS_NAME:"OpenLayers.Handler.Click"});OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:false,stopDown:true,dragging:false,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:false,documentEvents:null,initialize:function(C,D,B){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(this.documentDrag===true){var A=this;this._docMove=function(E){A.mousemove({xy:{x:E.clientX,y:E.clientY},element:document})};this._docUp=function(E){A.mouseup({xy:{x:E.clientX,y:E.clientY}})}}},dragstart:function(B){var A=true;this.dragging=false;if(this.checkModifiers(B)&&(OpenLayers.Event.isLeftClick(B)||OpenLayers.Event.isSingleTouch(B))){this.started=true;this.start=B.xy;this.last=B.xy;OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown");this.down(B);this.callback("down",[B.xy]);OpenLayers.Event.preventDefault(B);if(!this.oldOnselectstart){this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True}document.onselectstart=OpenLayers.Function.False;A=!this.stopDown}else{this.started=false;this.start=null;this.last=null}return A},dragmove:function(A){this.lastMoveEvt=A;if(this.started&&!this.timeoutId&&(A.xy.x!=this.last.x||A.xy.y!=this.last.y)){if(this.documentDrag===true&&this.documentEvents){if(A.element===document){this.adjustXY(A);this.setEvent(A)}else{this.removeDocumentEvents()}}if(this.interval>0){this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)}this.dragging=true;this.move(A);this.callback("move",[A.xy]);if(!this.oldOnselectstart){this.oldOnselectstart=document.onselectstart;document.onselectstart=OpenLayers.Function.False}this.last=A.xy}return true},dragend:function(A){if(this.started){if(this.documentDrag===true&&this.documentEvents){this.adjustXY(A);this.removeDocumentEvents()}var B=(this.start!=this.last);this.started=false;this.dragging=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(A);this.callback("up",[A.xy]);if(B){this.callback("done",[A.xy])}document.onselectstart=this.oldOnselectstart}return true},down:function(A){},move:function(A){},up:function(A){},out:function(A){},mousedown:function(A){return this.dragstart(A)},touchstart:function(A){this.startTouch();return this.dragstart(A)},mousemove:function(A){return this.dragmove(A)},touchmove:function(A){return this.dragmove(A)},removeTimeout:function(){this.timeoutId=null;if(this.dragging){this.mousemove(this.lastMoveEvt)}},mouseup:function(A){return this.dragend(A)},touchend:function(A){A.xy=this.last;return this.dragend(A)},mouseout:function(A){if(this.started&&OpenLayers.Util.mouseLeft(A,this.map.viewPortDiv)){if(this.documentDrag===true){this.addDocumentEvents()}else{var B=(this.start!=this.last);this.started=false;this.dragging=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(A);this.callback("out",[]);if(B){this.callback("done",[A.xy])}if(document.onselectstart){document.onselectstart=this.oldOnselectstart}}}return true},click:function(A){return(this.start==this.last)},activate:function(){var A=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragging=false;A=true}return A},deactivate:function(){var A=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.started=false;this.dragging=false;this.start=null;this.last=null;A=true;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown")}return A},adjustXY:function(A){var B=OpenLayers.Util.pagePosition(this.map.viewPortDiv);A.xy.x-=B[0];A.xy.y-=B[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown");this.documentEvents=true;OpenLayers.Event.observe(document,"mousemove",this._docMove);OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown");this.documentEvents=false;OpenLayers.Event.stopObserving(document,"mousemove",this._docMove);OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"});OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:false,handlers:null,resolutionFactor:1,maximized:false,maximizeTitle:"",minimizeTitle:"",initialize:function(A){this.layers=[];this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,[A])},destroy:function(){if(!this.mapDiv){return}if(this.handlers.click){this.handlers.click.destroy()}if(this.handlers.drag){this.handlers.drag.destroy()}this.ovmap&&this.ovmap.viewPortDiv.removeChild(this.extentRectangle);this.extentRectangle=null;if(this.rectEvents){this.rectEvents.destroy();this.rectEvents=null}if(this.ovmap){this.ovmap.destroy();this.ovmap=null}this.element.removeChild(this.mapDiv);this.mapDiv=null;this.div.removeChild(this.element);this.element=null;if(this.maximizeDiv){this.div.removeChild(this.maximizeDiv);this.maximizeDiv=null}if(this.minimizeDiv){this.div.removeChild(this.minimizeDiv);this.minimizeDiv=null}this.map.events.un({buttonclick:this.onButtonClick,moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(this.layers.length===0){if(this.map.baseLayer){var A=this.map.baseLayer.clone();this.layers=[A]}else{this.map.events.register("changebaselayer",this,this.baseLayerDraw);return this.div}}this.element=document.createElement("div");this.element.className=this.displayClass+"Element";this.element.style.display="none";this.mapDiv=document.createElement("div");this.mapDiv.style.width=this.size.w+"px";this.mapDiv.style.height=this.size.h+"px";this.mapDiv.style.position="relative";this.mapDiv.style.overflow="hidden";this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap");this.extentRectangle=document.createElement("div");this.extentRectangle.style.position="absolute";this.extentRectangle.style.zIndex=1000;this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.element.appendChild(this.mapDiv);this.div.appendChild(this.element);if(!this.outsideViewport){this.div.className+=" "+this.displayClass+"Container";var B=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,B,"absolute");this.maximizeDiv.style.display="none";this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton";if(this.maximizeTitle){this.maximizeDiv.title=this.maximizeTitle}this.div.appendChild(this.maximizeDiv);var B=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,null,B,"absolute");this.minimizeDiv.style.display="none";this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton";if(this.minimizeTitle){this.minimizeDiv.title=this.minimizeTitle}this.div.appendChild(this.minimizeDiv);this.minimizeControl()}else{this.element.style.display=""}if(this.map.getExtent()){this.update()}this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this});if(this.maximized){this.maximizeControl()}return this.div},baseLayerDraw:function(){this.draw();this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectDrag:function(G){var I=this.handlers.drag.last.x-G.x;var D=this.handlers.drag.last.y-G.y;if(I!=0||D!=0){var A=this.rectPxBounds.top;var H=this.rectPxBounds.left;var B=Math.abs(this.rectPxBounds.getHeight());var C=this.rectPxBounds.getWidth();var E=Math.max(0,(A-D));E=Math.min(E,this.ovmap.size.h-this.hComp-B);var F=Math.max(0,(H-I));F=Math.min(F,this.ovmap.size.w-this.wComp-C);this.setRectPxBounds(new OpenLayers.Bounds(F,E+B,F+C,E))}},mapDivClick:function(B){var H=this.rectPxBounds.getCenterPixel();var J=B.xy.x-H.x;var A=B.xy.y-H.y;var D=this.rectPxBounds.top;var E=this.rectPxBounds.left;var C=Math.abs(this.rectPxBounds.getHeight());var G=this.rectPxBounds.getWidth();var F=Math.max(0,(D+A));F=Math.min(F,this.ovmap.size.h-C);var I=Math.max(0,(E+J));I=Math.min(I,this.ovmap.size.w-G);this.setRectPxBounds(new OpenLayers.Bounds(I,F+C,I+G,F));this.updateMapToRect()},onButtonClick:function(A){if(A.buttonElement===this.minimizeDiv){this.minimizeControl()}else{if(A.buttonElement===this.maximizeDiv){this.maximizeControl()}}},maximizeControl:function(A){this.element.style.display="";this.showToggle(false);if(A!=null){OpenLayers.Event.stop(A)}},minimizeControl:function(A){this.element.style.display="none";this.showToggle(true);if(A!=null){OpenLayers.Event.stop(A)}},showToggle:function(A){if(this.maximizeDiv){this.maximizeDiv.style.display=A?"":"none"}if(this.minimizeDiv){this.minimizeDiv.style.display=A?"none":""}},update:function(){if(this.ovmap==null){this.createMap()}if(this.autoPan||!this.isSuitableOverview()){this.updateOverview()}this.updateRectToMap()},isSuitableOverview:function(){var B=this.map.getExtent();var C=this.map.getMaxExtent();var D=new OpenLayers.Bounds(Math.max(B.left,C.left),Math.max(B.bottom,C.bottom),Math.min(B.right,C.right),Math.min(B.top,C.top));if(this.ovmap.getProjection()!=this.map.getProjection()){D=D.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())}var A=this.ovmap.getResolution()/this.map.getResolution();return((A>this.minRatio)&&(A<=this.maxRatio)&&(this.ovmap.getExtent().containsBounds(D)))},updateOverview:function(){var B=this.map.getResolution();var A=this.ovmap.getResolution();var C=A/B;if(C>this.maxRatio){A=this.minRatio*B}else{if(C<=this.minRatio){A=this.maxRatio*B}}var D;if(this.ovmap.getProjection()!=this.map.getProjection()){D=this.map.center.clone();D.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())}else{D=this.map.center}this.ovmap.setCenter(D,this.ovmap.getZoomForResolution(A*this.resolutionFactor));this.updateRectToMap()},createMap:function(){var C=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:false},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,C);this.ovmap.viewPortDiv.appendChild(this.extentRectangle);OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy);this.ovmap.addLayers(this.layers);this.ovmap.zoomToMaxExtent();this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width"));this.wComp=(this.wComp)?this.wComp:2;this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width"));this.hComp=(this.hComp)?this.hComp:2;this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap});this.handlers.click=new OpenLayers.Handler.Click(this,{"click":this.mapDivClick},{"single":true,"double":false,"stopSingle":true,"stopDouble":true,"pixelTolerance":1,map:this.ovmap});this.handlers.click.activate();this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,true);this.rectEvents.register("mouseover",this,function(D){if(!this.handlers.drag.active&&!this.map.dragging){this.handlers.drag.activate()}});this.rectEvents.register("mouseout",this,function(D){if(!this.handlers.drag.dragging){this.handlers.drag.deactivate()}});if(this.ovmap.getProjection()!=this.map.getProjection()){var B=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;var A=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=B&&A?OpenLayers.INCHES_PER_UNIT[B]/OpenLayers.INCHES_PER_UNIT[A]:1}},updateRectToMap:function(){var A;if(this.ovmap.getProjection()!=this.map.getProjection()){A=this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())}else{A=this.map.getExtent()}var B=this.getRectBoundsFromMapBounds(A);if(B){this.setRectPxBounds(B)}},updateMapToRect:function(){var A=this.getMapBoundsFromRectBounds(this.rectPxBounds);if(this.ovmap.getProjection()!=this.map.getProjection()){A=A.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject())}this.map.panTo(A.getCenterLonLat())},setRectPxBounds:function(F){var D=Math.max(F.top,0);var E=Math.max(F.left,0);var H=Math.min(F.top+Math.abs(F.getHeight()),this.ovmap.size.h-this.hComp);var A=Math.min(F.left+F.getWidth(),this.ovmap.size.w-this.wComp);var G=Math.max(A-E,0);var I=Math.max(H-D,0);if(G<this.minRectSize||I<this.minRectSize){this.extentRectangle.className=this.displayClass+this.minRectDisplayClass;var C=E+(G/2)-(this.minRectSize/2);var B=D+(I/2)-(this.minRectSize/2);this.extentRectangle.style.top=Math.round(B)+"px";this.extentRectangle.style.left=Math.round(C)+"px";this.extentRectangle.style.height=this.minRectSize+"px";this.extentRectangle.style.width=this.minRectSize+"px"}else{this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.extentRectangle.style.top=Math.round(D)+"px";this.extentRectangle.style.left=Math.round(E)+"px";this.extentRectangle.style.height=Math.round(I)+"px";this.extentRectangle.style.width=Math.round(G)+"px"}this.rectPxBounds=new OpenLayers.Bounds(Math.round(E),Math.round(H),Math.round(A),Math.round(D))},getRectBoundsFromMapBounds:function(B){var A=this.getOverviewPxFromLonLat({lon:B.left,lat:B.bottom});var C=this.getOverviewPxFromLonLat({lon:B.right,lat:B.top});var D=null;if(A&&C){D=new OpenLayers.Bounds(A.x,A.y,C.x,C.y)}return D},getMapBoundsFromRectBounds:function(A){var B=this.getLonLatFromOverviewPx({x:A.left,y:A.bottom});var C=this.getLonLatFromOverviewPx({x:A.right,y:A.top});return new OpenLayers.Bounds(B.lon,B.lat,C.lon,C.lat)},getLonLatFromOverviewPx:function(E){var A=this.ovmap.size;var C=this.ovmap.getResolution();var B=this.ovmap.getExtent().getCenterLonLat();var D=E.x-(A.w/2);var F=E.y-(A.h/2);return{lon:B.lon+D*C,lat:B.lat-F*C}},getOverviewPxFromLonLat:function(A){var B=this.ovmap.getResolution();var C=this.ovmap.getExtent();if(C){return{x:Math.round(1/B*(A.lon-C.left)),y:Math.round(1/B*(C.top-A.lat))}}},CLASS_NAME:"OpenLayers.Control.OverviewMap"});OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:["scales","resolutions","maxScale","minScale","maxResolution","minResolution","numZoomLevels","maxZoomLevel"],events:null,map:null,isBaseLayer:false,alpha:false,displayInLayerSwitcher:true,visibility:true,attribution:null,inRange:false,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:false,wrapDateLine:false,metadata:null,initialize:function(B,A){this.metadata={};A=OpenLayers.Util.extend({},A);if(this.alwaysInRange!=null){A.alwaysInRange=this.alwaysInRange}this.addOptions(A);this.name=B;if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_");this.div=OpenLayers.Util.createDiv(this.id);this.div.style.width="100%";this.div.style.height="100%";this.div.dir="ltr";this.events=new OpenLayers.Events(this,this.div);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}}},destroy:function(A){if(A==null){A=true}if(this.map!=null){this.map.removeLayer(this,A)}this.projection=null;this.map=null;this.name=null;this.div=null;this.options=null;if(this.events){if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy()}this.eventListeners=null;this.events=null},clone:function(A){if(A==null){A=new OpenLayers.Layer(this.name,this.getOptions())}OpenLayers.Util.applyDefaults(A,this);A.map=null;return A},getOptions:function(){var B={};for(var A in this.options){B[A]=this[A]}return B},setName:function(A){if(A!=this.name){this.name=A;if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"name"})}}},addOptions:function(E,B){if(this.options==null){this.options={}}if(E){if(typeof E.projection=="string"){E.projection=new OpenLayers.Projection(E.projection)}if(E.projection){OpenLayers.Util.applyDefaults(E,OpenLayers.Projection.defaults[E.projection.getCode()])}if(E.maxExtent&&!(E.maxExtent instanceof OpenLayers.Bounds)){E.maxExtent=new OpenLayers.Bounds(E.maxExtent)}if(E.minExtent&&!(E.minExtent instanceof OpenLayers.Bounds)){E.minExtent=new OpenLayers.Bounds(E.minExtent)}}OpenLayers.Util.extend(this.options,E);OpenLayers.Util.extend(this,E);if(this.projection&&this.projection.getUnits()){this.units=this.projection.getUnits()}if(this.map){var A=this.map.getResolution();var C=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]);for(var D in E){if(E.hasOwnProperty(D)&&OpenLayers.Util.indexOf(C,D)>=0){this.initResolutions();if(B&&this.map.baseLayer===this){this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(A),false,true);this.map.events.triggerEvent("changebaselayer",{layer:this})}break}}}},onMapResize:function(){},redraw:function(){var C=false;if(this.map){this.inRange=this.calculateInRange();var B=this.getExtent();if(B&&this.inRange&&this.visibility){var A=true;this.moveTo(B,A,false);this.events.triggerEvent("moveend",{"zoomChanged":A});C=true}}return C},moveTo:function(B,A,D){var C=this.visibility;if(!this.isBaseLayer){C=C&&this.inRange}this.display(C)},moveByPx:function(A,B){},setMap:function(A){if(this.map==null){this.map=A;this.maxExtent=this.maxExtent||this.map.maxExtent;this.minExtent=this.minExtent||this.map.minExtent;this.projection=this.projection||this.map.projection;if(typeof this.projection=="string"){this.projection=new OpenLayers.Projection(this.projection)}this.units=this.projection.getUnits()||this.units||this.map.units;this.initResolutions();if(!this.isBaseLayer){this.inRange=this.calculateInRange();var B=((this.visibility)&&(this.inRange));this.div.style.display=B?"":"none"}this.setTileSize()}},afterAdd:function(){},removeMap:function(A){},getImageSize:function(A){return(this.imageSize||this.tileSize)},setTileSize:function(A){var B=(A)?A:((this.tileSize)?this.tileSize:this.map.getTileSize());this.tileSize=B;if(this.gutter){this.imageSize=new OpenLayers.Size(B.w+(2*this.gutter),B.h+(2*this.gutter))}},getVisibility:function(){return this.visibility},setVisibility:function(A){if(A!=this.visibility){this.visibility=A;this.display(A);this.redraw();if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"})}this.events.triggerEvent("visibilitychanged")}},display:function(A){if(A!=(this.div.style.display!="none")){this.div.style.display=(A&&this.calculateInRange())?"block":"none"}},calculateInRange:function(){var A=false;if(this.alwaysInRange){A=true}else{if(this.map){var B=this.map.getResolution();A=((B>=this.minResolution)&&(B<=this.maxResolution))}}return A},setIsBaseLayer:function(A){if(A!=this.isBaseLayer){this.isBaseLayer=A;if(this.map!=null){this.map.events.triggerEvent("changebaselayer",{layer:this})}}},initResolutions:function(){var D,F,A;var C={},H=true;for(D=0,F=this.RESOLUTION_PROPERTIES.length;D<F;D++){A=this.RESOLUTION_PROPERTIES[D];C[A]=this.options[A];if(H&&this.options[A]){H=false}}if(this.options.alwaysInRange==null){this.alwaysInRange=H}if(C.resolutions==null){C.resolutions=this.resolutionsFromScales(C.scales)}if(C.resolutions==null){C.resolutions=this.calculateResolutions(C)}if(C.resolutions==null){for(D=0,F=this.RESOLUTION_PROPERTIES.length;D<F;D++){A=this.RESOLUTION_PROPERTIES[D];C[A]=this.options[A]!=null?this.options[A]:this.map[A]}if(C.resolutions==null){C.resolutions=this.resolutionsFromScales(C.scales)}if(C.resolutions==null){C.resolutions=this.calculateResolutions(C)}}var G;if(this.options.maxResolution&&this.options.maxResolution!=="auto"){G=this.options.maxResolution}if(this.options.minScale){G=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units)}var B;if(this.options.minResolution&&this.options.minResolution!=="auto"){B=this.options.minResolution}if(this.options.maxScale){B=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units)}if(C.resolutions){C.resolutions.sort(function(J,I){return(I-J)});if(!G){G=C.resolutions[0]}if(!B){var E=C.resolutions.length-1;B=C.resolutions[E]}}this.resolutions=C.resolutions;if(this.resolutions){F=this.resolutions.length;this.scales=new Array(F);for(D=0;D<F;D++){this.scales[D]=OpenLayers.Util.getScaleFromResolution(this.resolutions[D],this.units)}this.numZoomLevels=F}this.minResolution=B;if(B){this.maxScale=OpenLayers.Util.getScaleFromResolution(B,this.units)}this.maxResolution=G;if(G){this.minScale=OpenLayers.Util.getScaleFromResolution(G,this.units)}},resolutionsFromScales:function(B){if(B==null){return}var D,A,C;C=B.length;D=new Array(C);for(A=0;A<C;A++){D[A]=OpenLayers.Util.getResolutionFromScale(B[A],this.units)}return D},calculateResolutions:function(E){var C,G,D;var L=E.maxResolution;if(E.minScale!=null){L=OpenLayers.Util.getResolutionFromScale(E.minScale,this.units)}else{if(L=="auto"&&this.maxExtent!=null){C=this.map.getSize();G=this.maxExtent.getWidth()/C.w;D=this.maxExtent.getHeight()/C.h;L=Math.max(G,D)}}var K=E.minResolution;if(E.maxScale!=null){K=OpenLayers.Util.getResolutionFromScale(E.maxScale,this.units)}else{if(E.minResolution=="auto"&&this.minExtent!=null){C=this.map.getSize();G=this.minExtent.getWidth()/C.w;D=this.minExtent.getHeight()/C.h;K=Math.max(G,D)}}if(typeof L!=="number"&&typeof K!=="number"&&this.maxExtent!=null){var A=this.map.getTileSize();L=Math.max(this.maxExtent.getWidth()/A.w,this.maxExtent.getHeight()/A.h)}var H=E.maxZoomLevel;var I=E.numZoomLevels;if(typeof K==="number"&&typeof L==="number"&&I===undefined){var B=L/K;I=Math.floor(Math.log(B)/Math.log(2))+1}else{if(I===undefined&&H!=null){I=H+1}}if(typeof I!=="number"||I<=0||(typeof L!=="number"&&typeof K!=="number")){return}var J=new Array(I);var M=2;if(typeof K=="number"&&typeof L=="number"){M=Math.pow((L/K),(1/(I-1)))}var F;if(typeof L==="number"){for(F=0;F<I;F++){J[F]=L/Math.pow(M,F)}}else{for(F=0;F<I;F++){J[I-1-F]=K*Math.pow(M,F)}}return J},getResolution:function(){var A=this.map.getZoom();return this.getResolutionForZoom(A)},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(C,A){var B=this.map.getSize();var D=Math.max(C.getWidth()/B.w,C.getHeight()/B.h);return this.getZoomForResolution(D,A)},getDataExtent:function(){},getResolutionForZoom:function(D){D=Math.max(0,Math.min(D,this.resolutions.length-1));var C;if(this.map.fractionalZoom){var A=Math.floor(D);var B=Math.ceil(D);C=this.resolutions[A]-((D-A)*(this.resolutions[A]-this.resolutions[B]))}else{C=this.resolutions[Math.round(D)]}return C},getZoomForResolution:function(J,G){var C,I,B;if(this.map.fractionalZoom){var K=0;var M=this.resolutions.length-1;var H=this.resolutions[K];var A=this.resolutions[M];var L;for(I=0,B=this.resolutions.length;I<B;++I){L=this.resolutions[I];if(L>=J){H=L;K=I}if(L<=J){A=L;M=I;break}}var D=H-A;if(D>0){C=K+((H-J)/D)}else{C=K}}else{var F;var E=Number.POSITIVE_INFINITY;for(I=0,B=this.resolutions.length;I<B;I++){if(G){F=Math.abs(this.resolutions[I]-J);if(F>E){break}E=F}else{if(this.resolutions[I]<J){break}}}C=Math.max(0,I-1)}return C},getLonLatFromViewPortPx:function(C){var B=null;var A=this.map;if(C!=null&&A.minPx){var E=A.getResolution();var D=A.getMaxExtent({restricted:true});var G=(C.x-A.minPx.x)*E+D.left;var F=(A.minPx.y-C.y)*E+D.top;B=new OpenLayers.LonLat(G,F);if(this.wrapDateLine){B=B.wrapDateLine(this.maxExtent)}}return B},getViewPortPxFromLonLat:function(A,D){var C=null;if(A!=null){D=D||this.map.getResolution();var B=this.map.calculateBounds(null,D);C=new OpenLayers.Pixel((1/D*(A.lon-B.left)),(1/D*(B.top-A.lat)))}return C},setOpacity:function(C){if(C!=this.opacity){this.opacity=C;var B=this.div.childNodes;for(var A=0,D=B.length;A<D;++A){var E=B[A].firstChild||B[A];var F=B[A].lastChild;if(F&&F.nodeName.toLowerCase()==="iframe"){E=F.parentNode}OpenLayers.Util.modifyDOMElement(E,null,null,null,null,null,null,C)}if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(A){this.div.style.zIndex=A},adjustBounds:function(B){if(this.gutter){var A=this.gutter*this.map.getResolution();B=new OpenLayers.Bounds(B.left-A,B.bottom-A,B.right+A,B.top+A)}if(this.wrapDateLine){var C={"rightTolerance":this.getResolution(),"leftTolerance":this.getResolution()};B=B.wrapDateLine(this.maxExtent,C)}return B},CLASS_NAME:"OpenLayers.Layer"});OpenLayers.Layer.SphericalMercator={getExtent:function(){var A=null;if(this.sphericalMercator){A=this.map.calculateBounds()}else{A=OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)}return A},getLonLatFromViewPortPx:function(A){return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this,arguments)},getViewPortPxFromLonLat:function(A){return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this,arguments)},initMercatorParameters:function(){this.RESOLUTIONS=[];var A=156543.03390625;for(var B=0;B<=this.MAX_ZOOM_LEVEL;++B){this.RESOLUTIONS[B]=A/Math.pow(2,B)}this.units="m";this.projection=this.projection||"EPSG:900913"},forwardMercator:(function(){var B=new OpenLayers.Projection("EPSG:4326");var A=new OpenLayers.Projection("EPSG:900913");return function(C,E){var D=OpenLayers.Projection.transform({x:C,y:E},B,A);return new OpenLayers.LonLat(D.x,D.y)}})(),inverseMercator:(function(){var B=new OpenLayers.Projection("EPSG:4326");var A=new OpenLayers.Projection("EPSG:900913");return function(D,E){var C=OpenLayers.Projection.transform({x:D,y:E},A,B);return new OpenLayers.LonLat(C.x,C.y)}})()};OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:true,isBaseLayer:true,isFixed:true,pane:null,mapObject:null,initialize:function(B,A){OpenLayers.Layer.prototype.initialize.apply(this,arguments);if(this.pane==null){this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane")}},destroy:function(){this.mapObject=null;this.pane=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(A){OpenLayers.Layer.prototype.setMap.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1;this.pane.style.display=this.div.style.display;this.pane.style.width="100%";this.pane.style.height="100%";if(OpenLayers.BROWSER_NAME=="msie"){this.pane.style.background="url("+OpenLayers.Util.getImageLocation("blank.gif")+")"}if(this.isFixed){this.map.viewPortDiv.appendChild(this.pane)}else{this.map.layerContainerDiv.appendChild(this.pane)}this.loadMapObject();if(this.mapObject==null){this.loadWarningMessage()}},removeMap:function(A){if(this.pane&&this.pane.parentNode){this.pane.parentNode.removeChild(this.pane)}OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var C=this.map.getSize();var G=Math.min(C.w,300);var B=Math.min(C.h,200);var A=new OpenLayers.Size(G,B);var E=new OpenLayers.Pixel(C.w/2,C.h/2);var D=E.add(-A.w/2,-A.h/2);var F=OpenLayers.Util.createDiv(this.name+"_warning",D,A,null,null,null,"auto");F.style.padding="7px";F.style.backgroundColor="yellow";F.innerHTML=this.getWarningHTML();this.div.appendChild(F)},getWarningHTML:function(){return""},display:function(A){OpenLayers.Layer.prototype.display.apply(this,arguments);this.pane.style.display=this.div.style.display},setZIndex:function(A){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveByPx:function(A,B){OpenLayers.Layer.prototype.moveByPx.apply(this,arguments);if(this.dragPanMapObject){this.dragPanMapObject(A,-B)}else{this.moveTo(this.map.getCachedCenter())}},moveTo:function(C,J,H){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(this.mapObject!=null){var A=this.map.getCenter();var G=this.map.getZoom();if(A!=null){var E=this.getMapObjectCenter();var L=this.getOLLonLatFromMapObjectLonLat(E);var B=this.getMapObjectZoom();var I=this.getOLZoomFromMapObjectZoom(B);if(!(A.equals(L))||G!=I){if(!J&&L&&this.dragPanMapObject&&this.smoothDragPan){var M=this.map.getViewPortPxFromLonLat(L);var F=this.map.getViewPortPxFromLonLat(A);this.dragPanMapObject(F.x-M.x,M.y-F.y)}else{var K=this.getMapObjectLonLatFromOLLonLat(A);var D=this.getMapObjectZoomFromOLZoom(G);this.setMapObjectCenter(K,D,H)}}}}},getLonLatFromViewPortPx:function(B){var A=null;if((this.mapObject!=null)&&(this.getMapObjectCenter()!=null)){var D=this.getMapObjectPixelFromOLPixel(B);var C=this.getMapObjectLonLatFromMapObjectPixel(D);A=this.getOLLonLatFromMapObjectLonLat(C)}return A},getViewPortPxFromLonLat:function(A){var B=null;if((this.mapObject!=null)&&(this.getMapObjectCenter()!=null)){var C=this.getMapObjectLonLatFromOLLonLat(A);var D=this.getMapObjectPixelFromMapObjectLonLat(C);B=this.getOLPixelFromMapObjectPixel(D)}return B},getOLLonLatFromMapObjectLonLat:function(C){var B=null;if(C!=null){var A=this.getLongitudeFromMapObjectLonLat(C);var D=this.getLatitudeFromMapObjectLonLat(C);B=new OpenLayers.LonLat(A,D)}return B},getMapObjectLonLatFromOLLonLat:function(A){var B=null;if(A!=null){B=this.getMapObjectLonLatFromLonLat(A.lon,A.lat)}return B},getOLPixelFromMapObjectPixel:function(A){var B=null;if(A!=null){var C=this.getXFromMapObjectPixel(A);var D=this.getYFromMapObjectPixel(A);B=new OpenLayers.Pixel(C,D)}return B},getMapObjectPixelFromOLPixel:function(B){var A=null;if(B!=null){A=this.getMapObjectPixelFromXY(B.x,B.y)}return A},CLASS_NAME:"OpenLayers.Layer.EventPane"});OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){var F=["minZoomLevel","maxZoomLevel","numZoomLevels"];for(var A=0,E=F.length;A<E;A++){var D=F[A];this[D]=(this.options[D]!=null)?this.options[D]:this.map[D]}if((this.minZoomLevel==null)||(this.minZoomLevel<this.MIN_ZOOM_LEVEL)){this.minZoomLevel=this.MIN_ZOOM_LEVEL}var G;var C=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;if(((this.options.numZoomLevels==null)&&(this.options.maxZoomLevel!=null))||((this.numZoomLevels==null)&&(this.maxZoomLevel!=null))){G=this.maxZoomLevel-this.minZoomLevel+1}else{G=this.numZoomLevels}if(G!=null){this.numZoomLevels=Math.min(G,C)}else{this.numZoomLevels=C}this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(this.RESOLUTIONS!=null){var B=0;this.resolutions=[];for(var A=this.minZoomLevel;A<=this.maxZoomLevel;A++){this.resolutions[B++]=this.RESOLUTIONS[A]}this.maxResolution=this.resolutions[0];this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(this.resolutions!=null){return OpenLayers.Layer.prototype.getResolution.apply(this,arguments)}else{var C=null;var A=this.map.getSize();var B=this.getExtent();if((A!=null)&&(B!=null)){C=Math.max(B.getWidth()/A.w,B.getHeight()/A.h)}return C}},getExtent:function(){var A=this.map.getSize();var C=this.getLonLatFromViewPortPx({x:0,y:0});var B=this.getLonLatFromViewPortPx({x:A.w,y:A.h});if((C!=null)&&(B!=null)){return new OpenLayers.Bounds(C.lon,B.lat,B.lon,C.lat)}else{return null}},getZoomForResolution:function(B){if(this.resolutions!=null){return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments)}else{var A=OpenLayers.Layer.prototype.getExtent.apply(this,[]);return this.getZoomForExtent(A)}},getOLZoomFromMapObjectZoom:function(A){var B=null;if(A!=null){B=A-this.minZoomLevel;if(this.map.baseLayer!==this){B=this.map.baseLayer.getZoomForResolution(this.getResolutionForZoom(B))}}return B},getMapObjectZoomFromOLZoom:function(A){var B=null;if(A!=null){B=A+this.minZoomLevel;if(this.map.baseLayer!==this){B=this.getZoomForResolution(this.map.baseLayer.getResolutionForZoom(B))}}return B},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"});OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,8.58306884765625e-05,4.29153442382813e-05,2.14576721191406e-05,1.07288360595703e-05,5.36441802978515e-06,2.68220901489257e-06,1.34110450744629e-06,6.70552253723145e-07],type:null,wrapDateLine:true,sphericalMercator:false,version:null,initialize:function(B,A){A=A||{};if(!A.version){A.version=typeof GMap2==="function"?"2":"3"}var C=OpenLayers.Layer.Google["v"+A.version.replace(/\./g,"_")];if(C){OpenLayers.Util.applyDefaults(A,C)}else{throw"Unsupported Google Maps API version: "+A.version}OpenLayers.Util.applyDefaults(A,C.DEFAULTS);if(A.maxExtent){A.maxExtent=A.maxExtent.clone()}OpenLayers.Layer.EventPane.prototype.initialize.apply(this,[B,A]);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,[B,A]);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters()}},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},setVisibility:function(A){var B=this.opacity==null?1:this.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments);this.setOpacity(B)},display:function(A){if(!this._dragging){this.setGMapVisibility(A)}OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments)},moveTo:function(B,A,C){this._dragging=C;OpenLayers.Layer.EventPane.prototype.moveTo.apply(this,arguments);delete this._dragging},setOpacity:function(A){if(A!==this.opacity){if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}this.opacity=A}if(this.getVisibility()){var B=this.getMapContainer();OpenLayers.Util.modifyDOMElement(B,null,null,null,null,null,null,A)}},destroy:function(){if(this.map){this.setGMapVisibility(false);var A=OpenLayers.Layer.Google.cache[this.map.id];if(A&&A.count<=1){this.removeGMapElements()}}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var A=OpenLayers.Layer.Google.cache[this.map.id];if(A){var D=this.mapObject&&this.getMapContainer();if(D&&D.parentNode){D.parentNode.removeChild(D)}var B=A.termsOfUse;if(B&&B.parentNode){B.parentNode.removeChild(B)}var C=A.poweredBy;if(C&&C.parentNode){C.parentNode.removeChild(C)}if(this.mapObject&&window.google&&google.maps&&google.maps.event&&google.maps.event.clearListeners){google.maps.event.clearListeners(this.mapObject,"tilesloaded")}}},removeMap:function(B){if(this.visibility&&this.mapObject){this.setGMapVisibility(false)}var A=OpenLayers.Layer.Google.cache[B.id];if(A){if(A.count<=1){this.removeGMapElements();delete OpenLayers.Layer.Google.cache[B.id]}else{--A.count}}delete this.termsOfUse;delete this.poweredBy;delete this.mapObject;delete this.dragObject;OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(D){var C=null;if(D!=null){var A=D.getSouthWest();var B=D.getNorthEast();if(this.sphericalMercator){A=this.forwardMercator(A.lng(),A.lat());B=this.forwardMercator(B.lng(),B.lat())}else{A=new OpenLayers.LonLat(A.lng(),A.lat());B=new OpenLayers.LonLat(B.lng(),B.lat())}C=new OpenLayers.Bounds(A.lon,A.lat,B.lon,B.lat)}return C},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getLongitudeFromMapObjectLonLat:function(A){return this.sphericalMercator?this.forwardMercator(A.lng(),A.lat()).lon:A.lng()},getLatitudeFromMapObjectLonLat:function(A){var B=this.sphericalMercator?this.forwardMercator(A.lng(),A.lat()).lat:A.lat();return B},getXFromMapObjectPixel:function(A){return A.x},getYFromMapObjectPixel:function(A){return A.y},CLASS_NAME:"OpenLayers.Layer.Google"});OpenLayers.Layer.Google.cache={};OpenLayers.Layer.Google.v2={termsOfUse:null,poweredBy:null,dragObject:null,loadMapObject:function(){if(!this.type){this.type=G_NORMAL_MAP}var D,B,C;var A=OpenLayers.Layer.Google.cache[this.map.id];if(A){D=A.mapObject;B=A.termsOfUse;C=A.poweredBy;++A.count}else{var G=this.map.viewPortDiv;var F=document.createElement("div");F.id=this.map.id+"_GMap2Container";F.style.position="absolute";F.style.width="100%";F.style.height="100%";G.appendChild(F);try{D=new GMap2(F);B=F.lastChild;G.appendChild(B);B.style.zIndex="1100";B.style.right="";B.style.bottom="";B.className="olLayerGoogleCopyright";C=F.lastChild;G.appendChild(C);C.style.zIndex="1100";C.style.right="";C.style.bottom="";C.className="olLayerGooglePoweredBy gmnoprint"}catch(E){throw (E)}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:D,termsOfUse:B,poweredBy:C,count:1}}this.mapObject=D;this.termsOfUse=B;this.poweredBy=C;if(OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)===-1){this.mapObject.addMapType(this.type)}if(typeof D.getDragObject=="function"){this.dragObject=D.getDragObject()}else{this.dragPanMapObject=null}if(this.isBaseLayer===false){this.setGMapVisibility(this.div.style.display!=="none")}},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded()){this.mapObject.checkResize()}else{if(!this._resized){var B=this;var A=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(A);delete B._resized;B.mapObject.checkResize();B.moveTo(B.map.getCenter(),B.map.getZoom())})}this._resized=true}},setGMapVisibility:function(B){var A=OpenLayers.Layer.Google.cache[this.map.id];if(A){var C=this.mapObject.getContainer();if(B===true){this.mapObject.setMapType(this.type);C.style.display="";this.termsOfUse.style.left="";this.termsOfUse.style.display="";this.poweredBy.style.display="";A.displayed=this.id}else{if(A.displayed===this.id){delete A.displayed}if(!A.displayed){C.style.display="none";this.termsOfUse.style.display="none";this.termsOfUse.style.left="-9999px";this.poweredBy.style.display="none"}}}},getMapContainer:function(){return this.mapObject.getContainer()},getMapObjectBoundsFromOLBounds:function(C){var D=null;if(C!=null){var A=this.sphericalMercator?this.inverseMercator(C.bottom,C.left):new OpenLayers.LonLat(C.bottom,C.left);var B=this.sphericalMercator?this.inverseMercator(C.top,C.right):new OpenLayers.LonLat(C.top,C.right);D=new GLatLngBounds(new GLatLng(A.lat,A.lon),new GLatLng(B.lat,B.lon))}return D},setMapObjectCenter:function(A,B){this.mapObject.setCenter(A,B)},dragPanMapObject:function(B,A){this.dragObject.moveBy(new GSize(-B,A))},getMapObjectLonLatFromMapObjectPixel:function(A){return this.mapObject.fromContainerPixelToLatLng(A)},getMapObjectPixelFromMapObjectLonLat:function(A){return this.mapObject.fromLatLngToContainerPixel(A)},getMapObjectZoomFromMapObjectBounds:function(A){return this.mapObject.getBoundsZoomLevel(A)},getMapObjectLonLatFromLonLat:function(B,C){var D;if(this.sphericalMercator){var A=this.inverseMercator(B,C);D=new GLatLng(A.lat,A.lon)}else{D=new GLatLng(C,B)}return D},getMapObjectPixelFromXY:function(A,B){return new GPoint(A,B)}};OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(B){if(window.ActiveXObject){this.xmldom=new ActiveXObject("Microsoft.XMLDOM")}OpenLayers.Format.prototype.initialize.apply(this,[B]);this.namespaces=OpenLayers.Util.extend({},this.namespaces);this.namespaceAlias={};for(var A in this.namespaces){this.namespaceAlias[this.namespaces[A]]=A}},destroy:function(){this.xmldom=null;OpenLayers.Format.prototype.destroy.apply(this,arguments)},setNamespace:function(B,A){this.namespaces[B]=A;this.namespaceAlias[A]=B},read:function(B){var C=B.indexOf("<");if(C>0){B=B.substring(C)}var A=OpenLayers.Util.Try(OpenLayers.Function.bind((function(){var D;if(window.ActiveXObject&&!this.xmldom){D=new ActiveXObject("Microsoft.XMLDOM")}else{D=this.xmldom}D.loadXML(B);return D}),this),function(){return new DOMParser().parseFromString(B,"text/xml")},function(){var D=new XMLHttpRequest();D.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(B),false);if(D.overrideMimeType){D.overrideMimeType("text/xml")}D.send(null);return D.responseXML});if(this.keepData){this.data=A}return A},write:function(A){var D;if(this.xmldom){D=A.xml}else{var C=new XMLSerializer();if(A.nodeType==1){var B=document.implementation.createDocument("","",null);if(B.importNode){A=B.importNode(A,true)}B.appendChild(A);D=C.serializeToString(B)}else{D=C.serializeToString(A)}}return D},createElementNS:function(A,B){var C;if(this.xmldom){if(typeof A=="string"){C=this.xmldom.createNode(1,B,A)}else{C=this.xmldom.createNode(1,B,"")}}else{C=document.createElementNS(A,B)}return C},createDocumentFragment:function(){var A;if(this.xmldom){A=this.xmldom.createDocumentFragment()}else{A=document.createDocumentFragment()}return A},createTextNode:function(B){var A;if(typeof B!=="string"){B=String(B)}if(this.xmldom){A=this.xmldom.createTextNode(B)}else{A=document.createTextNode(B)}return A},getElementsByTagNameNS:function(F,H,C){var A=[];if(F.getElementsByTagNameNS){A=F.getElementsByTagNameNS(H,C)}else{var I=F.getElementsByTagName("*");var B,E;for(var D=0,G=I.length;D<G;++D){B=I[D];E=(B.prefix)?(B.prefix+":"+C):C;if((C=="*")||(E==B.nodeName)){if((H=="*")||(H==B.namespaceURI)){A.push(B)}}}}return A},getAttributeNodeNS:function(G,I,B){var C=null;if(G.getAttributeNodeNS){C=G.getAttributeNodeNS(I,B)}else{var E=G.attributes;var A,F;for(var D=0,H=E.length;D<H;++D){A=E[D];if(A.namespaceURI==I){F=(A.prefix)?(A.prefix+":"+B):B;if(F==A.nodeName){C=A;break}}}}return C},getAttributeNS:function(C,D,E){var B="";if(C.getAttributeNS){B=C.getAttributeNS(D,E)||""}else{var A=this.getAttributeNodeNS(C,D,E);if(A){B=A.nodeValue}}return B},getChildValue:function(B,D){var C=D||"";if(B){for(var A=B.firstChild;A;A=A.nextSibling){switch(A.nodeType){case 3:case 4:C+=A.nodeValue}}}return C},isSimpleContent:function(C){var B=true;for(var A=C.firstChild;A;A=A.nextSibling){if(A.nodeType===1){B=false;break}}return B},contentType:function(C){var B=false,A=false;var E=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY;for(var D=C.firstChild;D;D=D.nextSibling){switch(D.nodeType){case 1:A=true;break;case 8:break;default:B=true}if(A&&B){break}}if(A&&B){E=OpenLayers.Format.XML.CONTENT_TYPE.MIXED}else{if(A){return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX}else{if(B){return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}}}return E},hasAttributeNS:function(A,B,C){var D=false;if(A.hasAttributeNS){D=A.hasAttributeNS(B,C)}else{D=!!this.getAttributeNodeNS(A,B,C)}return D},setAttributeNS:function(B,C,D,E){if(B.setAttributeNS){B.setAttributeNS(C,D,E)}else{if(this.xmldom){if(C){var A=B.ownerDocument.createNode(2,D,C);A.nodeValue=E;B.setAttributeNode(A)}else{B.setAttribute(D,E)}}else{throw"setAttributeNS not implemented"}}},createElementNSPlus:function(D,C){C=C||{};var A=C.uri||this.namespaces[C.prefix];if(!A){var F=D.indexOf(":");A=this.namespaces[D.substring(0,F)]}if(!A){A=this.namespaces[this.defaultPrefix]}var B=this.createElementNS(A,D);if(C.attributes){this.setAttributes(B,C.attributes)}var E=C.value;if(E!=null){B.appendChild(this.createTextNode(E))}return B},setAttributes:function(B,A){var E,C;for(var D in A){if(A[D]!=null&&A[D].toString){E=A[D].toString();C=this.namespaces[D.substring(0,D.indexOf(":"))]||null;this.setAttributeNS(B,C,D,E)}}},readNode:function(C,B){if(!B){B={}}var A=this.readers[C.namespaceURI?this.namespaceAlias[C.namespaceURI]:this.defaultPrefix];if(A){var E=C.localName||C.nodeName.split(":").pop();var D=A[E]||A["*"];if(D){D.apply(this,[C,B])}}return B},readChildNodes:function(D,C){if(!C){C={}}var F=D.childNodes;var A;for(var B=0,E=F.length;B<E;++B){A=F[B];if(A.nodeType==1){this.readNode(A,C)}}return C},writeNode:function(E,B,F){var C,G;var A=E.indexOf(":");if(A>0){C=E.substring(0,A);G=E.substring(A+1)}else{if(F){C=this.namespaceAlias[F.namespaceURI]}else{C=this.defaultPrefix}G=E}var D=this.writers[C][G].apply(this,[B]);if(F){F.appendChild(D)}return D},getChildEl:function(B,C,A){return B&&this.getThisOrNextEl(B.firstChild,C,A)},getNextEl:function(B,C,A){return B&&this.getThisOrNextEl(B.nextSibling,C,A)},getThisOrNextEl:function(C,D,A){outer:for(var B=C;B;B=B.nextSibling){switch(B.nodeType){case 1:if((!D||D===(B.localName||B.nodeName.split(":").pop()))&&(!A||A===B.namespaceURI)){break outer}B=null;break outer;case 3:if(/^\s*$/.test(B.nodeValue)){break}case 4:case 6:case 12:case 10:case 11:B=null;break outer}}return B||null},lookupNamespaceURI:function(C,B){var D=null;if(C){if(C.lookupNamespaceURI){D=C.lookupNamespaceURI(B)}else{outer:switch(C.nodeType){case 1:if(C.namespaceURI!==null&&C.prefix===B){D=C.namespaceURI;break outer}var E=C.attributes.length;if(E){var F;for(var A=0;A<E;++A){F=C.attributes[A];if(F.prefix==="xmlns"&&F.name==="xmlns:"+B){D=F.value||null;break outer}else{if(F.name==="xmlns"&&B===null){D=F.value||null;break outer}}}}D=this.lookupNamespaceURI(C.parentNode,B);break outer;case 2:D=this.lookupNamespaceURI(C.ownerElement,B);break outer;case 9:D=this.lookupNamespaceURI(C.documentElement,B);break outer;case 6:case 12:case 10:case 11:break outer;default:D=this.lookupNamespaceURI(C.parentNode,B);break outer}}}return D},getXMLDoc:function(){if(!OpenLayers.Format.XML.document&&!this.xmldom){if(document.implementation&&document.implementation.createDocument){OpenLayers.Format.XML.document=document.implementation.createDocument("","",null)}else{if(!this.xmldom&&window.ActiveXObject){this.xmldom=new ActiveXObject("Microsoft.XMLDOM")}}}return OpenLayers.Format.XML.document||this.xmldom},CLASS_NAME:"OpenLayers.Format.XML"});OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3};OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype);OpenLayers.Format.XML.document=null;OpenLayers.Format.WFST=function(B){B=OpenLayers.Util.applyDefaults(B,OpenLayers.Format.WFST.DEFAULTS);var A=OpenLayers.Format.WFST["v"+B.version.replace(/\./g,"_")];if(!A){throw"Unsupported WFST version: "+B.version}return new A(B)};OpenLayers.Format.WFST.DEFAULTS={"version":"1.0.0"};OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(B,A,C){this.layer=B;this.lonlat=A;this.data=(C!=null)?C:{};this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){if((this.layer!=null)&&(this.layer.map!=null)){if(this.popup!=null){this.layer.map.removePopup(this.popup)}}if(this.layer!=null&&this.marker!=null){this.layer.removeMarker(this.marker)}this.layer=null;this.id=null;this.lonlat=null;this.data=null;if(this.marker!=null){this.destroyMarker(this.marker);this.marker=null}if(this.popup!=null){this.destroyPopup(this.popup);this.popup=null}},onScreen:function(){var B=false;if((this.layer!=null)&&(this.layer.map!=null)){var A=this.layer.map.getExtent();B=A.containsLonLat(this.lonlat)}return B},createMarker:function(){if(this.lonlat!=null){this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon)}return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(A){if(this.lonlat!=null){if(!this.popup){var B=(this.marker)?this.marker.icon:null;var C=this.popupClass?this.popupClass:OpenLayers.Popup.Anchored;this.popup=new C(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,B,A)}if(this.data.overflow!=null){this.popup.contentDiv.style.overflow=this.data.overflow}this.popup.feature=this}return this.popup},destroyPopup:function(){if(this.popup){this.popup.feature=null;this.popup.destroy();this.popup=null}},CLASS_NAME:"OpenLayers.Feature"});OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"};OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(C,A,B){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,A]);this.lonlat=null;this.geometry=C?C:null;this.state=null;this.attributes={};if(A){this.attributes=OpenLayers.Util.extend(this.attributes,A)}this.style=B?B:null},destroy:function(){if(this.layer){this.layer.removeFeatures(this);this.layer=null}this.geometry=null;this.modified=null;OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(A){var E=false;if(this.layer&&this.layer.map){var D=this.layer.map.getExtent();if(A){var B=this.geometry.getBounds();E=D.intersectsBounds(B)}else{var C=D.toGeometry();E=C.intersects(this.geometry)}}return E},getVisibility:function(){return !(this.style&&this.style.display=="none"||!this.layer||this.layer&&this.layer.styleMap&&this.layer.styleMap.createSymbolizer(this,this.renderIntent).display=="none"||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(B,C,D){var A=false;if(this.geometry){A=this.geometry.atPoint(B,C,D)}return A},destroyPopup:function(){},move:function(B){if(!this.layer||!this.geometry.move){return undefined}var A;if(B.CLASS_NAME=="OpenLayers.LonLat"){A=this.layer.getViewPortPxFromLonLat(B)}else{A=B}var C=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat());var D=this.layer.map.getResolution();this.geometry.move(D*(A.x-C.x),D*(C.y-A.y));this.layer.drawFeature(this);return C},toState:function(A){if(A==OpenLayers.State.UPDATE){switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=A;break;case OpenLayers.State.UPDATE:case OpenLayers.State.INSERT:break}}else{if(A==OpenLayers.State.INSERT){switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=A;break}}else{if(A==OpenLayers.State.DELETE){switch(this.state){case OpenLayers.State.INSERT:break;case OpenLayers.State.DELETE:break;case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=A;break}}else{if(A==OpenLayers.State.UNKNOWN){this.state=A}}}}},CLASS_NAME:"OpenLayers.Feature.Vector"});OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"select":{fillColor:"blue",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"temporary":{fillColor:"#66cccc",fillOpacity:0.2,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}};OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:false,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:false,propertyStyles:null,initialize:function(B,A){OpenLayers.Util.extend(this,A);this.rules=[];if(A&&A.rules){this.addRules(A.rules)}this.setDefaultStyle(B||OpenLayers.Feature.Vector.style["default"]);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var A=0,B=this.rules.length;A<B;A++){this.rules[A].destroy();this.rules[A]=null}this.rules=null;this.defaultStyle=null},createSymbolizer:function(I){var E=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),I);var B=this.rules;var H,C;var A=[];var F=false;for(var D=0,G=B.length;D<G;D++){H=B[D];var J=H.evaluate(I);if(J){if(H instanceof OpenLayers.Rule&&H.elseFilter){A.push(H)}else{F=true;this.applySymbolizer(H,E,I)}}}if(F==false&&A.length>0){F=true;for(var D=0,G=A.length;D<G;D++){this.applySymbolizer(A[D],E,I)}}if(B.length>0&&F==false){E.display="none"}if(E.label!=null&&typeof E.label!=="string"){E.label=String(E.label)}return E},applySymbolizer:function(C,D,B){var E=B.geometry?this.getSymbolizerPrefix(B.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0];var A=C.symbolizer[E]||C.symbolizer;if(this.defaultsPerSymbolizer===true){var F=this.defaultStyle;OpenLayers.Util.applyDefaults(A,{pointRadius:F.pointRadius});if(A.stroke===true||A.graphic===true){OpenLayers.Util.applyDefaults(A,{strokeWidth:F.strokeWidth,strokeColor:F.strokeColor,strokeOpacity:F.strokeOpacity,strokeDashstyle:F.strokeDashstyle,strokeLinecap:F.strokeLinecap})}if(A.fill===true||A.graphic===true){OpenLayers.Util.applyDefaults(A,{fillColor:F.fillColor,fillOpacity:F.fillOpacity})}if(A.graphic===true){OpenLayers.Util.applyDefaults(A,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset})}}return this.createLiterals(OpenLayers.Util.extend(D,A),B)},createLiterals:function(D,B){var A=OpenLayers.Util.extend({},B.attributes||B.data);OpenLayers.Util.extend(A,this.context);for(var C in this.propertyStyles){D[C]=OpenLayers.Style.createLiteral(D[C],A,B,C)}return D},findPropertyStyles:function(){var F={};var E=this.defaultStyle;this.addPropertyStyles(F,E);var B=this.rules;var H,C;for(var D=0,G=B.length;D<G;D++){H=B[D].symbolizer;for(var A in H){C=H[A];if(typeof C=="object"){this.addPropertyStyles(F,C)}else{this.addPropertyStyles(F,H);break}}}return F},addPropertyStyles:function(C,B){var D;for(var A in B){D=B[A];if(typeof D=="string"&&D.match(/\$\{\w+\}/)){C[A]=true}}return C},addRules:function(A){Array.prototype.push.apply(this.rules,A);this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(A){this.defaultStyle=A;this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(C){var B=OpenLayers.Style.SYMBOLIZER_PREFIXES;for(var A=0,D=B.length;A<D;A++){if(C.CLASS_NAME.indexOf(B[A])!=-1){return B[A]}}},clone:function(){var C=OpenLayers.Util.extend({},this);if(this.rules){C.rules=[];for(var A=0,D=this.rules.length;A<D;++A){C.rules.push(this.rules[A].clone())}}C.context=this.context&&OpenLayers.Util.extend({},this.context);var B=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(B,C)},CLASS_NAME:"OpenLayers.Style"});OpenLayers.Style.createLiteral=function(C,A,D,B){if(typeof C=="string"&&C.indexOf("${")!=-1){C=OpenLayers.String.format(C,A,[D,B]);C=(isNaN(C)||!C)?C:parseFloat(C)}return C};OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"];OpenLayers.Filter=OpenLayers.Class({initialize:function(A){OpenLayers.Util.extend(this,A)},destroy:function(){},evaluate:function(A){return true},clone:function(){return null},toString:function(){var A;if(OpenLayers.Format&&OpenLayers.Format.CQL){A=OpenLayers.Format.CQL.prototype.write(this)}else{A=Object.prototype.toString.call(this)}return A},CLASS_NAME:"OpenLayers.Filter"});OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,evaluate:function(A){var B=false;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(A.geometry){var C=this.value;if(this.value.CLASS_NAME=="OpenLayers.Bounds"){C=this.value.toGeometry()}if(A.geometry.intersects(C)){B=true}}break;default:throw new Error("evaluate is not implemented for this filter type.")}return B},clone:function(){var A=OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(A)},CLASS_NAME:"OpenLayers.Filter.Spatial"});OpenLayers.Filter.Spatial.BBOX="BBOX";OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS";OpenLayers.Filter.Spatial.DWITHIN="DWITHIN";OpenLayers.Filter.Spatial.WITHIN="WITHIN";OpenLayers.Filter.Spatial.CONTAINS="CONTAINS";OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,type:"FID",initialize:function(A){this.fids=[];OpenLayers.Filter.prototype.initialize.apply(this,[A])},evaluate:function(A){for(var B=0,C=this.fids.length;B<C;B++){var D=A.fid||A.id;if(D==this.fids[B]){return true}}return false},clone:function(){var A=new OpenLayers.Filter.FeatureId();OpenLayers.Util.extend(A,this);A.fids=this.fids.slice();return A},CLASS_NAME:"OpenLayers.Filter.FeatureId"});OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:true,xy:true,stateName:null,initialize:function(A){this.stateName={};this.stateName[OpenLayers.State.INSERT]="wfs:Insert";this.stateName[OpenLayers.State.UPDATE]="wfs:Update";this.stateName[OpenLayers.State.DELETE]="wfs:Delete";OpenLayers.Format.XML.prototype.initialize.apply(this,[A])},getSrsName:function(A,C){var B=C&&C.srsName;if(!B){if(A&&A.layer){B=A.layer.projection.getCode()}else{B=this.srsName}}return B},read:function(C,B){B=B||{};OpenLayers.Util.applyDefaults(B,{output:"features"});if(typeof C=="string"){C=OpenLayers.Format.XML.prototype.read.apply(this,[C])}if(C&&C.nodeType==9){C=C.documentElement}var A={};if(C){this.readNode(C,A,true)}if(A.features&&B.output==="features"){A=A.features}return A},readers:{"wfs":{"FeatureCollection":function(B,A){A.features=[];this.readChildNodes(B,A)}}},write:function(A,C){var B=this.writeNode("wfs:Transaction",{features:A,options:C});var D=this.schemaLocationAttr();if(D){this.setAttributeNS(B,this.namespaces["xsi"],"xsi:schemaLocation",D)}return OpenLayers.Format.XML.prototype.write.apply(this,[B])},writers:{"wfs":{"GetFeature":function(C){var B=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,handle:C&&C.handle,outputFormat:C&&C.outputFormat,maxFeatures:C&&C.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(C)}});if(typeof this.featureType=="string"){this.writeNode("Query",C,B)}else{for(var A=0,D=this.featureType.length;A<D;A++){C.featureType=this.featureType[A];this.writeNode("Query",C,B)}}return B},"Transaction":function(F){F=F||{};var D=F.options||{};var E=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version,handle:D.handle}});var C,G;var B=F.features;if(B){if(D.multi===true){OpenLayers.Util.extend(this.geometryTypes,{"OpenLayers.Geometry.Point":"MultiPoint","OpenLayers.Geometry.LineString":(this.multiCurve===true)?"MultiCurve":"MultiLineString","OpenLayers.Geometry.Polygon":(this.multiSurface===true)?"MultiSurface":"MultiPolygon"})}var A,H;for(C=0,G=B.length;C<G;++C){H=B[C];A=this.stateName[H.state];if(A){this.writeNode(A,{feature:H,options:D},E)}}if(D.multi===true){this.setGeometryTypes()}}if(D.nativeElements){for(C=0,G=D.nativeElements.length;C<G;++C){this.writeNode("wfs:Native",D.nativeElements[C],E)}}return E},"Native":function(B){var A=this.createElementNSPlus("wfs:Native",{attributes:{vendorId:B.vendorId,safeToIgnore:B.safeToIgnore},value:B.value});return A},"Insert":function(B){var A=B.feature;var D=B.options;var C=this.createElementNSPlus("wfs:Insert",{attributes:{handle:D&&D.handle}});this.srsName=this.getSrsName(A);this.writeNode("feature:_typeName",A,C);return C},"Update":function(C){var B=C.feature;var E=C.options;var D=this.createElementNSPlus("wfs:Update",{attributes:{handle:E&&E.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});if(this.featureNS){D.setAttribute("xmlns:"+this.featurePrefix,this.featureNS)}var A=B.modified;if(this.geometryName!==null&&(!A||A.geometry!==undefined)){this.srsName=this.getSrsName(B);this.writeNode("Property",{name:this.geometryName,value:B.geometry},D)}for(var F in B.attributes){if(B.attributes[F]!==undefined&&(!A||!A.attributes||(A.attributes&&A.attributes[F]!==undefined))){this.writeNode("Property",{name:F,value:B.attributes[F]},D)}}this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[B.fid]}),D);return D},"Property":function(A){var B=this.createElementNSPlus("wfs:Property");this.writeNode("Name",A.name,B);if(A.value!==null){this.writeNode("Value",A.value,B)}return B},"Name":function(A){return this.createElementNSPlus("wfs:Name",{value:A})},"Value":function(A){var B;if(A instanceof OpenLayers.Geometry){B=this.createElementNSPlus("wfs:Value");var C=this.writeNode("feature:_geometry",A).firstChild;B.appendChild(C)}else{B=this.createElementNSPlus("wfs:Value",{value:A})}return B},"Delete":function(B){var A=B.feature;var D=B.options;var C=this.createElementNSPlus("wfs:Delete",{attributes:{handle:D&&D.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});if(this.featureNS){C.setAttribute("xmlns:"+this.featurePrefix,this.featureNS)}this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[A.fid]}),C);return C}}},schemaLocationAttr:function(D){D=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},D);var E=OpenLayers.Util.extend({},this.schemaLocations);if(D.schema){E[D.featurePrefix]=D.schema}var A=[];var B;for(var F in E){B=this.namespaces[F];if(B){A.push(B+" "+E[F])}}var C=A.join(" ")||undefined;return C},setFilterProperty:function(B){if(B.filters){for(var A=0,C=B.filters.length;A<C;++A){OpenLayers.Format.WFST.v1.prototype.setFilterProperty.call(this,B.filters[A])}}else{if(B instanceof OpenLayers.Filter.Spatial&&!B.property){B.property=this.geometryName}}},CLASS_NAME:"OpenLayers.Format.WFST.v1"});OpenLayers.Format.OGCExceptionReport=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc"},regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},defaultPrefix:"ogc",read:function(D){var C;if(typeof D=="string"){D=OpenLayers.Format.XML.prototype.read.apply(this,[D])}var B=D.documentElement;var A={exceptionReport:null};if(B){this.readChildNodes(D,A);if(A.exceptionReport===null){A=new OpenLayers.Format.OWSCommon().read(D)}}return A},readers:{"ogc":{"ServiceExceptionReport":function(B,A){A.exceptionReport={exceptions:[]};this.readChildNodes(B,A.exceptionReport)},"ServiceException":function(B,C){var A={code:B.getAttribute("code"),locator:B.getAttribute("locator"),text:this.getChildValue(B)};C.exceptions.push(A)}}},CLASS_NAME:"OpenLayers.Format.OGCExceptionReport"});OpenLayers.Format.XML.VersionedOGC=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:null,version:null,profile:null,allowFallback:false,name:null,stringifyOutput:false,parser:null,initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B]);var A=this.CLASS_NAME;this.name=A.substring(A.lastIndexOf(".")+1)},getVersion:function(A,B){var C;if(A){C=this.version;if(!C){C=A.getAttribute("version");if(!C){C=this.defaultVersion}}}else{C=(B&&B.version)||this.version||this.defaultVersion}return C},getParser:function(C){C=C||this.defaultVersion;var B=this.profile?"_"+this.profile:"";if(!this.parser||this.parser.VERSION!=C){var A=OpenLayers.Format[this.name]["v"+C.replace(/\./g,"_")+B];if(!A){if(B!==""&&this.allowFallback){B="";A=OpenLayers.Format[this.name]["v"+C.replace(/\./g,"_")]}if(!A){throw"Can't find a "+this.name+" parser for version "+C+B}}this.parser=new A(this.options)}return this.parser},write:function(A,B){var D=this.getVersion(null,B);this.parser=this.getParser(D);var C=this.parser.write(A,B);if(this.stringifyOutput===false){return C}else{return OpenLayers.Format.XML.prototype.write.apply(this,[C])}},read:function(G,E){if(typeof G=="string"){G=OpenLayers.Format.XML.prototype.read.apply(this,[G])}var C=G.documentElement;var F=this.getVersion(C);this.parser=this.getParser(F);var D=this.parser.read(G,E);var B=this.parser.errorProperty||null;if(B!==null&&D[B]===undefined){var A=new OpenLayers.Format.OGCExceptionReport();D.error=A.read(G)}D.version=F;return D},CLASS_NAME:"OpenLayers.Format.XML.VersionedOGC"});OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(A){this.filters=[];OpenLayers.Filter.prototype.initialize.apply(this,[A])},destroy:function(){this.filters=null;OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(A){var B,C;switch(this.type){case OpenLayers.Filter.Logical.AND:for(B=0,C=this.filters.length;B<C;B++){if(this.filters[B].evaluate(A)==false){return false}}return true;case OpenLayers.Filter.Logical.OR:for(B=0,C=this.filters.length;B<C;B++){if(this.filters[B].evaluate(A)==true){return true}}return false;case OpenLayers.Filter.Logical.NOT:return(!this.filters[0].evaluate(A))}return undefined},clone:function(){var B=[];for(var A=0,C=this.filters.length;A<C;++A){B.push(this.filters[A].clone())}return new OpenLayers.Filter.Logical({type:this.type,filters:B})},CLASS_NAME:"OpenLayers.Filter.Logical"});OpenLayers.Filter.Logical.AND="&&";OpenLayers.Filter.Logical.OR="||";OpenLayers.Filter.Logical.NOT="!";OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:true,lowerBoundary:null,upperBoundary:null,initialize:function(A){OpenLayers.Filter.prototype.initialize.apply(this,[A]);if(this.type===OpenLayers.Filter.Comparison.LIKE&&A.matchCase===undefined){this.matchCase=null}},evaluate:function(B){if(B instanceof OpenLayers.Feature.Vector){B=B.attributes}var C=false;var E=B[this.property];var D;switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:D=this.value;if(!this.matchCase&&typeof E=="string"&&typeof D=="string"){C=(E.toUpperCase()==D.toUpperCase())}else{C=(E==D)}break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:D=this.value;if(!this.matchCase&&typeof E=="string"&&typeof D=="string"){C=(E.toUpperCase()!=D.toUpperCase())}else{C=(E!=D)}break;case OpenLayers.Filter.Comparison.LESS_THAN:C=E<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:C=E>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:C=E<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:C=E>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:C=(E>=this.lowerBoundary)&&(E<=this.upperBoundary);break;case OpenLayers.Filter.Comparison.LIKE:var A=new RegExp(this.value,"gi");C=A.test(E);break;case OpenLayers.Filter.Comparison.IS_NULL:C=(E===null);break}return C},value2regex:function(B,C,A){if(B=="."){throw new Error("'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison")}B=B?B:"*";C=C?C:".";A=A?A:"!";this.value=this.value.replace(new RegExp("\\"+A+"(.|$)","g"),"\\$1");this.value=this.value.replace(new RegExp("\\"+C,"g"),".");this.value=this.value.replace(new RegExp("\\"+B,"g"),".*");this.value=this.value.replace(new RegExp("\\\\.\\*","g"),"\\"+B);this.value=this.value.replace(new RegExp("\\\\\\.","g"),"\\"+C);return this.value},regex2value:function(){var A=this.value;A=A.replace(/!/g,"!!");A=A.replace(/(\\)?\\\./g,function(C,B){return B?C:"!."});A=A.replace(/(\\)?\\\*/g,function(C,B){return B?C:"!*"});A=A.replace(/\\\\/g,"\\");A=A.replace(/\.\*/g,"*");return A},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison(),this)},CLASS_NAME:"OpenLayers.Filter.Comparison"});OpenLayers.Filter.Comparison.EQUAL_TO="==";OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=";OpenLayers.Filter.Comparison.LESS_THAN="<";OpenLayers.Filter.Comparison.GREATER_THAN=">";OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=";OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=";OpenLayers.Filter.Comparison.BETWEEN="..";OpenLayers.Filter.Comparison.LIKE="~";OpenLayers.Filter.Comparison.IS_NULL="NULL";OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.Filter"});OpenLayers.Filter.Function=OpenLayers.Class(OpenLayers.Filter,{name:null,params:null,CLASS_NAME:"OpenLayers.Filter.Function"});OpenLayers.Date={dateRegEx:/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/,toISOString:(function(){if("toISOString" in Date.prototype){return function(A){return A.toISOString()}}else{return function(B){var A;if(isNaN(B.getTime())){A="Invalid Date"}else{A=B.getUTCFullYear()+"-"+OpenLayers.Number.zeroPad(B.getUTCMonth()+1,2)+"-"+OpenLayers.Number.zeroPad(B.getUTCDate(),2)+"T"+OpenLayers.Number.zeroPad(B.getUTCHours(),2)+":"+OpenLayers.Number.zeroPad(B.getUTCMinutes(),2)+":"+OpenLayers.Number.zeroPad(B.getUTCSeconds(),2)+"."+OpenLayers.Number.zeroPad(B.getUTCMilliseconds(),3)+"Z"}return A}}})(),parse:function(G){var O;var D=G.match(this.dateRegEx);if(D&&(D[1]||D[7])){var J=parseInt(D[1],10)||0;var C=(parseInt(D[2],10)-1)||0;var H=parseInt(D[3],10)||1;O=new Date(Date.UTC(J,C,H));var L=D[7];if(L){var N=parseInt(D[4],10);var M=parseInt(D[5],10);var B=parseFloat(D[6]);var E=B|0;var A=Math.round(1000*(B-E));O.setUTCHours(N,M,E,A);if(L!=="Z"){var F=parseInt(L,10);var I=parseInt(D[8],10)||0;var K=-1000*(60*(F*60)+I*60);O=new Date(O.getTime()+K)}}}else{O=new Date("invalid")}return O}};OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(A){OpenLayers.Format.XML.prototype.initialize.apply(this,[A])},read:function(B){var A={};this.readers.ogc["Filter"].apply(this,[B,A]);return A.filter},readers:{"ogc":{"_expression":function(C){var B,D="";for(var A=C.firstChild;A;A=A.nextSibling){switch(A.nodeType){case 1:B=this.readNode(A);if(B.property){D+="${"+B.property+"}"}else{if(B.value!==undefined){D+=B.value}}break;case 3:case 4:D+=A.nodeValue}}return D},"Filter":function(B,C){var A={fids:[],filters:[]};this.readChildNodes(B,A);if(A.fids.length>0){C.filter=new OpenLayers.Filter.FeatureId({fids:A.fids})}else{if(A.filters.length>0){C.filter=A.filters[0]}}},"FeatureId":function(B,A){var C=B.getAttribute("fid");if(C){A.fids.push(C)}},"And":function(B,A){var C=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});this.readChildNodes(B,C);A.filters.push(C)},"Or":function(B,A){var C=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(B,C);A.filters.push(C)},"Not":function(B,A){var C=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(B,C);A.filters.push(C)},"PropertyIsLessThan":function(B,A){var C=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(B,C);A.filters.push(C)},"PropertyIsGreaterThan":function(B,A){var C=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(B,C);A.filters.push(C)},"PropertyIsLessThanOrEqualTo":function(B,A){var C=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(B,C);A.filters.push(C)},"PropertyIsGreaterThanOrEqualTo":function(B,A){var C=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(B,C);A.filters.push(C)},"PropertyIsBetween":function(B,A){var C=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(B,C);A.filters.push(C)},"Literal":function(B,A){A.value=OpenLayers.String.numericIf(this.getChildValue(B),true)},"PropertyName":function(A,B){B.property=this.getChildValue(A)},"LowerBoundary":function(A,B){B.lowerBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,A),true)},"UpperBoundary":function(A,B){B.upperBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,A),true)},"Intersects":function(B,A){this.readSpatial(B,A,OpenLayers.Filter.Spatial.INTERSECTS)},"Within":function(B,A){this.readSpatial(B,A,OpenLayers.Filter.Spatial.WITHIN)},"Contains":function(B,A){this.readSpatial(B,A,OpenLayers.Filter.Spatial.CONTAINS)},"DWithin":function(B,A){this.readSpatial(B,A,OpenLayers.Filter.Spatial.DWITHIN)},"Distance":function(B,A){A.distance=parseInt(this.getChildValue(B));A.distanceUnits=B.getAttribute("units")},"Function":function(B,A){return},"PropertyIsNull":function(B,A){var C=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.IS_NULL});this.readChildNodes(B,C);A.filters.push(C)}}},readSpatial:function(C,B,A){var D=new OpenLayers.Filter.Spatial({type:A});this.readChildNodes(C,D);D.value=D.components[0];delete D.components;B.filters.push(D)},encodeLiteral:function(A){if(A instanceof Date){A=OpenLayers.Date.toISOString(A)}return A},writeOgcExpression:function(B,A){if(B instanceof OpenLayers.Filter.Function){this.writeNode("Function",B,A)}else{this.writeNode("Literal",B,A)}return A},write:function(A){return this.writers.ogc["Filter"].apply(this,[A])},writers:{"ogc":{"Filter":function(B){var A=this.createElementNSPlus("ogc:Filter");this.writeNode(this.getFilterType(B),B,A);return A},"_featureIds":function(C){var B=this.createDocumentFragment();for(var A=0,D=C.fids.length;A<D;++A){this.writeNode("ogc:FeatureId",C.fids[A],B)}return B},"FeatureId":function(A){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:A}})},"And":function(D){var C=this.createElementNSPlus("ogc:And");var A;for(var B=0,E=D.filters.length;B<E;++B){A=D.filters[B];this.writeNode(this.getFilterType(A),A,C)}return C},"Or":function(D){var C=this.createElementNSPlus("ogc:Or");var A;for(var B=0,E=D.filters.length;B<E;++B){A=D.filters[B];this.writeNode(this.getFilterType(A),A,C)}return C},"Not":function(C){var B=this.createElementNSPlus("ogc:Not");var A=C.filters[0];this.writeNode(this.getFilterType(A),A,B);return B},"PropertyIsLessThan":function(B){var A=this.createElementNSPlus("ogc:PropertyIsLessThan");this.writeNode("PropertyName",B,A);this.writeOgcExpression(B.value,A);return A},"PropertyIsGreaterThan":function(B){var A=this.createElementNSPlus("ogc:PropertyIsGreaterThan");this.writeNode("PropertyName",B,A);this.writeOgcExpression(B.value,A);return A},"PropertyIsLessThanOrEqualTo":function(B){var A=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");this.writeNode("PropertyName",B,A);this.writeOgcExpression(B.value,A);return A},"PropertyIsGreaterThanOrEqualTo":function(B){var A=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");this.writeNode("PropertyName",B,A);this.writeOgcExpression(B.value,A);return A},"PropertyIsBetween":function(B){var A=this.createElementNSPlus("ogc:PropertyIsBetween");this.writeNode("PropertyName",B,A);this.writeNode("LowerBoundary",B,A);this.writeNode("UpperBoundary",B,A);return A},"PropertyName":function(A){return this.createElementNSPlus("ogc:PropertyName",{value:A.property})},"Literal":function(B){var A=this.encodeLiteral||OpenLayers.Format.Filter.v1.prototype.encodeLiteral;return this.createElementNSPlus("ogc:Literal",{value:A(B)})},"LowerBoundary":function(B){var A=this.createElementNSPlus("ogc:LowerBoundary");this.writeOgcExpression(B.lowerBoundary,A);return A},"UpperBoundary":function(B){var A=this.createElementNSPlus("ogc:UpperBoundary");this.writeNode("Literal",B.upperBoundary,A);return A},"INTERSECTS":function(A){return this.writeSpatial(A,"Intersects")},"WITHIN":function(A){return this.writeSpatial(A,"Within")},"CONTAINS":function(A){return this.writeSpatial(A,"Contains")},"DWITHIN":function(B){var A=this.writeSpatial(B,"DWithin");this.writeNode("Distance",B,A);return A},"Distance":function(A){return this.createElementNSPlus("ogc:Distance",{attributes:{units:A.distanceUnits},value:A.distance})},"Function":function(C){var B=this.createElementNSPlus("ogc:Function",{attributes:{name:C.name}});var E=C.params;for(var A=0,D=E.length;A<D;A++){this.writeOgcExpression(E[A],B)}return B},"PropertyIsNull":function(B){var A=this.createElementNSPlus("ogc:PropertyIsNull");this.writeNode("PropertyName",B,A);return A}}},getFilterType:function(B){var A=this.filterMap[B.type];if(!A){throw"Filter writing not supported for rule type: "+B.type}return A},filterMap:{"&&":"And","||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","<":"PropertyIsLessThan",">":"PropertyIsGreaterThan","<=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike","NULL":"PropertyIsNull","BBOX":"BBOX","DWITHIN":"DWITHIN","WITHIN":"WITHIN","CONTAINS":"CONTAINS","INTERSECTS":"INTERSECTS","FID":"_featureIds"},CLASS_NAME:"OpenLayers.Format.Filter.v1"});OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.id=null;this.bounds=null},clone:function(){return new OpenLayers.Geometry()},setBounds:function(A){if(A){this.bounds=A.clone()}},clearBounds:function(){this.bounds=null;if(this.parent){this.parent.clearBounds()}},extendBounds:function(B){var A=this.getBounds();if(!A){this.setBounds(B)}else{this.bounds.extend(B)}},getBounds:function(){if(this.bounds==null){this.calculateBounds()}return this.bounds},calculateBounds:function(){},distanceTo:function(B,A){},getVertices:function(A){},atPoint:function(G,E,A){var H=false;var C=this.getBounds();if((C!=null)&&(G!=null)){var D=(E!=null)?E:0;var F=(A!=null)?A:0;var B=new OpenLayers.Bounds(this.bounds.left-D,this.bounds.bottom-F,this.bounds.right+D,this.bounds.top+F);H=B.containsLonLat(G)}return H},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){var A;if(OpenLayers.Format&&OpenLayers.Format.WKT){A=OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this))}else{A=Object.prototype.toString.call(this)}return A},CLASS_NAME:"OpenLayers.Geometry"});OpenLayers.Geometry.fromWKT=function(F){var G;if(OpenLayers.Format&&OpenLayers.Format.WKT){var B=OpenLayers.Geometry.fromWKT.format;if(!B){B=new OpenLayers.Format.WKT();OpenLayers.Geometry.fromWKT.format=B}var C=B.read(F);if(C instanceof OpenLayers.Feature.Vector){G=C.geometry}else{if(OpenLayers.Util.isArray(C)){var D=C.length;var E=new Array(D);for(var A=0;A<D;++A){E[A]=C[A].geometry}G=new OpenLayers.Geometry.Collection(E)}}}return G};OpenLayers.Geometry.segmentsIntersect=function(D,F,U){var C=U&&U.point;var Y=U&&U.tolerance;var V=false;var T=D.x1-F.x1;var O=D.y1-F.y1;var B=D.x2-D.x1;var G=D.y2-D.y1;var J=F.y2-F.y1;var E=F.x2-F.x1;var L=(J*B)-(E*G);var N=(E*O)-(J*T);var I=(B*O)-(G*T);if(L==0){if(N==0&&I==0){V=true}}else{var b=N/L;var K=I/L;if(b>=0&&b<=1&&K>=0&&K<=1){if(!C){V=true}else{var M=D.x1+(b*B);var Z=D.y1+(b*G);V=new OpenLayers.Geometry.Point(M,Z)}}}if(Y){var R;if(V){if(C){var H=[D,F];var a,M,Z;outer:for(var X=0;X<2;++X){a=H[X];for(var A=1;A<3;++A){M=a["x"+A];Z=a["y"+A];R=Math.sqrt(Math.pow(M-V.x,2)+Math.pow(Z-V.y,2));if(R<Y){V.x=M;V.y=Z;break outer}}}}}else{var H=[D,F];var P,W,M,Z,S,Q;outer:for(var X=0;X<2;++X){P=H[X];W=H[(X+1)%2];for(var A=1;A<3;++A){S={x:P["x"+A],y:P["y"+A]};Q=OpenLayers.Geometry.distanceToSegment(S,W);if(Q.distance<Y){if(C){V=new OpenLayers.Geometry.Point(S.x,S.y)}else{V=true}break outer}}}}}return V};OpenLayers.Geometry.distanceToSegment=function(A,B){var C=OpenLayers.Geometry.distanceSquaredToSegment(A,B);C.distance=Math.sqrt(C.distance);return C};OpenLayers.Geometry.distanceSquaredToSegment=function(K,J){var G=K.x;var D=K.y;var A=J.x1;var B=J.y1;var C=J.x2;var E=J.y2;var H=C-A;var F=E-B;var I=((H*(G-A))+(F*(D-B)))/(Math.pow(H,2)+Math.pow(F,2));var L,M;if(I<=0){L=A;M=B}else{if(I>=1){L=C;M=E}else{L=A+I*H;M=B+I*F}}return{distance:Math.pow(L-G,2)+Math.pow(M-D,2),x:L,y:M,along:I}};OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(A,B){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(A);this.y=parseFloat(B)},clone:function(A){if(A==null){A=new OpenLayers.Geometry.Point(this.x,this.y)}OpenLayers.Util.applyDefaults(A,this);return A},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(F,I){var J=!(I&&I.edge===false);var G=J&&I&&I.details;var H,D,E,B,C,A;if(F instanceof OpenLayers.Geometry.Point){D=this.x;E=this.y;B=F.x;C=F.y;H=Math.sqrt(Math.pow(D-B,2)+Math.pow(E-C,2));A=!G?H:{x0:D,y0:E,x1:B,y1:C,distance:H}}else{A=F.distanceTo(this,I);if(G){A={x0:A.x1,y0:A.y1,x1:A.x0,y1:A.y0,distance:A.distance}}}return A},equals:function(B){var A=false;if(B!=null){A=((this.x==B.x&&this.y==B.y)||(isNaN(this.x)&&isNaN(this.y)&&isNaN(B.x)&&isNaN(B.y)))}return A},toShortString:function(){return(this.x+", "+this.y)},move:function(A,B){this.x=this.x+A;this.y=this.y+B;this.clearBounds()},rotate:function(D,B){D*=Math.PI/180;var A=this.distanceTo(B);var C=D+Math.atan2(this.y-B.y,this.x-B.x);this.x=B.x+(A*Math.cos(C));this.y=B.y+(A*Math.sin(C));this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(C,A,B){B=(B==undefined)?1:B;this.x=A.x+(C*B*(this.x-A.x));this.y=A.y+(C*(this.y-A.y));this.clearBounds();return this},intersects:function(B){var A=false;if(B.CLASS_NAME=="OpenLayers.Geometry.Point"){A=this.equals(B)}else{A=B.intersects(this)}return A},transform:function(B,A){if((B&&A)){OpenLayers.Projection.transform(this,B,A);this.bounds=null}return this},getVertices:function(A){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"});OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(A){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.components=[];if(A!=null){this.addComponents(A)}},destroy:function(){this.components.length=0;this.components=null;OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){var geometry=eval("new "+this.CLASS_NAME+"()");for(var i=0,len=this.components.length;i<len;i++){geometry.addComponent(this.components[i].clone())}OpenLayers.Util.applyDefaults(geometry,this);return geometry},getComponentsString:function(){var B=[];for(var A=0,C=this.components.length;A<C;A++){B.push(this.components[A].toShortString())}return B.join(",")},calculateBounds:function(){this.bounds=null;var B=new OpenLayers.Bounds();var C=this.components;if(C){for(var A=0,D=C.length;A<D;A++){B.extend(C[A].getBounds())}}if(B.left!=null&&B.bottom!=null&&B.right!=null&&B.top!=null){this.setBounds(B)}},addComponents:function(B){if(!(OpenLayers.Util.isArray(B))){B=[B]}for(var A=0,C=B.length;A<C;A++){this.addComponent(B[A])}},addComponent:function(C,D){var E=false;if(C){if(this.componentTypes==null||(OpenLayers.Util.indexOf(this.componentTypes,C.CLASS_NAME)>-1)){if(D!=null&&(D<this.components.length)){var A=this.components.slice(0,D);var B=this.components.slice(D,this.components.length);A.push(C);this.components=A.concat(B)}else{this.components.push(C)}C.parent=this;this.clearBounds();E=true}}return E},removeComponents:function(C){var A=false;if(!(OpenLayers.Util.isArray(C))){C=[C]}for(var B=C.length-1;B>=0;--B){A=this.removeComponent(C[B])||A}return A},removeComponent:function(A){OpenLayers.Util.removeItem(this.components,A);this.clearBounds();return true},getLength:function(){var A=0;for(var B=0,C=this.components.length;B<C;B++){A+=this.components[B].getLength()}return A},getArea:function(){var C=0;for(var A=0,B=this.components.length;A<B;A++){C+=this.components[A].getArea()}return C},getGeodesicArea:function(B){var D=0;for(var A=0,C=this.components.length;A<C;A++){D+=this.components[A].getGeodesicArea(B)}return D},getCentroid:function(B){if(!B){return this.components.length&&this.components[0].getCentroid()}var K=this.components.length;if(!K){return false}var F=[];var H=[];var D=0;var A=Number.MAX_VALUE;var I;for(var G=0;G<K;++G){I=this.components[G];var C=I.getArea();var L=I.getCentroid(true);if(isNaN(C)||isNaN(L.x)||isNaN(L.y)){continue}F.push(C);D+=C;A=(C<A&&C>0)?C:A;H.push(L)}K=F.length;if(D===0){for(var G=0;G<K;++G){F[G]=1}D=F.length}else{for(var G=0;G<K;++G){F[G]/=A}D/=A}var E=0,J=0,L,C;for(var G=0;G<K;++G){L=H[G];C=F[G];E+=L.x*C;J+=L.y*C}return new OpenLayers.Geometry.Point(E/D,J/D)},getGeodesicLength:function(C){var A=0;for(var B=0,D=this.components.length;B<D;B++){A+=this.components[B].getGeodesicLength(C)}return A},move:function(B,C){for(var A=0,D=this.components.length;A<D;A++){this.components[A].move(B,C)}},rotate:function(D,C){for(var A=0,B=this.components.length;A<B;++A){this.components[A].rotate(D,C)}},resize:function(D,A,C){for(var B=0;B<this.components.length;++B){this.components[B].resize(D,A,C)}return this},distanceTo:function(J,F){var H=!(F&&F.edge===false);var D=H&&F&&F.details;var A,C,E;var B=Number.POSITIVE_INFINITY;for(var G=0,I=this.components.length;G<I;++G){A=this.components[G].distanceTo(J,F);E=D?A.distance:A;if(E<B){B=E;C=A;if(B==0){break}}}return C},equals:function(C){var A=true;if(!C||!C.CLASS_NAME||(this.CLASS_NAME!=C.CLASS_NAME)){A=false}else{if(!(OpenLayers.Util.isArray(C.components))||(C.components.length!=this.components.length)){A=false}else{for(var B=0,D=this.components.length;B<D;++B){if(!this.components[B].equals(C.components[B])){A=false;break}}}}return A},transform:function(C,B){if(C&&B){for(var A=0,E=this.components.length;A<E;A++){var D=this.components[A];D.transform(C,B)}this.bounds=null}return this},intersects:function(C){var B=false;for(var A=0,D=this.components.length;A<D;++A){B=C.intersects(this.components[A]);if(B){break}}return B},getVertices:function(C){var B=[];for(var A=0,D=this.components.length;A<D;++A){Array.prototype.push.apply(B,this.components[A].getVertices(C))}return B},CLASS_NAME:"OpenLayers.Geometry.Collection"});OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(A,B){this.addComponent(A,B)},removePoint:function(A){this.removeComponent(A)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"});OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var A=0;if(this.components&&(this.components.length>1)){for(var B=1,C=this.components.length;B<C;B++){A+=this.components[B-1].distanceTo(this.components[B])}}return A},getGeodesicLength:function(B){var E=this;if(B){var H=new OpenLayers.Projection("EPSG:4326");if(!H.equals(B)){E=this.clone().transform(B,H)}}var C=0;if(E.components&&(E.components.length>1)){var A,F;for(var D=1,G=E.components.length;D<G;D++){A=E.components[D-1];F=E.components[D];C+=OpenLayers.Util.distVincenty({lon:A.x,lat:A.y},{lon:F.x,lat:F.y})}}return C*1000},CLASS_NAME:"OpenLayers.Geometry.Curve"});OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(B){var A=this.components&&(this.components.length>2);if(A){OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments)}return A},intersects:function(N){var H=false;var P=N.CLASS_NAME;if(P=="OpenLayers.Geometry.LineString"||P=="OpenLayers.Geometry.LinearRing"||P=="OpenLayers.Geometry.Point"){var M=this.getSortedSegments();var L;if(P=="OpenLayers.Geometry.Point"){L=[{x1:N.x,y1:N.y,x2:N.x,y2:N.y}]}else{L=N.getSortedSegments()}var B,F,I,Q,K,D,J,G;outer:for(var E=0,A=M.length;E<A;++E){B=M[E];F=B.x1;I=B.x2;Q=B.y1;K=B.y2;inner:for(var C=0,O=L.length;C<O;++C){D=L[C];if(D.x1>I){break}if(D.x2<F){continue}J=D.y1;G=D.y2;if(Math.min(J,G)>Math.max(Q,K)){continue}if(Math.max(J,G)<Math.min(Q,K)){continue}if(OpenLayers.Geometry.segmentsIntersect(B,D)){H=true;break outer}}}}else{H=N.intersects(this)}return H},getSortedSegments:function(){var D=this.components.length-1;var B=new Array(D),E,F;for(var A=0;A<D;++A){E=this.components[A];F=this.components[A+1];if(E.x<F.x){B[A]={x1:E.x,y1:E.y,x2:F.x,y2:F.y}}else{B[A]={x1:F.x,y1:F.y,x2:E.x,y2:E.y}}}function C(H,G){return H.x1-G.x1}return B.sort(C)},splitWithSegment:function(T,P){var A=!(P&&P.edge===false);var R=P&&P.tolerance;var J=[];var S=this.getVertices();var K=[];var G=[];var U=false;var F,I,B;var O,H,Q;var N={point:true,tolerance:R};var C=null;for(var D=0,L=S.length-2;D<=L;++D){F=S[D];K.push(F.clone());I=S[D+1];Q={x1:F.x,y1:F.y,x2:I.x,y2:I.y};B=OpenLayers.Geometry.segmentsIntersect(T,Q,N);if(B instanceof OpenLayers.Geometry.Point){if((B.x===T.x1&&B.y===T.y1)||(B.x===T.x2&&B.y===T.y2)||B.equals(F)||B.equals(I)){H=true}else{H=false}if(H||A){if(!B.equals(G[G.length-1])){G.push(B.clone())}if(D===0){if(B.equals(F)){continue}}if(B.equals(I)){continue}U=true;if(!B.equals(F)){K.push(B)}J.push(new OpenLayers.Geometry.LineString(K));K=[B.clone()]}}}if(U){K.push(I.clone());J.push(new OpenLayers.Geometry.LineString(K))}if(G.length>0){var E=T.x1<T.x2?1:-1;var M=T.y1<T.y2?1:-1;C={lines:J,points:G.sort(function(V,W){return(E*V.x-E*W.x)||(M*V.y-M*W.y)})}}return C},split:function(P,N){var T=null;var E=N&&N.mutual;var L,K,M,F;if(P instanceof OpenLayers.Geometry.LineString){var R=this.getVertices();var I,G,S,U,B,C;var J=[];M=[];for(var Q=0,A=R.length-2;Q<=A;++Q){I=R[Q];G=R[Q+1];S={x1:I.x,y1:I.y,x2:G.x,y2:G.y};F=F||[P];if(E){J.push(I.clone())}for(var D=0;D<F.length;++D){U=F[D].splitWithSegment(S,N);if(U){B=U.lines;if(B.length>0){B.unshift(D,1);Array.prototype.splice.apply(F,B);D+=B.length-2}if(E){for(var O=0,H=U.points.length;O<H;++O){C=U.points[O];if(!C.equals(I)){J.push(C);M.push(new OpenLayers.Geometry.LineString(J));if(C.equals(G)){J=[]}else{J=[C.clone()]}}}}}}}if(E&&M.length>0&&J.length>0){J.push(G.clone());M.push(new OpenLayers.Geometry.LineString(J))}}else{T=P.splitWith(this,N)}if(F&&F.length>1){K=true}else{F=[]}if(M&&M.length>1){L=true}else{M=[]}if(K||L){if(E){T=[M,F]}else{T=F}}return T},splitWith:function(B,A){return B.split(this,A)},getVertices:function(B){var A;if(B===true){A=[this.components[0],this.components[this.components.length-1]]}else{if(B===false){A=this.components.slice(1,this.components.length-1)}else{A=this.components.slice()}}return A},distanceTo:function(U,R){var A=!(R&&R.edge===false);var M=A&&R&&R.details;var E,J={};var N=Number.POSITIVE_INFINITY;if(U instanceof OpenLayers.Geometry.Point){var I=this.getSortedSegments();var V=U.x;var W=U.y;var X;for(var G=0,C=I.length;G<C;++G){X=I[G];E=OpenLayers.Geometry.distanceToSegment(U,X);if(E.distance<N){N=E.distance;J=E;if(N===0){break}}else{if(X.x2>V&&((W>X.y1&&W<X.y2)||(W<X.y1&&W>X.y2))){break}}}if(M){J={distance:J.distance,x0:J.x,y0:J.y,x1:V,y1:W}}else{J=J.distance}}else{if(U instanceof OpenLayers.Geometry.LineString){var S=this.getSortedSegments();var T=U.getSortedSegments();var O,D,K,H,F;var Q=T.length;var B={point:true};outer:for(var G=0,C=S.length;G<C;++G){O=S[G];H=O.x1;F=O.y1;for(var L=0;L<Q;++L){D=T[L];K=OpenLayers.Geometry.segmentsIntersect(O,D,B);if(K){N=0;J={distance:0,x0:K.x,y0:K.y,x1:K.x,y1:K.y};break outer}else{E=OpenLayers.Geometry.distanceToSegment({x:H,y:F},D);if(E.distance<N){N=E.distance;J={distance:N,x0:H,y0:F,x1:E.x,y1:E.y}}}}}if(!M){J=J.distance}if(N!==0){if(O){E=U.distanceTo(new OpenLayers.Geometry.Point(O.x2,O.y2),R);var P=M?E.distance:E;if(P<N){if(M){J={distance:N,x0:E.x1,y0:E.y1,x1:E.x0,y1:E.y0}}else{J=P}}}}}else{J=U.distanceTo(this,R);if(M){J={distance:J.distance,x0:J.x1,y0:J.y1,x1:J.x0,y1:J.y0}}}}return J},simplify:function(C){if(this&&this!==null){var H=this.getVertices();if(H.length<3){return this}var F=function(L,K){return(L-K)};var E=function(M,R,P,L){var Q=0;var K=0;for(var N=R,O;N<P;N++){O=A(M[R],M[P],M[N]);if(O>Q){Q=O;K=N}}if(Q>L&&K!=R){I.push(K);E(M,R,K,L);E(M,K,P,L)}};var A=function(M,P,K){var L=Math.abs(0.5*(M.x*P.y+P.x*K.y+K.x*M.y-P.x*M.y-K.x*P.y-M.x*K.y));var N=Math.sqrt(Math.pow(M.x-P.x,2)+Math.pow(M.y-P.y,2));var O=L/N*2;return O};var J=0;var G=H.length-1;var I=[];I.push(J);I.push(G);while(H[J].equals(H[G])){G--;I.push(G)}E(H,J,G,C);var B=[];I.sort(F);for(var D=0;D<I.length;D++){B.push(H[I[D]])}return new OpenLayers.Geometry.LineString(B)}else{return this}},CLASS_NAME:"OpenLayers.Geometry.LineString"});OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(N,I){var H=null;var B=I&&I.mutual;var F,C,E,M,A;var G=[];var O=[N];for(var J=0,L=this.components.length;J<L;++J){C=this.components[J];M=false;for(var D=0;D<O.length;++D){F=C.split(O[D],I);if(F){if(B){E=F[0];for(var K=0,P=E.length;K<P;++K){if(K===0&&G.length){G[G.length-1].addComponent(E[K])}else{G.push(new OpenLayers.Geometry.MultiLineString([E[K]]))}}M=true;F=F[1]}if(F.length){F.unshift(D,1);Array.prototype.splice.apply(O,F);break}}}if(!M){if(G.length){G[G.length-1].addComponent(C.clone())}else{G=[new OpenLayers.Geometry.MultiLineString(C.clone())]}}}if(G&&G.length>1){M=true}else{G=[]}if(O&&O.length>1){A=true}else{O=[]}if(M||A){if(B){H=[G,O]}else{H=O}}return H},splitWith:function(N,I){var H=null;var B=I&&I.mutual;var F,C,E,M,A,G,O;if(N instanceof OpenLayers.Geometry.LineString){O=[];G=[N];for(var J=0,L=this.components.length;J<L;++J){A=false;C=this.components[J];for(var D=0;D<G.length;++D){F=G[D].split(C,I);if(F){if(B){E=F[0];if(E.length){E.unshift(D,1);Array.prototype.splice.apply(G,E);D+=E.length-2}F=F[1];if(F.length===0){F=[C.clone()]}}for(var K=0,P=F.length;K<P;++K){if(K===0&&O.length){O[O.length-1].addComponent(F[K])}else{O.push(new OpenLayers.Geometry.MultiLineString([F[K]]))}}A=true}}if(!A){if(O.length){O[O.length-1].addComponent(C.clone())}else{O=[new OpenLayers.Geometry.MultiLineString([C.clone()])]}}}}else{H=N.split(this)}if(G&&G.length>1){M=true}else{G=[]}if(O&&O.length>1){A=true}else{O=[]}if(M||A){if(B){H=[G,O]}else{H=O}}return H},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"});OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(B,D){var E=false;var A=this.components.pop();if(D!=null||!B.equals(A)){E=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments)}var C=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[C]);return E},removeComponent:function(B){var A=this.components&&(this.components.length>3);if(A){this.components.pop();OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);var C=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[C])}return A},move:function(B,C){for(var A=0,D=this.components.length;A<D-1;A++){this.components[A].move(B,C)}},rotate:function(D,C){for(var A=0,B=this.components.length;A<B-1;++A){this.components[A].rotate(D,C)}},resize:function(E,A,C){for(var B=0,D=this.components.length;B<D-1;++B){this.components[B].resize(E,A,C)}return this},transform:function(C,B){if(C&&B){for(var A=0,E=this.components.length;A<E-1;A++){var D=this.components[A];D.transform(C,B)}this.bounds=null}return this},getCentroid:function(){if(this.components){var H=this.components.length;if(H>0&&H<=2){return this.components[0].clone()}else{if(H>2){var D=0;var F=0;var B=this.components[0].x;var C=this.components[0].y;var A=-1*this.getArea();if(A!=0){for(var E=0;E<H-1;E++){var G=this.components[E];var K=this.components[E+1];D+=(G.x+K.x-2*B)*((G.x-B)*(K.y-C)-(K.x-B)*(G.y-C));F+=(G.y+K.y-2*C)*((G.x-B)*(K.y-C)-(K.x-B)*(G.y-C))}var J=B+D/(6*A);var I=C+F/(6*A)}else{for(var E=0;E<H-1;E++){D+=this.components[E].x;F+=this.components[E].y}var J=D/(H-1);var I=F/(H-1)}return new OpenLayers.Geometry.Point(J,I)}else{return null}}}},getArea:function(){var F=0;if(this.components&&(this.components.length>2)){var E=0;for(var B=0,C=this.components.length;B<C-1;B++){var D=this.components[B];var A=this.components[B+1];E+=(D.x+A.x)*(A.y-D.y)}F=-E/2}return F},getGeodesicArea:function(C){var E=this;if(C){var H=new OpenLayers.Projection("EPSG:4326");if(!H.equals(C)){E=this.clone().transform(C,H)}}var B=0;var G=E.components&&E.components.length;if(G>2){var A,F;for(var D=0;D<G-1;D++){A=E.components[D];F=E.components[D+1];B+=OpenLayers.Util.rad(F.x-A.x)*(2+Math.sin(OpenLayers.Util.rad(A.y))+Math.sin(OpenLayers.Util.rad(F.y)))}B=B*6378137*6378137/2}return B},containsPoint:function(O){var L=OpenLayers.Number.limitSigDigs;var K=14;var P=L(O.x,K);var E=L(O.y,K);function A(U,V,W,S,T){return(U-T)*((S-V)/(T-W))+S}var G=this.components.length-1;var I,F,M,N,Q,R,C,J;var B=0;for(var D=0;D<G;++D){I=this.components[D];M=L(I.x,K);N=L(I.y,K);F=this.components[D+1];Q=L(F.x,K);R=L(F.y,K);if(N==R){if(E==N){if(M<=Q&&(P>=M&&P<=Q)||M>=Q&&(P<=M&&P>=Q)){B=-1;break}}continue}C=L(A(E,M,N,Q,R),K);if(C==P){if(N<R&&(E>=N&&E<=R)||N>R&&(E<=N&&E>=R)){B=-1;break}}if(C<=P){continue}if(M!=Q&&(C<Math.min(M,Q)||C>Math.max(M,Q))){continue}if(N<R&&(E>=N&&E<R)||N>R&&(E<N&&E>=R)){++B}}var H=(B==-1)?1:!!(B&1);return H},intersects:function(C){var B=false;if(C.CLASS_NAME=="OpenLayers.Geometry.Point"){B=this.containsPoint(C)}else{if(C.CLASS_NAME=="OpenLayers.Geometry.LineString"){B=C.intersects(this)}else{if(C.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){B=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[C])}else{for(var A=0,D=C.components.length;A<D;++A){B=C.components[A].intersects(this);if(B){break}}}}}return B},getVertices:function(A){return(A===true)?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"});OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var C=0;if(this.components&&(this.components.length>0)){C+=Math.abs(this.components[0].getArea());for(var A=1,B=this.components.length;A<B;A++){C-=Math.abs(this.components[A].getArea())}}return C},getGeodesicArea:function(B){var D=0;if(this.components&&(this.components.length>0)){D+=Math.abs(this.components[0].getGeodesicArea(B));for(var A=1,C=this.components.length;A<C;A++){D-=Math.abs(this.components[A].getGeodesicArea(B))}}return D},containsPoint:function(C){var E=this.components.length;var A=false;if(E>0){A=this.components[0].containsPoint(C);if(A!==1){if(A&&E>1){var D;for(var B=1;B<E;++B){D=this.components[B].containsPoint(C);if(D){if(D===1){A=1}else{A=false}break}}}}}return A},intersects:function(D){var C=false;var A,E;if(D.CLASS_NAME=="OpenLayers.Geometry.Point"){C=this.containsPoint(D)}else{if(D.CLASS_NAME=="OpenLayers.Geometry.LineString"||D.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){for(A=0,E=this.components.length;A<E;++A){C=D.intersects(this.components[A]);if(C){break}}if(!C){for(A=0,E=D.components.length;A<E;++A){C=this.containsPoint(D.components[A]);if(C){break}}}}else{for(A=0,E=D.components.length;A<E;++A){C=this.intersects(D.components[A]);if(C){break}}}}if(!C&&D.CLASS_NAME=="OpenLayers.Geometry.Polygon"){var B=this.components[0];for(A=0,E=B.components.length;A<E;++A){C=D.containsPoint(B.components[A]);if(C){break}}}return C},distanceTo:function(D,C){var B=!(C&&C.edge===false);var A;if(!B&&this.intersects(D)){A=0}else{A=OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[D,C])}return A},CLASS_NAME:"OpenLayers.Geometry.Polygon"});OpenLayers.Geometry.Polygon.createRegularPolygon=function(D,E,J,I){var F=Math.PI*((1/J)-(1/2));if(I){F+=(I/180)*Math.PI}var K,G,H;var B=[];for(var C=0;C<J;++C){K=F+(C*2*Math.PI/J);G=D.x+(E*Math.cos(K));H=D.y+(E*Math.sin(K));B.push(new OpenLayers.Geometry.Point(G,H))}var A=new OpenLayers.Geometry.LinearRing(B);return new OpenLayers.Geometry.Polygon([A])};OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"});OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:true,xy:true,initialize:function(A){this.regExes={trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)};OpenLayers.Format.XML.prototype.initialize.apply(this,[A])},read:function(E){if(typeof E=="string"){E=OpenLayers.Format.XML.prototype.read.apply(this,[E])}var C=this.getElementsByTagNameNS(E.documentElement,this.gmlns,this.featureName);var A=[];for(var B=0;B<C.length;B++){var D=this.parseFeature(C[B]);if(D){A.push(D)}}return A},parseFeature:function(N){var F=["MultiPolygon","Polygon","MultiLineString","LineString","MultiPoint","Point","Envelope"];var Q,K,P,B;for(var E=0;E<F.length;++E){Q=F[E];K=this.getElementsByTagNameNS(N,this.gmlns,Q);if(K.length>0){B=this.parseGeometry[Q.toLowerCase()];if(B){P=B.apply(this,[K[0]]);if(this.internalProjection&&this.externalProjection){P.transform(this.externalProjection,this.internalProjection)}}else{throw new TypeError("Unsupported geometry type: "+Q)}break}}var M;var A=this.getElementsByTagNameNS(N,this.gmlns,"Box");for(E=0;E<A.length;++E){var C=A[E];var D=this.parseGeometry["box"].apply(this,[C]);var L=C.parentNode;var G=L.localName||L.nodeName.split(":").pop();if(G==="boundedBy"){M=D}else{P=D.toGeometry()}}var O;if(this.extractAttributes){O=this.parseAttributes(N)}var I=new OpenLayers.Feature.Vector(P,O);I.bounds=M;I.gml={featureType:N.firstChild.nodeName.split(":")[1],featureNS:N.firstChild.namespaceURI,featureNSPrefix:N.firstChild.prefix};var J=N.firstChild;var H;while(J){if(J.nodeType==1){H=J.getAttribute("fid")||J.getAttribute("id");if(H){break}}J=J.nextSibling}I.fid=H;return I},parseGeometry:{point:function(D){var A,F;var B=[];var A=this.getElementsByTagNameNS(D,this.gmlns,"pos");if(A.length>0){F=A[0].firstChild.nodeValue;F=F.replace(this.regExes.trimSpace,"");B=F.split(this.regExes.splitSpace)}if(B.length==0){A=this.getElementsByTagNameNS(D,this.gmlns,"coordinates");if(A.length>0){F=A[0].firstChild.nodeValue;F=F.replace(this.regExes.removeSpace,"");B=F.split(",")}}if(B.length==0){A=this.getElementsByTagNameNS(D,this.gmlns,"coord");if(A.length>0){var E=this.getElementsByTagNameNS(A[0],this.gmlns,"X");var C=this.getElementsByTagNameNS(A[0],this.gmlns,"Y");if(E.length>0&&C.length>0){B=[E[0].firstChild.nodeValue,C[0].firstChild.nodeValue]}}}if(B.length==2){B[2]=null}if(this.xy){return new OpenLayers.Geometry.Point(B[0],B[1],B[2])}else{return new OpenLayers.Geometry.Point(B[1],B[0],B[2])}},multipoint:function(D){var A=this.getElementsByTagNameNS(D,this.gmlns,"Point");var E=[];if(A.length>0){var C;for(var B=0;B<A.length;++B){C=this.parseGeometry.point.apply(this,[A[B]]);if(C){E.push(C)}}}return new OpenLayers.Geometry.MultiPoint(E)},linestring:function(I,H){var B,D;var N=[];var K=[];B=this.getElementsByTagNameNS(I,this.gmlns,"posList");if(B.length>0){D=this.getChildValue(B[0]);D=D.replace(this.regExes.trimSpace,"");N=D.split(this.regExes.splitSpace);var F=parseInt(B[0].getAttribute("dimension"));var E,A,L,J;for(var G=0;G<N.length/F;++G){E=G*F;A=N[E];L=N[E+1];J=(F==2)?null:N[E+2];if(this.xy){K.push(new OpenLayers.Geometry.Point(A,L,J))}else{K.push(new OpenLayers.Geometry.Point(L,A,J))}}}if(N.length==0){B=this.getElementsByTagNameNS(I,this.gmlns,"coordinates");if(B.length>0){D=this.getChildValue(B[0]);D=D.replace(this.regExes.trimSpace,"");D=D.replace(this.regExes.trimComma,",");var M=D.split(this.regExes.splitSpace);for(var G=0;G<M.length;++G){N=M[G].split(",");if(N.length==2){N[2]=null}if(this.xy){K.push(new OpenLayers.Geometry.Point(N[0],N[1],N[2]))}else{K.push(new OpenLayers.Geometry.Point(N[1],N[0],N[2]))}}}}var C=null;if(K.length!=0){if(H){C=new OpenLayers.Geometry.LinearRing(K)}else{C=new OpenLayers.Geometry.LineString(K)}}return C},multilinestring:function(C){var A=this.getElementsByTagNameNS(C,this.gmlns,"LineString");var D=[];if(A.length>0){var E;for(var B=0;B<A.length;++B){E=this.parseGeometry.linestring.apply(this,[A[B]]);if(E){D.push(E)}}}return new OpenLayers.Geometry.MultiLineString(D)},polygon:function(C){var A=this.getElementsByTagNameNS(C,this.gmlns,"LinearRing");var D=[];if(A.length>0){var E;for(var B=0;B<A.length;++B){E=this.parseGeometry.linestring.apply(this,[A[B],true]);if(E){D.push(E)}}}return new OpenLayers.Geometry.Polygon(D)},multipolygon:function(C){var A=this.getElementsByTagNameNS(C,this.gmlns,"Polygon");var D=[];if(A.length>0){var E;for(var B=0;B<A.length;++B){E=this.parseGeometry.polygon.apply(this,[A[B]]);if(E){D.push(E)}}}return new OpenLayers.Geometry.MultiPolygon(D)},envelope:function(F){var D=[];var A;var G;var B=this.getElementsByTagNameNS(F,this.gmlns,"lowerCorner");if(B.length>0){var I=[];if(B.length>0){A=B[0].firstChild.nodeValue;A=A.replace(this.regExes.trimSpace,"");I=A.split(this.regExes.splitSpace)}if(I.length==2){I[2]=null}if(this.xy){var J=new OpenLayers.Geometry.Point(I[0],I[1],I[2])}else{var J=new OpenLayers.Geometry.Point(I[1],I[0],I[2])}}var C=this.getElementsByTagNameNS(F,this.gmlns,"upperCorner");if(C.length>0){var I=[];if(C.length>0){A=C[0].firstChild.nodeValue;A=A.replace(this.regExes.trimSpace,"");I=A.split(this.regExes.splitSpace)}if(I.length==2){I[2]=null}if(this.xy){var H=new OpenLayers.Geometry.Point(I[0],I[1],I[2])}else{var H=new OpenLayers.Geometry.Point(I[1],I[0],I[2])}}if(J&&H){D.push(new OpenLayers.Geometry.Point(J.x,J.y));D.push(new OpenLayers.Geometry.Point(H.x,J.y));D.push(new OpenLayers.Geometry.Point(H.x,H.y));D.push(new OpenLayers.Geometry.Point(J.x,H.y));D.push(new OpenLayers.Geometry.Point(J.x,J.y));var E=new OpenLayers.Geometry.LinearRing(D);G=new OpenLayers.Geometry.Polygon([E])}return G},box:function(D){var A=this.getElementsByTagNameNS(D,this.gmlns,"coordinates");var F;var C,E=null,B=null;if(A.length>0){F=A[0].firstChild.nodeValue;C=F.split(" ");if(C.length==2){E=C[0].split(",");B=C[1].split(",")}}if(E!==null&&B!==null){return new OpenLayers.Bounds(parseFloat(E[0]),parseFloat(E[1]),parseFloat(B[0]),parseFloat(B[1]))}}},parseAttributes:function(H){var G={};var J=H.firstChild;var D,F,I,A,E,B,C;while(J){if(J.nodeType==1){D=J.childNodes;for(F=0;F<D.length;++F){I=D[F];if(I.nodeType==1){A=I.childNodes;if(A.length==1){E=A[0];if(E.nodeType==3||E.nodeType==4){B=(I.prefix)?I.nodeName.split(":")[1]:I.nodeName;C=E.nodeValue.replace(this.regExes.trimSpace,"");G[B]=C}}else{G[I.nodeName.split(":").pop()]=null}}}break}J=J.nextSibling}return G},write:function(A){if(!(OpenLayers.Util.isArray(A))){A=[A]}var B=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName);for(var C=0;C<A.length;C++){B.appendChild(this.createFeatureXML(A[C]))}return OpenLayers.Format.XML.prototype.write.apply(this,[B])},createFeatureXML:function(K){var F=K.geometry;var A=this.buildGeometryNode(F);var H=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);H.appendChild(A);var I=this.createElementNS(this.gmlns,"gml:"+this.featureName);var B=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName);var D=K.fid||K.id;B.setAttribute("fid",D);B.appendChild(H);for(var E in K.attributes){var J=this.createTextNode(K.attributes[E]);var G=E.substring(E.lastIndexOf(":")+1);var C=this.createElementNS(this.featureNS,this.featurePrefix+":"+G);C.appendChild(J);B.appendChild(C)}I.appendChild(B);return I},buildGeometryNode:function(D){if(this.externalProjection&&this.internalProjection){D=D.clone();D.transform(this.internalProjection,this.externalProjection)}var B=D.CLASS_NAME;var A=B.substring(B.lastIndexOf(".")+1);var C=this.buildGeometry[A.toLowerCase()];return C.apply(this,[D])},buildGeometry:{point:function(B){var A=this.createElementNS(this.gmlns,"gml:Point");A.appendChild(this.buildCoordinatesNode(B));return A},multipoint:function(E){var A=this.createElementNS(this.gmlns,"gml:MultiPoint");var D=E.components;var C,F;for(var B=0;B<D.length;B++){C=this.createElementNS(this.gmlns,"gml:pointMember");F=this.buildGeometry.point.apply(this,[D[B]]);C.appendChild(F);A.appendChild(C)}return A},linestring:function(B){var A=this.createElementNS(this.gmlns,"gml:LineString");A.appendChild(this.buildCoordinatesNode(B));return A},multilinestring:function(E){var A=this.createElementNS(this.gmlns,"gml:MultiLineString");var D=E.components;var F,B;for(var C=0;C<D.length;++C){F=this.createElementNS(this.gmlns,"gml:lineStringMember");B=this.buildGeometry.linestring.apply(this,[D[C]]);F.appendChild(B);A.appendChild(F)}return A},linearring:function(B){var A=this.createElementNS(this.gmlns,"gml:LinearRing");A.appendChild(this.buildCoordinatesNode(B));return A},polygon:function(D){var A=this.createElementNS(this.gmlns,"gml:Polygon");var C=D.components;var G,E,F;for(var B=0;B<C.length;++B){F=(B==0)?"outerBoundaryIs":"innerBoundaryIs";G=this.createElementNS(this.gmlns,"gml:"+F);E=this.buildGeometry.linearring.apply(this,[C[B]]);G.appendChild(E);A.appendChild(G)}return A},multipolygon:function(D){var A=this.createElementNS(this.gmlns,"gml:MultiPolygon");var C=D.components;var E,F;for(var B=0;B<C.length;++B){E=this.createElementNS(this.gmlns,"gml:polygonMember");F=this.buildGeometry.polygon.apply(this,[C[B]]);E.appendChild(F);A.appendChild(E)}return A},bounds:function(B){var A=this.createElementNS(this.gmlns,"gml:Box");A.appendChild(this.buildCoordinatesNode(B));return A}},buildCoordinatesNode:function(D){var E=this.createElementNS(this.gmlns,"gml:coordinates");E.setAttribute("decimal",".");E.setAttribute("cs",",");E.setAttribute("ts"," ");var A=[];if(D instanceof OpenLayers.Bounds){A.push(D.left+","+D.bottom);A.push(D.right+","+D.top)}else{var C=(D.components)?D.components:[D];for(var B=0;B<C.length;B++){A.push(C[B].x+","+C[B].y)}}var F=this.createTextNode(A.join(" "));E.appendChild(F);return E},CLASS_NAME:"OpenLayers.Format.GML"});if(!OpenLayers.Format.GML){OpenLayers.Format.GML={}}OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:true,srsName:null,xy:true,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g),featureMember:(/^(.*:)?featureMembers?$/)},initialize:function(A){OpenLayers.Format.XML.prototype.initialize.apply(this,[A]);this.setGeometryTypes();if(A&&A.featureNS){this.setNamespace("feature",A.featureNS)}this.singleFeatureType=!A||(typeof A.featureType==="string")},read:function(E){if(typeof E=="string"){E=OpenLayers.Format.XML.prototype.read.apply(this,[E])}if(E&&E.nodeType==9){E=E.documentElement}var A=[];this.readNode(E,{features:A},true);if(A.length==0){var C=this.getElementsByTagNameNS(E,this.namespaces.gml,"featureMember");if(C.length){for(var B=0,D=C.length;B<D;++B){this.readNode(C[B],{features:A},true)}}else{var C=this.getElementsByTagNameNS(E,this.namespaces.gml,"featureMembers");if(C.length){this.readNode(C[0],{features:A},true)}}}return A},readNode:function(B,A,C){if(C===true&&this.autoConfig===true){this.featureType=null;delete this.namespaceAlias[this.featureNS];delete this.namespaces["feature"];this.featureNS=null}if(!this.featureNS&&(!(B.prefix in this.namespaces)&&B.parentNode.namespaceURI==this.namespaces["gml"]&&this.regExes.featureMember.test(B.parentNode.nodeName))){this.featureType=B.nodeName.split(":").pop();this.setNamespace("feature",B.namespaceURI);this.featureNS=B.namespaceURI;this.autoConfig=true}return OpenLayers.Format.XML.prototype.readNode.apply(this,[B,A])},readers:{"gml":{"_inherit":function(B,A,C){},"featureMember":function(B,A){this.readChildNodes(B,A)},"featureMembers":function(B,A){this.readChildNodes(B,A)},"name":function(B,A){A.name=this.getChildValue(B)},"boundedBy":function(B,A){var C={};this.readChildNodes(B,C);if(C.components&&C.components.length>0){A.bounds=C.components[0]}},"Point":function(B,C){var A={points:[]};this.readChildNodes(B,A);if(!C.components){C.components=[]}C.components.push(A.points[0])},"coordinates":function(D,F){var A=this.getChildValue(D).replace(this.regExes.trimSpace,"");A=A.replace(this.regExes.trimComma,",");var E=A.split(this.regExes.splitSpace);var H;var C=E.length;var G=new Array(C);for(var B=0;B<C;++B){H=E[B].split(",");if(this.xy){G[B]=new OpenLayers.Geometry.Point(H[0],H[1],H[2])}else{G[B]=new OpenLayers.Geometry.Point(H[1],H[0],H[2])}}F.points=G},"coord":function(B,A){var C={};this.readChildNodes(B,C);if(!A.points){A.points=[]}A.points.push(new OpenLayers.Geometry.Point(C.x,C.y,C.z))},"X":function(A,B){B.x=this.getChildValue(A)},"Y":function(A,B){B.y=this.getChildValue(A)},"Z":function(A,B){B.z=this.getChildValue(A)},"MultiPoint":function(B,C){var A={components:[]};this.readers.gml._inherit.apply(this,[B,A,C]);this.readChildNodes(B,A);C.components=[new OpenLayers.Geometry.MultiPoint(A.components)]},"pointMember":function(B,A){this.readChildNodes(B,A)},"LineString":function(B,C){var A={};this.readers.gml._inherit.apply(this,[B,A,C]);this.readChildNodes(B,A);if(!C.components){C.components=[]}C.components.push(new OpenLayers.Geometry.LineString(A.points))},"MultiLineString":function(B,C){var A={components:[]};this.readers.gml._inherit.apply(this,[B,A,C]);this.readChildNodes(B,A);C.components=[new OpenLayers.Geometry.MultiLineString(A.components)]},"lineStringMember":function(B,A){this.readChildNodes(B,A)},"Polygon":function(B,C){var A={outer:null,inner:[]};this.readers.gml._inherit.apply(this,[B,A,C]);this.readChildNodes(B,A);A.inner.unshift(A.outer);if(!C.components){C.components=[]}C.components.push(new OpenLayers.Geometry.Polygon(A.inner))},"LinearRing":function(B,A){var C={};this.readers.gml._inherit.apply(this,[B,C]);this.readChildNodes(B,C);A.components=[new OpenLayers.Geometry.LinearRing(C.points)]},"MultiPolygon":function(B,C){var A={components:[]};this.readers.gml._inherit.apply(this,[B,A,C]);this.readChildNodes(B,A);C.components=[new OpenLayers.Geometry.MultiPolygon(A.components)]},"polygonMember":function(B,A){this.readChildNodes(B,A)},"GeometryCollection":function(B,C){var A={components:[]};this.readers.gml._inherit.apply(this,[B,A,C]);this.readChildNodes(B,A);C.components=[new OpenLayers.Geometry.Collection(A.components)]},"geometryMember":function(B,A){this.readChildNodes(B,A)}},"feature":{"*":function(B,A){var C;var D=B.localName||B.nodeName.split(":").pop();if(A.features){if(!this.singleFeatureType&&(OpenLayers.Util.indexOf(this.featureType,D)!==-1)){C="_typeName"}else{if(D===this.featureType){C="_typeName"}}}else{if(B.childNodes.length==0||(B.childNodes.length==1&&B.firstChild.nodeType==3)){if(this.extractAttributes){C="_attribute"}}else{C="_geometry"}}if(C){this.readers.feature[C].apply(this,[B,A])}},"_typeName":function(C,B){var D={components:[],attributes:{}};this.readChildNodes(C,D);if(D.name){D.attributes.name=D.name}var A=new OpenLayers.Feature.Vector(D.components[0],D.attributes);if(!this.singleFeatureType){A.type=C.nodeName.split(":").pop();A.namespace=C.namespaceURI}var E=C.getAttribute("fid")||this.getAttributeNS(C,this.namespaces["gml"],"id");if(E){A.fid=E}if(this.internalProjection&&this.externalProjection&&A.geometry){A.geometry.transform(this.externalProjection,this.internalProjection)}if(D.bounds){A.bounds=D.bounds}B.features.push(A)},"_geometry":function(B,A){if(!this.geometryName){this.geometryName=B.nodeName.split(":").pop()}this.readChildNodes(B,A)},"_attribute":function(B,A){var D=B.localName||B.nodeName.split(":").pop();var C=this.getChildValue(B);A.attributes[D]=C}},"wfs":{"FeatureCollection":function(B,A){this.readChildNodes(B,A)}}},write:function(A){var C;if(OpenLayers.Util.isArray(A)){C="featureMembers"}else{C="featureMember"}var B=this.writeNode("gml:"+C,A);this.setAttributeNS(B,this.namespaces["xsi"],"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[B])},writers:{"gml":{"featureMember":function(A){var B=this.createElementNSPlus("gml:featureMember");this.writeNode("feature:_typeName",A,B);return B},"MultiPoint":function(C){var B=this.createElementNSPlus("gml:MultiPoint");var E=C.components||[C];for(var A=0,D=E.length;A<D;++A){this.writeNode("pointMember",E[A],B)}return B},"pointMember":function(B){var A=this.createElementNSPlus("gml:pointMember");this.writeNode("Point",B,A);return A},"MultiLineString":function(C){var B=this.createElementNSPlus("gml:MultiLineString");var E=C.components||[C];for(var A=0,D=E.length;A<D;++A){this.writeNode("lineStringMember",E[A],B)}return B},"lineStringMember":function(B){var A=this.createElementNSPlus("gml:lineStringMember");this.writeNode("LineString",B,A);return A},"MultiPolygon":function(C){var B=this.createElementNSPlus("gml:MultiPolygon");var E=C.components||[C];for(var A=0,D=E.length;A<D;++A){this.writeNode("polygonMember",E[A],B)}return B},"polygonMember":function(B){var A=this.createElementNSPlus("gml:polygonMember");this.writeNode("Polygon",B,A);return A},"GeometryCollection":function(C){var B=this.createElementNSPlus("gml:GeometryCollection");for(var A=0,D=C.components.length;A<D;++A){this.writeNode("geometryMember",C.components[A],B)}return B},"geometryMember":function(C){var B=this.createElementNSPlus("gml:geometryMember");var A=this.writeNode("feature:_geometry",C);B.appendChild(A.firstChild);return B}},"feature":{"_typeName":function(A){var B=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:A.fid}});if(A.geometry){this.writeNode("feature:_geometry",A.geometry,B)}for(var C in A.attributes){var D=A.attributes[C];if(D!=null){this.writeNode("feature:_attribute",{name:C,value:D},B)}}return B},"_geometry":function(C){if(this.externalProjection&&this.internalProjection){C=C.clone().transform(this.internalProjection,this.externalProjection)}var B=this.createElementNSPlus("feature:"+this.geometryName);var A=this.geometryTypes[C.CLASS_NAME];var D=this.writeNode("gml:"+A,C,B);if(this.srsName){D.setAttribute("srsName",this.srsName)}return B},"_attribute":function(A){return this.createElementNSPlus("feature:"+A.name,{value:A.value})}},"wfs":{"FeatureCollection":function(A){var C=this.createElementNSPlus("wfs:FeatureCollection");for(var B=0,D=A.length;B<D;++B){this.writeNode("gml:featureMember",A[B],C)}return C}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"});OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:false,multiCurve:true,surface:false,multiSurface:true,initialize:function(A){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[A])},readers:{"gml":OpenLayers.Util.applyDefaults({"_inherit":function(B,A,C){var D=parseInt(B.getAttribute("srsDimension"),10)||(C&&C.srsDimension);if(D){A.srsDimension=D}},"featureMembers":function(B,A){this.readChildNodes(B,A)},"Curve":function(B,C){var A={points:[]};this.readers.gml._inherit.apply(this,[B,A,C]);this.readChildNodes(B,A);if(!C.components){C.components=[]}C.components.push(new OpenLayers.Geometry.LineString(A.points))},"segments":function(B,A){this.readChildNodes(B,A)},"LineStringSegment":function(B,C){var A={};this.readChildNodes(B,A);if(A.points){Array.prototype.push.apply(C.points,A.points)}},"pos":function(C,A){var E=this.getChildValue(C).replace(this.regExes.trimSpace,"");var D=E.split(this.regExes.splitSpace);var B;if(this.xy){B=new OpenLayers.Geometry.Point(D[0],D[1],D[2])}else{B=new OpenLayers.Geometry.Point(D[1],D[0],D[2])}A.points=[B]},"posList":function(F,H){var K=this.getChildValue(F).replace(this.regExes.trimSpace,"");var L=K.split(this.regExes.splitSpace);var D=H.srsDimension||parseInt(F.getAttribute("srsDimension")||F.getAttribute("dimension"),10)||2;var C,I,J,G;var M=L.length/D;var B=new Array(M);for(var E=0,A=L.length;E<A;E+=D){I=L[E];J=L[E+1];G=(D==2)?undefined:L[E+2];if(this.xy){B[E/D]=new OpenLayers.Geometry.Point(I,J,G)}else{B[E/D]=new OpenLayers.Geometry.Point(J,I,G)}}H.points=B},"Surface":function(B,A){this.readChildNodes(B,A)},"patches":function(B,A){this.readChildNodes(B,A)},"PolygonPatch":function(B,A){this.readers.gml.Polygon.apply(this,[B,A])},"exterior":function(B,C){var A={};this.readChildNodes(B,A);C.outer=A.components[0]},"interior":function(B,C){var A={};this.readChildNodes(B,A);C.inner.push(A.components[0])},"MultiCurve":function(B,C){var A={components:[]};this.readers.gml._inherit.apply(this,[B,A,C]);this.readChildNodes(B,A);if(A.components.length>0){C.components=[new OpenLayers.Geometry.MultiLineString(A.components)]}},"curveMember":function(B,A){this.readChildNodes(B,A)},"MultiSurface":function(B,C){var A={components:[]};this.readers.gml._inherit.apply(this,[B,A,C]);this.readChildNodes(B,A);if(A.components.length>0){C.components=[new OpenLayers.Geometry.MultiPolygon(A.components)]}},"surfaceMember":function(B,A){this.readChildNodes(B,A)},"surfaceMembers":function(B,A){this.readChildNodes(B,A)},"pointMembers":function(B,A){this.readChildNodes(B,A)},"lineStringMembers":function(B,A){this.readChildNodes(B,A)},"polygonMembers":function(B,A){this.readChildNodes(B,A)},"geometryMembers":function(B,A){this.readChildNodes(B,A)},"Envelope":function(C,D){var B={points:new Array(2)};this.readChildNodes(C,B);if(!D.components){D.components=[]}var A=B.points[0];var E=B.points[1];D.components.push(new OpenLayers.Bounds(A.x,A.y,E.x,E.y))},"lowerCorner":function(B,C){var A={};this.readers.gml.pos.apply(this,[B,A]);C.points[0]=A.points[0]},"upperCorner":function(B,C){var A={};this.readers.gml.pos.apply(this,[B,A]);C.points[1]=A.points[0]}},OpenLayers.Format.GML.Base.prototype.readers["gml"]),"feature":OpenLayers.Format.GML.Base.prototype.readers["feature"],"wfs":OpenLayers.Format.GML.Base.prototype.readers["wfs"]},write:function(A){var C;if(OpenLayers.Util.isArray(A)){C="featureMembers"}else{C="featureMember"}var B=this.writeNode("gml:"+C,A);this.setAttributeNS(B,this.namespaces["xsi"],"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[B])},writers:{"gml":OpenLayers.Util.applyDefaults({"featureMembers":function(A){var C=this.createElementNSPlus("gml:featureMembers");for(var B=0,D=A.length;B<D;++B){this.writeNode("feature:_typeName",A[B],C)}return C},"Point":function(B){var A=this.createElementNSPlus("gml:Point");this.writeNode("pos",B,A);return A},"pos":function(A){var B=(this.xy)?(A.x+" "+A.y):(A.y+" "+A.x);return this.createElementNSPlus("gml:pos",{value:B})},"LineString":function(B){var A=this.createElementNSPlus("gml:LineString");this.writeNode("posList",B.components,A);return A},"Curve":function(B){var A=this.createElementNSPlus("gml:Curve");this.writeNode("segments",B,A);return A},"segments":function(B){var A=this.createElementNSPlus("gml:segments");this.writeNode("LineStringSegment",B,A);return A},"LineStringSegment":function(B){var A=this.createElementNSPlus("gml:LineStringSegment");this.writeNode("posList",B.components,A);return A},"posList":function(D){var E=D.length;var A=new Array(E);var C;for(var B=0;B<E;++B){C=D[B];if(this.xy){A[B]=C.x+" "+C.y}else{A[B]=C.y+" "+C.x}}return this.createElementNSPlus("gml:posList",{value:A.join(" ")})},"Surface":function(B){var A=this.createElementNSPlus("gml:Surface");this.writeNode("patches",B,A);return A},"patches":function(B){var A=this.createElementNSPlus("gml:patches");this.writeNode("PolygonPatch",B,A);return A},"PolygonPatch":function(C){var B=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});this.writeNode("exterior",C.components[0],B);for(var A=1,D=C.components.length;A<D;++A){this.writeNode("interior",C.components[A],B)}return B},"Polygon":function(C){var B=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",C.components[0],B);for(var A=1,D=C.components.length;A<D;++A){this.writeNode("interior",C.components[A],B)}return B},"exterior":function(B){var A=this.createElementNSPlus("gml:exterior");this.writeNode("LinearRing",B,A);return A},"interior":function(B){var A=this.createElementNSPlus("gml:interior");this.writeNode("LinearRing",B,A);return A},"LinearRing":function(B){var A=this.createElementNSPlus("gml:LinearRing");this.writeNode("posList",B.components,A);return A},"MultiCurve":function(C){var B=this.createElementNSPlus("gml:MultiCurve");var E=C.components||[C];for(var A=0,D=E.length;A<D;++A){this.writeNode("curveMember",E[A],B)}return B},"curveMember":function(B){var A=this.createElementNSPlus("gml:curveMember");if(this.curve){this.writeNode("Curve",B,A)}else{this.writeNode("LineString",B,A)}return A},"MultiSurface":function(C){var B=this.createElementNSPlus("gml:MultiSurface");var E=C.components||[C];for(var A=0,D=E.length;A<D;++A){this.writeNode("surfaceMember",E[A],B)}return B},"surfaceMember":function(B){var A=this.createElementNSPlus("gml:surfaceMember");if(this.surface){this.writeNode("Surface",B,A)}else{this.writeNode("Polygon",B,A)}return A},"Envelope":function(A){var B=this.createElementNSPlus("gml:Envelope");this.writeNode("lowerCorner",A,B);this.writeNode("upperCorner",A,B);if(this.srsName){B.setAttribute("srsName",this.srsName)}return B},"lowerCorner":function(A){var B=(this.xy)?(A.left+" "+A.bottom):(A.bottom+" "+A.left);return this.createElementNSPlus("gml:lowerCorner",{value:B})},"upperCorner":function(A){var B=(this.xy)?(A.right+" "+A.top):(A.top+" "+A.right);return this.createElementNSPlus("gml:upperCorner",{value:B})}},OpenLayers.Format.GML.Base.prototype.writers["gml"]),"feature":OpenLayers.Format.GML.Base.prototype.writers["feature"],"wfs":OpenLayers.Format.GML.Base.prototype.writers["wfs"]},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":(this.curve===true)?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":(this.multiCurve===false)?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":(this.surface===true)?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":(this.multiSurface===false)?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"});OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",initialize:function(A){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[A])},readers:{"ogc":OpenLayers.Util.applyDefaults({"PropertyIsEqualTo":function(B,A){var C=B.getAttribute("matchCase");var D=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:!(C==="false"||C==="0")});this.readChildNodes(B,D);A.filters.push(D)},"PropertyIsNotEqualTo":function(B,A){var C=B.getAttribute("matchCase");var D=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:!(C==="false"||C==="0")});this.readChildNodes(B,D);A.filters.push(D)},"PropertyIsLike":function(B,A){var D=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(B,D);var C=B.getAttribute("wildCard");var E=B.getAttribute("singleChar");var F=B.getAttribute("escapeChar");D.value2regex(C,E,F);A.filters.push(D)}},OpenLayers.Format.Filter.v1.prototype.readers["ogc"]),"gml":OpenLayers.Format.GML.v3.prototype.readers["gml"],"feature":OpenLayers.Format.GML.v3.prototype.readers["feature"]},writers:{"ogc":OpenLayers.Util.applyDefaults({"PropertyIsEqualTo":function(B){var A=this.createElementNSPlus("ogc:PropertyIsEqualTo",{attributes:{matchCase:B.matchCase}});this.writeNode("PropertyName",B,A);this.writeOgcExpression(B.value,A);return A},"PropertyIsNotEqualTo":function(B){var A=this.createElementNSPlus("ogc:PropertyIsNotEqualTo",{attributes:{matchCase:B.matchCase}});this.writeNode("PropertyName",B,A);this.writeOgcExpression(B.value,A);return A},"PropertyIsLike":function(B){var A=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{matchCase:B.matchCase,wildCard:"*",singleChar:".",escapeChar:"!"}});this.writeNode("PropertyName",B,A);this.writeNode("Literal",B.regex2value(),A);return A},"BBOX":function(C){var B=this.createElementNSPlus("ogc:BBOX");C.property&&this.writeNode("PropertyName",C,B);var A=this.writeNode("gml:Envelope",C.value);if(C.projection){A.setAttribute("srsName",C.projection)}B.appendChild(A);return B},"SortBy":function(A){var C=this.createElementNSPlus("ogc:SortBy");for(var B=0,D=A.length;B<D;B++){this.writeNode("ogc:SortProperty",A[B],C)}return C},"SortProperty":function(B){var A=this.createElementNSPlus("ogc:SortProperty");this.writeNode("ogc:PropertyName",B,A);this.writeNode("ogc:SortOrder",(B.order=="DESC")?"DESC":"ASC",A);return A},"SortOrder":function(B){var A=this.createElementNSPlus("ogc:SortOrder",{value:B});return A}},OpenLayers.Format.Filter.v1.prototype.writers["ogc"]),"gml":OpenLayers.Format.GML.v3.prototype.writers["gml"],"feature":OpenLayers.Format.GML.v3.prototype.writers["feature"]},writeSpatial:function(D,C){var B=this.createElementNSPlus("ogc:"+C);this.writeNode("PropertyName",D,B);if(D.value instanceof OpenLayers.Filter.Function){this.writeNode("Function",D.value,B)}else{var A;if(D.value instanceof OpenLayers.Geometry){A=this.writeNode("feature:_geometry",D.value).firstChild}else{A=this.writeNode("gml:Envelope",D.value)}if(D.projection){A.setAttribute("srsName",D.projection)}B.appendChild(A)}return B},CLASS_NAME:"OpenLayers.Format.Filter.v1_1_0"});OpenLayers.Format.OWSCommon=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",getVersion:function(B,C){var D=this.version;if(!D){var A=B.getAttribute("xmlns:ows");if(A&&A.substring(A.lastIndexOf("/")+1)==="1.1"){D="1.1.0"}if(!D){D=this.defaultVersion}}return D},CLASS_NAME:"OpenLayers.Format.OWSCommon"});OpenLayers.Format.OWSCommon.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},read:function(C,B){B=OpenLayers.Util.applyDefaults(B,this.options);var A={};this.readChildNodes(C,A);return A},readers:{"ows":{"Exception":function(B,C){var A={code:B.getAttribute("exceptionCode"),locator:B.getAttribute("locator"),texts:[]};C.exceptions.push(A);this.readChildNodes(B,A)},"ExceptionText":function(B,A){var C=this.getChildValue(B);A.texts.push(C)},"ServiceIdentification":function(B,A){A.serviceIdentification={};this.readChildNodes(B,A.serviceIdentification)},"Title":function(B,A){A.title=this.getChildValue(B)},"Abstract":function(A,B){B["abstract"]=this.getChildValue(A)},"Keywords":function(A,B){B.keywords={};this.readChildNodes(A,B.keywords)},"Keyword":function(A,B){B[this.getChildValue(A)]=true},"ServiceType":function(A,B){B.serviceType={codeSpace:A.getAttribute("codeSpace"),value:this.getChildValue(A)}},"ServiceTypeVersion":function(A,B){B.serviceTypeVersion=this.getChildValue(A)},"Fees":function(A,B){B.fees=this.getChildValue(A)},"AccessConstraints":function(A,B){B.accessConstraints=this.getChildValue(A)},"ServiceProvider":function(B,A){A.serviceProvider={};this.readChildNodes(B,A.serviceProvider)},"ProviderName":function(A,B){B.providerName=this.getChildValue(A)},"ProviderSite":function(A,B){B.providerSite=this.getAttributeNS(A,this.namespaces.xlink,"href")},"ServiceContact":function(A,B){B.serviceContact={};this.readChildNodes(A,B.serviceContact)},"IndividualName":function(A,B){B.individualName=this.getChildValue(A)},"PositionName":function(A,B){B.positionName=this.getChildValue(A)},"ContactInfo":function(A,B){B.contactInfo={};this.readChildNodes(A,B.contactInfo)},"Phone":function(A,B){B.phone={};this.readChildNodes(A,B.phone)},"Voice":function(B,A){A.voice=this.getChildValue(B)},"Address":function(A,B){B.address={};this.readChildNodes(A,B.address)},"DeliveryPoint":function(B,A){A.deliveryPoint=this.getChildValue(B)},"City":function(B,A){A.city=this.getChildValue(B)},"AdministrativeArea":function(B,A){A.administrativeArea=this.getChildValue(B)},"PostalCode":function(B,A){A.postalCode=this.getChildValue(B)},"Country":function(B,A){A.country=this.getChildValue(B)},"ElectronicMailAddress":function(B,A){A.electronicMailAddress=this.getChildValue(B)},"Role":function(A,B){B.role=this.getChildValue(A)},"OperationsMetadata":function(B,A){A.operationsMetadata={};this.readChildNodes(B,A.operationsMetadata)},"Operation":function(A,C){var B=A.getAttribute("name");C[B]={};this.readChildNodes(A,C[B])},"DCP":function(A,B){B.dcp={};this.readChildNodes(A,B.dcp)},"HTTP":function(A,B){B.http={};this.readChildNodes(A,B.http)},"Get":function(C,A){if(!A.get){A.get=[]}var B={url:this.getAttributeNS(C,this.namespaces.xlink,"href")};this.readChildNodes(C,B);A.get.push(B)},"Post":function(C,A){if(!A.post){A.post=[]}var B={url:this.getAttributeNS(C,this.namespaces.xlink,"href")};this.readChildNodes(C,B);A.post.push(B)},"Parameter":function(A,C){if(!C.parameters){C.parameters={}}var B=A.getAttribute("name");C.parameters[B]={};this.readChildNodes(A,C.parameters[B])},"Constraint":function(B,A){if(!A.constraints){A.constraints={}}var C=B.getAttribute("name");A.constraints[C]={};this.readChildNodes(B,A.constraints[C])},"Value":function(B,A){A[this.getChildValue(B)]=true},"OutputFormat":function(B,A){A.formats.push({value:this.getChildValue(B)});this.readChildNodes(B,A)},"WGS84BoundingBox":function(C,B){var A={};A.crs=C.getAttribute("crs");if(B.BoundingBox){B.BoundingBox.push(A)}else{B.projection=A.crs;A=B}this.readChildNodes(C,A)},"BoundingBox":function(B,A){this.readers["ows"]["WGS84BoundingBox"].apply(this,[B,A])},"LowerCorner":function(C,B){var D=this.getChildValue(C).replace(this.regExes.trimSpace,"");D=D.replace(this.regExes.trimComma,",");var A=D.split(this.regExes.splitSpace);B.left=A[0];B.bottom=A[1]},"UpperCorner":function(C,B){var D=this.getChildValue(C).replace(this.regExes.trimSpace,"");D=D.replace(this.regExes.trimComma,",");var A=D.split(this.regExes.splitSpace);B.right=A[0];B.top=A[1];B.bounds=new OpenLayers.Bounds(B.left,B.bottom,B.right,B.top);delete B.left;delete B.bottom;delete B.right;delete B.top},"Language":function(B,A){A.language=this.getChildValue(B)}}},writers:{"ows":{"BoundingBox":function(B,C){var A=this.createElementNSPlus(C||"ows:BoundingBox",{attributes:{crs:B.projection}});this.writeNode("ows:LowerCorner",B,A);this.writeNode("ows:UpperCorner",B,A);return A},"LowerCorner":function(B){var A=this.createElementNSPlus("ows:LowerCorner",{value:B.bounds.left+" "+B.bounds.bottom});return A},"UpperCorner":function(B){var A=this.createElementNSPlus("ows:UpperCorner",{value:B.bounds.right+" "+B.bounds.top});return A},"Identifier":function(A){var B=this.createElementNSPlus("ows:Identifier",{value:A});return B},"Title":function(B){var A=this.createElementNSPlus("ows:Title",{value:B});return A},"Abstract":function(B){var A=this.createElementNSPlus("ows:Abstract",{value:B});return A},"OutputFormat":function(A){var B=this.createElementNSPlus("ows:OutputFormat",{value:A});return B}}},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1"});OpenLayers.Format.OWSCommon.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink"},readers:{"ows":OpenLayers.Util.applyDefaults({"ExceptionReport":function(B,A){A.success=false;A.exceptionReport={version:B.getAttribute("version"),language:B.getAttribute("language"),exceptions:[]};this.readChildNodes(B,A.exceptionReport)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{"ows":OpenLayers.Format.OWSCommon.v1.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_0_0"});OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:"1.1.0",schemaLocations:{"wfs":"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},initialize:function(A){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[A]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[A])},readNode:function(B,A,C){return OpenLayers.Format.GML.v3.prototype.readNode.apply(this,arguments)},readers:{"wfs":OpenLayers.Util.applyDefaults({"FeatureCollection":function(B,A){A.numberOfFeatures=parseInt(B.getAttribute("numberOfFeatures"));OpenLayers.Format.WFST.v1.prototype.readers["wfs"]["FeatureCollection"].apply(this,arguments)},"TransactionResponse":function(B,A){A.insertIds=[];A.success=false;this.readChildNodes(B,A)},"TransactionSummary":function(B,A){A.success=true},"InsertResults":function(B,A){this.readChildNodes(B,A)},"Feature":function(B,C){var A={fids:[]};this.readChildNodes(B,A);C.insertIds.push(A.fids[0])}},OpenLayers.Format.WFST.v1.prototype.readers["wfs"]),"gml":OpenLayers.Format.GML.v3.prototype.readers["gml"],"feature":OpenLayers.Format.GML.v3.prototype.readers["feature"],"ogc":OpenLayers.Format.Filter.v1_1_0.prototype.readers["ogc"],"ows":OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers["ows"]},writers:{"wfs":OpenLayers.Util.applyDefaults({"GetFeature":function(B){var A=OpenLayers.Format.WFST.v1.prototype.writers["wfs"]["GetFeature"].apply(this,arguments);B&&this.setAttributes(A,{resultType:B.resultType,startIndex:B.startIndex,count:B.count});return A},"Query":function(D){D=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},D);var B=D.featurePrefix;var C=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(B?B+":":"")+D.featureType,srsName:D.srsName}});if(D.featureNS){C.setAttribute("xmlns:"+B,D.featureNS)}if(D.propertyNames){for(var A=0,E=D.propertyNames.length;A<E;A++){this.writeNode("wfs:PropertyName",{property:D.propertyNames[A]},C)}}if(D.filter){OpenLayers.Format.WFST.v1_1_0.prototype.setFilterProperty.call(this,D.filter);this.writeNode("ogc:Filter",D.filter,C)}return C},"PropertyName":function(A){return this.createElementNSPlus("wfs:PropertyName",{value:A.property})}},OpenLayers.Format.WFST.v1.prototype.writers["wfs"]),"gml":OpenLayers.Format.GML.v3.prototype.writers["gml"],"feature":OpenLayers.Format.GML.v3.prototype.writers["feature"],"ogc":OpenLayers.Format.Filter.v1_1_0.prototype.writers["ogc"]},CLASS_NAME:"OpenLayers.Format.WFST.v1_1_0"});OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:true,defaultFilter:null,initialize:function(A){A=A||{};OpenLayers.Util.extend(this,A);this.options=A},mergeWithDefaultFilter:function(B){var A;if(B&&this.defaultFilter){A=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,B]})}else{A=B||this.defaultFilter||undefined}return A},destroy:function(){this.options=null;this.format=null},read:function(A){A=A||{};A.filter=this.mergeWithDefaultFilter(A.filter)},create:function(){},update:function(){},"delete":function(){},commit:function(){},abort:function(A){},createCallback:function(B,C,A){return OpenLayers.Function.bind(function(){B.apply(this,[C,A])},this)},CLASS_NAME:"OpenLayers.Protocol"});OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:true,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(A){OpenLayers.Util.extend(this,A)},success:function(){return this.code>0},CLASS_NAME:"OpenLayers.Protocol.Response"});OpenLayers.Protocol.Response.SUCCESS=1;OpenLayers.Protocol.Response.FAILURE=0;OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:false,nativeJSON:(function(){return !!(window.JSON&&typeof JSON.parse=="function"&&typeof JSON.stringify=="function")})(),read:function(json,filter){var object;if(this.nativeJSON){object=JSON.parse(json,filter)}else{try{if(/^[\],:{}\s]*$/.test(json.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){object=eval("("+json+")");if(typeof filter==="function"){function walk(k,v){if(v&&typeof v==="object"){for(var i in v){if(v.hasOwnProperty(i)){v[i]=walk(i,v[i])}}}return filter(k,v)}object=walk("",object)}}}catch(e){}}if(this.keepData){this.data=object}return object},write:function(D,B){this.pretty=!!B;var C=null;var A=typeof D;if(this.serialize[A]){try{C=(!this.pretty&&this.nativeJSON)?JSON.stringify(D):this.serialize[A].apply(this,[D])}catch(E){OpenLayers.Console.error("Trouble serializing: "+E)}}return C},writeIndent:function(){var B=[];if(this.pretty){for(var A=0;A<this.level;++A){B.push(this.indent)}}return B.join("")},writeNewline:function(){return(this.pretty)?this.newline:""},writeSpace:function(){return(this.pretty)?this.space:""},serialize:{"object":function(C){if(C==null){return"null"}if(C.constructor==Date){return this.serialize.date.apply(this,[C])}if(C.constructor==Array){return this.serialize.array.apply(this,[C])}var D=["{"];this.level+=1;var A,E,B;var F=false;for(A in C){if(C.hasOwnProperty(A)){E=OpenLayers.Format.JSON.prototype.write.apply(this,[A,this.pretty]);B=OpenLayers.Format.JSON.prototype.write.apply(this,[C[A],this.pretty]);if(E!=null&&B!=null){if(F){D.push(",")}D.push(this.writeNewline(),this.writeIndent(),E,":",this.writeSpace(),B);F=true}}}this.level-=1;D.push(this.writeNewline(),this.writeIndent(),"}");return D.join("")},"array":function(A){var C;var D=["["];this.level+=1;for(var B=0,E=A.length;B<E;++B){C=OpenLayers.Format.JSON.prototype.write.apply(this,[A[B],this.pretty]);if(C!=null){if(B>0){D.push(",")}D.push(this.writeNewline(),this.writeIndent(),C)}}this.level-=1;D.push(this.writeNewline(),this.writeIndent(),"]");return D.join("")},"string":function(B){var A={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(/["\\\x00-\x1f]/.test(B)){return'"'+B.replace(/([\x00-\x1f\\"])/g,function(E,C){var D=A[C];if(D){return D}D=C.charCodeAt();return"\\u00"+Math.floor(D/16).toString(16)+(D%16).toString(16)})+'"'}return'"'+B+'"'},"number":function(A){return isFinite(A)?String(A):"null"},"boolean":function(A){return String(A)},"date":function(B){function A(C){return(C<10)?"0"+C:C}return'"'+B.getFullYear()+"-"+A(B.getMonth()+1)+"-"+A(B.getDate())+"T"+A(B.getHours())+":"+A(B.getMinutes())+":"+A(B.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"});OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:false,read:function(B,I,C){I=(I)?I:"FeatureCollection";var F=null;var G=null;if(typeof B=="string"){G=OpenLayers.Format.JSON.prototype.read.apply(this,[B,C])}else{G=B}if(!G){OpenLayers.Console.error("Bad JSON: "+B)}else{if(typeof(G.type)!="string"){OpenLayers.Console.error("Bad GeoJSON - no type: "+B)}else{if(this.isValidType(G,I)){switch(I){case"Geometry":try{F=this.parseGeometry(G)}catch(D){OpenLayers.Console.error(D)}break;case"Feature":try{F=this.parseFeature(G);F.type="Feature"}catch(D){OpenLayers.Console.error(D)}break;case"FeatureCollection":F=[];switch(G.type){case"Feature":try{F.push(this.parseFeature(G))}catch(D){F=null;OpenLayers.Console.error(D)}break;case"FeatureCollection":for(var E=0,H=G.features.length;E<H;++E){try{F.push(this.parseFeature(G.features[E]))}catch(D){F=null;OpenLayers.Console.error(D)}}break;default:try{var A=this.parseGeometry(G);F.push(new OpenLayers.Feature.Vector(A))}catch(D){F=null;OpenLayers.Console.error(D)}}break}}}}return F},isValidType:function(B,A){var C=false;switch(A){case"Geometry":if(OpenLayers.Util.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],B.type)==-1){OpenLayers.Console.error("Unsupported geometry type: "+B.type)}else{C=true}break;case"FeatureCollection":C=true;break;default:if(B.type==A){C=true}else{OpenLayers.Console.error("Cannot convert types from "+B.type+" to "+A)}}return C},parseFeature:function(B){var A,D,C,F;C=(B.properties)?B.properties:{};F=(B.geometry&&B.geometry.bbox)||B.bbox;try{D=this.parseGeometry(B.geometry)}catch(E){throw E}A=new OpenLayers.Feature.Vector(D,C);if(F){A.bounds=OpenLayers.Bounds.fromArray(F)}if(B.id){A.fid=B.id}return A},parseGeometry:function(B){if(B==null){return null}var E,D=false;if(B.type=="GeometryCollection"){if(!(OpenLayers.Util.isArray(B.geometries))){throw"GeometryCollection must have geometries array: "+B}var A=B.geometries.length;var G=new Array(A);for(var C=0;C<A;++C){G[C]=this.parseGeometry.apply(this,[B.geometries[C]])}E=new OpenLayers.Geometry.Collection(G);D=true}else{if(!(OpenLayers.Util.isArray(B.coordinates))){throw"Geometry must have coordinates array: "+B}if(!this.parseCoords[B.type.toLowerCase()]){throw"Unsupported geometry type: "+B.type}try{E=this.parseCoords[B.type.toLowerCase()].apply(this,[B.coordinates])}catch(F){throw F}}if(this.internalProjection&&this.externalProjection&&!D){E.transform(this.externalProjection,this.internalProjection)}return E},parseCoords:{"point":function(A){if(this.ignoreExtraDims==false&&A.length!=2){throw"Only 2D points are supported: "+A}return new OpenLayers.Geometry.Point(A[0],A[1])},"multipoint":function(A){var D=[];var C=null;for(var B=0,E=A.length;B<E;++B){try{C=this.parseCoords["point"].apply(this,[A[B]])}catch(F){throw F}D.push(C)}return new OpenLayers.Geometry.MultiPoint(D)},"linestring":function(A){var D=[];var C=null;for(var B=0,E=A.length;B<E;++B){try{C=this.parseCoords["point"].apply(this,[A[B]])}catch(F){throw F}D.push(C)}return new OpenLayers.Geometry.LineString(D)},"multilinestring":function(A){var C=[];var D=null;for(var B=0,E=A.length;B<E;++B){try{D=this.parseCoords["linestring"].apply(this,[A[B]])}catch(F){throw F}C.push(D)}return new OpenLayers.Geometry.MultiLineString(C)},"polygon":function(A){var E=[];var B,D;for(var C=0,F=A.length;C<F;++C){try{D=this.parseCoords["linestring"].apply(this,[A[C]])}catch(G){throw G}B=new OpenLayers.Geometry.LinearRing(D.components);E.push(B)}return new OpenLayers.Geometry.Polygon(E)},"multipolygon":function(A){var B=[];var C=null;for(var D=0,E=A.length;D<E;++D){try{C=this.parseCoords["polygon"].apply(this,[A[D]])}catch(F){throw F}B.push(C)}return new OpenLayers.Geometry.MultiPolygon(B)},"box":function(A){if(A.length!=2){throw"GeoJSON box coordinates must have 2 elements"}return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(A[0][0],A[0][1]),new OpenLayers.Geometry.Point(A[1][0],A[0][1]),new OpenLayers.Geometry.Point(A[1][0],A[1][1]),new OpenLayers.Geometry.Point(A[0][0],A[1][1]),new OpenLayers.Geometry.Point(A[0][0],A[0][1])])])}},write:function(B,A){var G={"type":null};if(OpenLayers.Util.isArray(B)){G.type="FeatureCollection";var E=B.length;G.features=new Array(E);for(var C=0;C<E;++C){var F=B[C];if(!F instanceof OpenLayers.Feature.Vector){var D="FeatureCollection only supports collections of features: "+F;throw D}G.features[C]=this.extract.feature.apply(this,[F])}}else{if(B.CLASS_NAME.indexOf("OpenLayers.Geometry")==0){G=this.extract.geometry.apply(this,[B])}else{if(B instanceof OpenLayers.Feature.Vector){G=this.extract.feature.apply(this,[B]);if(B.layer&&B.layer.projection){G.crs=this.createCRSObject(B)}}}}return OpenLayers.Format.JSON.prototype.write.apply(this,[G,A])},createCRSObject:function(B){var D=B.layer.projection.toString();var A={};if(D.match(/epsg:/i)){var C=parseInt(D.substring(D.indexOf(":")+1));if(C==4326){A={"type":"name","properties":{"name":"urn:ogc:def:crs:OGC:1.3:CRS84"}}}else{A={"type":"name","properties":{"name":"EPSG:"+C}}}}return A},extract:{"feature":function(A){var C=this.extract.geometry.apply(this,[A.geometry]);var B={"type":"Feature","properties":A.attributes,"geometry":C};if(A.fid!=null){B.id=A.fid}return B},"geometry":function(B){if(B==null){return null}if(this.internalProjection&&this.externalProjection){B=B.clone();B.transform(this.internalProjection,this.externalProjection)}var C=B.CLASS_NAME.split(".")[2];var D=this.extract[C.toLowerCase()].apply(this,[B]);var A;if(C=="Collection"){A={"type":"GeometryCollection","geometries":D}}else{A={"type":C,"coordinates":D}}return A},"point":function(A){return[A.x,A.y]},"multipoint":function(A){var B=[];for(var C=0,D=A.components.length;C<D;++C){B.push(this.extract.point.apply(this,[A.components[C]]))}return B},"linestring":function(C){var A=[];for(var B=0,D=C.components.length;B<D;++B){A.push(this.extract.point.apply(this,[C.components[B]]))}return A},"multilinestring":function(C){var A=[];for(var B=0,D=C.components.length;B<D;++B){A.push(this.extract.linestring.apply(this,[C.components[B]]))}return A},"polygon":function(D){var A=[];for(var B=0,C=D.components.length;B<C;++B){A.push(this.extract.linestring.apply(this,[D.components[B]]))}return A},"multipolygon":function(C){var A=[];for(var B=0,D=C.components.length;B<D;++B){A.push(this.extract.polygon.apply(this,[C.components[B]]))}return A},"collection":function(C){var D=C.components.length;var A=new Array(D);for(var B=0;B<D;++B){A[B]=this.extract.geometry.apply(this,[C.components[B]])}return A}},CLASS_NAME:"OpenLayers.Format.GeoJSON"});OpenLayers.Protocol.Script=OpenLayers.Class(OpenLayers.Protocol,{url:null,params:null,callback:null,callbackTemplate:"OpenLayers.Protocol.Script.registry.${id}",callbackKey:"callback",callbackPrefix:"",scope:null,format:null,pendingRequests:null,srsInBBOX:false,initialize:function(B){B=B||{};this.params={};this.pendingRequests={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);if(!this.format){this.format=new OpenLayers.Format.GeoJSON()}if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var A=new OpenLayers.Format.QueryStringFilter({srsInBBOX:this.srsInBBOX});this.filterToParams=function(C,D){return A.write(C,D)}}},read:function(B){OpenLayers.Protocol.prototype.read.apply(this,arguments);B=OpenLayers.Util.applyDefaults(B,this.options);B.params=OpenLayers.Util.applyDefaults(B.params,this.options.params);if(B.filter&&this.filterToParams){B.params=this.filterToParams(B.filter,B.params)}var C=new OpenLayers.Protocol.Response({requestType:"read"});var A=this.createRequest(B.url,B.params,OpenLayers.Function.bind(function(D){C.data=D;this.handleRead(C,B)},this));C.priv=A;return C},createRequest:function(B,F,A){var G=OpenLayers.Protocol.Script.register(A);var D=OpenLayers.String.format(this.callbackTemplate,{id:G});F=OpenLayers.Util.extend({},F);F[this.callbackKey]=this.callbackPrefix+D;B=OpenLayers.Util.urlAppend(B,OpenLayers.Util.getParameterString(F));var E=document.createElement("script");E.type="text/javascript";E.src=B;E.id="OpenLayers_Protocol_Script_"+G;this.pendingRequests[E.id]=E;var C=document.getElementsByTagName("head")[0];C.appendChild(E);return E},destroyRequest:function(A){OpenLayers.Protocol.Script.unregister(A.id.split("_").pop());delete this.pendingRequests[A.id];if(A.parentNode){A.parentNode.removeChild(A)}},handleRead:function(B,A){this.handleResponse(B,A)},handleResponse:function(B,A){if(A.callback){if(B.data){B.features=this.parseFeatures(B.data);B.code=OpenLayers.Protocol.Response.SUCCESS}else{B.code=OpenLayers.Protocol.Response.FAILURE}this.destroyRequest(B.priv);A.callback.call(A.scope,B)}},parseFeatures:function(A){return this.format.read(A)},abort:function(B){if(B){this.destroyRequest(B.priv)}else{for(var A in this.pendingRequests){this.destroyRequest(this.pendingRequests[A])}}},destroy:function(){this.abort();delete this.params;delete this.format;OpenLayers.Protocol.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Protocol.Script"});(function(){var B=OpenLayers.Protocol.Script;var A=0;B.registry={};B.register=function(C){var D="c"+(++A);B.registry[D]=function(){C.apply(this,arguments)};return D};B.unregister=function(C){delete B.registry[C]}})();OpenLayers.Format.EncodedPolyline=OpenLayers.Class(OpenLayers.Format,{geometryType:"linestring",initialize:function(A){OpenLayers.Format.prototype.initialize.apply(this,[A])},read:function(H){var E;if(this.geometryType=="linestring"){E=OpenLayers.Geometry.LineString}else{if(this.geometryType=="linearring"){E=OpenLayers.Geometry.LinearRing}else{if(this.geometryType=="multipoint"){E=OpenLayers.Geometry.MultiPoint}else{if(this.geometryType!="point"&&this.geometryType!="polygon"){return null}}}}var B=this.decodeDeltas(H,2);var D=B.length;var A=[];for(var C=0;C+1<D;){var G=B[C++],F=B[C++];A.push(new OpenLayers.Geometry.Point(F,G))}if(this.geometryType=="point"){return new OpenLayers.Feature.Vector(A[0])}if(this.geometryType=="polygon"){return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(A)]))}return new OpenLayers.Feature.Vector(new E(A))},decode:function(J,G,B){var E=B||100000;var A=this.decodeDeltas(J,G,E);var F=A.length;var H=[];for(var D=0;D+(G-1)<F;){var I=[];for(var C=0;C<G;++C){I.push(A[D++])}H.push(I)}return H},write:function(H){var G;if(H.constructor==Array){G=H[0]}else{G=H}var D=G.geometry;var F=D.CLASS_NAME.split(".")[2].toLowerCase();var A;if(F=="point"){A=new Array(D)}else{if(F=="linestring"||F=="linearring"||F=="multipoint"){A=D.components}else{if(F=="polygon"){A=D.components[0].components}else{return null}}}var C=[];var B=A.length;for(var E=0;E<B;++E){var I=A[E];C.push(I.y);C.push(I.x)}return this.encodeDeltas(C,2)},encode:function(G,A,B){var E=B||100000;var I=[];var D=G.length;for(var F=0;F<D;++F){var H=G[F];for(var C=0;C<A;++C){I.push(H[C])}}return this.encodeDeltas(I,A,E)},encodeDeltas:function(G,B,C){var E=C||100000;var A;var J=new Array(B);for(A=0;A<B;++A){J[A]=0}var H=G.length;for(var D=0;D<H;){for(A=0;A<B;++A,++D){var F=G[D];var I=F-J[A];J[A]=F;G[D]=I}}return this.encodeFloats(G,E)},decodeDeltas:function(H,B,C){var E=C||100000;var A;var I=new Array(B);for(A=0;A<B;++A){I[A]=0}var F=this.decodeFloats(H,E);var G=F.length;for(var D=0;D<G;){for(A=0;A<B;++A,++D){I[A]+=F[D];F[D]=I[A]}}return F},encodeFloats:function(C,E){var B=E||100000;var D=C.length;for(var A=0;A<D;++A){C[A]=Math.round(C[A]*B)}return this.encodeSignedIntegers(C)},decodeFloats:function(D,F){var B=F||100000;var C=this.decodeSignedIntegers(D);var E=C.length;for(var A=0;A<E;++A){C[A]/=B}return C},encodeSignedIntegers:function(C){var E=C.length;for(var B=0;B<E;++B){var D=C[B];var A=D<<1;if(D<0){A=~(A)}C[B]=A}return this.encodeUnsignedIntegers(C)},decodeSignedIntegers:function(D){var C=this.decodeUnsignedIntegers(D);var E=C.length;for(var A=0;A<E;++A){var B=C[A];C[A]=(B&1)?~(B>>1):(B>>1)}return C},encodeUnsignedIntegers:function(B){var C="";var D=B.length;for(var A=0;A<D;++A){C+=this.encodeUnsignedInteger(B[A])}return C},decodeUnsignedIntegers:function(E){var D=[];var C=0;var B=0;var G=E.length;for(var A=0;A<G;++A){var F=E.charCodeAt(A)-63;C|=(F&31)<<B;if(F<32){D.push(C);C=0;B=0}else{B+=5}}return D},encodeFloat:function(A,B){A=Math.round(A*(B||100000));return this.encodeSignedInteger(A)},decodeFloat:function(B,C){var A=this.decodeSignedInteger(B);return A/(C||100000)},encodeSignedInteger:function(B){var A=B<<1;if(B<0){A=~(A)}return this.encodeUnsignedInteger(A)},decodeSignedInteger:function(B){var A=this.decodeUnsignedInteger(B);return((A&1)?~(A>>1):(A>>1))},encodeUnsignedInteger:function(A){var B,C="";while(A>=32){B=(32|(A&31))+63;C+=(String.fromCharCode(B));A>>=5}B=A+63;C+=(String.fromCharCode(B));return C},decodeUnsignedInteger:function(D){var B=0;var C=0;var F=D.length;for(var A=0;A<F;++A){var E=D.charCodeAt(A)-63;B|=(E&31)<<C;if(E<32){break}C+=5}return B},CLASS_NAME:"OpenLayers.Format.EncodedPolyline"});OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:true,defaultControl:null,saveState:false,allowDepress:false,activeState:null,initialize:function(A){OpenLayers.Control.prototype.initialize.apply(this,[A]);this.controls=[];this.activeState={}},destroy:function(){if(this.map){this.map.events.unregister("buttonclick",this,this.onButtonClick)}OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var B,A=this.controls.length-1;A>=0;A--){B=this.controls[A];if(B.events){B.events.un({activate:this.iconOn,deactivate:this.iconOff})}B.panel_div=null}this.activeState=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){var C;for(var A=0,B=this.controls.length;A<B;A++){C=this.controls[A];if(C===this.defaultControl||(this.saveState&&this.activeState[C.id])){C.activate()}}if(this.saveState===true){this.defaultControl=null}this.redraw();return true}else{return false}},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){var C;for(var A=0,B=this.controls.length;A<B;A++){C=this.controls[A];this.activeState[C.id]=C.deactivate()}this.redraw();return true}else{return false}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(this.outsideViewport){this.events.attachToElement(this.div);this.events.register("buttonclick",this,this.onButtonClick)}else{this.map.events.register("buttonclick",this,this.onButtonClick)}this.addControlsToMap(this.controls);return this.div},redraw:function(){for(var B=this.div.childNodes.length,A=B-1;A>=0;A--){this.div.removeChild(this.div.childNodes[A])}this.div.innerHTML="";if(this.active){for(var A=0,C=this.controls.length;A<C;A++){this.div.appendChild(this.controls[A].panel_div)}}},activateControl:function(D){if(!this.active){return false}if(D.type==OpenLayers.Control.TYPE_BUTTON){D.trigger();return}if(D.type==OpenLayers.Control.TYPE_TOGGLE){if(D.active){D.deactivate()}else{D.activate()}return}if(this.allowDepress&&D.active){D.deactivate()}else{var C;for(var A=0,B=this.controls.length;A<B;A++){C=this.controls[A];if(C!=D&&(C.type===OpenLayers.Control.TYPE_TOOL||C.type==null)){C.deactivate()}}D.activate()}},addControls:function(B){if(!(OpenLayers.Util.isArray(B))){B=[B]}this.controls=this.controls.concat(B);for(var A=0,C=B.length;A<C;A++){var E=B[A],D=this.createControlMarkup(E);OpenLayers.Element.addClass(D,E.displayClass+"ItemInactive");OpenLayers.Element.addClass(D,"olButton");if(E.title!=""&&!D.title){D.title=E.title}E.panel_div=D}if(this.map){this.addControlsToMap(B);this.redraw()}},createControlMarkup:function(A){return document.createElement("div")},addControlsToMap:function(B){var D;for(var A=0,C=B.length;A<C;A++){D=B[A];if(D.autoActivate===true){D.autoActivate=false;this.map.addControl(D);D.autoActivate=true}else{this.map.addControl(D);D.deactivate()}D.events.on({activate:this.iconOn,deactivate:this.iconOff})}},iconOn:function(){var A=this.panel_div;var B=new RegExp("\\b("+this.displayClass+"Item)Inactive\\b");A.className=A.className.replace(B,"$1Active")},iconOff:function(){var A=this.panel_div;var B=new RegExp("\\b("+this.displayClass+"Item)Active\\b");A.className=A.className.replace(B,"$1Inactive")},onButtonClick:function(D){var C=this.controls,A=D.buttonElement;for(var B=C.length-1;B>=0;--B){if(C[B].panel_div===A){this.activateControl(C[B]);break}}},getControlsBy:function(C,B){var A=(typeof B.test=="function");var D=OpenLayers.Array.filter(this.controls,function(E){return E[C]==B||(A&&B.test(E[C]))});return D},getControlsByName:function(A){return this.getControlsBy("name",A)},getControlsByClass:function(A){return this.getControlsBy("CLASS_NAME",A)},CLASS_NAME:"OpenLayers.Control.Panel"});OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:"OpenLayers.Control.Button"});OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){if(this.map){this.map.zoomIn()}},CLASS_NAME:"OpenLayers.Control.ZoomIn"});OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){if(this.map){this.map.zoomOut()}},CLASS_NAME:"OpenLayers.Control.ZoomOut"});OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){if(this.map){this.map.zoomToMaxExtent()}},CLASS_NAME:"OpenLayers.Control.ZoomToMaxExtent"});OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(A){OpenLayers.Control.Panel.prototype.initialize.apply(this,[A]);this.addControls([new OpenLayers.Control.ZoomIn(),new OpenLayers.Control.ZoomToMaxExtent(),new OpenLayers.Control.ZoomOut()])},CLASS_NAME:"OpenLayers.Control.ZoomPanel"});OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:false,initialize:function(C,A,D,B){OpenLayers.Layer.prototype.initialize.apply(this,[C,B]);this.url=A;if(!this.params){this.params=OpenLayers.Util.extend({},D)}},destroy:function(){this.url=null;this.params=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(A){if(A==null){A=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions())}A=OpenLayers.Layer.prototype.clone.apply(this,[A]);return A},setUrl:function(A){this.url=A},mergeNewParams:function(A){this.params=OpenLayers.Util.extend(this.params,A);var B=this.redraw();if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"params"})}return B},redraw:function(A){if(A){return this.mergeNewParams({"_olSalt":Math.random()})}else{return OpenLayers.Layer.prototype.redraw.apply(this,[])}},selectUrl:function(E,D){var B=1;for(var A=0,C=E.length;A<C;A++){B*=E.charCodeAt(A)*this.URL_HASH_FACTOR;B-=Math.floor(B)}return D[Math.floor(B*D.length)]},getFullRequestString:function(C,D){var B=D||this.url;var G=OpenLayers.Util.extend({},this.params);G=OpenLayers.Util.extend(G,C);var E=OpenLayers.Util.getParameterString(G);if(OpenLayers.Util.isArray(B)){B=this.selectUrl(E,B)}var F=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(B));for(var A in G){if(A.toUpperCase() in F){delete G[A]}}E=OpenLayers.Util.getParameterString(G);return OpenLayers.Util.urlAppend(B,E)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"});OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:false,initialize:function(E,A,C,B,F,D){this.layer=E;this.position=A.clone();this.setBounds(C);this.url=B;if(F){this.size=F.clone()}this.id=OpenLayers.Util.createUniqueID("Tile_");OpenLayers.Util.extend(this,D);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}},unload:function(){if(this.isLoading){this.isLoading=false;this.events.triggerEvent("unload")}},destroy:function(){this.layer=null;this.bounds=null;this.size=null;this.position=null;if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy();this.eventListeners=null;this.events=null},draw:function(A){if(!A){this.clear()}var B=this.shouldDraw();if(B&&!A&&this.events.triggerEvent("beforedraw")===false){B=null}return B},shouldDraw:function(){var A=false,C=this.layer.maxExtent;if(C){var B=this.layer.map;var D=B.baseLayer.wrapDateLine&&B.getMaxExtent();if(this.bounds.intersectsBounds(C,{inclusive:false,worldBounds:D})){A=true}}return A||this.layer.displayOutsideMaxExtent},setBounds:function(B){B=B.clone();if(this.layer.map.baseLayer.wrapDateLine){var C=this.layer.map.getMaxExtent(),A=this.layer.map.getResolution();B=B.wrapDateLine(C,{leftTolerance:A,rightTolerance:A})}this.bounds=B},moveTo:function(A,B,C){if(C==null){C=true}this.setBounds(A);this.position=B.clone();if(C){this.draw()}},clear:function(A){},CLASS_NAME:"OpenLayers.Tile"});OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(E,A,C,B,F,D){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=B;this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack();if(this.maxGetUrlLength!=null||this.layer.gutter||this.layerAlphaHack){this.frame=document.createElement("div");this.frame.style.position="absolute";this.frame.style.overflow="hidden"}if(this.maxGetUrlLength!=null){OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)}},destroy:function(){if(this.imgDiv){this.clear();this.imgDiv=null;this.frame=null}this.asyncRequestId=null;OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var A=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(A){if(this.layer!=this.layer.map.baseLayer&&this.layer.reproject){this.bounds=this.getBoundsFromBaseLayer(this.position)}if(this.isLoading){this._loadEvent="reload"}else{this.isLoading=true;this._loadEvent="loadstart"}this.renderTile();this.positionTile()}else{if(A===false){this.unload()}}return A},renderTile:function(){if(this.layer.async){var A=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(B){if(A==this.asyncRequestId){this.url=B;this.initImage()}},this)}else{this.url=this.layer.getURL(this.bounds);this.initImage()}},positionTile:function(){var C=this.getTile().style,A=this.frame?this.size:this.layer.getImageSize(this.bounds),B=1;if(this.layer instanceof OpenLayers.Layer.Grid){B=this.layer.getServerResolution()/this.layer.map.getResolution()}C.left=this.position.x+"px";C.top=this.position.y+"px";C.width=Math.round(B*A.w)+"px";C.height=Math.round(B*A.h)+"px"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var B=this.imgDiv;if(B){var A=this.getTile();if(A.parentNode===this.layer.div){this.layer.div.removeChild(A)}this.setImgSrc();if(this.layerAlphaHack===true){B.style.filter=""}OpenLayers.Element.removeClass(B,"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=OpenLayers.Tile.Image.IMAGE.cloneNode(false);var C=this.imgDiv.style;if(this.frame){var A=0,B=0;if(this.layer.gutter){A=this.layer.gutter/this.layer.tileSize.w*100;B=this.layer.gutter/this.layer.tileSize.h*100}C.left=-A+"%";C.top=-B+"%";C.width=(2*A+100)+"%";C.height=(2*B+100)+"%"}C.visibility="hidden";C.opacity=0;if(this.layer.opacity<1){C.filter="alpha(opacity="+(this.layer.opacity*100)+")"}C.position="absolute";if(this.layerAlphaHack){C.paddingTop=C.height;C.height="0";C.width="100%"}if(this.frame){this.frame.appendChild(this.imgDiv)}}return this.imgDiv},setImage:function(A){this.imgDiv=A},initImage:function(){if(!this.url&&!this.imgDiv){this.isLoading=false;return}this.events.triggerEvent("beforeload");this.layer.div.appendChild(this.getTile());this.events.triggerEvent(this._loadEvent);var B=this.getImage();var A=B.getAttribute("src")||"";if(this.url&&OpenLayers.Util.isEquivalentUrl(A,this.url)){this._loadTimeout=window.setTimeout(OpenLayers.Function.bind(this.onImageLoad,this),0)}else{this.stopLoading();if(this.crossOriginKeyword){B.removeAttribute("crossorigin")}OpenLayers.Event.observe(B,"load",OpenLayers.Function.bind(this.onImageLoad,this));OpenLayers.Event.observe(B,"error",OpenLayers.Function.bind(this.onImageError,this));this.imageReloadAttempts=0;this.setImgSrc(this.url)}},setImgSrc:function(A){var B=this.imgDiv;if(A){B.style.visibility="hidden";B.style.opacity=0;if(this.crossOriginKeyword){if(A.substr(0,5)!=="data:"){B.setAttribute("crossorigin",this.crossOriginKeyword)}else{B.removeAttribute("crossorigin")}}B.src=A}else{this.stopLoading();this.imgDiv=null;if(B.parentNode){B.parentNode.removeChild(B)}}},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(!this.imgDiv||this.isLoading){return}var A;if(this.frame){A=this.frame.cloneNode(false);A.appendChild(this.imgDiv)}else{A=this.imgDiv}this.imgDiv=null;return A},onImageLoad:function(){var A=this.imgDiv;this.stopLoading();A.style.visibility="inherit";A.style.opacity=this.layer.opacity;this.isLoading=false;this.canvasContext=null;this.events.triggerEvent("loadend");if(this.layerAlphaHack===true){A.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+A.src+"', sizingMethod='scale')"}},onImageError:function(){var A=this.imgDiv;if(A.src!=null){this.imageReloadAttempts++;if(this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS){this.setImgSrc(this.layer.getURL(this.bounds))}else{OpenLayers.Element.addClass(A,"olImageLoadError");this.events.triggerEvent("loaderror");this.onImageLoad()}}},stopLoading:function(){OpenLayers.Event.stopObservingElement(this.imgDiv);window.clearTimeout(this._loadTimeout);delete this._loadTimeout},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var A=document.createElement("canvas");A.width=this.size.w;A.height=this.size.h;this.canvasContext=A.getContext("2d");this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"});OpenLayers.Tile.Image.IMAGE=(function(){var A=new Image();A.className="olTileImage";A.galleryImg="no";return A}());OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:false,ratio:1.5,buffer:0,transitionEffect:"resize",numLoadingTiles:0,serverResolutions:null,loading:false,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,className:null,gridLayout:null,rowSign:null,transitionendEvents:["transitionend","webkitTransitionEnd","otransitionend","oTransitionEnd"],initialize:function(C,A,D,B){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.grid=[];this._removeBackBuffer=OpenLayers.Function.bind(this.removeBackBuffer,this);this.initProperties();this.rowSign=this.tileOriginCorner.substr(0,1)==="t"?1:-1},initProperties:function(){if(this.options.removeBackBufferDelay===undefined){this.removeBackBufferDelay=this.singleTile?0:2500}if(this.options.className===undefined){this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid"}},setMap:function(A){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,A);OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(A){this.removeBackBuffer()},destroy:function(){this.removeBackBuffer();this.clearGrid();this.grid=null;this.tileSize=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){if(this.grid){for(var B=0,D=this.grid.length;B<D;B++){var C=this.grid[B];for(var A=0,F=C.length;A<F;A++){var E=C[A];this.destroyTile(E)}}this.grid=[];this.gridResolution=null;this.gridLayout=null}},addOptions:function(C,A){var B=C.singleTile!==undefined&&C.singleTile!==this.singleTile;OpenLayers.Layer.HTTPRequest.prototype.addOptions.apply(this,arguments);if(this.map&&B){this.initProperties();this.clearGrid();this.tileSize=this.options.tileSize;this.setTileSize();this.moveTo(null,true)}},clone:function(A){if(A==null){A=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions())}A=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[A]);if(this.tileSize!=null){A.tileSize=this.tileSize.clone()}A.grid=[];A.gridResolution=null;A.backBuffer=null;A.backBufferTimerId=null;A.loading=false;A.numLoadingTiles=0;return A},moveTo:function(D,C,F){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);D=D||this.map.getExtent();if(D!=null){var E=!this.grid.length||C;var B=this.getTilesBounds();var A=this.map.getResolution();var G=this.getServerResolution(A);if(this.singleTile){if(E||(!F&&!B.containsBounds(D))){if(C&&this.transitionEffect!=="resize"){this.removeBackBuffer()}if(!C||this.transitionEffect==="resize"){this.applyBackBuffer(A)}this.initSingleTile(D)}}else{E=E||!B.intersectsBounds(D,{worldBounds:this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent()});if(E){if(C&&(this.transitionEffect==="resize"||this.gridResolution===A)){this.applyBackBuffer(A)}this.initGriddedTiles(D)}else{this.moveGriddedTiles()}}}},getTileData:function(R){var K=null,E=R.lon,O=R.lat,D=this.grid.length;if(this.map&&D){var N=this.map.getResolution(),L=this.tileSize.w,I=this.tileSize.h,G=this.grid[0][0].bounds,J=G.left,H=G.top;if(E<J){if(this.map.baseLayer.wrapDateLine){var A=this.map.getMaxExtent().getWidth();var C=Math.ceil((J-E)/A);E+=A*C}}var P=(E-J)/(N*L);var Q=(H-O)/(N*I);var M=Math.floor(P);var F=Math.floor(Q);if(F>=0&&F<D){var B=this.grid[F][M];if(B){K={tile:B,i:Math.floor((P-M)*L),j:Math.floor((Q-F)*I)}}}}return K},destroyTile:function(A){this.removeTileMonitoringHooks(A);A.destroy()},getServerResolution:function(D){var E=Number.POSITIVE_INFINITY;D=D||this.map.getResolution();if(this.serverResolutions&&OpenLayers.Util.indexOf(this.serverResolutions,D)===-1){var A,B,C,F;for(A=this.serverResolutions.length-1;A>=0;A--){C=this.serverResolutions[A];B=Math.abs(C-D);if(B>E){break}E=B;F=C}D=F}return D},getServerZoom:function(){var A=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,A):this.map.getZoomForResolution(A)+(this.zoomOffset||0)},applyBackBuffer:function(H){if(this.backBufferTimerId!==null){this.removeBackBuffer()}var D=this.backBuffer;if(!D){D=this.createBackBuffer();if(!D){return}if(H===this.gridResolution){this.div.insertBefore(D,this.div.firstChild)}else{this.map.baseLayer.div.parentNode.insertBefore(D,this.map.baseLayer.div)}this.backBuffer=D;var C=this.grid[0][0].bounds;this.backBufferLonLat={lon:C.left,lat:C.top};this.backBufferResolution=this.gridResolution}var I=this.backBufferResolution/H;var B=D.childNodes,A;for(var E=B.length-1;E>=0;--E){A=B[E];A.style.top=((I*A._i*A._h)|0)+"px";A.style.left=((I*A._j*A._w)|0)+"px";A.style.width=Math.round(I*A._w)+"px";A.style.height=Math.round(I*A._h)+"px"}var G=this.getViewPortPxFromLonLat(this.backBufferLonLat,H);var F=this.map.layerContainerOriginPx.x;var J=this.map.layerContainerOriginPx.y;D.style.left=Math.round(G.x-F)+"px";D.style.top=Math.round(G.y-J)+"px"},createBackBuffer:function(){var B;if(this.grid.length>0){B=document.createElement("div");B.id=this.div.id+"_bb";B.className="olBackBuffer";B.style.position="absolute";var H=this.map;B.style.zIndex=this.transitionEffect==="resize"?this.getZIndex()-1:H.Z_INDEX_BASE.BaseLayer-(H.getNumLayers()-H.getLayerIndex(this));for(var F=0,D=this.grid.length;F<D;F++){for(var E=0,C=this.grid[F].length;E<C;E++){var A=this.grid[F][E],G=this.grid[F][E].createBackBuffer();if(G){G._i=F;G._j=E;G._w=A.size.w;G._h=A.size.h;G.id=A.id+"_bb";B.appendChild(G)}}}}return B},removeBackBuffer:function(){if(this._transitionElement){for(var A=this.transitionendEvents.length-1;A>=0;--A){OpenLayers.Event.stopObserving(this._transitionElement,this.transitionendEvents[A],this._removeBackBuffer)}delete this._transitionElement}if(this.backBuffer){if(this.backBuffer.parentNode){this.backBuffer.parentNode.removeChild(this.backBuffer)}this.backBuffer=null;this.backBufferResolution=null;if(this.backBufferTimerId!==null){window.clearTimeout(this.backBufferTimerId);this.backBufferTimerId=null}}},moveByPx:function(A,B){if(!this.singleTile){this.moveGriddedTiles()}},setTileSize:function(A){if(this.singleTile){A=this.map.getSize();A.h=parseInt(A.h*this.ratio,10);A.w=parseInt(A.w*this.ratio,10)}OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[A])},getTilesBounds:function(){var B=null;var A=this.grid.length;if(A){var D=this.grid[A-1][0].bounds,E=this.grid[0].length*D.getWidth(),C=this.grid.length*D.getHeight();B=new OpenLayers.Bounds(D.left,D.bottom,D.left+E,D.bottom+C)}return B},initSingleTile:function(B){this.events.triggerEvent("retile");var D=B.getCenterLonLat();var A=B.getWidth()*this.ratio;var C=B.getHeight()*this.ratio;var G=new OpenLayers.Bounds(D.lon-(A/2),D.lat-(C/2),D.lon+(A/2),D.lat+(C/2));var E=this.map.getLayerPxFromLonLat({lon:G.left,lat:G.top});if(!this.grid.length){this.grid[0]=[]}var F=this.grid[0][0];if(!F){F=this.addTile(G,E);this.addTileMonitoringHooks(F);F.draw();this.grid[0][0]=F}else{F.moveTo(G,E)}this.removeExcessTiles(1,1);this.gridResolution=this.getServerResolution()},calculateGridLayout:function(C,F,I){var D=I*this.tileSize.w;var G=I*this.tileSize.h;var H=C.left-F.lon;var E=Math.floor(H/D)-this.buffer;var A=this.rowSign;var J=A*(F.lat-C.top+G);var B=Math[~A?"floor":"ceil"](J/G)-this.buffer*A;return{tilelon:D,tilelat:G,startcol:E,startrow:B}},getTileOrigin:function(){var C=this.tileOrigin;if(!C){var B=this.getMaxExtent();var A=({"tl":["left","top"],"tr":["right","top"],"bl":["left","bottom"],"br":["right","bottom"]})[this.tileOriginCorner];C=new OpenLayers.LonLat(B[A[0]],B[A[1]])}return C},getTileBoundsForGridIndex:function(H,I){var F=this.getTileOrigin();var B=this.gridLayout;var C=B.tilelon;var E=B.tilelat;var G=B.startcol;var D=B.startrow;var A=this.rowSign;return new OpenLayers.Bounds(F.lon+(G+I)*C,F.lat-(D+H*A)*E*A,F.lon+(G+I+1)*C,F.lat-(D+(H-1)*A)*E*A)},initGriddedTiles:function(U){this.events.triggerEvent("retile");var Y=this.map.getSize();var E=this.getTileOrigin();var S=this.map.getResolution(),L=this.getServerResolution(),T=S/L,G={w:this.tileSize.w/T,h:this.tileSize.h/T};var C=Math.ceil(Y.h/G.h)+2*this.buffer+1;var D=Math.ceil(Y.w/G.w)+2*this.buffer+1;var X=this.calculateGridLayout(U,E,L);this.gridLayout=X;var A=X.tilelon;var I=X.tilelat;var N=this.map.layerContainerOriginPx.x;var Q=this.map.layerContainerOriginPx.y;var B=this.getTileBoundsForGridIndex(0,0);var Z=this.map.getViewPortPxFromLonLat(new OpenLayers.LonLat(B.left,B.top));Z.x=Math.round(Z.x)-N;Z.y=Math.round(Z.y)-Q;var P=[],H=this.map.getCenter();var R=0;do{var O=this.grid[R];if(!O){O=[];this.grid.push(O)}var K=0;do{B=this.getTileBoundsForGridIndex(R,K);var W=Z.clone();W.x=W.x+K*Math.round(G.w);W.y=W.y+R*Math.round(G.h);var J=O[K];if(!J){J=this.addTile(B,W);this.addTileMonitoringHooks(J);O.push(J)}else{J.moveTo(B,W,false)}var F=B.getCenterLonLat();P.push({tile:J,distance:Math.pow(F.lon-H.lon,2)+Math.pow(F.lat-H.lat,2)});K+=1}while((B.right<=U.right+A*this.buffer)||K<D);R+=1}while((B.bottom>=U.bottom-I*this.buffer)||R<C);this.removeExcessTiles(R,K);var S=this.getServerResolution();this.gridResolution=S;P.sort(function(d,c){return d.distance-c.distance});for(var V=0,M=P.length;V<M;++V){P[V].tile.draw()}},getMaxExtent:function(){return this.maxExtent},addTile:function(A,B){var C=new this.tileClass(this,B,A,null,this.tileSize,this.tileOptions);this.events.triggerEvent("addtile",{tile:C});return C},addTileMonitoringHooks:function(A){var B="olTileReplacing";A.onLoadStart=function(){if(this.loading===false){this.loading=true;this.events.triggerEvent("loadstart")}this.events.triggerEvent("tileloadstart",{tile:A});this.numLoadingTiles++;if(!this.singleTile&&this.backBuffer&&this.gridResolution===this.backBufferResolution){OpenLayers.Element.addClass(A.getTile(),B)}};A.onLoadEnd=function(F){this.numLoadingTiles--;var C=F.type==="unload";this.events.triggerEvent("tileloaded",{tile:A,aborted:C});if(!this.singleTile&&!C&&this.backBuffer&&this.gridResolution===this.backBufferResolution){var G=A.getTile();if(OpenLayers.Element.getStyle(G,"display")==="none"){var E=document.getElementById(A.id+"_bb");if(E){E.parentNode.removeChild(E)}}OpenLayers.Element.removeClass(G,B)}if(this.numLoadingTiles===0){if(this.backBuffer){if(this.backBuffer.childNodes.length===0){this.removeBackBuffer()}else{this._transitionElement=C?this.div.lastChild:A.imgDiv;var H=this.transitionendEvents;for(var D=H.length-1;D>=0;--D){OpenLayers.Event.observe(this._transitionElement,H[D],this._removeBackBuffer)}this.backBufferTimerId=window.setTimeout(this._removeBackBuffer,this.removeBackBufferDelay)}}this.loading=false;this.events.triggerEvent("loadend")}};A.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:A})};A.events.on({"loadstart":A.onLoadStart,"loadend":A.onLoadEnd,"unload":A.onLoadEnd,"loaderror":A.onLoadError,scope:this})},removeTileMonitoringHooks:function(A){A.unload();A.events.un({"loadstart":A.onLoadStart,"loadend":A.onLoadEnd,"unload":A.onLoadEnd,"loaderror":A.onLoadError,scope:this})},moveGriddedTiles:function(){var B=this.buffer+1;while(true){var A=this.grid[0][0];var E={x:A.position.x+this.map.layerContainerOriginPx.x,y:A.position.y+this.map.layerContainerOriginPx.y};var C=this.getServerResolution()/this.map.getResolution();var D={w:Math.round(this.tileSize.w*C),h:Math.round(this.tileSize.h*C)};if(E.x>-D.w*(B-1)){this.shiftColumn(true,D)}else{if(E.x<-D.w*B){this.shiftColumn(false,D)}else{if(E.y>-D.h*(B-1)){this.shiftRow(true,D)}else{if(E.y<-D.h*B){this.shiftRow(false,D)}else{break}}}}}},shiftRow:function(D,K){var M=this.grid;var B=D?0:(M.length-1);var L=D?-1:1;var A=this.rowSign;var C=this.gridLayout;C.startrow+=L*A;var I=M[B];var G=M[D?"pop":"shift"]();for(var F=0,J=G.length;F<J;F++){var E=G[F];var H=I[F].position.clone();H.y+=K.h*L;E.moveTo(this.getTileBoundsForGridIndex(B,F),H)}M[D?"unshift":"push"](G)},shiftColumn:function(C,I){var K=this.grid;var G=C?0:(K[0].length-1);var J=C?-1:1;var B=this.gridLayout;B.startcol+=J;for(var D=0,H=K.length;D<H;D++){var E=K[D];var F=E[G].position.clone();var A=E[C?"pop":"shift"]();F.x+=I.w*J;A.moveTo(this.getTileBoundsForGridIndex(D,G),F);E[C?"unshift":"push"](A)}},removeExcessTiles:function(D,F){var A,C;while(this.grid.length>D){var B=this.grid.pop();for(A=0,C=B.length;A<C;A++){var E=B[A];this.destroyTile(E)}}for(A=0,C=this.grid.length;A<C;A++){while(this.grid[A].length>F){var B=this.grid[A];var E=B.pop();this.destroyTile(E)}}},onMapResize:function(){if(this.singleTile){this.clearGrid();this.setTileSize()}},getTileBounds:function(E){var A=this.maxExtent;var F=this.getResolution();var C=F*this.tileSize.w;var B=F*this.tileSize.h;var D=this.getLonLatFromViewPortPx(E);var H=A.left+(C*Math.floor((D.lon-A.left)/C));var G=A.bottom+(B*Math.floor((D.lat-A.bottom)/B));return new OpenLayers.Bounds(H,G,H+C,G+B)},CLASS_NAME:"OpenLayers.Layer.Grid"});OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,{fontStyleKeys:["antialiasing","blockout","font","fontcolor","fontsize","fontstyle","glowing","interval","outline","printmode","shadow","transparency"],request:null,response:null,initialize:function(A){this.request=new OpenLayers.Format.ArcXML.Request();this.response=new OpenLayers.Format.ArcXML.Response();if(A){if(A.requesttype=="feature"){this.request.get_image=null;var C=this.request.get_feature.query;this.addCoordSys(C.featurecoordsys,A.featureCoordSys);this.addCoordSys(C.filtercoordsys,A.filterCoordSys);if(A.polygon){C.isspatial=true;C.spatialfilter.polygon=A.polygon}else{if(A.envelope){C.isspatial=true;C.spatialfilter.envelope={minx:0,miny:0,maxx:0,maxy:0};this.parseEnvelope(C.spatialfilter.envelope,A.envelope)}}}else{if(A.requesttype=="image"){this.request.get_feature=null;var B=this.request.get_image.properties;this.parseEnvelope(B.envelope,A.envelope);this.addLayers(B.layerlist,A.layers);this.addImageSize(B.imagesize,A.tileSize);this.addCoordSys(B.featurecoordsys,A.featureCoordSys);this.addCoordSys(B.filtercoordsys,A.filterCoordSys)}else{this.request=null}}}OpenLayers.Format.XML.prototype.initialize.apply(this,[A])},parseEnvelope:function(A,B){if(B&&B.length==4){A.minx=B[0];A.miny=B[1];A.maxx=B[2];A.maxy=B[3]}},addLayers:function(A,B){for(var D=0,C=B.length;D<C;D++){A.push(B[D])}},addImageSize:function(A,B){if(B!==null){A.width=B.w;A.height=B.h;A.printwidth=B.w;A.printheight=B.h}},addCoordSys:function(B,A){if(typeof A=="string"){B.id=parseInt(A);B.string=A}else{if(typeof A=="object"&&A.proj!==null){B.id=A.proj.srsProjNumber;B.string=A.proj.srsCode}else{B=A}}},iserror:function(C){var B=null;if(!C){B=(this.response.error!=="")}else{C=OpenLayers.Format.XML.prototype.read.apply(this,[C]);var A=C.documentElement.getElementsByTagName("ERROR");B=(A!==null&&A.length>0)}return B},read:function(F){if(typeof F=="string"){F=OpenLayers.Format.XML.prototype.read.apply(this,[F])}var B=null;if(F&&F.documentElement){if(F.documentElement.nodeName=="ARCXML"){B=F.documentElement}else{B=F.documentElement.getElementsByTagName("ARCXML")[0]}}if(!B||B.firstChild.nodeName==="parsererror"){var D,A;try{D=F.firstChild.nodeValue;A=F.firstChild.childNodes[1].firstChild.nodeValue}catch(C){}throw {message:"Error parsing the ArcXML request",error:D,source:A}}var E=this.parseResponse(B);return E},write:function(E){if(!E){E=this.request}var N=this.createElementNS("","ARCXML");N.setAttribute("version","1.1");var X=this.createElementNS("","REQUEST");if(E.get_image!=null){var I=this.createElementNS("","GET_IMAGE");X.appendChild(I);var S=this.createElementNS("","PROPERTIES");I.appendChild(S);var C=E.get_image.properties;if(C.featurecoordsys!=null){var L=this.createElementNS("","FEATURECOORDSYS");S.appendChild(L);if(C.featurecoordsys.id===0){L.setAttribute("string",C.featurecoordsys["string"])}else{L.setAttribute("id",C.featurecoordsys.id)}}if(C.filtercoordsys!=null){var P=this.createElementNS("","FILTERCOORDSYS");S.appendChild(P);if(C.filtercoordsys.id===0){P.setAttribute("string",C.filtercoordsys.string)}else{P.setAttribute("id",C.filtercoordsys.id)}}if(C.envelope!=null){var A=this.createElementNS("","ENVELOPE");S.appendChild(A);A.setAttribute("minx",C.envelope.minx);A.setAttribute("miny",C.envelope.miny);A.setAttribute("maxx",C.envelope.maxx);A.setAttribute("maxy",C.envelope.maxy)}var H=this.createElementNS("","IMAGESIZE");S.appendChild(H);H.setAttribute("height",C.imagesize.height);H.setAttribute("width",C.imagesize.width);if(C.imagesize.height!=C.imagesize.printheight||C.imagesize.width!=C.imagesize.printwidth){H.setAttribute("printheight",C.imagesize.printheight);H.setArrtibute("printwidth",C.imagesize.printwidth)}if(C.background!=null){var D=this.createElementNS("","BACKGROUND");S.appendChild(D);D.setAttribute("color",C.background.color.r+","+C.background.color.g+","+C.background.color.b);if(C.background.transcolor!==null){D.setAttribute("transcolor",C.background.transcolor.r+","+C.background.transcolor.g+","+C.background.transcolor.b)}}if(C.layerlist!=null&&C.layerlist.length>0){var B=this.createElementNS("","LAYERLIST");S.appendChild(B);for(var U=0;U<C.layerlist.length;U++){var W=this.createElementNS("","LAYERDEF");B.appendChild(W);W.setAttribute("id",C.layerlist[U].id);W.setAttribute("visible",C.layerlist[U].visible);if(typeof C.layerlist[U].query=="object"){var F=C.layerlist[U].query;if(F.where.length<0){continue}var M=null;if(typeof F.spatialfilter=="boolean"&&F.spatialfilter){M=this.createElementNS("","SPATIALQUERY")}else{M=this.createElementNS("","QUERY")}M.setAttribute("where",F.where);if(typeof F.accuracy=="number"&&F.accuracy>0){M.setAttribute("accuracy",F.accuracy)}if(typeof F.featurelimit=="number"&&F.featurelimit<2000){M.setAttribute("featurelimit",F.featurelimit)}if(typeof F.subfields=="string"&&F.subfields!="#ALL#"){M.setAttribute("subfields",F.subfields)}if(typeof F.joinexpression=="string"&&F.joinexpression.length>0){M.setAttribute("joinexpression",F.joinexpression)}if(typeof F.jointables=="string"&&F.jointables.length>0){M.setAttribute("jointables",F.jointables)}W.appendChild(M)}if(typeof C.layerlist[U].renderer=="object"){this.addRenderer(W,C.layerlist[U].renderer)}}}}else{if(E.get_feature!=null){var I=this.createElementNS("","GET_FEATURES");I.setAttribute("outputmode","newxml");I.setAttribute("checkesc","true");if(E.get_feature.geometry){I.setAttribute("geometry",E.get_feature.geometry)}else{I.setAttribute("geometry","false")}if(E.get_feature.compact){I.setAttribute("compact",E.get_feature.compact)}if(E.get_feature.featurelimit=="number"){I.setAttribute("featurelimit",E.get_feature.featurelimit)}I.setAttribute("globalenvelope","true");X.appendChild(I);if(E.get_feature.layer!=null&&E.get_feature.layer.length>0){var V=this.createElementNS("","LAYER");V.setAttribute("id",E.get_feature.layer);I.appendChild(V)}var O=E.get_feature.query;if(O!=null){var Q=null;if(O.isspatial){Q=this.createElementNS("","SPATIALQUERY")}else{Q=this.createElementNS("","QUERY")}I.appendChild(Q);if(typeof O.accuracy=="number"){Q.setAttribute("accuracy",O.accuracy)}if(O.featurecoordsys!=null){var G=this.createElementNS("","FEATURECOORDSYS");if(O.featurecoordsys.id==0){G.setAttribute("string",O.featurecoordsys.string)}else{G.setAttribute("id",O.featurecoordsys.id)}Q.appendChild(G)}if(O.filtercoordsys!=null){var R=this.createElementNS("","FILTERCOORDSYS");if(O.filtercoordsys.id===0){R.setAttribute("string",O.filtercoordsys.string)}else{R.setAttribute("id",O.filtercoordsys.id)}Q.appendChild(R)}if(O.buffer>0){var K=this.createElementNS("","BUFFER");K.setAttribute("distance",O.buffer);Q.appendChild(K)}if(O.isspatial){var J=this.createElementNS("","SPATIALFILTER");J.setAttribute("relation",O.spatialfilter.relation);Q.appendChild(J);if(O.spatialfilter.envelope){var T=this.createElementNS("","ENVELOPE");T.setAttribute("minx",O.spatialfilter.envelope.minx);T.setAttribute("miny",O.spatialfilter.envelope.miny);T.setAttribute("maxx",O.spatialfilter.envelope.maxx);T.setAttribute("maxy",O.spatialfilter.envelope.maxy);J.appendChild(T)}else{if(typeof O.spatialfilter.polygon=="object"){J.appendChild(this.writePolygonGeometry(O.spatialfilter.polygon))}}}if(O.where!=null&&O.where.length>0){Q.setAttribute("where",O.where)}}}}N.appendChild(X);return OpenLayers.Format.XML.prototype.write.apply(this,[N])},addGroupRenderer:function(D,B){var A=this.createElementNS("","GROUPRENDERER");D.appendChild(A);for(var E=0;E<B.length;E++){var C=B[E];this.addRenderer(A,C)}},addRenderer:function(A,B){if(OpenLayers.Util.isArray(B)){this.addGroupRenderer(A,B)}else{var C=this.createElementNS("",B.type.toUpperCase()+"RENDERER");A.appendChild(C);if(C.tagName=="VALUEMAPRENDERER"){this.addValueMapRenderer(C,B)}else{if(C.tagName=="VALUEMAPLABELRENDERER"){this.addValueMapLabelRenderer(C,B)}else{if(C.tagName=="SIMPLELABELRENDERER"){this.addSimpleLabelRenderer(C,B)}else{if(C.tagName=="SCALEDEPENDENTRENDERER"){this.addScaleDependentRenderer(C,B)}}}}}},addScaleDependentRenderer:function(B,A){if(typeof A.lower=="string"||typeof A.lower=="number"){B.setAttribute("lower",A.lower)}if(typeof A.upper=="string"||typeof A.upper=="number"){B.setAttribute("upper",A.upper)}this.addRenderer(B,A.renderer)},addValueMapLabelRenderer:function(G,A){G.setAttribute("lookupfield",A.lookupfield);G.setAttribute("labelfield",A.labelfield);if(typeof A.exacts=="object"){for(var K=0,J=A.exacts.length;K<J;K++){var B=A.exacts[K];var I=this.createElementNS("","EXACT");if(typeof B.value=="string"){I.setAttribute("value",B.value)}if(typeof B.label=="string"){I.setAttribute("label",B.label)}if(typeof B.method=="string"){I.setAttribute("method",B.method)}G.appendChild(I);if(typeof B.symbol=="object"){var E=null;if(B.symbol.type=="text"){E=this.createElementNS("","TEXTSYMBOL")}if(E!=null){var F=this.fontStyleKeys;for(var C=0,H=F.length;C<H;C++){var D=F[C];if(B.symbol[D]){E.setAttribute(D,B.symbol[D])}}I.appendChild(E)}}}}},addValueMapRenderer:function(H,C){H.setAttribute("lookupfield",C.lookupfield);if(typeof C.ranges=="object"){for(var K=0,D=C.ranges.length;K<D;K++){var J=C.ranges[K];var B=this.createElementNS("","RANGE");B.setAttribute("lower",J.lower);B.setAttribute("upper",J.upper);H.appendChild(B);if(typeof J.symbol=="object"){var G=null;if(J.symbol.type=="simplepolygon"){G=this.createElementNS("","SIMPLEPOLYGONSYMBOL")}if(G!=null){if(typeof J.symbol.boundarycolor=="string"){G.setAttribute("boundarycolor",J.symbol.boundarycolor)}if(typeof J.symbol.fillcolor=="string"){G.setAttribute("fillcolor",J.symbol.fillcolor)}if(typeof J.symbol.filltransparency=="number"){G.setAttribute("filltransparency",J.symbol.filltransparency)}B.appendChild(G)}}}}else{if(typeof C.exacts=="object"){for(var I=0,A=C.exacts.length;I<A;I++){var F=C.exacts[I];var E=this.createElementNS("","EXACT");if(typeof F.value=="string"){E.setAttribute("value",F.value)}if(typeof F.label=="string"){E.setAttribute("label",F.label)}if(typeof F.method=="string"){E.setAttribute("method",F.method)}H.appendChild(E);if(typeof F.symbol=="object"){var G=null;if(F.symbol.type=="simplemarker"){G=this.createElementNS("","SIMPLEMARKERSYMBOL")}if(G!=null){if(typeof F.symbol.antialiasing=="string"){G.setAttribute("antialiasing",F.symbol.antialiasing)}if(typeof F.symbol.color=="string"){G.setAttribute("color",F.symbol.color)}if(typeof F.symbol.outline=="string"){G.setAttribute("outline",F.symbol.outline)}if(typeof F.symbol.overlap=="string"){G.setAttribute("overlap",F.symbol.overlap)}if(typeof F.symbol.shadow=="string"){G.setAttribute("shadow",F.symbol.shadow)}if(typeof F.symbol.transparency=="number"){G.setAttribute("transparency",F.symbol.transparency)}if(typeof F.symbol.usecentroid=="string"){G.setAttribute("usecentroid",F.symbol.usecentroid)}if(typeof F.symbol.width=="number"){G.setAttribute("width",F.symbol.width)}E.appendChild(G)}}}}}},addSimpleLabelRenderer:function(G,A){G.setAttribute("field",A.field);var F=["featureweight","howmanylabels","labelbufferratio","labelpriorities","labelweight","linelabelposition","rotationalangles"];for(var B=0,H=F.length;B<H;B++){var C=F[B];if(A[C]){G.setAttribute(C,A[C])}}if(A.symbol.type=="text"){var D=A.symbol;var E=this.createElementNS("","TEXTSYMBOL");G.appendChild(E);var F=this.fontStyleKeys;for(var B=0,H=F.length;B<H;B++){var C=F[B];if(D[C]){E.setAttribute(C,A[C])}}}},writePolygonGeometry:function(E){if(!(E instanceof OpenLayers.Geometry.Polygon)){throw {message:"Cannot write polygon geometry to ArcXML with an "+E.CLASS_NAME+" object.",geometry:E}}var I=this.createElementNS("","POLYGON");for(var C=0,B=E.components.length;C<B;C++){var A=E.components[C];var J=this.createElementNS("","RING");for(var G=0,F=A.components.length;G<F;G++){var H=A.components[G];var D=this.createElementNS("","POINT");D.setAttribute("x",H.x);D.setAttribute("y",H.y);J.appendChild(D)}I.appendChild(J)}return I},parseResponse:function(V){if(typeof V=="string"){var M=new OpenLayers.Format.XML();V=M.read(V)}var I=new OpenLayers.Format.ArcXML.Response();var T=V.getElementsByTagName("ERROR");if(T!=null&&T.length>0){I.error=this.getChildValue(T,"Unknown error.")}else{var X=V.getElementsByTagName("RESPONSE");if(X==null||X.length==0){I.error="No RESPONSE tag found in ArcXML response.";return I}var S=X[0].firstChild.nodeName;if(S=="#text"){S=X[0].firstChild.nextSibling.nodeName}if(S=="IMAGE"){var E=V.getElementsByTagName("ENVELOPE");var H=V.getElementsByTagName("OUTPUT");if(E==null||E.length==0){I.error="No ENVELOPE tag found in ArcXML response."}else{if(H==null||H.length==0){I.error="No OUTPUT tag found in ArcXML response."}else{var K=this.parseAttributes(E[0]);var R=this.parseAttributes(H[0]);if(typeof R.type=="string"){I.image={envelope:K,output:{type:R.type,data:this.getChildValue(H[0])}}}else{I.image={envelope:K,output:R}}}}}else{if(S=="FEATURES"){var Z=X[0].getElementsByTagName("FEATURES");var D=Z[0].getElementsByTagName("FEATURECOUNT");I.features.featurecount=D[0].getAttribute("count");if(I.features.featurecount>0){var L=Z[0].getElementsByTagName("ENVELOPE");I.features.envelope=this.parseAttributes(L[0],typeof(0));var B=Z[0].getElementsByTagName("FEATURE");for(var Y=0;Y<B.length;Y++){var J=new OpenLayers.Feature.Vector();var P=B[Y].getElementsByTagName("FIELD");for(var W=0;W<P.length;W++){var C=P[W].getAttribute("name");var G=P[W].getAttribute("value");J.attributes[C]=G}var Q=B[Y].getElementsByTagName("POLYGON");if(Q.length>0){var a=Q[0].getElementsByTagName("RING");var O=[];for(var A=0;A<a.length;A++){var N=[];N.push(this.parsePointGeometry(a[A]));var U=a[A].getElementsByTagName("HOLE");for(var F=0;F<U.length;F++){N.push(this.parsePointGeometry(U[F]))}U=null;O.push(new OpenLayers.Geometry.Polygon(N));N=null}a=null;if(O.length==1){J.geometry=O[0]}else{J.geometry=new OpenLayers.Geometry.MultiPolygon(O)}}I.features.feature.push(J)}}}else{I.error="Unidentified response type."}}}return I},parseAttributes:function(C,A){var B={};for(var D=0;D<C.attributes.length;D++){if(A=="number"){B[C.attributes[D].nodeName]=parseFloat(C.attributes[D].nodeValue)}else{B[C.attributes[D].nodeName]=C.attributes[D].nodeValue}}return B},parsePointGeometry:function(D){var B=[];var E=D.getElementsByTagName("COORDS");if(E.length>0){var A=this.getChildValue(E[0]);A=A.split(/;/);for(var C=0;C<A.length;C++){var H=A[C].split(/ /);B.push(new OpenLayers.Geometry.Point(H[0],H[1]))}E=null}else{var G=D.getElementsByTagName("POINT");if(G.length>0){for(var F=0;F<G.length;F++){B.push(new OpenLayers.Geometry.Point(parseFloat(G[F].getAttribute("x")),parseFloat(G[F].getAttribute("y"))))}}G=null}return new OpenLayers.Geometry.LinearRing(B)},CLASS_NAME:"OpenLayers.Format.ArcXML"});OpenLayers.Format.ArcXML.Request=OpenLayers.Class({initialize:function(A){var B={get_image:{properties:{background:null,draw:true,envelope:{minx:0,miny:0,maxx:0,maxy:0},featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},imagesize:{height:0,width:0,dpi:96,printheight:0,printwidth:0,scalesymbols:false},layerlist:[],output:{baseurl:"",legendbaseurl:"",legendname:"",legendpath:"",legendurl:"",name:"",path:"",type:"jpg",url:""}}},get_feature:{layer:"",query:{isspatial:false,featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},buffer:0,where:"",spatialfilter:{relation:"envelope_intersection",envelope:null}}},environment:{separators:{cs:" ",ts:";"}},layer:[],workspaces:[]};return OpenLayers.Util.extend(this,B)},CLASS_NAME:"OpenLayers.Format.ArcXML.Request"});OpenLayers.Format.ArcXML.Response=OpenLayers.Class({initialize:function(A){var B={image:{envelope:null,output:""},features:{featurecount:0,envelope:null,feature:[]},error:""};return OpenLayers.Util.extend(this,B)},CLASS_NAME:"OpenLayers.Format.ArcXML.Response"});(function(){var E=window.XMLHttpRequest;var D=!!window.controllers,C=window.document.all&&!window.opera,A=C&&window.navigator.userAgent.match(/MSIE 7.0/);function J(){this._object=E&&!A?new E:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}function B(){return new J}B.prototype=J.prototype;if(D&&E.wrapped){B.wrapped=E.wrapped}B.UNSENT=0;B.OPENED=1;B.HEADERS_RECEIVED=2;B.LOADING=3;B.DONE=4;B.prototype.readyState=B.UNSENT;B.prototype.responseText="";B.prototype.responseXML=null;B.prototype.status=0;B.prototype.statusText="";B.prototype.priority="NORMAL";B.prototype.onreadystatechange=null;B.onreadystatechange=null;B.onopen=null;B.onsend=null;B.onabort=null;B.prototype.open=function(R,L,N,M,Q){delete this._headers;if(arguments.length<3){N=true}this._async=N;var S=this,O=this.readyState,P;if(C&&N){P=function(){if(O!=B.DONE){K(S);S.abort()}};window.attachEvent("onunload",P)}if(B.onopen){B.onopen.apply(this,arguments)}if(arguments.length>4){this._object.open(R,L,N,M,Q)}else{if(arguments.length>3){this._object.open(R,L,N,M)}else{this._object.open(R,L,N)}}this.readyState=B.OPENED;I(this);this._object.onreadystatechange=function(){if(D&&!N){return}S.readyState=S._object.readyState;H(S);if(S._aborted){S.readyState=B.UNSENT;return}if(S.readyState==B.DONE){delete S._data;K(S);if(C&&N){window.detachEvent("onunload",P)}}if(O!=S.readyState){I(S)}O=S.readyState}};function G(L){L._object.send(L._data);if(D&&!L._async){L.readyState=B.OPENED;H(L);while(L.readyState<B.DONE){L.readyState++;I(L);if(L._aborted){return}}}}B.prototype.send=function(L){if(B.onsend){B.onsend.apply(this,arguments)}if(!arguments.length){L=null}if(L&&L.nodeType){L=window.XMLSerializer?new window.XMLSerializer().serializeToString(L):L.xml;if(!this._headers["Content-Type"]){this._object.setRequestHeader("Content-Type","application/xml")}}this._data=L;G(this)};B.prototype.abort=function(){if(B.onabort){B.onabort.apply(this,arguments)}if(this.readyState>B.UNSENT){this._aborted=true}this._object.abort();K(this);this.readyState=B.UNSENT;delete this._data};B.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};B.prototype.getResponseHeader=function(L){return this._object.getResponseHeader(L)};B.prototype.setRequestHeader=function(M,L){if(!this._headers){this._headers={}}this._headers[M]=L;return this._object.setRequestHeader(M,L)};B.prototype.addEventListener=function(M,L,N){for(var P=0,O;O=this._listeners[P];P++){if(O[0]==M&&O[1]==L&&O[2]==N){return}}this._listeners.push([M,L,N])};B.prototype.removeEventListener=function(M,L,N){for(var P=0,O;O=this._listeners[P];P++){if(O[0]==M&&O[1]==L&&O[2]==N){break}}if(O){this._listeners.splice(P,1)}};B.prototype.dispatchEvent=function(M){var L={"type":M.type,"target":this,"currentTarget":this,"eventPhase":2,"bubbles":M.bubbles,"cancelable":M.cancelable,"timeStamp":M.timeStamp,"stopPropagation":function(){},"preventDefault":function(){},"initEvent":function(){}};if(L.type=="readystatechange"&&this.onreadystatechange){(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[L])}for(var O=0,N;N=this._listeners[O];O++){if(N[0]==L.type&&!N[2]){(N[1].handleEvent||N[1]).apply(this,[L])}}};B.prototype.toString=function(){return"[object XMLHttpRequest]"};B.toString=function(){return"[XMLHttpRequest]"};function I(L){if(B.onreadystatechange){B.onreadystatechange.apply(L)}L.dispatchEvent({"type":"readystatechange","bubbles":false,"cancelable":false,"timeStamp":new Date+0})}function F(N){var L=N.responseXML,M=N.responseText;if(C&&M&&L&&!L.documentElement&&N.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)){L=new window.ActiveXObject("Microsoft.XMLDOM");L.async=false;L.validateOnParse=false;L.loadXML(M)}if(L){if((C&&L.parseError!=0)||!L.documentElement||(L.documentElement&&L.documentElement.tagName=="parsererror")){return null}}return L}function H(M){try{M.responseText=M._object.responseText}catch(L){}try{M.responseXML=F(M._object)}catch(L){}try{M.status=M._object.status}catch(L){}try{M.statusText=M._object.statusText}catch(L){}}function K(L){L._object.onreadystatechange=new window.Function}if(!window.Function.prototype.apply){window.Function.prototype.apply=function(L,M){if(!M){M=[]}L.__func=this;L.__func(M[0],M[1],M[2],M[3],M[4]);delete L.__func}}if(!OpenLayers.Request){OpenLayers.Request={}}OpenLayers.Request.XMLHttpRequest=B})();OpenLayers.ProxyHost="";if(!OpenLayers.Request){OpenLayers.Request={}}OpenLayers.Util.extend(OpenLayers.Request,{DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:true,user:undefined,password:undefined,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(C,E){var F=C.indexOf("http")!==0;var G=!F&&C.match(this.URL_SPLIT_REGEX);if(G){var B=window.location;F=G[1]==B.protocol&&G[3]==B.hostname;var D=G[4],A=B.port;if(D!=80&&D!=""||A!="80"&&A!=""){F=F&&D==A}}if(!F){if(E){if(typeof E=="function"){C=E(C)}else{C=E+encodeURIComponent(C)}}}return C},issue:function(B){var F=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});B=B||{};B.headers=B.headers||{};B=OpenLayers.Util.applyDefaults(B,F);B.headers=OpenLayers.Util.applyDefaults(B.headers,F.headers);var D=false,A;for(A in B.headers){if(B.headers.hasOwnProperty(A)){if(A.toLowerCase()==="x-requested-with"){D=true}}}if(D===false){B.headers["X-Requested-With"]="XMLHttpRequest"}var C=new OpenLayers.Request.XMLHttpRequest();var G=OpenLayers.Util.urlAppend(B.url,OpenLayers.Util.getParameterString(B.params||{}));G=OpenLayers.Request.makeSameOrigin(G,B.proxy);C.open(B.method,G,B.async,B.user,B.password);for(var I in B.headers){C.setRequestHeader(I,B.headers[I])}var H=this.events;var E=this;C.onreadystatechange=function(){if(C.readyState==OpenLayers.Request.XMLHttpRequest.DONE){var J=H.triggerEvent("complete",{request:C,config:B,requestUrl:G});if(J!==false){E.runCallbacks({request:C,config:B,requestUrl:G})}}};if(B.async===false){C.send(B.data)}else{window.setTimeout(function(){if(C.readyState!==0){C.send(B.data)}},0)}return C},runCallbacks:function(D){var B=D.request;var C=D.config;var A=(C.scope)?OpenLayers.Function.bind(C.callback,C.scope):C.callback;var E;if(C.success){E=(C.scope)?OpenLayers.Function.bind(C.success,C.scope):C.success}var F;if(C.failure){F=(C.scope)?OpenLayers.Function.bind(C.failure,C.scope):C.failure}if(OpenLayers.Util.createUrlObject(C.url).protocol=="file:"&&B.responseText){B.status=200}A(B);if(!B.status||(B.status>=200&&B.status<300)){this.events.triggerEvent("success",D);if(E){E(B)}}if(B.status&&(B.status<200||B.status>=300)){this.events.triggerEvent("failure",D);if(F){F(B)}}},GET:function(A){A=OpenLayers.Util.extend(A,{method:"GET"});return OpenLayers.Request.issue(A)},POST:function(A){A=OpenLayers.Util.extend(A,{method:"POST"});A.headers=A.headers?A.headers:{};if(!("CONTENT-TYPE" in OpenLayers.Util.upperCaseObject(A.headers))){A.headers["Content-Type"]="application/xml"}return OpenLayers.Request.issue(A)},PUT:function(A){A=OpenLayers.Util.extend(A,{method:"PUT"});A.headers=A.headers?A.headers:{};if(!("CONTENT-TYPE" in OpenLayers.Util.upperCaseObject(A.headers))){A.headers["Content-Type"]="application/xml"}return OpenLayers.Request.issue(A)},DELETE:function(A){A=OpenLayers.Util.extend(A,{method:"DELETE"});return OpenLayers.Request.issue(A)},HEAD:function(A){A=OpenLayers.Util.extend(A,{method:"HEAD"});return OpenLayers.Request.issue(A)},OPTIONS:function(A){A=OpenLayers.Util.extend(A,{method:"OPTIONS"});return OpenLayers.Request.issue(A)}});OpenLayers.Layer.ArcIMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{ClientVersion:"9.2",ServiceName:""},featureCoordSys:"4326",filterCoordSys:"4326",layers:null,async:true,name:"ArcIMS",isBaseLayer:true,DEFAULT_OPTIONS:{tileSize:new OpenLayers.Size(512,512),featureCoordSys:"4326",filterCoordSys:"4326",layers:null,isBaseLayer:true,async:true,name:"ArcIMS"},initialize:function(C,A,B){this.tileSize=new OpenLayers.Size(512,512);this.params=OpenLayers.Util.applyDefaults({ServiceName:B.serviceName},this.DEFAULT_PARAMS);this.options=OpenLayers.Util.applyDefaults(B,this.DEFAULT_OPTIONS);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[C,A,this.params,B]);if(this.transparent){if(!this.isBaseLayer){this.isBaseLayer=false}if(this.format=="image/jpeg"){this.format=OpenLayers.Util.alphaHack()?"image/gif":"image/png"}}if(this.options.layers===null){this.options.layers=[]}},getURL:function(C){var B="";C=this.adjustBounds(C);var A=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:C.toArray(),tileSize:this.tileSize}));var E=new OpenLayers.Request.POST({url:this.getFullRequestString(),data:A.write(),async:false});if(E!=null){var G=E.responseXML;if(!G||!G.documentElement){G=E.responseText}var F=new OpenLayers.Format.ArcXML();var D=F.read(G);B=this.getUrlOrImage(D.image.output)}return B},getURLasync:function(C,A,D){C=this.adjustBounds(C);var B=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:C.toArray(),tileSize:this.tileSize}));OpenLayers.Request.POST({url:this.getFullRequestString(),async:true,data:B.write(),callback:function(E){var H=E.responseXML;if(!H||!H.documentElement){H=E.responseText}var G=new OpenLayers.Format.ArcXML();var F=G.read(H);A.call(D,this.getUrlOrImage(F.image.output))},scope:this})},getUrlOrImage:function(B){var A="";if(B.url){A=B.url}else{if(B.data){A="data:image/"+B.type+";base64,"+B.data}}return A},setLayerQuery:function(C,B){for(var A=0;A<this.options.layers.length;A++){if(C==this.options.layers[A].id){this.options.layers[A].query=B;return}}this.options.layers.push({id:C,visible:true,query:B})},getFeatureInfo:function(E,G,C){var H=C.buffer||1;var A=C.callback||function(){};var B=C.scope||window;var I={};OpenLayers.Util.extend(I,this.options);I.requesttype="feature";if(E instanceof OpenLayers.LonLat){I.polygon=null;I.envelope=[E.lon-H,E.lat-H,E.lon+H,E.lat+H]}else{if(E instanceof OpenLayers.Geometry.Polygon){I.envelope=null;I.polygon=E}}var K=new OpenLayers.Format.ArcXML(I);OpenLayers.Util.extend(K.request.get_feature,C);K.request.get_feature.layer=G.id;if(typeof G.query.accuracy=="number"){K.request.get_feature.query.accuracy=G.query.accuracy}else{var J=this.map.getCenter();var D=this.map.getViewPortPxFromLonLat(J);D.x++;var F=this.map.getLonLatFromPixel(D);K.request.get_feature.query.accuracy=F.lon-J.lon}K.request.get_feature.query.where=G.query.where;K.request.get_feature.query.spatialfilter.relation="area_intersection";OpenLayers.Request.POST({url:this.getFullRequestString({"CustomService":"Query"}),data:K.write(),callback:function(L){var M=K.parseResponse(L.responseText);if(!K.iserror()){A.call(B,M.features)}else{A.call(B,null)}}})},clone:function(A){if(A==null){A=new OpenLayers.Layer.ArcIMS(this.name,this.url,this.getOptions())}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);return A},CLASS_NAME:"OpenLayers.Layer.ArcIMS"});OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(A){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y);OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){if(this.map){this.map.events.unregister("buttonclick",this,this.onButtonClick)}this.removeButtons();this.buttons=null;this.position=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(A){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(C){OpenLayers.Control.prototype.draw.apply(this,arguments);C=this.position;this.buttons=[];var A={w:18,h:18};var B=new OpenLayers.Pixel(C.x+A.w/2,C.y);this._addButton("panup","north-mini.png",B,A);C.y=B.y+A.h;this._addButton("panleft","west-mini.png",C,A);this._addButton("panright","east-mini.png",C.add(A.w,0),A);this._addButton("pandown","south-mini.png",B.add(0,A.h*2),A);this._addButton("zoomin","zoom-plus-mini.png",B.add(0,A.h*3+5),A);this._addButton("zoomworld","zoom-world-mini.png",B.add(0,A.h*4+5),A);this._addButton("zoomout","zoom-minus-mini.png",B.add(0,A.h*5+5),A);return this.div},_addButton:function(F,E,A,B){var D=OpenLayers.Util.getImageLocation(E);var C=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+F,A,B,D,"absolute");C.style.cursor="pointer";this.div.appendChild(C);C.action=F;C.className="olButton olCtl_NavBtn";this.buttons.push(C);return C},_addChildButton:function(D,E,A,B){var C=OpenLayers.Util.createDiv(this.id+"_"+E,A,B,null);C.style.cursor="pointer";D.appendChild(C);C.action=E;C.className="olButton olCtl_NavBtn";this.buttons.push(C);return C},_removeChildButton:function(B,A){B.removeChild(A);OpenLayers.Util.removeItem(this.buttons,A)},_removeButton:function(A){if(this.div&&this.div.contains(A)){this.div.removeChild(A)}OpenLayers.Util.removeItem(this.buttons,A)},removeButtons:function(){for(var A=this.buttons.length-1;A>=0;--A){this._removeButton(this.buttons[A])}},onButtonClick:function(A){var B=A.buttonElement;switch(B.action){case"panup":this.map.pan(0,-this.getSlideFactor("h"));break;case"pandown":this.map.pan(0,this.getSlideFactor("h"));break;case"panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case"panright":this.map.pan(this.getSlideFactor("w"),0);break;case"zoomin":this.map.zoomIn();break;case"zoomout":this.map.zoomOut();break;case"zoomworld":this.map.zoomToMaxExtent();break;case"zoomstreet":this.map.zoomTo(18);break;case"zoomcity":this.map.zoomTo(11);break;case"zoomprovince":this.map.zoomTo(7);break;case"zoomcountry":this.map.zoomTo(2);break}},getSlideFactor:function(A){return this.slideRatio?this.map.getSize()[A]*this.slideRatio:this.slideFactor},CLASS_NAME:"OpenLayers.Control.PanZoom"});OpenLayers.Control.PanZoom.X=6;OpenLayers.Control.PanZoom.Y=4;OpenLayers.Control.PanZoomBar=OpenLayers.Class(OpenLayers.Control.PanZoom,{zoomStopWidth:18,zoomStopHeight:6,slider:null,sliderEvents:null,zoombarDiv:null,zoombarBotDiv:null,zoombarMaskDiv:null,panbarDiv:null,zoomHolderDiv:null,zoombarMaskEvents:null,zoomWorldIcon:false,panIcons:true,forceFixedZoomLevel:false,mouseDragStart:null,deltaY:null,zoomStart:null,destroy:function(){this._removePanBar();this._removeZoomBar();this.map.events.un({"changebaselayer":this.redraw,"updatesize":this.redraw,scope:this});OpenLayers.Control.PanZoom.prototype.destroy.apply(this,arguments);delete this.mouseDragStart;delete this.zoomStart},setMap:function(A){OpenLayers.Control.PanZoom.prototype.setMap.apply(this,arguments);this.map.events.on({"changebaselayer":this.redraw,"updatesize":this.redraw,scope:this})},redraw:function(){if(this.div!=null){this._removePanBar();this._removeZoomBar()}this.draw()},draw:function(B){OpenLayers.Control.prototype.draw.apply(this,arguments);B=this.position.clone();B.y=B.y+24;this.buttons=[];var A={w:18,h:18};if(this.panIcons){this._addPanBar(B);this._addZoomBar(B,A)}else{this._addButton("zoomin","zoom-plus-mini.png",B,A);centered=this._addZoomBar(B.add(0,A.h));this._addButton("zoomout","zoom-minus-mini.png",centered,A);if(this.zoomWorldIcon){centered=centered.add(0,A.h+3);this._addButton("zoomworld","zoom-world-mini.png",centered,A)}}return this.div},_addPanBar:function(H){var I=new OpenLayers.Pixel(H.x-4,H.y+7);var A=OpenLayers.Util.getImageLocation("transparent.gif");var E=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_PanBar"+this.map.id,I,{w:42,h:42},null,"absolute");E.className="olCtl_MpPan";var G={w:16,h:16};var C=this._addChildButton(E,"panup",new OpenLayers.Pixel(14,0),G);C.title="向上平移";if(C.attachEvent){C.attachEvent("onmouseover",function(){E.style.backgroundPosition="-15px -45px"});C.attachEvent("onmouseout",function(){E.style.backgroundPosition="-15px 0"})}else{C.addEventListener("mouseover",function(){E.style.backgroundPosition="-15px -45px"},false);C.addEventListener("mouseout",function(){E.style.backgroundPosition="-15px 0"},false)}var D=this._addChildButton(E,"panleft",new OpenLayers.Pixel(1,13),G);D.title="向左平移";if(D.attachEvent){D.attachEvent("onmouseover",function(){E.style.backgroundPosition="-15px -180px"});D.attachEvent("onmouseout",function(){E.style.backgroundPosition="-15px 0"})}else{D.addEventListener("mouseover",function(){E.style.backgroundPosition="-15px -180px"},false);D.addEventListener("mouseout",function(){E.style.backgroundPosition="-15px 0"},false)}var B=this._addChildButton(E,"panright",new OpenLayers.Pixel(27,13),G);B.title="向右平移";if(B.attachEvent){B.attachEvent("onmouseover",function(){E.style.backgroundPosition="-15px -90px"});B.attachEvent("onmouseout",function(){E.style.backgroundPosition="-15px 0"})}else{B.addEventListener("mouseover",function(){E.style.backgroundPosition="-15px -90px"},false);B.addEventListener("mouseout",function(){E.style.backgroundPosition="-15px 0"},false)}var F=this._addChildButton(E,"pandown",new OpenLayers.Pixel(14,27),G);F.title="向下平移";if(F.attachEvent){F.attachEvent("onmouseover",function(){E.style.backgroundPosition="-15px -135px"});F.attachEvent("onmouseout",function(){E.style.backgroundPosition="-15px 0"})}else{F.addEventListener("mouseover",function(){E.style.backgroundPosition="-15px -135px"},false);F.addEventListener("mouseout",function(){E.style.backgroundPosition="-15px 0"},false)}this.panbarDiv=E;this.div.appendChild(E)},_removePanBar:function(){this.div.removeChild(this.panbarDiv);this.panbarDiv=null},_addZoomBar:function(E,B){_zoombardiv=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar"+this.map.id,E.add(0,53),{w:80,h:156},null);this.zoombarDiv=_zoombardiv;var C=new OpenLayers.Pixel(E.x+3,0);var D=this._addChildButton(this.zoombarDiv,"zoomin",C.add(0,0),B);D.title="放大一级";D.style.backgroundPosition="-10px -226px";if(D.attachEvent){D.attachEvent("onmouseover",function(){this.style.backgroundPosition="-10px -248px"});D.attachEvent("onmouseout",function(){this.style.backgroundPosition="-10px -226px"})}else{D.addEventListener("mouseover",function(){this.style.backgroundPosition="-10px -248px"},false);D.addEventListener("mouseout",function(){this.style.backgroundPosition="-10px -226px"},false)}C=this._addZoomSlider(C.add(0,18));var A=this._addChildButton(this.zoombarDiv,"zoomout",C,B);A.title="缩小一级";A.style.backgroundPosition="-10px -270px";if(A.attachEvent){A.attachEvent("onmouseover",function(){this.style.backgroundPosition="-10px -292px"});A.attachEvent("onmouseout",function(){this.style.backgroundPosition="-10px -270px"})}else{A.addEventListener("mouseover",function(){this.style.backgroundPosition="-10px -292px"},false);A.addEventListener("mouseout",function(){this.style.backgroundPosition="-10px -270px"},false)}this._addZoomHolder(new OpenLayers.Pixel(E.x+3,0));this.div.appendChild(_zoombardiv);return C},_addZoomSlider:function(I){if(!this.zoombarDiv){return I}var E=this.id+"_"+this.map.id;var D=this.map.getMinZoom();var F=this.map.getNumZoomLevels()-1-this.map.getZoom();var B=OpenLayers.Util.createDiv(E,I.add(-1,F*this.zoomStopHeight),{w:20,h:10},null);B.title="拖动缩放";B.className="olCtl_NavBtn";B.style.backgroundPosition="-9px -314px";if(B.attachEvent){B.attachEvent("onmouseover",function(){this.style.backgroundPosition="-9px -328px"});B.attachEvent("onmouseout",function(){this.style.backgroundPosition="-9px -314px"})}else{B.addEventListener("mouseover",function(){this.style.backgroundPosition="-9px -328px"},false);B.addEventListener("mouseout",function(){this.style.backgroundPosition="-9px -314px"},false)}B.style.cursor="move";this.slider=B;this.sliderEvents=new OpenLayers.Events(this,B,null,true,{includeXY:true});this.sliderEvents.on({"touchstart":this.zoomBarDown,"touchmove":this.zoomBarDrag,"touchend":this.zoomBarUp,"mousedown":this.zoomBarDown,"mousemove":this.zoomBarDrag,"mouseup":this.zoomBarUp});var A={w:this.zoomStopWidth,h:this.zoomStopHeight*(this.map.getNumZoomLevels()-D)};var G=OpenLayers.Util.getImageLocation("zoombar.png");topdiv=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar"+this.map.id,I.add(5,0),{w:10,h:A.h},null);topdiv.className="olButton olControlSliderBgTop";this.zoombarDiv.appendChild(topdiv);var C=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_ZoombarBot"+this.map.id,I.add(6,F*this.zoomStopHeight),{w:10,h:(this.zoomStopHeight*(2+this.map.getZoom()-this.map.getMinZoom())-1)},null);C.className="olButton olControlSliderBgBot";this.zoombarBotDiv=C;this.zoombarDiv.appendChild(C);var H=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_ZoombarMask"+this.map.id,I.add(-3,0),{w:24,h:A.h},null);H.style.cursor="pointer";H.className="olButton";this.zoombarMaskEvents=new OpenLayers.Events(this,H,null,true,{includeXY:true});this.zoombarMaskEvents.on({"mousemove":this.zoombarMaskMousemove});this.zoombarMaskDiv=H;this.zoombarDiv.appendChild(H);this.startTop=parseInt(topdiv.style.top);this.endBottom=this.startTop+A.h-9;this.zoombarDiv.appendChild(B);this.map.events.register("zoomend",this,this.moveZoomBar);I=I.add(0,this.zoomStopHeight*(this.map.getNumZoomLevels()-D));return I},_addZoomHolder:function(C){if(!this.zoombarDiv){return}_zoomholderdiv=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_ZoomHolder"+this.map.id,C.add(7,0),null,null);_zoomholderdiv.style.display="none";if(this.zoombarDiv.attachEvent){this.zoombarDiv.attachEvent("onmouseover",function(){_zoomholderdiv.style.display="block"});this.zoombarDiv.attachEvent("onmouseout",function(){_zoomholderdiv.style.display="none"})}else{this.zoombarDiv.addEventListener("mouseover",function(){_zoomholderdiv.style.display="block"},false);this.zoombarDiv.addEventListener("mouseout",function(){_zoomholderdiv.style.display="none"},false)}var D={w:23,h:17};var E=this._addChildButton(_zoomholderdiv,"zoomstreet",new OpenLayers.Pixel(12,21),D);E.style.backgroundPosition="-8px -386px";var F=this._addChildButton(_zoomholderdiv,"zoomcity",new OpenLayers.Pixel(12,64),D);F.style.backgroundPosition="-8px -410px";var B=this._addChildButton(_zoomholderdiv,"zoomprovince",new OpenLayers.Pixel(12,88),D);B.style.backgroundPosition="-8px -434px";var A=this._addChildButton(_zoomholderdiv,"zoomcountry",new OpenLayers.Pixel(12,118),D);A.style.backgroundPosition="-8px -458px";this.zoomHolderDiv=_zoomholderdiv;this.zoombarDiv.appendChild(_zoomholderdiv)},_removeZoomBar:function(){this.sliderEvents.un({"touchstart":this.zoomBarDown,"touchmove":this.zoomBarDrag,"touchend":this.zoomBarUp,"mousedown":this.zoomBarDown,"mousemove":this.zoomBarDrag,"mouseup":this.zoomBarUp});this.sliderEvents.destroy();this.zoombarMaskEvents.un({"mouseover":this.zoombarMaskMousemove});this.zoombarMaskEvents.destroy();this.div.removeChild(this.zoombarDiv);this.zoombarDiv=null;this.zoombarBotDiv=null;this.zoombarMaskDiv=null;this.zoomHolderDiv=null;this.slider=null;this.map.events.unregister("zoomend",this,this.moveZoomBar)},zoombarMaskMousemove:function(B){var C=this.map.getNumZoomLevels();var A=Math.floor(C-(B.xy.y)/6)+this.map.getMinZoom();if(A<this.map.getNumZoomLevels()&&A>this.map.getMinZoom()){var D=parseInt(this.map.baseLayer.scales[A]);this.zoombarMaskDiv.title="1:"+this.formatNum(D)}else{this.zoombarMaskDiv.title="放置到此级别"}},formatNum:function(B){if(B.length<=3){return B}if(!/^(\+|-)?(\d+)(\.\d+)?$/.test(B)){return B}var E=RegExp.$1,C=RegExp.$2,D=RegExp.$3;var A=new RegExp();A.compile("(\\d)(\\d{3})(,|$)");while(A.test(C)){C=C.replace(A,"$1,$2$3")}return E+""+C+""+D},onButtonClick:function(B){OpenLayers.Control.PanZoom.prototype.onButtonClick.apply(this,arguments);if(B.buttonElement===this.zoombarMaskDiv){var A=B.buttonXY.y/this.zoomStopHeight;if(this.forceFixedZoomLevel||!this.map.fractionalZoom){A=Math.floor(A)}var C=(this.map.getNumZoomLevels()-1)-A;C=Math.min(Math.max(C,0),this.map.getNumZoomLevels()-1);this.map.zoomTo(C)}},passEventToSlider:function(A){this.sliderEvents.handleBrowserEvent(A)},zoomBarDown:function(A){if(!OpenLayers.Event.isLeftClick(A)&&!OpenLayers.Event.isSingleTouch(A)){return}this.map.events.on({"touchmove":this.passEventToSlider,"mousemove":this.passEventToSlider,"mouseup":this.passEventToSlider,scope:this});this.mouseDragStart=A.xy.clone();this.zoomStart=A.xy.clone();this.div.style.cursor="move";this.zoombarDiv.offsets=null;OpenLayers.Event.stop(A)},zoomBarDrag:function(B){if(this.mouseDragStart!=null){var C=this.mouseDragStart.y-B.xy.y;var A=OpenLayers.Util.pagePosition(this.zoombarDiv);if((B.clientY-A[1])>0&&(B.clientY-A[1])<parseInt(this.zoombarDiv.style.height)-2){var D=parseInt(this.slider.style.top)-C;D=D<(this.startTop+1)?(this.startTop+1):D;D=D>(this.endBottom-1)?(this.endBottom-1):D;this.zoombarBotDiv.style.top=D+"px";this.zoombarBotDiv.style.height=(this.endBottom-D+this.zoomStopHeight*2+9)+"px";D=D<(this.startTop+1)?(this.startTop+1):D;D=D>(this.endBottom-1)?(this.endBottom-1):D;this.slider.style.top=D+"px";this.mouseDragStart=B.xy.clone()}this.deltaY=this.zoomStart.y-B.xy.y;OpenLayers.Event.stop(B)}},zoomBarUp:function(B){if(!OpenLayers.Event.isLeftClick(B)&&B.type!=="touchend"){return}if(this.mouseDragStart){this.div.style.cursor="";this.map.events.un({"touchmove":this.passEventToSlider,"mouseup":this.passEventToSlider,"mousemove":this.passEventToSlider,scope:this});var A=this.map.zoom;A+=this.deltaY/this.zoomStopHeight;A=Math.min(Math.max(A,0),this.map.getNumZoomLevels()-1);this.map.zoomTo(A);this.mouseDragStart=null;this.zoomStart=null;this.deltaY=0;OpenLayers.Event.stop(B)}},moveZoomBar:function(){var A=((this.map.getNumZoomLevels()-1)-this.map.getZoom())*this.zoomStopHeight+this.startTop+1;this.zoombarBotDiv.style.top=A+"px";this.zoombarBotDiv.style.height=(this.zoomStopHeight*(2+this.map.getZoom()-this.map.getMinZoom())-1)+"px";A=A>(this.endBottom-1)?(this.endBottom-1):A;this.slider.style.top=A+"px"},CLASS_NAME:"OpenLayers.Control.PanZoomBar"});OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",CLASS_NAME:"OpenLayers.Format.WFSCapabilities"});OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wfs:"http://www.opengis.net/wfs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},errorProperty:"featureTypeList",defaultPrefix:"wfs",read:function(C){if(typeof C=="string"){C=OpenLayers.Format.XML.prototype.read.apply(this,[C])}var A=C;if(C&&C.nodeType==9){C=C.documentElement}var B={};this.readNode(C,B);return B},readers:{"wfs":{"WFS_Capabilities":function(B,A){this.readChildNodes(B,A)},"FeatureTypeList":function(B,A){A.featureTypeList={featureTypes:[]};this.readChildNodes(B,A.featureTypeList)},"FeatureType":function(C,A){var B={};this.readChildNodes(C,B);A.featureTypes.push(B)},"Name":function(C,B){var D=this.getChildValue(C);if(D){var A=D.split(":");B.name=A.pop();if(A.length>0){B.featureNS=this.lookupNamespaceURI(C,A[0])}}},"Title":function(B,A){var C=this.getChildValue(B);if(C){A.title=C}},"Abstract":function(B,A){var C=this.getChildValue(B);if(C){A["abstract"]=C}}}},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1"});OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},readers:{"wfs":OpenLayers.Util.applyDefaults({"DefaultSRS":function(B,A){var C=this.getChildValue(B);if(C){A.srs=C}}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers["wfs"]),"ows":OpenLayers.Format.OWSCommon.v1.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_1_0"});OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:true,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(D,B,E,A,C){this.url=B;this.extent=E;this.maxExtent=E;this.size=A;OpenLayers.Layer.prototype.initialize.apply(this,[D,C]);this.aspectRatio=(this.extent.getHeight()/this.size.h)/(this.extent.getWidth()/this.size.w)},destroy:function(){if(this.tile){this.removeTileMonitoringHooks(this.tile);this.tile.destroy();this.tile=null}OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(A){if(A==null){A=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions())}A=OpenLayers.Layer.prototype.clone.apply(this,[A]);return A},setMap:function(A){if(this.options.maxResolution==null){this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w}OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(C,B,E){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var D=(this.tile==null);if(B||D){this.setTileSize();var A=this.map.getLayerPxFromLonLat({lon:this.extent.left,lat:this.extent.top});if(D){this.tile=new OpenLayers.Tile.Image(this,A,this.extent,null,this.tileSize);this.addTileMonitoringHooks(this.tile)}else{this.tile.size=this.tileSize.clone();this.tile.position=A.clone()}this.tile.draw()}},setTileSize:function(){var B=this.extent.getWidth()/this.map.getResolution();var A=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(B,A)},addTileMonitoringHooks:function(A){A.onLoadStart=function(){this.events.triggerEvent("loadstart")};A.events.register("loadstart",this,A.onLoadStart);A.onLoadEnd=function(){this.events.triggerEvent("loadend")};A.events.register("loadend",this,A.onLoadEnd);A.events.register("unload",this,A.onLoadEnd)},removeTileMonitoringHooks:function(A){A.unload();A.events.un({"loadstart":A.onLoadStart,"loadend":A.onLoadEnd,"unload":A.onLoadEnd,scope:this})},setUrl:function(A){this.url=A;this.tile.draw()},getURL:function(A){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"});OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:true,autoDestroy:true,initialize:function(A){OpenLayers.Util.extend(this,A);this.options=A;this.active=false},destroy:function(){this.deactivate();this.layer=null;this.options=null},setLayer:function(A){this.layer=A},activate:function(){if(!this.active){this.active=true;return true}return false},deactivate:function(){if(this.active){this.active=false;return true}return false},CLASS_NAME:"OpenLayers.Strategy"});OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,{events:null,auto:false,timer:null,initialize:function(A){OpenLayers.Strategy.prototype.initialize.apply(this,[A]);this.events=new OpenLayers.Events(this)},activate:function(){var A=OpenLayers.Strategy.prototype.activate.call(this);if(A){if(this.auto){if(typeof this.auto==="number"){this.timer=window.setInterval(OpenLayers.Function.bind(this.save,this),this.auto*1000)}else{this.layer.events.on({"featureadded":this.triggerSave,"afterfeaturemodified":this.triggerSave,scope:this})}}}return A},deactivate:function(){var A=OpenLayers.Strategy.prototype.deactivate.call(this);if(A){if(this.auto){if(typeof this.auto==="number"){window.clearInterval(this.timer)}else{this.layer.events.un({"featureadded":this.triggerSave,"afterfeaturemodified":this.triggerSave,scope:this})}}}return A},triggerSave:function(B){var A=B.feature;if(A.state===OpenLayers.State.INSERT||A.state===OpenLayers.State.UPDATE||A.state===OpenLayers.State.DELETE){this.save([B.feature])}},save:function(B){if(!B){B=this.layer.features}this.events.triggerEvent("start",{features:B});var C=this.layer.projection;var G=this.layer.map.getProjectionObject();if(!G.equals(C)){var F=B.length;var E=new Array(F);var H,A;for(var D=0;D<F;++D){H=B[D];A=H.clone();A.fid=H.fid;A.state=H.state;if(H.url){A.url=H.url}A._original=H;A.geometry.transform(G,C);E[D]=A}B=E}this.layer.protocol.commit(B,{callback:this.onCommit,scope:this})},onCommit:function(J){var A={"response":J};if(J.success()){var B=J.reqFeatures;var D,I;var E=[];var G=J.insertIds||[];var C=0;for(var F=0,H=B.length;F<H;++F){I=B[F];I=I._original||I;D=I.state;if(D){if(D==OpenLayers.State.DELETE){E.push(I)}else{if(D==OpenLayers.State.INSERT){I.fid=G[C];++C}}I.state=null}}if(E.length>0){this.layer.destroyFeatures(E)}this.events.triggerEvent("success",A)}else{this.events.triggerEvent("fail",A)}},CLASS_NAME:"OpenLayers.Strategy.Save"});OpenLayers.Events.featureclick=OpenLayers.Class({cache:null,map:null,provides:["featureclick","nofeatureclick","featureover","featureout"],initialize:function(B){this.target=B;if(B.object instanceof OpenLayers.Map){this.setMap(B.object)}else{if(B.object instanceof OpenLayers.Layer.Vector){if(B.object.map){this.setMap(B.object.map)}else{B.object.events.register("added",this,function(C){this.setMap(B.object.map)})}}else{throw ("Listeners for '"+this.provides.join("', '")+"' events can only be registered for OpenLayers.Layer.Vector or OpenLayers.Map instances")}}for(var A=this.provides.length-1;A>=0;--A){B.extensions[this.provides[A]]=true}},setMap:function(A){this.map=A;this.cache={};A.events.register("mousedown",this,this.start,{extension:true});A.events.register("mouseup",this,this.onClick,{extension:true});A.events.register("touchstart",this,this.start,{extension:true});A.events.register("touchmove",this,this.cancel,{extension:true});A.events.register("touchend",this,this.onClick,{extension:true});A.events.register("mousemove",this,this.onMousemove,{extension:true})},start:function(A){this.startEvt=A},cancel:function(A){delete this.startEvt},onClick:function(C){if(!this.startEvt||C.type!=="touchend"&&!OpenLayers.Event.isLeftClick(C)){return}var D=this.getFeatures(this.startEvt);delete this.startEvt;var H,F,B,A={};for(var E=0,G=D.length;E<G;++E){H=D[E];F=H.layer;A[F.id]=true;B=this.triggerEvent("featureclick",{feature:H});if(B===false){break}}for(E=0,G=this.map.layers.length;E<G;++E){F=this.map.layers[E];if(F instanceof OpenLayers.Layer.Vector&&!A[F.id]){this.triggerEvent("nofeatureclick",{layer:F})}}},onMousemove:function(C){delete this.startEvt;var D=this.getFeatures(C);var H={},G=[],J;for(var F=0,I=D.length;F<I;++F){J=D[F];H[J.id]=J;if(!this.cache[J.id]){G.push(J)}}var B=[];for(var A in this.cache){J=this.cache[A];if(J.layer&&J.layer.map){if(!H[J.id]){B.push(J)}}else{delete this.cache[A]}}var E;for(F=0,I=G.length;F<I;++F){J=G[F];this.cache[J.id]=J;E=this.triggerEvent("featureover",{feature:J});if(E===false){break}}for(F=0,I=B.length;F<I;++F){J=B[F];delete this.cache[J.id];E=this.triggerEvent("featureout",{feature:J});if(E===false){break}}},triggerEvent:function(A,C){var D=C.feature?C.feature.layer:C.layer,B=this.target.object;if(B instanceof OpenLayers.Map||B===D){return this.target.triggerEvent(A,C)}},getFeatures:function(B){var H=B.clientX,I=B.clientY,C=[],F=[],K=[],E,G,J,D,A;for(D=this.map.layers.length-1;D>=0;--D){E=this.map.layers[D];if(E.div.style.display!=="none"){if(E.renderer instanceof OpenLayers.Renderer.Elements){if(E instanceof OpenLayers.Layer.Vector){G=document.elementFromPoint(H,I);while(G&&G._featureId){J=E.getFeatureById(G._featureId);if(J){C.push(J);G.style.display="none";F.push(G);G=document.elementFromPoint(H,I)}else{G=false}}}K.push(E);E.div.style.display="none"}else{if(E.renderer instanceof OpenLayers.Renderer.Canvas){J=E.renderer.getFeatureIdFromEvent(B);if(J){C.push(J);K.push(E)}}}}}for(D=0,A=F.length;D<A;++D){F[D].style.display=""}for(D=K.length-1;D>=0;--D){K[D].div.style.display="block"}return C},destroy:function(){for(var A=this.provides.length-1;A>=0;--A){delete this.target.extensions[this.provides[A]]}this.map.events.un({mousemove:this.onMousemove,mousedown:this.start,mouseup:this.onClick,touchstart:this.start,touchmove:this.cancel,touchend:this.onClick,scope:this});delete this.cache;delete this.map;delete this.target}});OpenLayers.Events.nofeatureclick=OpenLayers.Events.featureclick;OpenLayers.Events.featureover=OpenLayers.Events.featureclick;OpenLayers.Events.featureout=OpenLayers.Events.featureclick;OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{defaultDesc:"No description available",extractWaypoints:true,extractTracks:true,extractRoutes:true,extractAttributes:true,namespaces:{gpx:"http://www.topografix.com/GPX/1/1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",creator:"OpenLayers",initialize:function(A){this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[A])},read:function(M){if(typeof M=="string"){M=OpenLayers.Format.XML.prototype.read.apply(this,[M])}var S=[];if(this.extractTracks){var N=M.getElementsByTagName("trk");for(var Q=0,B=N.length;Q<B;Q++){var O={};if(this.extractAttributes){O=this.parseAttributes(N[Q])}var G=this.getElementsByTagNameNS(N[Q],N[Q].namespaceURI,"trkseg");for(var D=0,L=G.length;D<L;D++){var F=this.extractSegment(G[D],"trkpt");S.push(new OpenLayers.Feature.Vector(F,O))}}}if(this.extractRoutes){var R=M.getElementsByTagName("rte");for(var E=0,C=R.length;E<C;E++){var O={};if(this.extractAttributes){O=this.parseAttributes(R[E])}var P=this.extractSegment(R[E],"rtept");S.push(new OpenLayers.Feature.Vector(P,O))}}if(this.extractWaypoints){var J=M.getElementsByTagName("wpt");for(var H=0,B=J.length;H<B;H++){var O={};if(this.extractAttributes){O=this.parseAttributes(J[H])}var I=new OpenLayers.Geometry.Point(J[H].getAttribute("lon"),J[H].getAttribute("lat"));S.push(new OpenLayers.Feature.Vector(I,O))}}if(this.internalProjection&&this.externalProjection){for(var K=0,A=S.length;K<A;K++){S[K].geometry.transform(this.externalProjection,this.internalProjection)}}return S},extractSegment:function(D,F){var C=this.getElementsByTagNameNS(D,D.namespaceURI,F);var A=[];for(var B=0,E=C.length;B<E;B++){A.push(new OpenLayers.Geometry.Point(C[B].getAttribute("lon"),C[B].getAttribute("lat")))}return new OpenLayers.Geometry.LineString(A)},parseAttributes:function(B){var A={};var C=B.firstChild,E,D;while(C){if(C.nodeType==1&&C.firstChild){E=C.firstChild;if(E.nodeType==3||E.nodeType==4){D=(C.prefix)?C.nodeName.split(":")[1]:C.nodeName;if(D!="trkseg"&&D!="rtept"){A[D]=E.nodeValue}}}C=C.nextSibling}return A},write:function(A,E){A=OpenLayers.Util.isArray(A)?A:[A];var D=this.createElementNS(this.namespaces.gpx,"gpx");D.setAttribute("version","1.1");D.setAttribute("creator",this.creator);this.setAttributes(D,{"xsi:schemaLocation":this.schemaLocation});if(E&&typeof E=="object"){D.appendChild(this.buildMetadataNode(E))}for(var B=0,C=A.length;B<C;B++){D.appendChild(this.buildFeatureNode(A[B]))}return OpenLayers.Format.XML.prototype.write.apply(this,[D])},buildMetadataNode:function(F){var E=["name","desc","author"],C=this.createElementNS(this.namespaces.gpx,"metadata");for(var B=0;B<E.length;B++){var A=E[B];if(F[A]){var D=this.createElementNS(this.namespaces.gpx,A);D.appendChild(this.createTextNode(F[A]));C.appendChild(D)}}return C},buildFeatureNode:function(B){var F=B.geometry;F=F.clone();if(this.internalProjection&&this.externalProjection){F.transform(this.internalProjection,this.externalProjection)}if(F.CLASS_NAME=="OpenLayers.Geometry.Point"){var A=this.buildWptNode(F);this.appendAttributesNode(A,B);return A}else{var E=this.createElementNS(this.namespaces.gpx,"trk");this.appendAttributesNode(E,B);var C=this.buildTrkSegNode(F);C=OpenLayers.Util.isArray(C)?C:[C];for(var D=0,G=C.length;D<G;D++){E.appendChild(C[D])}return E}},buildTrkSegNode:function(E){var D,B,F,C,A;if(E.CLASS_NAME=="OpenLayers.Geometry.LineString"||E.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){D=this.createElementNS(this.namespaces.gpx,"trkseg");for(B=0,F=E.components.length;B<F;B++){C=E.components[B];D.appendChild(this.buildTrkPtNode(C))}return D}else{A=[];for(B=0,F=E.components.length;B<F;B++){A.push(this.buildTrkSegNode(E.components[B]))}return A}},buildTrkPtNode:function(A){var B=this.createElementNS(this.namespaces.gpx,"trkpt");B.setAttribute("lon",A.x);B.setAttribute("lat",A.y);return B},buildWptNode:function(B){var A=this.createElementNS(this.namespaces.gpx,"wpt");A.setAttribute("lon",B.x);A.setAttribute("lat",B.y);return A},appendAttributesNode:function(C,A){var D=this.createElementNS(this.namespaces.gpx,"name");D.appendChild(this.createTextNode(A.attributes.name||A.id));C.appendChild(D);var B=this.createElementNS(this.namespaces.gpx,"desc");B.appendChild(this.createTextNode(A.attributes.description||this.defaultDesc));C.appendChild(B)},CLASS_NAME:"OpenLayers.Format.GPX"});OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer"});OpenLayers.Format.WMSDescribeLayer.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,{initialize:function(A){OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this,[A])},read:function(B){if(typeof B=="string"){B=OpenLayers.Format.XML.prototype.read.apply(this,[B])}var F=B.documentElement;var D=F.childNodes;var A={layerDescriptions:[]};var M,C;for(var H=0;H<D.length;++H){M=D[H];C=M.nodeName;if(C=="LayerDescription"){var G=M.getAttribute("name");var E="";var I="";var J="";if(M.getAttribute("owsType")){E=M.getAttribute("owsType");I=M.getAttribute("owsURL")}else{if(M.getAttribute("wfs")!=""){E="WFS";I=M.getAttribute("wfs")}else{if(M.getAttribute("wcs")!=""){E="WCS";I=M.getAttribute("wcs")}}}var L=M.getElementsByTagName("Query");if(L.length>0){J=L[0].getAttribute("typeName");if(!J){J=L[0].getAttribute("typename")}}var K={layerName:G,owsType:E,owsURL:I,typeName:J};A.layerDescriptions.push(K);A.length=A.layerDescriptions.length;A[A.length-1]=K}else{if(C=="ServiceException"){var N=new OpenLayers.Format.OGCExceptionReport();return{error:N.read(B)}}}}return A},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer.v1_1_1"});OpenLayers.Format.WMSDescribeLayer.v1_1_0=OpenLayers.Format.WMSDescribeLayer.v1_1_1;OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,sphericalMercator:false,zoomOffset:0,serverResolutions:null,initialize:function(C,A,B){if(B&&B.sphericalMercator||this.sphericalMercator){B=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},B)}OpenLayers.Layer.Grid.prototype.initialize.apply(this,[C||this.name,A||this.url,{},B])},clone:function(A){if(A==null){A=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions())}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);return A},getURL:function(B){var D=this.getXYZ(B);var A=this.url;if(OpenLayers.Util.isArray(A)){var C=""+D.x+D.y+D.z;A=this.selectUrl(C,A)}return OpenLayers.String.format(A,D)},getXYZ:function(A){var C=this.getServerResolution();var D=Math.round((A.left-this.maxExtent.left)/(C*this.tileSize.w));var E=Math.round((this.maxExtent.top-A.top)/(C*this.tileSize.h));var B=this.getServerZoom();if(this.wrapDateLine){var F=Math.pow(2,B);D=((D%F)+F)%F}return{"x":D,"y":E,"z":B}},setMap:function(A){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);if(!this.tileOrigin){this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom)}},CLASS_NAME:"OpenLayers.Layer.XYZ"});OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",url:["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],attribution:"&copy; <a href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors",sphericalMercator:true,wrapDateLine:true,tileOptions:null,initialize:function(C,A,B){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options&&this.options.tileOptions)},clone:function(A){if(A==null){A=new OpenLayers.Layer.OSM(this.name,this.url,this.getOptions())}A=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[A]);return A},CLASS_NAME:"OpenLayers.Layer.OSM"});OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:false,size:null,resolution:null,map:null,featureDx:0,initialize:function(A,B){this.container=OpenLayers.Util.getElement(A);OpenLayers.Util.extend(this,B)},destroy:function(){this.container=null;this.extent=null;this.size=null;this.resolution=null;this.map=null},supported:function(){return false},setExtent:function(C,B){this.extent=C.clone();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var A=C.getWidth()/this.map.getExtent().getWidth(),C=C.scale(1/A);this.extent=C.wrapDateLine(this.map.getMaxExtent()).scale(A)}if(B){this.resolution=null}return true},setSize:function(A){this.size=A.clone();this.resolution=null},getResolution:function(){this.resolution=this.resolution||this.map.getResolution();return this.resolution},drawFeature:function(H,E){if(E==null){E=H.style}if(H.geometry){var B=H.geometry.getBounds();if(B){var D;if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){D=this.map.getMaxExtent()}if(!B.intersectsBounds(this.extent,{worldBounds:D})){E={display:"none"}}else{this.calculateFeatureDx(B,D)}var A=this.drawGeometry(H.geometry,E,H.id);if(E.display!="none"&&E.label&&A!==false){var G=H.geometry.getCentroid();if(E.labelXOffset||E.labelYOffset){var F=isNaN(E.labelXOffset)?0:E.labelXOffset;var I=isNaN(E.labelYOffset)?0:E.labelYOffset;var C=this.getResolution();G.move(F*C,I*C)}this.drawText(H.id,E,G)}else{this.removeText(H.id)}return A}}},calculateFeatureDx:function(C,F){this.featureDx=0;if(F){var A=F.getWidth(),B=(this.extent.left+this.extent.right)/2,D=(C.left+C.right)/2,E=Math.round((D-B)/A);this.featureDx=E*A}},drawGeometry:function(C,B,A){},drawText:function(A,C,B){},removeText:function(A){},clear:function(){},getFeatureIdFromEvent:function(A){},eraseFeatures:function(A){if(!(OpenLayers.Util.isArray(A))){A=[A]}for(var B=0,C=A.length;B<C;++B){var D=A[B];this.eraseGeometry(D.geometry,D.id);this.removeText(D.id)}},eraseGeometry:function(B,A){},moveRoot:function(A){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(A){var B=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);if(A.stroke===false){delete B.strokeWidth;delete B.strokeColor}if(A.fill===false){delete B.fillColor}OpenLayers.Util.extend(B,A);return B},CLASS_NAME:"OpenLayers.Renderer"});OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"};OpenLayers.Renderer.symbol={"star":[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],"cross":[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],"x":[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],"square":[0,0,0,1,1,1,1,0,0,0],"triangle":[0,10,10,10,5,0,0,10]};OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:true,hitOverflow:0,canvas:null,features:null,pendingRedraw:false,cachedSymbolBounds:{},initialize:function(A,B){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.root=document.createElement("canvas");this.container.appendChild(this.root);this.canvas=this.root.getContext("2d");this.features={};if(this.hitDetection){this.hitCanvas=document.createElement("canvas");this.hitContext=this.hitCanvas.getContext("2d")}},setExtent:function(){OpenLayers.Renderer.prototype.setExtent.apply(this,arguments);return false},eraseGeometry:function(B,A){this.eraseFeatures(this.features[A][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(A){this.size=A.clone();var B=this.root;B.style.width=A.w+"px";B.style.height=A.h+"px";B.width=A.w;B.height=A.h;this.resolution=null;if(this.hitDetection){var C=this.hitCanvas;C.style.width=A.w+"px";C.style.height=A.h+"px";C.width=A.w;C.height=A.h}},drawFeature:function(A,D){var B;if(A.geometry){D=this.applyDefaultSymbolizer(D||A.style);var C=A.geometry.getBounds();var E;if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){E=this.map.getMaxExtent()}var F=C&&C.intersectsBounds(this.extent,{worldBounds:E});B=(D.display!=="none")&&!!C&&F;if(B){this.features[A.id]=[A,D]}else{delete (this.features[A.id])}this.pendingRedraw=true}if(this.pendingRedraw&&!this.locked){this.redraw();this.pendingRedraw=false}return B},drawGeometry:function(E,D,A){var B=E.CLASS_NAME;if((B=="OpenLayers.Geometry.Collection")||(B=="OpenLayers.Geometry.MultiPoint")||(B=="OpenLayers.Geometry.MultiLineString")||(B=="OpenLayers.Geometry.MultiPolygon")){for(var C=0;C<E.components.length;C++){this.drawGeometry(E.components[C],D,A)}return}switch(E.CLASS_NAME){case"OpenLayers.Geometry.Point":this.drawPoint(E,D,A);break;case"OpenLayers.Geometry.LineString":this.drawLineString(E,D,A);break;case"OpenLayers.Geometry.LinearRing":this.drawLinearRing(E,D,A);break;case"OpenLayers.Geometry.Polygon":this.drawPolygon(E,D,A);break;default:break}},drawExternalGraphic:function(E,F,B){var A=new Image();var H=F.title||F.graphicTitle;if(H){A.title=H}var G=F.graphicWidth||F.graphicHeight;var K=F.graphicHeight||F.graphicWidth;G=G?G:F.pointRadius*2;K=K?K:F.pointRadius*2;var I=(F.graphicXOffset!=undefined)?F.graphicXOffset:-(0.5*G);var J=(F.graphicYOffset!=undefined)?F.graphicYOffset:-(0.5*K);var D=F.graphicOpacity||F.fillOpacity;var C=function(){if(!this.features[B]){return}var O=this.getLocalXY(E);var M=O[0];var P=O[1];if(!isNaN(M)&&!isNaN(P)){var Q=(M+I)|0;var R=(P+J)|0;var L=this.canvas;L.globalAlpha=D;var N=OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);L.drawImage(A,Q*N,R*N,G*N,K*N);if(this.hitDetection){this.setHitContextStyle("fill",B);this.hitContext.fillRect(Q,R,G,K)}}};A.onload=OpenLayers.Function.bind(C,this);A.src=F.externalGraphic},drawNamedSymbol:function(M,Q,I){var O,P,A,J,C,B,L,F;var D;var N=Math.PI/180;var K=OpenLayers.Renderer.symbol[Q.graphicName];if(!K){throw new Error(Q.graphicName+" is not a valid symbol name")}if(!K.length||K.length<2){return}var G=this.getLocalXY(M);var H=G[0];var E=G[1];if(isNaN(H)||isNaN(E)){return}this.canvas.lineCap="round";this.canvas.lineJoin="round";if(this.hitDetection){this.hitContext.lineCap="round";this.hitContext.lineJoin="round"}if(Q.graphicName in this.cachedSymbolBounds){B=this.cachedSymbolBounds[Q.graphicName]}else{B=new OpenLayers.Bounds();for(C=0;C<K.length;C+=2){B.extend(new OpenLayers.LonLat(K[C],K[C+1]))}this.cachedSymbolBounds[Q.graphicName]=B}this.canvas.save();if(this.hitDetection){this.hitContext.save()}this.canvas.translate(H,E);if(this.hitDetection){this.hitContext.translate(H,E)}F=N*Q.rotation;if(!isNaN(F)){this.canvas.rotate(F);if(this.hitDetection){this.hitContext.rotate(F)}}L=2*Q.pointRadius/Math.max(B.getWidth(),B.getHeight());this.canvas.scale(L,L);if(this.hitDetection){this.hitContext.scale(L,L)}A=B.getCenterLonLat().lon;J=B.getCenterLonLat().lat;this.canvas.translate(-A,-J);if(this.hitDetection){this.hitContext.translate(-A,-J)}D=Q.strokeWidth;Q.strokeWidth=D/L;if(Q.fill!==false){this.setCanvasStyle("fill",Q);this.canvas.beginPath();for(C=0;C<K.length;C=C+2){O=K[C];P=K[C+1];if(C==0){this.canvas.moveTo(O,P)}this.canvas.lineTo(O,P)}this.canvas.closePath();this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",I,Q);this.hitContext.beginPath();for(C=0;C<K.length;C=C+2){O=K[C];P=K[C+1];if(C==0){this.canvas.moveTo(O,P)}this.hitContext.lineTo(O,P)}this.hitContext.closePath();this.hitContext.fill()}}if(Q.stroke!==false){this.setCanvasStyle("stroke",Q);this.canvas.beginPath();for(C=0;C<K.length;C=C+2){O=K[C];P=K[C+1];if(C==0){this.canvas.moveTo(O,P)}this.canvas.lineTo(O,P)}this.canvas.closePath();this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",I,Q,L);this.hitContext.beginPath();for(C=0;C<K.length;C=C+2){O=K[C];P=K[C+1];if(C==0){this.hitContext.moveTo(O,P)}this.hitContext.lineTo(O,P)}this.hitContext.closePath();this.hitContext.stroke()}}Q.strokeWidth=D;this.canvas.restore();if(this.hitDetection){this.hitContext.restore()}this.setCanvasStyle("reset")},setCanvasStyle:function(A,B){if(A==="fill"){this.canvas.globalAlpha=B["fillOpacity"];this.canvas.fillStyle=B["fillColor"]}else{if(A==="stroke"){this.canvas.globalAlpha=B["strokeOpacity"];this.canvas.strokeStyle=B["strokeColor"];this.canvas.lineWidth=B["strokeWidth"]}else{this.canvas.globalAlpha=0;this.canvas.lineWidth=1}}},featureIdToHex:function(A){var D=Number(A.split("_").pop())+1;if(D>=16777216){this.hitOverflow=D-16777215;D=D%16777216+1}var C="000000"+D.toString(16);var B=C.length;C="#"+C.substring(B-6,B);return C},setHitContextStyle:function(A,D,B,C){var E=this.featureIdToHex(D);if(A=="fill"){this.hitContext.globalAlpha=1;this.hitContext.fillStyle=E}else{if(A=="stroke"){this.hitContext.globalAlpha=1;this.hitContext.strokeStyle=E;if(typeof C==="undefined"){this.hitContext.lineWidth=B.strokeWidth+2}else{if(!isNaN(C)){this.hitContext.lineWidth=B.strokeWidth+2/C}}}else{this.hitContext.globalAlpha=0;this.hitContext.lineWidth=1}}},drawPoint:function(C,D,B){if(D.graphic!==false){if(D.externalGraphic){this.drawExternalGraphic(C,D,B)}else{if(D.graphicName&&(D.graphicName!="circle")){this.drawNamedSymbol(C,D,B)}else{var A=this.getLocalXY(C);var G=A[0];var E=A[1];if(!isNaN(G)&&!isNaN(E)){var H=Math.PI*2;var F=D.pointRadius;if(D.fill!==false){this.setCanvasStyle("fill",D);this.canvas.beginPath();this.canvas.arc(G,E,F,0,H,true);this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",B,D);this.hitContext.beginPath();this.hitContext.arc(G,E,F,0,H,true);this.hitContext.fill()}}if(D.stroke!==false){this.setCanvasStyle("stroke",D);this.canvas.beginPath();this.canvas.arc(G,E,F,0,H,true);this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",B,D);this.hitContext.beginPath();this.hitContext.arc(G,E,F,0,H,true);this.hitContext.stroke()}this.setCanvasStyle("reset")}}}}}},drawLineString:function(C,B,A){B=OpenLayers.Util.applyDefaults({fill:false},B);this.drawLinearRing(C,B,A)},drawLinearRing:function(C,B,A){if(B.fill!==false){this.setCanvasStyle("fill",B);this.renderPath(this.canvas,C,B,A,"fill");if(this.hitDetection){this.setHitContextStyle("fill",A,B);this.renderPath(this.hitContext,C,B,A,"fill")}}if(B.stroke!==false){this.setCanvasStyle("stroke",B);this.renderPath(this.canvas,C,B,A,"stroke");if(this.hitDetection){this.setHitContextStyle("stroke",A,B);this.renderPath(this.hitContext,C,B,A,"stroke")}}this.setCanvasStyle("reset")},renderPath:function(D,E,G,C,J){var F=E.components;var I=F.length;D.beginPath();var B=this.getLocalXY(F[0]);var K=B[0];var L=B[1];if(!isNaN(K)&&!isNaN(L)){D.moveTo(B[0],B[1]);for(var H=1;H<I;++H){var A=this.getLocalXY(F[H]);D.lineTo(A[0],A[1])}if(J==="fill"){D.fill()}else{D.stroke()}}},drawPolygon:function(D,C,A){var F=D.components;var E=F.length;this.drawLinearRing(F[0],C,A);for(var B=1;B<E;++B){this.canvas.globalCompositeOperation="destination-out";if(this.hitDetection){this.hitContext.globalCompositeOperation="destination-out"}this.drawLinearRing(F[B],OpenLayers.Util.applyDefaults({stroke:false,fillOpacity:1},C),A);this.canvas.globalCompositeOperation="source-over";if(this.hitDetection){this.hitContext.globalCompositeOperation="source-over"}this.drawLinearRing(F[B],OpenLayers.Util.applyDefaults({fill:false},C),A)}},drawText:function(I,F){var A=this.getLocalXY(I);this.setCanvasStyle("reset");this.canvas.fillStyle=F.fontColor;this.canvas.globalAlpha=F.fontOpacity||1;var D=[F.fontStyle?F.fontStyle:"normal","normal",F.fontWeight?F.fontWeight:"normal",F.fontSize?F.fontSize:"1em",F.fontFamily?F.fontFamily:"sans-serif"].join(" ");var K=F.label.split("\n");var H=K.length;if(this.canvas.fillText){this.canvas.font=D;this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[F.labelAlign[0]]||"center";this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[F.labelAlign[1]]||"middle";var C=OpenLayers.Renderer.Canvas.LABEL_FACTOR[F.labelAlign[1]];if(C==null){C=-0.5}var G=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;A[1]+=G*C*(H-1);for(var E=0;E<H;E++){if(F.labelOutlineWidth){this.canvas.save();this.canvas.globalAlpha=F.labelOutlineOpacity||F.fontOpacity||1;this.canvas.strokeStyle=F.labelOutlineColor;this.canvas.lineWidth=F.labelOutlineWidth;this.canvas.strokeText(K[E],A[0],A[1]+(G*E)+1);this.canvas.restore()}this.canvas.fillText(K[E],A[0],A[1]+(G*E))}}else{if(this.canvas.mozDrawText){this.canvas.mozTextStyle=D;var L=OpenLayers.Renderer.Canvas.LABEL_FACTOR[F.labelAlign[0]];if(L==null){L=-0.5}var C=OpenLayers.Renderer.Canvas.LABEL_FACTOR[F.labelAlign[1]];if(C==null){C=-0.5}var G=this.canvas.mozMeasureText("xx");A[1]+=G*(1+(C*H));for(var E=0;E<H;E++){var J=A[0]+(L*this.canvas.mozMeasureText(K[E]));var B=A[1]+(E*G);this.canvas.translate(J,B);this.canvas.mozDrawText(K[E]);this.canvas.translate(-J,-B)}}}this.setCanvasStyle("reset")},getLocalXY:function(A){var D=this.getResolution();var B=this.extent;var C=((A.x-this.featureDx)/D+(-B.left/D));var E=((B.top/D)-A.y/D);return[C,E]},clear:function(){var A=this.root.height;var B=this.root.width;this.canvas.clearRect(0,0,B,A);this.features={};if(this.hitDetection){this.hitContext.clearRect(0,0,B,A)}},getFeatureIdFromEvent:function(A){var B,I;if(this.hitDetection&&this.root.style.display!=="none"){if(!this.map.dragging){var D=A.xy;var G=D.x|0;var H=D.y|0;var C=this.hitContext.getImageData(G,H,1,1).data;if(C[3]===255){var F=C[2]+(256*(C[1]+(256*C[0])));if(F){B="OpenLayers_Feature_Vector_"+(F-1+this.hitOverflow);try{I=this.features[B][0]}catch(E){}}}}}return I},eraseFeatures:function(A){if(!(OpenLayers.Util.isArray(A))){A=[A]}for(var B=0;B<A.length;++B){delete this.features[A[B].id]}this.redraw()},redraw:function(){if(!this.locked){var B=this.root.height;var G=this.root.width;this.canvas.clearRect(0,0,G,B);if(this.hitDetection){this.hitContext.clearRect(0,0,G,B)}var J=[];var I,D,F;var C=(this.map.baseLayer&&this.map.baseLayer.wrapDateLine)&&this.map.getMaxExtent();for(var A in this.features){if(!this.features.hasOwnProperty(A)){continue}I=this.features[A][0];D=I.geometry;this.calculateFeatureDx(D.getBounds(),C);F=this.features[A][1];this.drawGeometry(D,F,I.id);if(F.label){J.push([I,F])}}var K;for(var E=0,H=J.length;E<H;++E){K=J[E];this.drawText(K[0].geometry.getCentroid(),K[1])}}},CLASS_NAME:"OpenLayers.Renderer.Canvas"});OpenLayers.Renderer.Canvas.LABEL_ALIGN={"l":"left","r":"right","t":"top","b":"bottom"};OpenLayers.Renderer.Canvas.LABEL_FACTOR={"l":0,"r":-1,"t":0,"b":-1};OpenLayers.Renderer.Canvas.drawImageScaleFactor=null;OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,{checkTags:false,interestingTagsExclude:null,areaTags:null,initialize:function(C){var D={"interestingTagsExclude":["source","source_ref","source:ref","history","attribution","created_by"],"areaTags":["area","building","leisure","tourism","ruins","historic","landuse","military","natural","sport"]};D=OpenLayers.Util.extend(D,C);var B={};for(var A=0;A<D.interestingTagsExclude.length;A++){B[D.interestingTagsExclude[A]]=true}D.interestingTagsExclude=B;var E={};for(var A=0;A<D.areaTags.length;A++){E[D.areaTags[A]]=true}D.areaTags=E;this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[D])},read:function(H){if(typeof H=="string"){H=OpenLayers.Format.XML.prototype.read.apply(this,[H])}var O=this.getNodes(H);var I=this.getWays(H);var N=new Array(I.length);for(var F=0;F<I.length;F++){var D=new Array(I[F].nodes.length);var A=this.isWayArea(I[F])?1:0;for(var J=0;J<I[F].nodes.length;J++){var G=O[I[F].nodes[J]];var L=new OpenLayers.Geometry.Point(G.lon,G.lat);L.osm_id=parseInt(I[F].nodes[J]);D[J]=L;G.used=true}var E=null;if(A){E=new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(D))}else{E=new OpenLayers.Geometry.LineString(D)}if(this.internalProjection&&this.externalProjection){E.transform(this.externalProjection,this.internalProjection)}var K=new OpenLayers.Feature.Vector(E,I[F].tags);K.osm_id=parseInt(I[F].id);K.fid="way."+K.osm_id;N[F]=K}for(var B in O){var G=O[B];if(!G.used||this.checkTags){var M=null;if(this.checkTags){var C=this.getTags(G.node,true);if(G.used&&!C[1]){continue}M=C[0]}else{M=this.getTags(G.node)}var K=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(G["lon"],G["lat"]),M);if(this.internalProjection&&this.externalProjection){K.geometry.transform(this.externalProjection,this.internalProjection)}K.osm_id=parseInt(B);K.fid="node."+K.osm_id;N.push(K)}G.node=null}return N},getNodes:function(F){var D=F.getElementsByTagName("node");var C={};for(var A=0;A<D.length;A++){var B=D[A];var E=B.getAttribute("id");C[E]={"lat":B.getAttribute("lat"),"lon":B.getAttribute("lon"),"node":B}}return C},getWays:function(F){var D=F.getElementsByTagName("way");var A=[];for(var E=0;E<D.length;E++){var H=D[E];var G={id:H.getAttribute("id")};G.tags=this.getTags(H);var B=H.getElementsByTagName("nd");G.nodes=new Array(B.length);for(var C=0;C<B.length;C++){G.nodes[C]=B[C].getAttribute("ref")}A.push(G)}return A},getTags:function(F,E){var B=F.getElementsByTagName("tag");var D={};var C=false;for(var G=0;G<B.length;G++){var A=B[G].getAttribute("k");D[A]=B[G].getAttribute("v");if(E){if(!this.interestingTagsExclude[A]){C=true}}}return E?[D,C]:D},isWayArea:function(C){var D=false;var B=false;if(C.nodes[0]==C.nodes[C.nodes.length-1]){D=true}if(this.checkTags){for(var A in C.tags){if(this.areaTags[A]){B=true;break}}}return D&&(this.checkTags?B:true)},write:function(A){if(!(OpenLayers.Util.isArray(A))){A=[A]}this.osm_id=1;this.created_nodes={};var C=this.createElementNS(null,"osm");C.setAttribute("version","0.5");C.setAttribute("generator","OpenLayers "+OpenLayers.VERSION_NUMBER);for(var B=A.length-1;B>=0;B--){var D=this.createFeatureNodes(A[B]);for(var E=0;E<D.length;E++){C.appendChild(D[E])}}return OpenLayers.Format.XML.prototype.write.apply(this,[C])},createFeatureNodes:function(B){var E=[];var D=B.geometry.CLASS_NAME;var A=D.substring(D.lastIndexOf(".")+1);A=A.toLowerCase();var C=this.createXML[A];if(C){E=C.apply(this,[B])}return E},createXML:{"point":function(A){var E=null;var D=A.geometry?A.geometry:A;if(this.internalProjection&&this.externalProjection){D=D.clone();D.transform(this.internalProjection,this.externalProjection)}var C=false;if(A.osm_id){E=A.osm_id;if(this.created_nodes[E]){C=true}}else{E=-this.osm_id;this.osm_id++}if(C){B=this.created_nodes[E]}else{var B=this.createElementNS(null,"node")}this.created_nodes[E]=B;B.setAttribute("id",E);B.setAttribute("lon",D.x);B.setAttribute("lat",D.y);if(A.attributes){this.serializeTags(A,B)}this.setState(A,B);return C?[]:[B]},linestring:function(H){var F;var G=[];var C=H.geometry;if(H.osm_id){F=H.osm_id}else{F=-this.osm_id;this.osm_id++}var I=this.createElementNS(null,"way");I.setAttribute("id",F);for(var D=0;D<C.components.length;D++){var E=this.createXML["point"].apply(this,[C.components[D]]);if(E.length){E=E[0];var A=E.getAttribute("id");G.push(E)}else{A=C.components[D].osm_id;E=this.created_nodes[A]}this.setState(H,E);var B=this.createElementNS(null,"nd");B.setAttribute("ref",A);I.appendChild(B)}this.serializeTags(H,I);G.push(I);return G},polygon:function(A){var C=OpenLayers.Util.extend({"area":"yes"},A.attributes);var B=new OpenLayers.Feature.Vector(A.geometry.components[0],C);B.osm_id=A.osm_id;return this.createXML["linestring"].apply(this,[B])}},serializeTags:function(B,D){for(var A in B.attributes){var C=this.createElementNS(null,"tag");C.setAttribute("k",A);C.setAttribute("v",B.attributes[A]);D.appendChild(C)}},setState:function(A,B){if(A.state){var C=null;switch(A.state){case OpenLayers.State.UPDATE:C="modify";case OpenLayers.State.DELETE:C="delete"}if(C){B.setAttribute("action",C)}}},CLASS_NAME:"OpenLayers.Format.OSM"});OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(B,C,A){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate();this.eventListener=null;OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.observeElement=this.observeElement||document;for(var A=0,B=this.KEY_EVENTS.length;A<B;A++){OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[A],this.eventListener)}return true}else{return false}},deactivate:function(){var B=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var A=0,C=this.KEY_EVENTS.length;A<C;A++){OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[A],this.eventListener)}B=true}return B},handleKeyEvent:function(A){if(this.checkModifiers(A)){this.callback(A.type,[A])}},CLASS_NAME:"OpenLayers.Handler.Keyboard"});OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{documentDrag:false,geometryTypes:null,clickout:true,toggle:true,standalone:false,layer:null,feature:null,vertex:null,vertices:null,virtualVertices:null,handlers:null,deleteCodes:null,virtualStyle:null,vertexRenderIntent:null,mode:null,createVertices:true,modified:false,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(D,C){C=C||{};this.layer=D;this.vertices=[];this.virtualVertices=[];this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer(null,C.vertexRenderIntent));this.virtualStyle.fillOpacity=0.3;this.virtualStyle.strokeOpacity=0.3;this.deleteCodes=[46,68];this.mode=OpenLayers.Control.ModifyFeature.RESHAPE;OpenLayers.Control.prototype.initialize.apply(this,[C]);if(!(OpenLayers.Util.isArray(this.deleteCodes))){this.deleteCodes=[this.deleteCodes]}var B={down:function(F){this.vertex=null;var G=this.layer.getFeatureFromEvent(this.handlers.drag.evt);if(G){this.dragStart(G)}else{if(this.clickout){this._unselect=this.feature}}},move:function(F){delete this._unselect;if(this.vertex){this.dragVertex(this.vertex,F)}},up:function(){this.handlers.drag.stopDown=false;if(this._unselect){this.unselectFeature(this._unselect);delete this._unselect}},done:function(F){if(this.vertex){this.dragComplete(this.vertex)}}};var A={documentDrag:this.documentDrag,stopDown:false};var E={keydown:this.handleKeypress};this.handlers={keyboard:new OpenLayers.Handler.Keyboard(this,E),drag:new OpenLayers.Handler.Drag(this,B,A)}},destroy:function(){if(this.map){this.map.events.un({"removelayer":this.handleMapEvents,"changelayer":this.handleMapEvents,scope:this})}this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){this.moveLayerToTop();this.map.events.on({"removelayer":this.handleMapEvents,"changelayer":this.handleMapEvents,scope:this});return(this.handlers.keyboard.activate()&&this.handlers.drag.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments))},deactivate:function(){var B=false;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.moveLayerBack();this.map.events.un({"removelayer":this.handleMapEvents,"changelayer":this.handleMapEvents,scope:this});this.layer.removeFeatures(this.vertices,{silent:true});this.layer.removeFeatures(this.virtualVertices,{silent:true});this.vertices=[];this.handlers.drag.deactivate();this.handlers.keyboard.deactivate();var A=this.feature;if(A&&A.geometry&&A.layer){this.unselectFeature(A)}B=true}return B},beforeSelectFeature:function(A){return this.layer.events.triggerEvent("beforefeaturemodified",{feature:A})},selectFeature:function(A){if(this.feature===A||(this.geometryTypes&&OpenLayers.Util.indexOf(this.geometryTypes,A.geometry.CLASS_NAME)==-1)){return}if(this.beforeSelectFeature(A)!==false){if(this.feature){this.unselectFeature(this.feature)}this.feature=A;this.layer.selectedFeatures.push(A);this.layer.drawFeature(A,"select");this.modified=false;this.resetVertices();this.onModificationStart(this.feature)}var B=A.modified;if(A.geometry&&!(B&&B.geometry)){this._originalGeometry=A.geometry.clone()}},unselectFeature:function(A){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[];this.layer.destroyFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[];if(this.dragHandle){this.layer.destroyFeatures([this.dragHandle],{silent:true});delete this.dragHandle}if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});delete this.radiusHandle}this.layer.drawFeature(this.feature,"default");this.feature=null;OpenLayers.Util.removeItem(this.layer.selectedFeatures,A);this.onModificationEnd(A);this.layer.events.triggerEvent("afterfeaturemodified",{feature:A,modified:this.modified});this.modified=false},dragStart:function(A){var B=A.geometry.CLASS_NAME=="OpenLayers.Geometry.Point";if(!this.standalone&&((!A._sketch&&B)||!A._sketch)){if(this.toggle&&this.feature===A){this._unselect=A}this.selectFeature(A)}if(A._sketch||B){this.vertex=A;this.handlers.drag.stopDown=true}},dragVertex:function(C,A){var D=this.map.getLonLatFromViewPortPx(A);var B=C.geometry;B.move(D.lon-B.x,D.lat-B.y);this.modified=true;if(this.feature.geometry.CLASS_NAME=="OpenLayers.Geometry.Point"){this.layer.events.triggerEvent("vertexmodified",{vertex:C.geometry,feature:this.feature,pixel:A})}else{if(C._index){C.geometry.parent.addComponent(C.geometry,C._index);delete C._index;OpenLayers.Util.removeItem(this.virtualVertices,C);this.vertices.push(C)}else{if(C==this.dragHandle){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[];if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});this.radiusHandle=null}}else{if(C!==this.radiusHandle){this.layer.events.triggerEvent("vertexmodified",{vertex:C.geometry,feature:this.feature,pixel:A})}}}if(this.virtualVertices.length>0){this.layer.destroyFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[]}this.layer.drawFeature(this.feature,this.standalone?undefined:"select")}this.layer.drawFeature(C)},dragComplete:function(A){this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&&this.feature.state!=OpenLayers.State.DELETE){this.feature.state=OpenLayers.State.UPDATE;if(this.modified&&this._originalGeometry){var A=this.feature;A.modified=OpenLayers.Util.extend(A.modified,{geometry:this._originalGeometry});delete this._originalGeometry}}},resetVertices:function(){if(this.vertices.length>0){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[]}if(this.virtualVertices.length>0){this.layer.removeFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[]}if(this.dragHandle){this.layer.destroyFeatures([this.dragHandle],{silent:true});this.dragHandle=null}if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});this.radiusHandle=null}if(this.feature&&this.feature.geometry.CLASS_NAME!="OpenLayers.Geometry.Point"){if((this.mode&OpenLayers.Control.ModifyFeature.DRAG)){this.collectDragHandle()}if((this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE))){this.collectRadiusHandle()}if(this.mode&OpenLayers.Control.ModifyFeature.RESHAPE){if(!(this.mode&OpenLayers.Control.ModifyFeature.RESIZE)){this.collectVertices()}}}},handleKeypress:function(B){var A=B.keyCode;if(this.feature&&OpenLayers.Util.indexOf(this.deleteCodes,A)!=-1){var C=this.layer.getFeatureFromEvent(this.handlers.drag.evt);if(C&&OpenLayers.Util.indexOf(this.vertices,C)!=-1&&!this.handlers.drag.dragging&&C.geometry.parent){C.geometry.parent.removeComponent(C.geometry);this.layer.events.triggerEvent("vertexremoved",{vertex:C.geometry,feature:this.feature,pixel:B.xy});this.layer.drawFeature(this.feature,this.standalone?undefined:"select");this.modified=true;this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",{feature:this.feature})}}},collectVertices:function(){this.vertices=[];this.virtualVertices=[];var B=this;function A(E){var F,H,G,J;if(E.CLASS_NAME=="OpenLayers.Geometry.Point"){H=new OpenLayers.Feature.Vector(E);H._sketch=true;H.renderIntent=B.vertexRenderIntent;B.vertices.push(H)}else{var C=E.components.length;if(E.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){C-=1}for(F=0;F<C;++F){G=E.components[F];if(G.CLASS_NAME=="OpenLayers.Geometry.Point"){H=new OpenLayers.Feature.Vector(G);H._sketch=true;H.renderIntent=B.vertexRenderIntent;B.vertices.push(H)}else{A(G)}}if(B.createVertices&&E.CLASS_NAME!="OpenLayers.Geometry.MultiPoint"){for(F=0,J=E.components.length;F<J-1;++F){var L=E.components[F];var I=E.components[F+1];if(L.CLASS_NAME=="OpenLayers.Geometry.Point"&&I.CLASS_NAME=="OpenLayers.Geometry.Point"){var M=(L.x+I.x)/2;var K=(L.y+I.y)/2;var D=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(M,K),null,B.virtualStyle);D.geometry.parent=E;D._index=F+1;D._sketch=true;B.virtualVertices.push(D)}}}}}A.call(this,this.feature.geometry);this.layer.addFeatures(this.virtualVertices,{silent:true});this.layer.addFeatures(this.vertices,{silent:true})},collectDragHandle:function(){var C=this.feature.geometry;var B=C.getBounds().getCenterLonLat();var A=new OpenLayers.Geometry.Point(B.lon,B.lat);var D=new OpenLayers.Feature.Vector(A);A.move=function(E,F){OpenLayers.Geometry.Point.prototype.move.call(this,E,F);C.move(E,F)};D._sketch=true;this.dragHandle=D;this.dragHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.dragHandle],{silent:true})},collectRadiusHandle:function(){var E=this.feature.geometry;var B=E.getBounds();var A=B.getCenterLonLat();var C=new OpenLayers.Geometry.Point(A.lon,A.lat);var D=new OpenLayers.Geometry.Point(B.right,B.bottom);var F=new OpenLayers.Feature.Vector(D);var G=(this.mode&OpenLayers.Control.ModifyFeature.RESIZE);var I=(this.mode&OpenLayers.Control.ModifyFeature.RESHAPE);var H=(this.mode&OpenLayers.Control.ModifyFeature.ROTATE);D.move=function(U,V){OpenLayers.Geometry.Point.prototype.move.call(this,U,V);var R=this.x-C.x;var N=this.y-C.y;var P=R-U;var M=N-V;if(H){var Q=Math.atan2(M,P);var O=Math.atan2(N,R);var T=O-Q;T*=180/Math.PI;E.rotate(T,C)}if(G){var J,K;if(I){J=N/M;K=(R/P)/J}else{var L=Math.sqrt((P*P)+(M*M));var S=Math.sqrt((R*R)+(N*N));J=S/L}E.resize(J,C,K)}};F._sketch=true;this.radiusHandle=F;this.radiusHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.radiusHandle],{silent:true})},setMap:function(A){this.handlers.drag.setMap(A);OpenLayers.Control.prototype.setMap.apply(this,arguments)},handleMapEvents:function(A){if(A.type=="removelayer"||A.property=="order"){this.moveLayerToTop()}},moveLayerToTop:function(){var A=Math.max(this.map.Z_INDEX_BASE["Feature"]-1,this.layer.getZIndex())+1;this.layer.setZIndex(A)},moveLayerBack:function(){var A=this.layer.getZIndex()-1;if(A>=this.map.Z_INDEX_BASE["Feature"]){this.layer.setZIndex(A)}else{this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))}},CLASS_NAME:"OpenLayers.Control.ModifyFeature"});OpenLayers.Control.ModifyFeature.RESHAPE=1;OpenLayers.Control.ModifyFeature.RESIZE=2;OpenLayers.Control.ModifyFeature.ROTATE=4;OpenLayers.Control.ModifyFeature.DRAG=8;OpenLayers.Layer.Bing=OpenLayers.Class(OpenLayers.Layer.XYZ,{key:null,serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.8792382813,9783.93961914062,4891.96980957031,2445.98490478516,1222.99245239258,611.496226196289,305.748113098145,152.874056549072,76.4370282745361,38.2185141372681,19.109257068634,9.55462853431702,4.77731426715851,2.38865713357925,1.19432856678963,0.597164283394814,0.298582141697407,0.149291070848703,0.0746455354243517],attributionTemplate:'<span class="olBingAttribution ${type}"><div><a target="_blank" href="http://www.bing.com/maps/"><img src="${logo}" /></a></div>${copyrights}<a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a></span>',metadata:null,protocolRegex:/^http:/i,type:"Road",culture:"en-US",metadataParams:null,tileOptions:null,protocol:~window.location.href.indexOf("http")?"":"http:",initialize:function(A){A=OpenLayers.Util.applyDefaults({sphericalMercator:true},A);var B=A.name||"Bing "+(A.type||this.type);var C=[B,null,A];OpenLayers.Layer.XYZ.prototype.initialize.apply(this,C);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options.tileOptions);this.loadMetadata()},loadMetadata:function(){this._callbackId="_callback_"+this.id.replace(/\./g,"_");window[this._callbackId]=OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata,this);var C=OpenLayers.Util.applyDefaults({key:this.key,jsonp:this._callbackId,include:"ImageryProviders"},this.metadataParams);var A=this.protocol+"//dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.type+"?"+OpenLayers.Util.getParameterString(C);var B=document.createElement("script");B.type="text/javascript";B.src=A;B.id=this._callbackId;document.getElementsByTagName("head")[0].appendChild(B)},initLayer:function(){var C=this.metadata.resourceSets[0].resources[0];var B=C.imageUrl.replace("{quadkey}","${quadkey}");B=B.replace("{culture}",this.culture);B=B.replace(this.protocolRegex,this.protocol);this.url=[];for(var A=0;A<C.imageUrlSubdomains.length;++A){this.url.push(B.replace("{subdomain}",C.imageUrlSubdomains[A]))}this.addOptions({maxResolution:Math.min(this.serverResolutions[C.zoomMin],this.maxResolution||Number.POSITIVE_INFINITY),numZoomLevels:Math.min(C.zoomMax+1-C.zoomMin,this.numZoomLevels)},true);if(!this.isBaseLayer){this.redraw()}this.updateAttribution()},getURL:function(C){if(!this.url){return}var E=this.getXYZ(C),H=E.x,I=E.y,G=E.z;var D=[];for(var F=G;F>0;--F){var A="0";var K=1<<(F-1);if((H&K)!=0){A++}if((I&K)!=0){A++;A++}D.push(A)}var B=D.join("");var J=this.selectUrl(""+H+I+G,this.url);return OpenLayers.String.format(J,{"quadkey":B})},updateAttribution:function(){var L=this.metadata;if(!L.resourceSets||!this.map||!this.map.center){return}var D=L.resourceSets[0].resources[0];var E=this.map.getExtent().transform(this.map.getProjectionObject(),new OpenLayers.Projection("EPSG:4326"));var K=D.imageryProviders||[],C=OpenLayers.Util.indexOf(this.serverResolutions,this.getServerResolution()),A="",G,H,B,J,M,F,I;for(H=0,B=K.length;H<B;++H){G=K[H];for(J=0,M=G.coverageAreas.length;J<M;++J){I=G.coverageAreas[J];F=OpenLayers.Bounds.fromArray(I.bbox,true);if(E.intersectsBounds(F)&&C<=I.zoomMax&&C>=I.zoomMin){A+=G.attribution+" "}}}var N=L.brandLogoUri.replace(this.protocolRegex,this.protocol);this.attribution=OpenLayers.String.format(this.attributionTemplate,{type:this.type.toLowerCase(),logo:N,copyrights:A});this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"attribution"})},setMap:function(){OpenLayers.Layer.XYZ.prototype.setMap.apply(this,arguments);this.map.events.register("moveend",this,this.updateAttribution)},clone:function(A){if(A==null){A=new OpenLayers.Layer.Bing(this.options)}A=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[A]);return A},destroy:function(){this.map&&this.map.events.unregister("moveend",this,this.updateAttribution);OpenLayers.Layer.XYZ.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.Bing"});OpenLayers.Layer.Bing.processMetadata=function(B){this.metadata=B;this.initLayer();var A=document.getElementById(this._callbackId);A.parentNode.removeChild(A);window[this._callbackId]=undefined;delete this._callbackId};OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:true,initialize:function(C,B){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),"select":new OpenLayers.Style(OpenLayers.Feature.Vector.style["select"]),"temporary":new OpenLayers.Style(OpenLayers.Feature.Vector.style["temporary"]),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(C instanceof OpenLayers.Style){this.styles["default"]=C;this.styles["select"]=C;this.styles["temporary"]=C;this.styles["delete"]=C}else{if(typeof C=="object"){for(var A in C){if(C[A] instanceof OpenLayers.Style){this.styles[A]=C[A]}else{if(typeof C[A]=="object"){this.styles[A]=new OpenLayers.Style(C[A])}else{this.styles["default"]=new OpenLayers.Style(C);this.styles["select"]=new OpenLayers.Style(C);this.styles["temporary"]=new OpenLayers.Style(C);this.styles["delete"]=new OpenLayers.Style(C);break}}}}}OpenLayers.Util.extend(this,B)},destroy:function(){for(var A in this.styles){this.styles[A].destroy()}this.styles=null},createSymbolizer:function(A,C){if(!A){A=new OpenLayers.Feature.Vector()}if(!this.styles[C]){C="default"}A.renderIntent=C;var B={};if(this.extendDefault&&C!="default"){B=this.styles["default"].createSymbolizer(A)}return OpenLayers.Util.extend(B,this.styles[C].createSymbolizer(A))},addUniqueValueRules:function(A,E,C,B){var D=[];for(var F in C){D.push(new OpenLayers.Rule({symbolizer:C[F],context:B,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:E,value:F})}))}this.styles[A].addRules(D)},CLASS_NAME:"OpenLayers.StyleMap"});OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:false,isFixed:false,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:true,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:false,ratio:1,initialize:function(C,B){OpenLayers.Layer.prototype.initialize.apply(this,arguments);if(!this.renderer||!this.renderer.supported()){this.assignRenderer()}if(!this.renderer||!this.renderer.supported()){this.renderer=null;this.displayError()}if(!this.styleMap){this.styleMap=new OpenLayers.StyleMap()}this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies){for(var A=0,D=this.strategies.length;A<D;A++){this.strategies[A].setLayer(this)}}},destroy:function(){if(this.strategies){var C,A,B;for(A=0,B=this.strategies.length;A<B;A++){C=this.strategies[A];if(C.autoDestroy){C.destroy()}}this.strategies=null}if(this.protocol){if(this.protocol.autoDestroy){this.protocol.destroy()}this.protocol=null}this.destroyFeatures();this.features=null;this.selectedFeatures=null;this.unrenderedFeatures=null;if(this.renderer){this.renderer.destroy()}this.renderer=null;this.geometryType=null;this.drawn=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(C){if(C==null){C=new OpenLayers.Layer.Vector(this.name,this.getOptions())}C=OpenLayers.Layer.prototype.clone.apply(this,[C]);var A=this.features;var E=A.length;var D=new Array(E);for(var B=0;B<E;++B){D[B]=A[B].clone()}C.features=D;return C},refresh:function(A){if(this.calculateInRange()&&this.visibility){this.events.triggerEvent("refresh",A)}},assignRenderer:function(){for(var A=0,C=this.renderers.length;A<C;A++){var D=this.renderers[A];var B=(typeof D=="function")?D:OpenLayers.Renderer[D];if(B&&B.prototype.supported()){this.renderer=new B(this.div,this.rendererOptions);break}}},displayError:function(){if(this.reportError){OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))}},setMap:function(A){OpenLayers.Layer.prototype.setMap.apply(this,arguments);if(!this.renderer){this.map.removeLayer(this)}else{this.renderer.map=this.map;var B=this.map.getSize();B.w=B.w*this.ratio;B.h=B.h*this.ratio;this.renderer.setSize(B)}},afterAdd:function(){if(this.strategies){var C,A,B;for(A=0,B=this.strategies.length;A<B;A++){C=this.strategies[A];if(C.autoActivate){C.activate()}}}},removeMap:function(B){this.drawn=false;if(this.strategies){var D,A,C;for(A=0,C=this.strategies.length;A<C;A++){D=this.strategies[A];if(D.autoActivate){D.deactivate()}}}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments);var A=this.map.getSize();A.w=A.w*this.ratio;A.h=A.h*this.ratio;this.renderer.setSize(A)},moveTo:function(B,I,G){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var H=true;if(!G){this.renderer.root.style.visibility="hidden";var A=this.map.getSize(),D=A.w,M=A.h,C=(D/2*this.ratio)-D/2,L=(M/2*this.ratio)-M/2;C+=this.map.layerContainerOriginPx.x;C=-Math.round(C);L+=this.map.layerContainerOriginPx.y;L=-Math.round(L);this.div.style.left=C+"px";this.div.style.top=L+"px";var E=this.map.getExtent().scale(this.ratio);H=this.renderer.setExtent(E,I);this.renderer.root.style.visibility="visible";if(OpenLayers.IS_GECKO===true){this.div.scrollLeft=this.div.scrollLeft}if(!I&&H){for(var F in this.unrenderedFeatures){var K=this.unrenderedFeatures[F];this.drawFeature(K)}}}if(!this.drawn||I||!H){this.drawn=true;var K;for(var F=0,J=this.features.length;F<J;F++){this.renderer.locked=(F!==(J-1));K=this.features[F];this.drawFeature(K)}}},display:function(B){OpenLayers.Layer.prototype.display.apply(this,arguments);var A=this.div.style.display;if(A!=this.renderer.root.style.display){this.renderer.root.style.display=A}},addFeatures:function(A,F){if(!(OpenLayers.Util.isArray(A))){A=[A]}var B=!F||!F.silent;if(B){var C={features:A};var I=this.events.triggerEvent("beforefeaturesadded",C);if(I===false){return}A=C.features}var D=[];for(var E=0,G=A.length;E<G;E++){if(E!=(A.length-1)){this.renderer.locked=true}else{this.renderer.locked=false}var H=A[E];if(this.geometryType&&!(H.geometry instanceof this.geometryType)){throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME)}H.layer=this;if(!H.style&&this.style){H.style=OpenLayers.Util.extend({},this.style)}if(B){if(this.events.triggerEvent("beforefeatureadded",{feature:H})===false){continue}this.preFeatureInsert(H)}D.push(H);this.features.push(H);this.drawFeature(H);if(B){this.events.triggerEvent("featureadded",{feature:H});this.onFeatureInsert(H)}}if(B){this.events.triggerEvent("featuresadded",{features:D})}},removeFeatures:function(A,C){if(!A||A.length===0){return}if(A===this.features){return this.removeAllFeatures(C)}if(!(OpenLayers.Util.isArray(A))){A=[A]}if(A===this.selectedFeatures){A=A.slice()}var D=!C||!C.silent;if(D){this.events.triggerEvent("beforefeaturesremoved",{features:A})}for(var B=A.length-1;B>=0;B--){if(B!=0&&A[B-1].geometry){this.renderer.locked=true}else{this.renderer.locked=false}var E=A[B];delete this.unrenderedFeatures[E.id];if(D){this.events.triggerEvent("beforefeatureremoved",{feature:E})}this.features=OpenLayers.Util.removeItem(this.features,E);E.layer=null;if(E.geometry){this.renderer.eraseFeatures(E)}if(OpenLayers.Util.indexOf(this.selectedFeatures,E)!=-1){OpenLayers.Util.removeItem(this.selectedFeatures,E)}if(D){this.events.triggerEvent("featureremoved",{feature:E})}}if(D){this.events.triggerEvent("featuresremoved",{features:A})}},removeAllFeatures:function(D){var A=!D||!D.silent;var B=this.features;if(A){this.events.triggerEvent("beforefeaturesremoved",{features:B})}var E;for(var C=B.length-1;C>=0;C--){E=B[C];if(A){this.events.triggerEvent("beforefeatureremoved",{feature:E})}E.layer=null;if(A){this.events.triggerEvent("featureremoved",{feature:E})}}this.renderer.clear();this.features=[];this.unrenderedFeatures={};this.selectedFeatures=[];if(A){this.events.triggerEvent("featuresremoved",{features:B})}},destroyFeatures:function(A,C){var D=(A==undefined);if(D){A=this.features}if(A){this.removeFeatures(A,C);for(var B=A.length-1;B>=0;B--){A[B].destroy()}}},drawFeature:function(B,C){if(!this.drawn){return}if(typeof C!="object"){if(!C&&B.state===OpenLayers.State.DELETE){C="delete"}var A=C||B.renderIntent;C=B.style||this.style;if(!C){C=this.styleMap.createSymbolizer(B,A)}}var D=this.renderer.drawFeature(B,C);if(D===false||D===null){this.unrenderedFeatures[B.id]=B}else{delete this.unrenderedFeatures[B.id]}},eraseFeatures:function(A){this.renderer.eraseFeatures(A)},getFeatureFromEvent:function(C){if(!this.renderer){throw new Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.")}var B=null;var A=this.renderer.getFeatureIdFromEvent(C);if(A){if(typeof A==="string"){B=this.getFeatureById(A)}else{B=A}}return B},getFeatureBy:function(C,E){var A=null;for(var B=0,D=this.features.length;B<D;++B){if(this.features[B][C]==E){A=this.features[B];break}}return A},getFeatureById:function(A){return this.getFeatureBy("id",A)},getFeatureByFid:function(A){return this.getFeatureBy("fid",A)},getFeaturesByAttribute:function(A,D){var B,F,E=this.features.length,C=[];for(B=0;B<E;B++){F=this.features[B];if(F&&F.attributes){if(F.attributes[A]===D){C.push(F)}}}return C},onFeatureInsert:function(A){},preFeatureInsert:function(A){},getDataExtent:function(){var C=null;var A=this.features;if(A&&(A.length>0)){var D=null;for(var B=0,E=A.length;B<E;B++){D=A[B].geometry;if(D){if(C===null){C=new OpenLayers.Bounds()}C.extend(D.getBounds())}}}return C},CLASS_NAME:"OpenLayers.Layer.Vector"});OpenLayers.Layer.PointGrid=OpenLayers.Class(OpenLayers.Layer.Vector,{dx:null,dy:null,ratio:1.5,maxFeatures:250,rotation:0,origin:null,gridBounds:null,initialize:function(A){A=A||{};OpenLayers.Layer.Vector.prototype.initialize.apply(this,[A.name,A])},setMap:function(A){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);A.events.register("moveend",this,this.onMoveEnd)},removeMap:function(A){A.events.unregister("moveend",this,this.onMoveEnd);OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},setRatio:function(A){this.ratio=A;this.updateGrid(true)},setMaxFeatures:function(A){this.maxFeatures=A;this.updateGrid(true)},setSpacing:function(A,B){this.dx=A;this.dy=B||A;this.updateGrid(true)},setOrigin:function(A){this.origin=A;this.updateGrid(true)},getOrigin:function(){if(!this.origin){this.origin=this.map.getExtent().getCenterLonLat()}return this.origin},setRotation:function(A){this.rotation=A;this.updateGrid(true)},onMoveEnd:function(){this.updateGrid()},getViewBounds:function(){var A=this.map.getExtent();if(this.rotation){var C=this.getOrigin();var D=new OpenLayers.Geometry.Point(C.lon,C.lat);var B=A.toGeometry();B.rotate(-this.rotation,D);A=B.getBounds()}return A},updateGrid:function(D){if(D||this.invalidBounds()){var O=this.getViewBounds();var C=this.getOrigin();var K=new OpenLayers.Geometry.Point(C.lon,C.lat);var N=O.getWidth();var R=O.getHeight();var I=N/R;var H=Math.sqrt(this.dx*this.dy*this.maxFeatures/I);var G=H*I;var Q=Math.min(N*this.ratio,G);var E=Math.min(R*this.ratio,H);var V=O.getCenterLonLat();this.gridBounds=new OpenLayers.Bounds(V.lon-(Q/2),V.lat-(E/2),V.lon+(Q/2),V.lat+(E/2));var A=Math.floor(E/this.dy);var S=Math.floor(Q/this.dx);var U=C.lon+(this.dx*Math.ceil((this.gridBounds.left-C.lon)/this.dx));var B=C.lat+(this.dy*Math.ceil((this.gridBounds.bottom-C.lat)/this.dy));var L=new Array(A*S);var T,J,M;for(var F=0;F<S;++F){T=U+(F*this.dx);for(var P=0;P<A;++P){J=B+(P*this.dy);M=new OpenLayers.Geometry.Point(T,J);if(this.rotation){M.rotate(this.rotation,K)}L[(F*A)+P]=new OpenLayers.Feature.Vector(M)}}this.destroyFeatures(this.features,{silent:true});this.addFeatures(L,{silent:true})}},invalidBounds:function(){return !this.gridBounds||!this.gridBounds.containsBounds(this.getViewBounds())},CLASS_NAME:"OpenLayers.Layer.PointGrid"});OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,interval:0,maxDelta:Number.POSITIVE_INFINITY,delta:0,cumulative:true,initialize:function(B,C,A){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(A){if(!this.map||!this.checkModifiers(A)){return}var E=false;var M=false;var J=false;var C=OpenLayers.Event.element(A);while((C!=null)&&!J&&!E){if(!E){try{var D;if(C.currentStyle){D=C.currentStyle["overflow"]}else{var H=document.defaultView.getComputedStyle(C,null);D=H.getPropertyValue("overflow")}E=(D&&(D=="auto")||(D=="scroll"))}catch(F){}}if(!M){M=OpenLayers.Element.hasClass(C,"olScrollable");if(!M){for(var G=0,K=this.map.layers.length;G<K;G++){var I=this.map.layers[G];if(C==I.div||C==I.pane){M=true;break}}}}J=(C==this.map.div);C=C.parentNode}if(!E&&J){if(M){var L=0;if(A.wheelDelta){L=A.wheelDelta;if(L%160===0){L=L*0.75}L=L/120}else{if(A.detail){L=-(A.detail/Math.abs(A.detail))}}this.delta+=L;window.clearTimeout(this._timeoutId);if(this.interval&&Math.abs(this.delta)<this.maxDelta){var B=OpenLayers.Util.extend({},A);this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(B)},this),this.interval)}else{this.wheelZoom(A)}}OpenLayers.Event.stop(A)}},wheelZoom:function(B){var A=this.delta;this.delta=0;if(A){B.xy=this.map.events.getMousePosition(B);if(A<0){this.callback("down",[B,this.cumulative?Math.max(-this.maxDelta,A):-1])}else{this.callback("up",[B,this.cumulative?Math.min(this.maxDelta,A):1])}}},activate:function(B){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var A=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",A);OpenLayers.Event.observe(window,"mousewheel",A);OpenLayers.Event.observe(document,"mousewheel",A);return true}else{return false}},deactivate:function(B){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var A=this.wheelListener;OpenLayers.Event.stopObserving(window,"DOMMouseScroll",A);OpenLayers.Event.stopObserving(window,"mousewheel",A);OpenLayers.Event.stopObserving(document,"mousewheel",A);return true}else{return false}},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});OpenLayers.Symbolizer=OpenLayers.Class({zIndex:0,initialize:function(A){OpenLayers.Util.extend(this,A)},clone:function(){var Type=eval(this.CLASS_NAME);return new Type(OpenLayers.Util.extend({},this))},CLASS_NAME:"OpenLayers.Symbolizer"});OpenLayers.Symbolizer.Raster=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(A){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Raster"});OpenLayers.Rule=OpenLayers.Class({id:null,name:null,title:null,description:null,context:null,filter:null,elseFilter:false,symbolizer:null,symbolizers:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(A){this.symbolizer={};OpenLayers.Util.extend(this,A);if(this.symbolizers){delete this.symbolizer}this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var A in this.symbolizer){this.symbolizer[A]=null}this.symbolizer=null;delete this.symbolizers},evaluate:function(B){var A=this.getContext(B);var C=true;if(this.minScaleDenominator||this.maxScaleDenominator){var D=B.layer.map.getScale()}if(this.minScaleDenominator){C=D>=OpenLayers.Style.createLiteral(this.minScaleDenominator,A)}if(C&&this.maxScaleDenominator){C=D<OpenLayers.Style.createLiteral(this.maxScaleDenominator,A)}if(C&&this.filter){if(this.filter.CLASS_NAME=="OpenLayers.Filter.FeatureId"){C=this.filter.evaluate(B)}else{C=this.filter.evaluate(A)}}return C},getContext:function(B){var A=this.context;if(!A){A=B.attributes||B.data}if(typeof this.context=="function"){A=this.context(B)}return A},clone:function(){var C=OpenLayers.Util.extend({},this);if(this.symbolizers){var D=this.symbolizers.length;C.symbolizers=new Array(D);for(var B=0;B<D;++B){C.symbolizers[B]=this.symbolizers[B].clone()}}else{C.symbolizer={};var E,A;for(var F in this.symbolizer){E=this.symbolizer[F];A=typeof E;if(A==="object"){C.symbolizer[F]=OpenLayers.Util.extend({},E)}else{if(A==="string"){C.symbolizer[F]=E}}}}C.filter=this.filter&&this.filter.clone();C.context=this.context&&OpenLayers.Util.extend({},this.context);return new OpenLayers.Rule(C)},CLASS_NAME:"OpenLayers.Rule"});OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{profile:null,defaultVersion:"1.0.0",stringifyOutput:true,namedLayersAsArray:false,CLASS_NAME:"OpenLayers.Format.SLD"});OpenLayers.Symbolizer.Polygon=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(A){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Polygon"});OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(A){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[A])},readers:{"gml":OpenLayers.Util.applyDefaults({"outerBoundaryIs":function(B,C){var A={};this.readChildNodes(B,A);C.outer=A.components[0]},"innerBoundaryIs":function(B,C){var A={};this.readChildNodes(B,A);C.inner.push(A.components[0])},"Box":function(C,D){var B={};this.readChildNodes(C,B);if(!D.components){D.components=[]}var A=B.points[0];var E=B.points[1];D.components.push(new OpenLayers.Bounds(A.x,A.y,E.x,E.y))}},OpenLayers.Format.GML.Base.prototype.readers["gml"]),"feature":OpenLayers.Format.GML.Base.prototype.readers["feature"],"wfs":OpenLayers.Format.GML.Base.prototype.readers["wfs"]},write:function(A){var C;if(OpenLayers.Util.isArray(A)){C="wfs:FeatureCollection"}else{C="gml:featureMember"}var B=this.writeNode(C,A);this.setAttributeNS(B,this.namespaces["xsi"],"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[B])},writers:{"gml":OpenLayers.Util.applyDefaults({"Point":function(B){var A=this.createElementNSPlus("gml:Point");this.writeNode("coordinates",[B],A);return A},"coordinates":function(D){var E=D.length;var A=new Array(E);var C;for(var B=0;B<E;++B){C=D[B];if(this.xy){A[B]=C.x+","+C.y}else{A[B]=C.y+","+C.x}if(C.z!=undefined){A[B]+=","+C.z}}return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:(E==1)?A[0]:A.join(" ")})},"LineString":function(B){var A=this.createElementNSPlus("gml:LineString");this.writeNode("coordinates",B.components,A);return A},"Polygon":function(C){var B=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",C.components[0],B);for(var A=1;A<C.components.length;++A){this.writeNode("innerBoundaryIs",C.components[A],B)}return B},"outerBoundaryIs":function(B){var A=this.createElementNSPlus("gml:outerBoundaryIs");this.writeNode("LinearRing",B,A);return A},"innerBoundaryIs":function(B){var A=this.createElementNSPlus("gml:innerBoundaryIs");this.writeNode("LinearRing",B,A);return A},"LinearRing":function(B){var A=this.createElementNSPlus("gml:LinearRing");this.writeNode("coordinates",B.components,A);return A},"Box":function(A){var B=this.createElementNSPlus("gml:Box");this.writeNode("coordinates",[{x:A.left,y:A.bottom},{x:A.right,y:A.top}],B);if(this.srsName){B.setAttribute("srsName",this.srsName)}return B}},OpenLayers.Format.GML.Base.prototype.writers["gml"]),"feature":OpenLayers.Format.GML.Base.prototype.writers["feature"],"wfs":OpenLayers.Format.GML.Base.prototype.writers["wfs"]},CLASS_NAME:"OpenLayers.Format.GML.v2"});OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(A){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[A])},readers:{"ogc":OpenLayers.Util.applyDefaults({"PropertyIsEqualTo":function(B,A){var C=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(B,C);A.filters.push(C)},"PropertyIsNotEqualTo":function(B,A){var C=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(B,C);A.filters.push(C)},"PropertyIsLike":function(B,A){var D=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(B,D);var C=B.getAttribute("wildCard");var E=B.getAttribute("singleChar");var F=B.getAttribute("escape");D.value2regex(C,E,F);A.filters.push(D)}},OpenLayers.Format.Filter.v1.prototype.readers["ogc"]),"gml":OpenLayers.Format.GML.v2.prototype.readers["gml"],"feature":OpenLayers.Format.GML.v2.prototype.readers["feature"]},writers:{"ogc":OpenLayers.Util.applyDefaults({"PropertyIsEqualTo":function(B){var A=this.createElementNSPlus("ogc:PropertyIsEqualTo");this.writeNode("PropertyName",B,A);this.writeOgcExpression(B.value,A);return A},"PropertyIsNotEqualTo":function(B){var A=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");this.writeNode("PropertyName",B,A);this.writeOgcExpression(B.value,A);return A},"PropertyIsLike":function(B){var A=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{wildCard:"*",singleChar:".",escape:"!"}});this.writeNode("PropertyName",B,A);this.writeNode("Literal",B.regex2value(),A);return A},"BBOX":function(C){var B=this.createElementNSPlus("ogc:BBOX");C.property&&this.writeNode("PropertyName",C,B);var A=this.writeNode("gml:Box",C.value,B);if(C.projection){A.setAttribute("srsName",C.projection)}return B}},OpenLayers.Format.Filter.v1.prototype.writers["ogc"]),"gml":OpenLayers.Format.GML.v2.prototype.writers["gml"],"feature":OpenLayers.Format.GML.v2.prototype.writers["feature"]},writeSpatial:function(D,C){var B=this.createElementNSPlus("ogc:"+C);this.writeNode("PropertyName",D,B);if(D.value instanceof OpenLayers.Filter.Function){this.writeNode("Function",D.value,B)}else{var A;if(D.value instanceof OpenLayers.Geometry){A=this.writeNode("feature:_geometry",D.value).firstChild}else{A=this.writeNode("gml:Box",D.value)}if(D.projection){A.setAttribute("srsName",D.projection)}B.appendChild(A)}return B},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"});OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",srsNameInQuery:false,schemaLocations:{"wfs":"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(A){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[A]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[A])},readNode:function(B,A,C){return OpenLayers.Format.GML.v2.prototype.readNode.apply(this,arguments)},readers:{"wfs":OpenLayers.Util.applyDefaults({"WFS_TransactionResponse":function(B,A){A.insertIds=[];A.success=false;this.readChildNodes(B,A)},"InsertResult":function(B,C){var A={fids:[]};this.readChildNodes(B,A);C.insertIds=C.insertIds.concat(A.fids)},"TransactionResult":function(B,A){this.readChildNodes(B,A)},"Status":function(B,A){this.readChildNodes(B,A)},"SUCCESS":function(B,A){A.success=true}},OpenLayers.Format.WFST.v1.prototype.readers["wfs"]),"gml":OpenLayers.Format.GML.v2.prototype.readers["gml"],"feature":OpenLayers.Format.GML.v2.prototype.readers["feature"],"ogc":OpenLayers.Format.Filter.v1_0_0.prototype.readers["ogc"]},writers:{"wfs":OpenLayers.Util.applyDefaults({"Query":function(D){D=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName,srsNameInQuery:this.srsNameInQuery},D);var B=D.featurePrefix;var C=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(B?B+":":"")+D.featureType}});if(D.srsNameInQuery&&D.srsName){C.setAttribute("srsName",D.srsName)}if(D.featureNS){C.setAttribute("xmlns:"+B,D.featureNS)}if(D.propertyNames){for(var A=0,E=D.propertyNames.length;A<E;A++){this.writeNode("ogc:PropertyName",{property:D.propertyNames[A]},C)}}if(D.filter){this.setFilterProperty(D.filter);this.writeNode("ogc:Filter",D.filter,C)}return C}},OpenLayers.Format.WFST.v1.prototype.writers["wfs"]),"gml":OpenLayers.Format.GML.v2.prototype.writers["gml"],"feature":OpenLayers.Format.GML.v2.prototype.writers["feature"],"ogc":OpenLayers.Format.Filter.v1_0_0.prototype.writers["ogc"]},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"});OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(A){this.compare=A?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.clear()},insert:function(F){if(this.exists(F)){this.remove(F)}var A=F.id;this.determineZIndex(F);var D=-1;var C=this.order.length;var E;while(C-D>1){E=parseInt((D+C)/2);var B=this.compare(this,F,OpenLayers.Util.getElement(this.order[E]));if(B>0){D=E}else{C=E}}this.order.splice(C,0,A);this.indices[A]=this.getZIndex(F);return this.getNextElement(C)},remove:function(C){var A=C.id;var D=OpenLayers.Util.indexOf(this.order,A);if(D>=0){this.order.splice(D,1);delete this.indices[A];if(this.order.length>0){var B=this.order[this.order.length-1];this.maxZIndex=this.indices[B]}else{this.maxZIndex=0}}},clear:function(){this.order=[];this.indices={};this.maxZIndex=0},exists:function(A){return(this.indices[A.id]!=null)},getZIndex:function(A){return A._style.graphicZIndex},determineZIndex:function(B){var A=B._style.graphicZIndex;if(A==null){A=this.maxZIndex;B._style.graphicZIndex=A}else{if(A>this.maxZIndex){this.maxZIndex=A}}},getNextElement:function(B){var A=B+1;if(A<this.order.length){var C=OpenLayers.Util.getElement(this.order[A]);if(C==undefined){C=this.getNextElement(A)}return C}else{return null}},CLASS_NAME:"OpenLayers.ElementsIndexer"});OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(D,F,E){var A=D.getZIndex(F);var C=0;if(E){var B=D.getZIndex(E);C=A-B}return C},Z_ORDER_DRAWING_ORDER:function(B,D,C){var A=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(B,D,C);if(C&&A==0){A=1}return A},Z_ORDER_Y_ORDER:function(C,E,D){var B=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(C,E,D);if(D&&B===0){var A=D._boundsBottom-E._boundsBottom;B=(A===0)?1:A}return B}};OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(A,B){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot("_root");this.vectorRoot=this.createRoot("_vroot");this.textRoot=this.createRoot("_troot");this.root.appendChild(this.vectorRoot);this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);if(B&&(B.zIndexing||B.yOrdering)){this.indexer=new OpenLayers.ElementsIndexer(B.yOrdering)}},destroy:function(){this.clear();this.rendererRoot=null;this.root=null;this.xmlns=null;OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var B;var A=this.vectorRoot;if(A){while(B=A.firstChild){A.removeChild(B)}}A=this.textRoot;if(A){while(B=A.firstChild){A.removeChild(B)}}if(this.indexer){this.indexer.clear()}},setExtent:function(E,D){var G=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments);var F=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var A,C=E.getWidth()/this.map.getExtent().getWidth(),E=E.scale(1/C),B=this.map.getMaxExtent();if(B.right>E.left&&B.right<E.right){A=true}else{if(B.left>E.left&&B.left<E.right){A=false}}if(A!==this.rightOfDateLine||D){G=false;this.xOffset=A===true?B.getWidth()/F:0}this.rightOfDateLine=A}return G},getNodeType:function(B,A){},drawGeometry:function(C,E,B){var I=C.CLASS_NAME;var A=true;if((I=="OpenLayers.Geometry.Collection")||(I=="OpenLayers.Geometry.MultiPoint")||(I=="OpenLayers.Geometry.MultiLineString")||(I=="OpenLayers.Geometry.MultiPolygon")){for(var D=0,H=C.components.length;D<H;D++){A=this.drawGeometry(C.components[D],E,B)&&A}return A}A=false;var F=false;if(E.display!="none"){if(E.backgroundGraphic){this.redrawBackgroundNode(C.id,C,E,B)}else{F=true}A=this.redrawNode(C.id,C,E,B)}if(A==false){var G=document.getElementById(C.id);if(G){if(G._style.backgroundGraphic){F=true}G.parentNode.removeChild(G)}}if(F){var G=document.getElementById(C.id+this.BACKGROUND_ID_SUFFIX);if(G){G.parentNode.removeChild(G)}}return A},redrawNode:function(G,E,D,A){D=this.applyDefaultSymbolizer(D);var C=this.nodeFactory(G,this.getNodeType(E,D));C._featureId=A;C._boundsBottom=E.getBounds().bottom;C._geometryClass=E.CLASS_NAME;C._style=D;var B=this.drawGeometryNode(C,E,D);if(B===false){return false}C=B.node;if(this.indexer){var F=this.indexer.insert(C);if(F){this.vectorRoot.insertBefore(C,F)}else{this.vectorRoot.appendChild(C)}}else{if(C.parentNode!==this.vectorRoot){this.vectorRoot.appendChild(C)}}this.postDraw(C);return B.complete},redrawBackgroundNode:function(E,D,C,A){var B=OpenLayers.Util.extend({},C);B.externalGraphic=B.backgroundGraphic;B.graphicXOffset=B.backgroundXOffset;B.graphicYOffset=B.backgroundYOffset;B.graphicZIndex=B.backgroundGraphicZIndex;B.graphicWidth=B.backgroundWidth||B.graphicWidth;B.graphicHeight=B.backgroundHeight||B.graphicHeight;B.backgroundGraphic=null;B.backgroundXOffset=null;B.backgroundYOffset=null;B.backgroundGraphicZIndex=null;return this.redrawNode(E+this.BACKGROUND_ID_SUFFIX,D,B,null)},drawGeometryNode:function(B,D,C){C=C||B._style;var A={"isFilled":C.fill===undefined?true:C.fill,"isStroked":C.stroke===undefined?!!C.strokeWidth:C.stroke};var E;switch(D.CLASS_NAME){case"OpenLayers.Geometry.Point":if(C.graphic===false){A.isFilled=false;A.isStroked=false}E=this.drawPoint(B,D);break;case"OpenLayers.Geometry.LineString":A.isFilled=false;E=this.drawLineString(B,D);break;case"OpenLayers.Geometry.LinearRing":E=this.drawLinearRing(B,D);break;case"OpenLayers.Geometry.Polygon":E=this.drawPolygon(B,D);break;case"OpenLayers.Geometry.Rectangle":E=this.drawRectangle(B,D);break;default:break}B._options=A;if(E!=false){return{node:this.setStyle(B,C,A,D),complete:E}}else{return false}},postDraw:function(A){},drawPoint:function(A,B){},drawLineString:function(A,B){},drawLinearRing:function(A,B){},drawPolygon:function(A,B){},drawRectangle:function(A,B){},drawCircle:function(A,B){},removeText:function(A){var B=document.getElementById(A+this.LABEL_ID_SUFFIX);if(B){this.textRoot.removeChild(B)}var C=document.getElementById(A+this.LABEL_OUTLINE_SUFFIX);if(C){this.textRoot.removeChild(C)}},getFeatureIdFromEvent:function(C){var D=C.target;var A=D&&D.correspondingUseElement;var B=A?A:(D||C.srcElement);return B._featureId},eraseGeometry:function(D,A){if((D.CLASS_NAME=="OpenLayers.Geometry.MultiPoint")||(D.CLASS_NAME=="OpenLayers.Geometry.MultiLineString")||(D.CLASS_NAME=="OpenLayers.Geometry.MultiPolygon")||(D.CLASS_NAME=="OpenLayers.Geometry.Collection")){for(var B=0,E=D.components.length;B<E;B++){this.eraseGeometry(D.components[B],A)}}else{var F=OpenLayers.Util.getElement(D.id);if(F&&F.parentNode){if(F.geometry){F.geometry.destroy();F.geometry=null}F.parentNode.removeChild(F);if(this.indexer){this.indexer.remove(F)}if(F._style.backgroundGraphic){var C=D.id+this.BACKGROUND_ID_SUFFIX;var G=OpenLayers.Util.getElement(C);if(G&&G.parentNode){G.parentNode.removeChild(G)}}}}},nodeFactory:function(C,A){var B=OpenLayers.Util.getElement(C);if(B){if(!this.nodeTypeCompare(B,A)){B.parentNode.removeChild(B);B=this.nodeFactory(C,A)}}else{B=this.createNode(A,C)}return B},nodeTypeCompare:function(B,A){},createNode:function(A,B){},moveRoot:function(B){var A=this.root;if(B.root.parentNode==this.rendererRoot){A=B.root}A.parentNode.removeChild(A);B.rendererRoot.appendChild(A)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(A){return(A!="circle")&&!!A},CLASS_NAME:"OpenLayers.Renderer.Elements"});OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,{center:null,zoom:null,layers:null,displayProjection:null,getParameters:function(A){A=A||window.location.href;var C=OpenLayers.Util.getParameters(A);var B=A.indexOf("#");if(B>0){A="?"+A.substring(B+1,A.length);OpenLayers.Util.extend(C,OpenLayers.Util.getParameters(A))}return C},setMap:function(B){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var A=0,C=this.map.controls.length;A<C;A++){var D=this.map.controls[A];if((D!=this)&&(D.CLASS_NAME=="OpenLayers.Control.ArgParser")){if(D.displayProjection!=this.displayProjection){this.displayProjection=D.displayProjection}break}}if(A==this.map.controls.length){var E=this.getParameters();if(E.layers){this.layers=E.layers;this.map.events.register("addlayer",this,this.configureLayers);this.configureLayers()}if(E.lat&&E.lon){this.center=new OpenLayers.LonLat(parseFloat(E.lon),parseFloat(E.lat));if(E.zoom){this.zoom=parseFloat(E.zoom)}this.map.events.register("changebaselayer",this,this.setCenter);this.setCenter()}}},setCenter:function(){if(this.map.baseLayer){this.map.events.unregister("changebaselayer",this,this.setCenter);if(this.displayProjection){this.center.transform(this.displayProjection,this.map.getProjectionObject())}this.map.setCenter(this.center,this.zoom)}},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var A=0,C=this.layers.length;A<C;A++){var B=this.map.layers[A];var D=this.layers.charAt(A);if(D=="B"){this.map.setBaseLayer(B)}else{if((D=="T")||(D=="F")){B.setVisibility(D=="T")}}}}},CLASS_NAME:"OpenLayers.Control.ArgParser"});OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,anchor:false,base:"",displayProjection:null,initialize:function(B,C,A){if(B!==null&&typeof B=="object"&&!OpenLayers.Util.isElement(B)){A=B;this.base=document.location.href;OpenLayers.Control.prototype.initialize.apply(this,[A]);if(this.element!=null){this.element=OpenLayers.Util.getElement(this.element)}}else{OpenLayers.Control.prototype.initialize.apply(this,[A]);this.element=OpenLayers.Util.getElement(B);this.base=C||document.location.href}},destroy:function(){if(this.element&&this.element.parentNode==this.div){this.div.removeChild(this.element);this.element=null}if(this.map){this.map.events.unregister("moveend",this,this.updateLink)}OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(B){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var A=0,C=this.map.controls.length;A<C;A++){var D=this.map.controls[A];if(D.CLASS_NAME==this.argParserClass.CLASS_NAME){if(D.displayProjection!=this.displayProjection){this.displayProjection=D.displayProjection}break}}if(A==this.map.controls.length){this.map.addControl(new this.argParserClass({"displayProjection":this.displayProjection}))}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element&&!this.anchor){this.element=document.createElement("a");this.element.innerHTML=OpenLayers.i18n("Permalink");this.element.href="";this.div.appendChild(this.element)}this.map.events.on({"moveend":this.updateLink,"changelayer":this.updateLink,"changebaselayer":this.updateLink,scope:this});this.updateLink();return this.div},updateLink:function(){var B=this.anchor?"#":"?";var A=this.base;var D=null;if(A.indexOf("#")!=-1&&this.anchor==false){D=A.substring(A.indexOf("#"),A.length)}if(A.indexOf(B)!=-1){A=A.substring(0,A.indexOf(B))}var C=A.split("#");A=C[0]+B+OpenLayers.Util.getParameterString(this.createParams());if(D){A+=D}if(this.anchor&&!this.element){window.location.href=A}else{this.element.href=A}},createParams:function(A,C,J){A=A||this.map.getCenter();var F=OpenLayers.Util.getParameters(this.base);if(A){F.zoom=C||this.map.getZoom();var B=A.lat;var D=A.lon;if(this.displayProjection){var I=OpenLayers.Projection.transform({x:D,y:B},this.map.getProjectionObject(),this.displayProjection);D=I.x;B=I.y}F.lat=Math.round(B*100000)/100000;F.lon=Math.round(D*100000)/100000;J=J||this.map.layers;F.layers="";for(var E=0,H=J.length;E<H;E++){var G=J[E];if(G.isBaseLayer){F.layers+=(G==this.map.baseLayer)?"B":"0"}else{F.layers+=(G.getVisibility())?"T":"F"}}}return F},CLASS_NAME:"OpenLayers.Control.Permalink"});OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",layername:null,type:null,isBaseLayer:true,tileOrigin:null,serverResolutions:null,zoomOffset:0,initialize:function(C,A,B){var D=[];D.push(C,A,{},B);OpenLayers.Layer.Grid.prototype.initialize.apply(this,D)},clone:function(A){if(A==null){A=new OpenLayers.Layer.TMS(this.name,this.url,this.getOptions())}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);return A},getURL:function(B){B=this.adjustBounds(B);var D=this.getServerResolution();var E=Math.round((B.left-this.tileOrigin.lon)/(D*this.tileSize.w));var F=Math.round((B.bottom-this.tileOrigin.lat)/(D*this.tileSize.h));var C=this.getServerZoom();var G=this.serviceVersion+"/"+this.layername+"/"+C+"/"+E+"/"+F+"."+this.type;var A=this.url;if(OpenLayers.Util.isArray(A)){A=this.selectUrl(G,A)}return A+G},setMap:function(A){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);if(!this.tileOrigin){this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom)}},CLASS_NAME:"OpenLayers.Layer.TMS"});OpenLayers.Format.WCSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",CLASS_NAME:"OpenLayers.Format.WCSCapabilities"});OpenLayers.Format.WCSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:(/^\s*|\s*$/g),splitSpace:(/\s+/)},defaultPrefix:"wcs",read:function(C){if(typeof C=="string"){C=OpenLayers.Format.XML.prototype.read.apply(this,[C])}var A=C;if(C&&C.nodeType==9){C=C.documentElement}var B={};this.readNode(C,B);return B},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1"});OpenLayers.Format.WCSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WCSCapabilities.v1,{namespaces:{wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},errorProperty:"service",readers:{"wcs":{"WCS_Capabilities":function(B,A){this.readChildNodes(B,A)},"Service":function(B,A){A.service={};this.readChildNodes(B,A.service)},"name":function(A,B){B.name=this.getChildValue(A)},"label":function(A,B){B.label=this.getChildValue(A)},"keywords":function(A,B){B.keywords=[];this.readChildNodes(A,B.keywords)},"keyword":function(A,B){B.push(this.getChildValue(A))},"responsibleParty":function(A,B){B.responsibleParty={};this.readChildNodes(A,B.responsibleParty)},"individualName":function(A,B){B.individualName=this.getChildValue(A)},"organisationName":function(A,B){B.organisationName=this.getChildValue(A)},"positionName":function(A,B){B.positionName=this.getChildValue(A)},"contactInfo":function(A,B){B.contactInfo={};this.readChildNodes(A,B.contactInfo)},"phone":function(A,B){B.phone={};this.readChildNodes(A,B.phone)},"voice":function(B,A){A.voice=this.getChildValue(B)},"facsimile":function(B,A){A.facsimile=this.getChildValue(B)},"address":function(A,B){B.address={};this.readChildNodes(A,B.address)},"deliveryPoint":function(B,A){A.deliveryPoint=this.getChildValue(B)},"city":function(B,A){A.city=this.getChildValue(B)},"postalCode":function(B,A){A.postalCode=this.getChildValue(B)},"country":function(B,A){A.country=this.getChildValue(B)},"electronicMailAddress":function(B,A){A.electronicMailAddress=this.getChildValue(B)},"fees":function(A,B){B.fees=this.getChildValue(A)},"accessConstraints":function(A,B){B.accessConstraints=this.getChildValue(A)},"ContentMetadata":function(B,A){A.contentMetadata=[];this.readChildNodes(B,A.contentMetadata)},"CoverageOfferingBrief":function(C,B){var A={};this.readChildNodes(C,A);B.push(A)},"name":function(B,A){A.name=this.getChildValue(B)},"label":function(B,A){A.label=this.getChildValue(B)},"lonLatEnvelope":function(C,B){var A=this.getElementsByTagNameNS(C,"http://www.opengis.net/gml","pos");if(A.length==2){var D={};var E={};OpenLayers.Format.GML.v3.prototype.readers["gml"].pos.apply(this,[A[0],D]);OpenLayers.Format.GML.v3.prototype.readers["gml"].pos.apply(this,[A[1],E]);B.lonLatEnvelope={};B.lonLatEnvelope.srsName=C.getAttribute("srsName");B.lonLatEnvelope.min=D.points[0];B.lonLatEnvelope.max=E.points[0]}}}},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1_0_0"});OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:false,activate:function(){var A=OpenLayers.Strategy.prototype.activate.apply(this,arguments);if(A){this.layer.events.on({"refresh":this.load,scope:this});if(this.layer.visibility==true||this.preload){this.load()}else{this.layer.events.on({"visibilitychanged":this.load,scope:this})}}return A},deactivate:function(){var A=OpenLayers.Strategy.prototype.deactivate.call(this);if(A){this.layer.events.un({"refresh":this.load,"visibilitychanged":this.load,scope:this})}return A},load:function(B){var A=this.layer;A.events.triggerEvent("loadstart",{filter:A.filter});A.protocol.read(OpenLayers.Util.applyDefaults({callback:this.merge,filter:A.filter,scope:this},B));A.events.un({"visibilitychanged":this.load,scope:this})},merge:function(F){var E=this.layer;E.destroyFeatures();var A=F.features;if(A&&A.length>0){var B=E.projection;var H=E.map.getProjectionObject();if(!H.equals(B)){var D;for(var C=0,G=A.length;C<G;++C){D=A[C].geometry;if(D){D.transform(B,H)}}}E.addFeatures(A)}E.events.triggerEvent("loadend",{response:F})},CLASS_NAME:"OpenLayers.Strategy.Fixed"});OpenLayers.Control.Zoom=OpenLayers.Class(OpenLayers.Control,{zoomInText:"+",zoomInId:"olZoomInLink",zoomOutText:"\u2212",zoomOutId:"olZoomOutLink",draw:function(){var C=OpenLayers.Control.prototype.draw.apply(this),E=this.getOrCreateLinks(C),D=E.zoomIn,B=E.zoomOut,A=this.map.events;if(B.parentNode!==C){A=this.events;A.attachToElement(B.parentNode)}A.register("buttonclick",this,this.onZoomClick);this.zoomInLink=D;this.zoomOutLink=B;return C},getOrCreateLinks:function(A){var C=document.getElementById(this.zoomInId),B=document.getElementById(this.zoomOutId);if(!C){C=document.createElement("a");C.href="#zoomIn";C.appendChild(document.createTextNode(this.zoomInText));C.className="olControlZoomIn";A.appendChild(C)}OpenLayers.Element.addClass(C,"olButton");if(!B){B=document.createElement("a");B.href="#zoomOut";B.appendChild(document.createTextNode(this.zoomOutText));B.className="olControlZoomOut";A.appendChild(B)}OpenLayers.Element.addClass(B,"olButton");return{zoomIn:C,zoomOut:B}},onZoomClick:function(B){var A=B.buttonElement;if(A===this.zoomInLink){this.map.zoomIn()}else{if(A===this.zoomOutLink){this.map.zoomOut()}}},destroy:function(){if(this.map){this.map.events.unregister("buttonclick",this,this.onZoomClick)}delete this.zoomInLink;delete this.zoomOutLink;OpenLayers.Control.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Control.Zoom"});OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,{dataFrom:null,styleFrom:null,addNodes:function(K,H){if(K.length<2){throw new Error("At least two point features have to be added to create a line from")}var B=new Array(K.length-1);var L,D,C;for(var F=0,J=K.length;F<J;F++){L=K[F];C=L.geometry;if(!C){var I=L.lonlat;C=new OpenLayers.Geometry.Point(I.lon,I.lat)}else{if(C.CLASS_NAME!="OpenLayers.Geometry.Point"){throw new TypeError("Only features with point geometries are supported.")}}if(F>0){var G=(this.dataFrom!=null)?(K[F+this.dataFrom].data||K[F+this.dataFrom].attributes):null;var E=(this.styleFrom!=null)?(K[F+this.styleFrom].style):null;var A=new OpenLayers.Geometry.LineString([D,C]);B[F-1]=new OpenLayers.Feature.Vector(A,G,E)}D=C}this.addFeatures(B,H)},CLASS_NAME:"OpenLayers.Layer.PointTrack"});OpenLayers.Layer.PointTrack.SOURCE_NODE=-1;OpenLayers.Layer.PointTrack.TARGET_NODE=0;OpenLayers.Layer.PointTrack.dataFrom={"SOURCE_NODE":-1,"TARGET_NODE":0};OpenLayers.Protocol.WFS=function(B){B=OpenLayers.Util.applyDefaults(B,OpenLayers.Protocol.WFS.DEFAULTS);var A=OpenLayers.Protocol.WFS["v"+B.version.replace(/\./g,"_")];if(!A){throw"Unsupported WFS version: "+B.version}return new A(B)};OpenLayers.Protocol.WFS.fromWMSLayer=function(E,D){var A,F;var G=E.params["LAYERS"];var B=(OpenLayers.Util.isArray(G)?G[0]:G).split(":");if(B.length>1){F=B[0]}A=B.pop();var C={url:E.url,featureType:A,featurePrefix:F,srsName:E.projection&&E.projection.getCode()||E.map&&E.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(D,C))};OpenLayers.Protocol.WFS.DEFAULTS={"version":"1.0.0"};OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:false,markers:null,drawn:false,initialize:function(B,A){OpenLayers.Layer.prototype.initialize.apply(this,arguments);this.markers=[]},destroy:function(){this.clearMarkers();this.markers=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(B){if(B!=this.opacity){this.opacity=B;for(var A=0,C=this.markers.length;A<C;A++){this.markers[A].setOpacity(this.opacity)}}},moveTo:function(C,B,E){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(B||!this.drawn){for(var A=0,D=this.markers.length;A<D;A++){this.drawMarker(this.markers[A])}this.drawn=true}},addMarker:function(A){this.markers.push(A);if(this.opacity<1){A.setOpacity(this.opacity)}if(this.map&&this.map.getExtent()){A.map=this.map;this.drawMarker(A)}},removeMarker:function(A){if(this.markers&&this.markers.length){OpenLayers.Util.removeItem(this.markers,A);A.erase()}},clearMarkers:function(){if(this.markers!=null){while(this.markers.length>0){this.removeMarker(this.markers[0])}}},drawMarker:function(A){var B=this.map.getLayerPxFromLonLat(A.lonlat);if(B==null){A.display(false)}else{if(!A.isDrawn()){var C=A.draw(B);this.div.appendChild(C)}else{if(A.icon){A.icon.moveTo(B)}}}},getDataExtent:function(){var B=null;if(this.markers&&(this.markers.length>0)){var B=new OpenLayers.Bounds();for(var A=0,C=this.markers.length;A<C;A++){var D=this.markers[A];B.extend(D.lonlat)}}return B},CLASS_NAME:"OpenLayers.Layer.Markers"});OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control.Button,{slideFactor:50,slideRatio:null,direction:null,initialize:function(B,A){this.direction=B;this.CLASS_NAME+=this.direction;OpenLayers.Control.prototype.initialize.apply(this,[A])},trigger:function(){if(this.map){var A=OpenLayers.Function.bind(function(B){return this.slideRatio?this.map.getSize()[B]*this.slideRatio:this.slideFactor},this);switch(this.direction){case OpenLayers.Control.Pan.NORTH:this.map.pan(0,-A("h"));break;case OpenLayers.Control.Pan.SOUTH:this.map.pan(0,A("h"));break;case OpenLayers.Control.Pan.WEST:this.map.pan(-A("w"),0);break;case OpenLayers.Control.Pan.EAST:this.map.pan(A("w"),0);break}}},CLASS_NAME:"OpenLayers.Control.Pan"});OpenLayers.Control.Pan.NORTH="North";OpenLayers.Control.Pan.SOUTH="South";OpenLayers.Control.Pan.EAST="East";OpenLayers.Control.Pan.WEST="West";OpenLayers.Format.CSWGetDomain=function(B){B=OpenLayers.Util.applyDefaults(B,OpenLayers.Format.CSWGetDomain.DEFAULTS);var A=OpenLayers.Format.CSWGetDomain["v"+B.version.replace(/\./g,"_")];if(!A){throw"Unsupported CSWGetDomain version: "+B.version}return new A(B)};OpenLayers.Format.CSWGetDomain.DEFAULTS={"version":"2.0.2"};OpenLayers.Format.CSWGetDomain.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",csw:"http://www.opengis.net/cat/csw/2.0.2"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",PropertyName:null,ParameterName:null,read:function(B){if(typeof B=="string"){B=OpenLayers.Format.XML.prototype.read.apply(this,[B])}if(B&&B.nodeType==9){B=B.documentElement}var A={};this.readNode(B,A);return A},readers:{"csw":{"GetDomainResponse":function(B,A){this.readChildNodes(B,A)},"DomainValues":function(D,B){if(!(OpenLayers.Util.isArray(B.DomainValues))){B.DomainValues=[]}var E=D.attributes;var A={};for(var C=0,F=E.length;C<F;++C){A[E[C].name]=E[C].nodeValue}this.readChildNodes(D,A);B.DomainValues.push(A)},"PropertyName":function(B,A){A.PropertyName=this.getChildValue(B)},"ParameterName":function(B,A){A.ParameterName=this.getChildValue(B)},"ListOfValues":function(B,A){if(!(OpenLayers.Util.isArray(A.ListOfValues))){A.ListOfValues=[]}this.readChildNodes(B,A.ListOfValues)},"Value":function(C,B){var D=C.attributes;var E={};for(var A=0,F=D.length;A<F;++A){E[D[A].name]=D[A].nodeValue}E.value=this.getChildValue(C);B.push({Value:E})},"ConceptualScheme":function(B,A){A.ConceptualScheme={};this.readChildNodes(B,A.ConceptualScheme)},"Name":function(B,A){A.Name=this.getChildValue(B)},"Document":function(B,A){A.Document=this.getChildValue(B)},"Authority":function(B,A){A.Authority=this.getChildValue(B)},"RangeOfValues":function(B,A){A.RangeOfValues={};this.readChildNodes(B,A.RangeOfValues)},"MinValue":function(C,B){var D=C.attributes;var E={};for(var A=0,F=D.length;A<F;++A){E[D[A].name]=D[A].nodeValue}E.value=this.getChildValue(C);B.MinValue=E},"MaxValue":function(C,B){var D=C.attributes;var E={};for(var A=0,F=D.length;A<F;++A){E[D[A].name]=D[A].nodeValue}E.value=this.getChildValue(C);B.MaxValue=E}}},write:function(B){var A=this.writeNode("csw:GetDomain",B);return OpenLayers.Format.XML.prototype.write.apply(this,[A])},writers:{"csw":{"GetDomain":function(B){var A=this.createElementNSPlus("csw:GetDomain",{attributes:{service:"CSW",version:this.version}});if(B.PropertyName||this.PropertyName){this.writeNode("csw:PropertyName",B.PropertyName||this.PropertyName,A)}else{if(B.ParameterName||this.ParameterName){this.writeNode("csw:ParameterName",B.ParameterName||this.ParameterName,A)}}this.readChildNodes(A,B);return A},"PropertyName":function(B){var A=this.createElementNSPlus("csw:PropertyName",{value:B});return A},"ParameterName":function(B){var A=this.createElementNSPlus("csw:ParameterName",{value:B});return A}}},CLASS_NAME:"OpenLayers.Format.CSWGetDomain.v2_0_2"});OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,{read:function(C){var A=new OpenLayers.Format.ArcXML();var B=A.read(C);return B.features.feature}});OpenLayers.Control.Snapping=OpenLayers.Class(OpenLayers.Control,{DEFAULTS:{tolerance:10,node:true,edge:true,vertex:true},greedy:true,precedence:["node","vertex","edge"],resolution:null,geoToleranceCache:null,layer:null,feature:null,point:null,initialize:function(A){OpenLayers.Control.prototype.initialize.apply(this,[A]);this.options=A||{};if(this.options.layer){this.setLayer(this.options.layer)}var B=OpenLayers.Util.extend({},this.options.defaults);this.defaults=OpenLayers.Util.applyDefaults(B,this.DEFAULTS);this.setTargets(this.options.targets);if(this.targets.length===0&&this.layer){this.addTargetLayer(this.layer)}this.geoToleranceCache={}},setLayer:function(A){if(this.active){this.deactivate();this.layer=A;this.activate()}else{this.layer=A}},setTargets:function(B){this.targets=[];if(B&&B.length){var D;for(var A=0,C=B.length;A<C;++A){D=B[A];if(D instanceof OpenLayers.Layer.Vector){this.addTargetLayer(D)}else{this.addTarget(D)}}}},addTargetLayer:function(A){this.addTarget({layer:A})},addTarget:function(A){A=OpenLayers.Util.applyDefaults(A,this.defaults);A.nodeTolerance=A.nodeTolerance||A.tolerance;A.vertexTolerance=A.vertexTolerance||A.tolerance;A.edgeTolerance=A.edgeTolerance||A.tolerance;this.targets.push(A)},removeTargetLayer:function(B){var C;for(var A=this.targets.length-1;A>=0;--A){C=this.targets[A];if(C.layer===B){this.removeTarget(C)}}},removeTarget:function(A){return OpenLayers.Util.removeItem(this.targets,A)},activate:function(){var A=OpenLayers.Control.prototype.activate.call(this);if(A){if(this.layer&&this.layer.events){this.layer.events.on({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this})}}return A},deactivate:function(){var A=OpenLayers.Control.prototype.deactivate.call(this);if(A){if(this.layer&&this.layer.events){this.layer.events.un({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this})}}this.feature=null;this.point=null;return A},onSketchModified:function(A){this.feature=A.feature;this.considerSnapping(A.vertex,A.vertex)},onVertexModified:function(A){this.feature=A.feature;var B=this.layer.map.getLonLatFromViewPortPx(A.pixel);this.considerSnapping(A.vertex,new OpenLayers.Geometry.Point(B.lon,B.lat))},considerSnapping:function(I,C){var D={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY,x:null,y:null};var H=false;var B,G;for(var E=0,A=this.targets.length;E<A;++E){G=this.targets[E];B=this.testTarget(G,C);if(B){if(this.greedy){D=B;D.target=G;H=true;break}else{if((B.rank<D.rank)||(B.rank===D.rank&&B.dist<D.dist)){D=B;D.target=G;H=true}}}}if(H){var F=this.events.triggerEvent("beforesnap",{point:I,x:D.x,y:D.y,distance:D.dist,layer:D.target.layer,snapType:this.precedence[D.rank]});if(F!==false){I.x=D.x;I.y=D.y;this.point=I;this.events.triggerEvent("snap",{point:I,snapType:this.precedence[D.rank],layer:D.target.layer,distance:D.dist})}else{H=false}}if(this.point&&!H){I.x=C.x;I.y=C.y;this.point=null;this.events.triggerEvent("unsnap",{point:I})}},testTarget:function(S,W){var O=this.layer.map.getResolution();if("minResolution" in S){if(O<S.minResolution){return null}}if("maxResolution" in S){if(O>=S.maxResolution){return null}}var T={node:this.getGeoTolerance(S.nodeTolerance,O),vertex:this.getGeoTolerance(S.vertexTolerance,O),edge:this.getGeoTolerance(S.edgeTolerance,O)};var P=Math.max(T.node,T.vertex,T.edge);var F={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY};var K=false;var V=S.layer.features;var L,U,N,J,E,I,M;var B=this.precedence.length;var C=new OpenLayers.LonLat(W.x,W.y);for(var H=0,R=V.length;H<R;++H){L=V[H];if(L!==this.feature&&!L._sketch&&L.state!==OpenLayers.State.DELETE&&(!S.filter||S.filter.evaluate(L))){if(L.atPoint(C,P,P)){for(var Q=0,A=Math.min(F.rank+1,B);Q<A;++Q){U=this.precedence[Q];if(S[U]){if(U==="edge"){E=L.geometry.distanceTo(W,{details:true});I=E.distance;if(I<=T[U]&&I<F.dist){F={rank:Q,dist:I,x:E.x0,y:E.y0};K=true;break}}else{N=L.geometry.getVertices(U==="node");M=false;for(var G=0,D=N.length;G<D;++G){J=N[G];I=J.distanceTo(W);if(I<=T[U]&&(Q<F.rank||(Q===F.rank&&I<F.dist))){F={rank:Q,dist:I,x:J.x,y:J.y};K=true;M=true}}if(M){break}}}}}}}return K?F:null},getGeoTolerance:function(A,C){if(C!==this.resolution){this.resolution=C;this.geoToleranceCache={}}var B=this.geoToleranceCache[A];if(B===undefined){B=A*C;this.geoToleranceCache[A]=B}return B},destroy:function(){if(this.active){this.deactivate()}delete this.layer;delete this.targets;OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Snapping"});OpenLayers.Format.OWSCommon.v1_1_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows/1.1",xlink:"http://www.w3.org/1999/xlink"},readers:{"ows":OpenLayers.Util.applyDefaults({"ExceptionReport":function(B,A){A.exceptionReport={version:B.getAttribute("version"),language:B.getAttribute("xml:lang"),exceptions:[]};this.readChildNodes(B,A.exceptionReport)},"AllowedValues":function(B,A){A.allowedValues={};this.readChildNodes(B,A.allowedValues)},"AnyValue":function(B,A){A.anyValue=true},"DataType":function(B,A){A.dataType=this.getChildValue(B)},"Range":function(B,A){A.range={};this.readChildNodes(B,A.range)},"MinimumValue":function(A,B){B.minValue=this.getChildValue(A)},"MaximumValue":function(A,B){B.maxValue=this.getChildValue(A)},"Identifier":function(B,A){A.identifier=this.getChildValue(B)},"SupportedCRS":function(B,A){A.supportedCRS=this.getChildValue(B)}},OpenLayers.Format.OWSCommon.v1.prototype.readers["ows"])},writers:{"ows":OpenLayers.Util.applyDefaults({"Range":function(B){var A=this.createElementNSPlus("ows:Range",{attributes:{"ows:rangeClosure":B.closure}});this.writeNode("ows:MinimumValue",B.minValue,A);this.writeNode("ows:MaximumValue",B.maxValue,A);return A},"MinimumValue":function(B){var A=this.createElementNSPlus("ows:MinimumValue",{value:B});return A},"MaximumValue":function(B){var A=this.createElementNSPlus("ows:MaximumValue",{value:B});return A},"Value":function(B){var A=this.createElementNSPlus("ows:Value",{value:B});return A}},OpenLayers.Format.OWSCommon.v1.prototype.writers["ows"])},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_1_0"});OpenLayers.Format.WCSGetCoverage=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},VERSION:"1.1.2",schemaLocation:"http://www.opengis.net/wcs/1.1 http://schemas.opengis.net/wcs/1.1/wcsGetCoverage.xsd",write:function(B){var A=this.writeNode("wcs:GetCoverage",B);this.setAttributeNS(A,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[A])},writers:{"wcs":{"GetCoverage":function(B){var A=this.createElementNSPlus("wcs:GetCoverage",{attributes:{version:B.version||this.VERSION,service:"WCS"}});this.writeNode("ows:Identifier",B.identifier,A);this.writeNode("wcs:DomainSubset",B.domainSubset,A);this.writeNode("wcs:Output",B.output,A);return A},"DomainSubset":function(B){var A=this.createElementNSPlus("wcs:DomainSubset",{});this.writeNode("ows:BoundingBox",B.boundingBox,A);if(B.temporalSubset){this.writeNode("wcs:TemporalSubset",B.temporalSubset,A)}return A},"TemporalSubset":function(C){var B=this.createElementNSPlus("wcs:TemporalSubset",{});for(var A=0,D=C.timePeriods.length;A<D;++A){this.writeNode("wcs:TimePeriod",C.timePeriods[A],B)}return B},"TimePeriod":function(B){var A=this.createElementNSPlus("wcs:TimePeriod",{});this.writeNode("wcs:BeginPosition",B.begin,A);this.writeNode("wcs:EndPosition",B.end,A);if(B.resolution){this.writeNode("wcs:TimeResolution",B.resolution,A)}return A},"BeginPosition":function(A){var B=this.createElementNSPlus("wcs:BeginPosition",{value:A});return B},"EndPosition":function(B){var A=this.createElementNSPlus("wcs:EndPosition",{value:B});return A},"TimeResolution":function(B){var A=this.createElementNSPlus("wcs:TimeResolution",{value:B});return A},"Output":function(B){var A=this.createElementNSPlus("wcs:Output",{attributes:{format:B.format,store:B.store}});if(B.gridCRS){this.writeNode("wcs:GridCRS",B.gridCRS,A)}return A},"GridCRS":function(B){var A=this.createElementNSPlus("wcs:GridCRS",{});this.writeNode("wcs:GridBaseCRS",B.baseCRS,A);if(B.type){this.writeNode("wcs:GridType",B.type,A)}if(B.origin){this.writeNode("wcs:GridOrigin",B.origin,A)}this.writeNode("wcs:GridOffsets",B.offsets,A);if(B.CS){this.writeNode("wcs:GridCS",B.CS,A)}return A},"GridBaseCRS":function(A){return this.createElementNSPlus("wcs:GridBaseCRS",{value:A})},"GridOrigin":function(A){return this.createElementNSPlus("wcs:GridOrigin",{value:A})},"GridType":function(A){return this.createElementNSPlus("wcs:GridType",{value:A})},"GridOffsets":function(A){return this.createElementNSPlus("wcs:GridOffsets",{value:A})},"GridCS":function(A){return this.createElementNSPlus("wcs:GridCS",{value:A})}},"ows":OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.WCSGetCoverage"});OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{kml:"http://www.opengis.net/kml/2.2",gx:"http://www.google.com/kml/ext/2.2"},kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date(),extractAttributes:true,kvpAttributes:false,extractStyles:false,extractTracks:false,trackAttributes:null,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(A){this.regExes={trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g),kmlColor:(/(\w{2})(\w{2})(\w{2})(\w{2})/),kmlIconPalette:(/root:\/\/icons\/palette-(\d+)(\.\w+)/),straightBracket:(/\$\[(.*?)\]/g)};this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[A])},read:function(B){this.features=[];this.styles={};this.fetched={};var A={depth:0,styleBaseUrl:this.styleBaseUrl};return this.parseData(B,A)},parseData:function(G,E){if(typeof G=="string"){G=OpenLayers.Format.XML.prototype.read.apply(this,[G])}var D=["Link","NetworkLink","Style","StyleMap","Placemark"];for(var B=0,F=D.length;B<F;++B){var A=D[B];var C=this.getElementsByTagNameNS(G,"*",A);if(C.length==0){continue}switch(A.toLowerCase()){case"link":case"networklink":this.parseLinks(C,E);break;case"style":if(this.extractStyles){this.parseStyles(C,E)}break;case"stylemap":if(this.extractStyles){this.parseStyleMaps(C,E)}break;case"placemark":this.parseFeatures(C,E);break}}return this.features},parseLinks:function(D,C){if(C.depth>=this.maxDepth){return false}var E=OpenLayers.Util.extend({},C);E.depth++;for(var B=0,F=D.length;B<F;B++){var A=this.parseProperty(D[B],"*","href");if(A&&!this.fetched[A]){this.fetched[A]=true;var G=this.fetchLink(A);if(G){this.parseData(G,E)}}}},fetchLink:function(A){var B=OpenLayers.Request.GET({url:A,async:false});if(B){return B.responseText}},parseStyles:function(D,C){for(var A=0,E=D.length;A<E;A++){var F=this.parseStyle(D[A]);if(F){var B=(C.styleBaseUrl||"")+"#"+F.id;this.styles[B]=F}}},parseKmlColor:function(B){var C=null;if(B){var A=B.match(this.regExes.kmlColor);if(A){C={color:"#"+A[4]+A[3]+A[2],opacity:parseInt(A[1],16)/255}}}return C},parseStyle:function(R){var V={};var S=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"];var A,U,T,H,b;for(var d=0,N=S.length;d<N;++d){A=S[d];U=this.getElementsByTagNameNS(R,"*",A)[0];if(!U){continue}switch(A.toLowerCase()){case"linestyle":var L=this.parseProperty(U,"*","color");var C=this.parseKmlColor(L);if(C){V["strokeColor"]=C.color;V["strokeOpacity"]=C.opacity}var F=this.parseProperty(U,"*","width");if(F){V["strokeWidth"]=F}break;case"polystyle":var L=this.parseProperty(U,"*","color");var C=this.parseKmlColor(L);if(C){V["fillOpacity"]=C.opacity;V["fillColor"]=C.color}var M=this.parseProperty(U,"*","fill");if(M=="0"){V["fillColor"]="none"}var Q=this.parseProperty(U,"*","outline");if(Q=="0"){V["strokeWidth"]="0"}break;case"iconstyle":var k=parseFloat(this.parseProperty(U,"*","scale")||1);var F=32*k;var D=32*k;var e=this.getElementsByTagNameNS(U,"*","Icon")[0];if(e){var J=this.parseProperty(e,"*","href");if(J){var a=this.parseProperty(e,"*","w");var c=this.parseProperty(e,"*","h");var X="http://maps.google.com/mapfiles/kml";if(OpenLayers.String.startsWith(J,X)&&!a&&!c){a=64;c=64;k=k/2}a=a||c;c=c||a;if(a){F=parseInt(a)*k}if(c){D=parseInt(c)*k}var I=J.match(this.regExes.kmlIconPalette);if(I){var j=I[1];var W=I[2];var Y=this.parseProperty(e,"*","x");var Z=this.parseProperty(e,"*","y");var O=Y?Y/32:0;var f=Z?(7-Z/32):7;var E=f*8+O;J="http://maps.google.com/mapfiles/kml/pal"+j+"/icon"+E+W}V["graphicOpacity"]=1;V["externalGraphic"]=J}}var G=this.getElementsByTagNameNS(U,"*","hotSpot")[0];if(G){var Y=parseFloat(G.getAttribute("x"));var Z=parseFloat(G.getAttribute("y"));var B=G.getAttribute("xunits");if(B=="pixels"){V["graphicXOffset"]=-Y*k}else{if(B=="insetPixels"){V["graphicXOffset"]=-F+(Y*k)}else{if(B=="fraction"){V["graphicXOffset"]=-F*Y}}}var P=G.getAttribute("yunits");if(P=="pixels"){V["graphicYOffset"]=-D+(Z*k)+1}else{if(P=="insetPixels"){V["graphicYOffset"]=-(Z*k)+1}else{if(P=="fraction"){V["graphicYOffset"]=-D*(1-Z)+1}}}}V["graphicWidth"]=F;V["graphicHeight"]=D;break;case"balloonstyle":var g=OpenLayers.Util.getXmlNodeValue(U);if(g){V["balloonStyle"]=g.replace(this.regExes.straightBracket,"${$1}")}break;case"labelstyle":var L=this.parseProperty(U,"*","color");var C=this.parseKmlColor(L);if(C){V["fontColor"]=C.color;V["fontOpacity"]=C.opacity}break;default:}}if(!V["strokeColor"]&&V["fillColor"]){V["strokeColor"]=V["fillColor"]}var K=R.getAttribute("id");if(K&&V){V.id=K}return V},parseStyleMaps:function(L,G){for(var E=0,J=L.length;E<J;E++){var H=L[E];var F=this.getElementsByTagNameNS(H,"*","Pair");var I=H.getAttribute("id");for(var C=0,D=F.length;C<D;C++){var A=F[C];var B=this.parseProperty(A,"*","key");var K=this.parseProperty(A,"*","styleUrl");if(K&&B=="normal"){this.styles[(G.styleBaseUrl||"")+"#"+I]=this.styles[(G.styleBaseUrl||"")+K]}}}},parseFeatures:function(L,G){var A=[];for(var E=0,J=L.length;E<J;E++){var I=L[E];var K=this.parseFeature.apply(this,[I]);if(K){if(this.extractStyles&&K.attributes&&K.attributes.styleUrl){K.style=this.getStyle(K.attributes.styleUrl,G)}if(this.extractStyles){var H=this.getElementsByTagNameNS(I,"*","Style")[0];if(H){var D=this.parseStyle(H);if(D){K.style=OpenLayers.Util.extend(K.style,D)}}}if(this.extractTracks){var B=this.getElementsByTagNameNS(I,this.namespaces.gx,"Track");if(B&&B.length>0){var F=B[0];var C={features:[],feature:K};this.readNode(F,C);if(C.features.length>0){A.push.apply(A,C.features)}}}else{A.push(K)}}else{throw"Bad Placemark: "+E}}this.features=this.features.concat(A)},readers:{"kml":{"when":function(A,B){B.whens.push(OpenLayers.Date.parse(this.getChildValue(A)))},"_trackPointAttribute":function(A,B){var C=A.nodeName.split(":").pop();B.attributes[C].push(this.getChildValue(A))}},"gx":{"Track":function(F,H){var I={whens:[],points:[],angles:[]};if(this.trackAttributes){var A;I.attributes={};for(var E=0,B=this.trackAttributes.length;E<B;++E){A=this.trackAttributes[E];I.attributes[A]=[];if(!(A in this.readers.kml)){this.readers.kml[A]=this.readers.kml._trackPointAttribute}}}this.readChildNodes(F,I);if(I.whens.length!==I.points.length){throw new Error("gx:Track with unequal number of when ("+I.whens.length+") and gx:coord ("+I.points.length+") elements.")}var D=I.angles.length>0;if(D&&I.whens.length!==I.angles.length){throw new Error("gx:Track with unequal number of when ("+I.whens.length+") and gx:angles ("+I.angles.length+") elements.")}var K,J,C;for(var E=0,B=I.whens.length;E<B;++E){K=H.feature.clone();K.fid=H.feature.fid||H.feature.id;J=I.points[E];K.geometry=J;if("z" in J){K.attributes.altitude=J.z}if(this.internalProjection&&this.externalProjection){K.geometry.transform(this.externalProjection,this.internalProjection)}if(this.trackAttributes){for(var G=0,L=this.trackAttributes.length;G<L;++G){var A=this.trackAttributes[G];K.attributes[A]=I.attributes[A][E]}}K.attributes.when=I.whens[E];K.attributes.trackId=H.feature.id;if(D){C=I.angles[E];K.attributes.heading=parseFloat(C[0]);K.attributes.tilt=parseFloat(C[1]);K.attributes.roll=parseFloat(C[2])}H.features.push(K)}},"coord":function(C,D){var E=this.getChildValue(C);var A=E.replace(this.regExes.trimSpace,"").split(/\s+/);var B=new OpenLayers.Geometry.Point(A[0],A[1]);if(A.length>2){B.z=parseFloat(A[2])}D.points.push(B)},"angles":function(B,C){var D=this.getChildValue(B);var A=D.replace(this.regExes.trimSpace,"").split(/\s+/);C.angles.push(A)}}},parseFeature:function(F){var G=["MultiGeometry","Polygon","LineString","Point"];var I,A,C,K;for(var D=0,H=G.length;D<H;++D){I=G[D];this.internalns=F.namespaceURI?F.namespaceURI:this.kmlns;A=this.getElementsByTagNameNS(F,this.internalns,I);if(A.length>0){var K=this.parseGeometry[I.toLowerCase()];if(K){C=K.apply(this,[A[0]]);if(this.internalProjection&&this.externalProjection){C.transform(this.externalProjection,this.internalProjection)}}else{throw new TypeError("Unsupported geometry type: "+I)}break}}var E;if(this.extractAttributes){E=this.parseAttributes(F)}var J=new OpenLayers.Feature.Vector(C,E);var B=F.getAttribute("id")||F.getAttribute("name");if(B!=null){J.fid=B}return J},getStyle:function(A,C){var B=OpenLayers.Util.removeTail(A);var D=OpenLayers.Util.extend({},C);D.depth++;D.styleBaseUrl=B;if(!this.styles[A]&&!OpenLayers.String.startsWith(A,"#")&&D.depth<=this.maxDepth&&!this.fetched[B]){var F=this.fetchLink(B);if(F){this.parseData(F,D)}}var E=OpenLayers.Util.extend({},this.styles[A]);return E},parseGeometry:{point:function(D){var A=this.getElementsByTagNameNS(D,this.internalns,"coordinates");var B=[];if(A.length>0){var E=A[0].firstChild.nodeValue;E=E.replace(this.regExes.removeSpace,"");B=E.split(",")}var C=null;if(B.length>1){if(B.length==2){B[2]=null}C=new OpenLayers.Geometry.Point(B[0],B[1],B[2])}else{throw"Bad coordinate string: "+E}return C},linestring:function(H,F){var A=this.getElementsByTagNameNS(H,this.internalns,"coordinates");var B=null;if(A.length>0){var C=this.getChildValue(A[0]);C=C.replace(this.regExes.trimSpace,"");C=C.replace(this.regExes.trimComma,",");var I=C.split(this.regExes.splitSpace);var G=I.length;var J=new Array(G);var K,D;for(var E=0;E<G;++E){K=I[E].split(",");D=K.length;if(D>1){if(K.length==2){K[2]=null}J[E]=new OpenLayers.Geometry.Point(K[0],K[1],K[2])}else{throw"Bad LineString point coordinates: "+I[E]}}if(G){if(F){B=new OpenLayers.Geometry.LinearRing(J)}else{B=new OpenLayers.Geometry.LineString(J)}}else{throw"Bad LineString coordinates: "+C}}return B},polygon:function(D){var A=this.getElementsByTagNameNS(D,this.internalns,"LinearRing");var C=A.length;var E=new Array(C);if(C>0){var G;for(var B=0,F=A.length;B<F;++B){G=this.parseGeometry.linestring.apply(this,[A[B],true]);if(G){E[B]=G}else{throw"Bad LinearRing geometry: "+B}}}return new OpenLayers.Geometry.Polygon(E)},multigeometry:function(C){var E,H;var D=[];var A=C.childNodes;for(var B=0,F=A.length;B<F;++B){E=A[B];if(E.nodeType==1){var G=(E.prefix)?E.nodeName.split(":")[1]:E.nodeName;var H=this.parseGeometry[G.toLowerCase()];if(H){D.push(H.apply(this,[E]))}}}return new OpenLayers.Geometry.Collection(D)}},parseAttributes:function(I){var H={};var K=I.getElementsByTagName("ExtendedData");if(K.length){H=this.parseExtendedData(K[0])}var J,A,F;var E=I.childNodes;for(var G=0,B=E.length;G<B;++G){J=E[G];if(J.nodeType==1){A=J.childNodes;if(A.length>=1&&A.length<=3){var F;switch(A.length){case 1:F=A[0];break;case 2:var D=A[0];var M=A[1];F=(D.nodeType==3||D.nodeType==4)?D:M;break;case 3:default:F=A[1];break}if(F.nodeType==3||F.nodeType==4){var C=(J.prefix)?J.nodeName.split(":")[1]:J.nodeName;var L=OpenLayers.Util.getXmlNodeValue(F);if(L){L=L.replace(this.regExes.trimSpace,"");H[C]=L}}}}}return H},parseExtendedData:function(H){var G={};var F,J,D,A;var E=H.getElementsByTagName("Data");for(F=0,J=E.length;F<J;F++){D=E[F];A=D.getAttribute("name");var C={};var K=D.getElementsByTagName("value");if(K.length){C["value"]=this.getChildValue(K[0])}if(this.kvpAttributes){G[A]=C["value"]}else{var B=D.getElementsByTagName("displayName");if(B.length){C["displayName"]=this.getChildValue(B[0])}G[A]=C}}var I=H.getElementsByTagName("SimpleData");for(F=0,J=I.length;F<J;F++){var C={};D=I[F];A=D.getAttribute("name");C["value"]=this.getChildValue(D);if(this.kvpAttributes){G[A]=C["value"]}else{C["displayName"]=A;G[A]=C}}return G},parseProperty:function(F,A,B){var E;var D=this.getElementsByTagNameNS(F,A,B);try{E=OpenLayers.Util.getXmlNodeValue(D[0])}catch(C){E=null}return E},write:function(A){if(!(OpenLayers.Util.isArray(A))){A=[A]}var C=this.createElementNS(this.kmlns,"kml");var D=this.createFolderXML();for(var B=0,E=A.length;B<E;++B){D.appendChild(this.createPlacemarkXML(A[B]))}C.appendChild(D);return OpenLayers.Format.XML.prototype.write.apply(this,[C])},createFolderXML:function(){var B=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var A=this.createElementNS(this.kmlns,"name");var D=this.createTextNode(this.foldersName);A.appendChild(D);B.appendChild(A)}if(this.foldersDesc){var E=this.createElementNS(this.kmlns,"description");var C=this.createTextNode(this.foldersDesc);E.appendChild(C);B.appendChild(E)}return B},createPlacemarkXML:function(H){var C=this.createElementNS(this.kmlns,"name");var F=(H.style&&H.style.label)?H.style.label:H.id;var G=H.attributes.name||F;C.appendChild(this.createTextNode(G));var B=this.createElementNS(this.kmlns,"description");var D=H.attributes.description||this.placemarksDesc;B.appendChild(this.createTextNode(D));var E=this.createElementNS(this.kmlns,"Placemark");if(H.fid!=null){E.setAttribute("id",H.fid)}E.appendChild(C);E.appendChild(B);var A=this.buildGeometryNode(H.geometry);E.appendChild(A);if(H.attributes){var I=this.buildExtendedData(H.attributes);if(I){E.appendChild(I)}}return E},buildGeometryNode:function(E){var B=E.CLASS_NAME;var A=B.substring(B.lastIndexOf(".")+1);var C=this.buildGeometry[A.toLowerCase()];var D=null;if(C){D=C.apply(this,[E])}return D},buildGeometry:{point:function(B){var A=this.createElementNS(this.kmlns,"Point");A.appendChild(this.buildCoordinatesNode(B));return A},multipoint:function(A){return this.buildGeometry.collection.apply(this,[A])},linestring:function(B){var A=this.createElementNS(this.kmlns,"LineString");A.appendChild(this.buildCoordinatesNode(B));return A},multilinestring:function(A){return this.buildGeometry.collection.apply(this,[A])},linearring:function(B){var A=this.createElementNS(this.kmlns,"LinearRing");A.appendChild(this.buildCoordinatesNode(B));return A},polygon:function(C){var B=this.createElementNS(this.kmlns,"Polygon");var E=C.components;var A,H,G;for(var D=0,F=E.length;D<F;++D){G=(D==0)?"outerBoundaryIs":"innerBoundaryIs";A=this.createElementNS(this.kmlns,G);H=this.buildGeometry.linearring.apply(this,[E[D]]);A.appendChild(H);B.appendChild(A)}return B},multipolygon:function(A){return this.buildGeometry.collection.apply(this,[A])},collection:function(D){var B=this.createElementNS(this.kmlns,"MultiGeometry");var C;for(var A=0,E=D.components.length;A<E;++A){C=this.buildGeometryNode.apply(this,[D.components[A]]);if(C){B.appendChild(C)}}return B}},buildCoordinatesNode:function(A){var I=this.createElementNS(this.kmlns,"coordinates");var E;var G=A.components;if(G){var H;var C=G.length;var D=new Array(C);for(var B=0;B<C;++B){H=G[B];D[B]=this.buildCoordinates(H)}E=D.join(" ")}else{E=this.buildCoordinates(A)}var F=this.createTextNode(E);I.appendChild(F);return I},buildCoordinates:function(A){if(this.internalProjection&&this.externalProjection){A=A.clone();A.transform(this.internalProjection,this.externalProjection)}return A.x+","+A.y},buildExtendedData:function(B){var E=this.createElementNS(this.kmlns,"ExtendedData");for(var C in B){if(B[C]&&C!="name"&&C!="description"&&C!="styleUrl"){var F=this.createElementNS(this.kmlns,"Data");F.setAttribute("name",C);var D=this.createElementNS(this.kmlns,"value");if(typeof B[C]=="object"){if(B[C].value){D.appendChild(this.createTextNode(B[C].value))}if(B[C].displayName){var A=this.createElementNS(this.kmlns,"displayName");A.appendChild(this.getXMLDoc().createCDATASection(B[C].displayName));F.appendChild(A)}}else{D.appendChild(this.createTextNode(B[C]))}F.appendChild(D);E.appendChild(F)}}if(this.isSimpleContent(E)){return null}else{return E}},CLASS_NAME:"OpenLayers.Format.KML"});OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",profile:null,CLASS_NAME:"OpenLayers.Format.WMSCapabilities"});OpenLayers.Format.WMSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wms:"http://www.opengis.net/wms",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"wms",read:function(D){if(typeof D=="string"){D=OpenLayers.Format.XML.prototype.read.apply(this,[D])}var A=D;if(D&&D.nodeType==9){D=D.documentElement}var B={};this.readNode(D,B);if(B.service===undefined){var C=new OpenLayers.Format.OGCExceptionReport();B.error=C.read(A)}return B},readers:{"wms":{"Service":function(B,A){A.service={};this.readChildNodes(B,A.service)},"Name":function(B,A){A.name=this.getChildValue(B)},"Title":function(B,A){A.title=this.getChildValue(B)},"Abstract":function(B,A){A["abstract"]=this.getChildValue(B)},"BoundingBox":function(B,A){var D={};D.bbox=[parseFloat(B.getAttribute("minx")),parseFloat(B.getAttribute("miny")),parseFloat(B.getAttribute("maxx")),parseFloat(B.getAttribute("maxy"))];var C={x:parseFloat(B.getAttribute("resx")),y:parseFloat(B.getAttribute("resy"))};if(!(isNaN(C.x)&&isNaN(C.y))){D.res=C}return D},"OnlineResource":function(B,A){A.href=this.getAttributeNS(B,this.namespaces.xlink,"href")},"ContactInformation":function(B,A){A.contactInformation={};this.readChildNodes(B,A.contactInformation)},"ContactPersonPrimary":function(B,A){A.personPrimary={};this.readChildNodes(B,A.personPrimary)},"ContactPerson":function(B,A){A.person=this.getChildValue(B)},"ContactOrganization":function(B,A){A.organization=this.getChildValue(B)},"ContactPosition":function(B,A){A.position=this.getChildValue(B)},"ContactAddress":function(B,A){A.contactAddress={};this.readChildNodes(B,A.contactAddress)},"AddressType":function(B,A){A.type=this.getChildValue(B)},"Address":function(B,A){A.address=this.getChildValue(B)},"City":function(B,A){A.city=this.getChildValue(B)},"StateOrProvince":function(B,A){A.stateOrProvince=this.getChildValue(B)},"PostCode":function(B,A){A.postcode=this.getChildValue(B)},"Country":function(B,A){A.country=this.getChildValue(B)},"ContactVoiceTelephone":function(B,A){A.phone=this.getChildValue(B)},"ContactFacsimileTelephone":function(B,A){A.fax=this.getChildValue(B)},"ContactElectronicMailAddress":function(B,A){A.email=this.getChildValue(B)},"Fees":function(C,B){var A=this.getChildValue(C);if(A&&A.toLowerCase()!="none"){B.fees=A}},"AccessConstraints":function(B,A){var C=this.getChildValue(B);if(C&&C.toLowerCase()!="none"){A.accessConstraints=C}},"Capability":function(B,A){A.capability={nestedLayers:[],layers:[]};this.readChildNodes(B,A.capability)},"Request":function(B,A){A.request={};this.readChildNodes(B,A.request)},"GetCapabilities":function(B,A){A.getcapabilities={formats:[]};this.readChildNodes(B,A.getcapabilities)},"Format":function(B,A){if(OpenLayers.Util.isArray(A.formats)){A.formats.push(this.getChildValue(B))}else{A.format=this.getChildValue(B)}},"DCPType":function(B,A){this.readChildNodes(B,A)},"HTTP":function(B,A){this.readChildNodes(B,A)},"Get":function(B,A){A.get={};this.readChildNodes(B,A.get);if(!A.href){A.href=A.get.href}},"Post":function(B,A){A.post={};this.readChildNodes(B,A.post);if(!A.href){A.href=A.get.href}},"GetMap":function(B,A){A.getmap={formats:[]};this.readChildNodes(B,A.getmap)},"GetFeatureInfo":function(B,A){A.getfeatureinfo={formats:[]};this.readChildNodes(B,A.getfeatureinfo)},"Exception":function(B,A){A.exception={formats:[]};this.readChildNodes(B,A.exception)},"Layer":function(K,D){var M,B;if(D.capability){B=D.capability;M=D}else{B=D}var F=K.getAttributeNode("queryable");var A=(F&&F.specified)?K.getAttribute("queryable"):null;F=K.getAttributeNode("cascaded");var L=(F&&F.specified)?K.getAttribute("cascaded"):null;F=K.getAttributeNode("opaque");var H=(F&&F.specified)?K.getAttribute("opaque"):null;var N=K.getAttribute("noSubsets");var E=K.getAttribute("fixedWidth");var P=K.getAttribute("fixedHeight");var J=M||{},I=OpenLayers.Util.extend;var G={nestedLayers:[],styles:M?[].concat(M.styles):[],srs:M?I({},J.srs):{},metadataURLs:[],bbox:M?I({},J.bbox):{},llbbox:J.llbbox,dimensions:M?I({},J.dimensions):{},authorityURLs:M?I({},J.authorityURLs):{},identifiers:{},keywords:[],queryable:(A&&A!=="")?(A==="1"||A==="true"):(J.queryable||false),cascaded:(L!==null)?parseInt(L):(J.cascaded||0),opaque:H?(H==="1"||H==="true"):(J.opaque||false),noSubsets:(N!==null)?(N==="1"||N==="true"):(J.noSubsets||false),fixedWidth:(E!=null)?parseInt(E):(J.fixedWidth||0),fixedHeight:(P!=null)?parseInt(P):(J.fixedHeight||0),minScale:J.minScale,maxScale:J.maxScale,attribution:J.attribution};D.nestedLayers.push(G);G.capability=B;this.readChildNodes(K,G);delete G.capability;if(G.name){var Q=G.name.split(":"),C=B.request,O=C.getfeatureinfo;if(Q.length>0){G.prefix=Q[0]}B.layers.push(G);if(G.formats===undefined){G.formats=C.getmap.formats}if(G.infoFormats===undefined&&O){G.infoFormats=O.formats}}},"Attribution":function(B,A){A.attribution={};this.readChildNodes(B,A.attribution)},"LogoURL":function(B,A){A.logo={width:B.getAttribute("width"),height:B.getAttribute("height")};this.readChildNodes(B,A.logo)},"Style":function(B,A){var C={};A.styles.push(C);this.readChildNodes(B,C)},"LegendURL":function(C,A){var B={width:C.getAttribute("width"),height:C.getAttribute("height")};A.legend=B;this.readChildNodes(C,B)},"MetadataURL":function(C,B){var A={type:C.getAttribute("type")};B.metadataURLs.push(A);this.readChildNodes(C,A)},"DataURL":function(B,A){A.dataURL={};this.readChildNodes(B,A.dataURL)},"FeatureListURL":function(B,A){A.featureListURL={};this.readChildNodes(B,A.featureListURL)},"AuthorityURL":function(C,B){var D=C.getAttribute("name");var A={};this.readChildNodes(C,A);B.authorityURLs[D]=A.href},"Identifier":function(C,B){var A=C.getAttribute("authority");B.identifiers[A]=this.getChildValue(C)},"KeywordList":function(B,A){this.readChildNodes(B,A)},"SRS":function(B,A){A.srs[this.getChildValue(B)]=true}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1"});OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{"wms":OpenLayers.Util.applyDefaults({"WMT_MS_Capabilities":function(B,A){this.readChildNodes(B,A)},"Keyword":function(B,A){if(A.keywords){A.keywords.push(this.getChildValue(B))}},"DescribeLayer":function(B,A){A.describelayer={formats:[]};this.readChildNodes(B,A.describelayer)},"GetLegendGraphic":function(B,A){A.getlegendgraphic={formats:[]};this.readChildNodes(B,A.getlegendgraphic)},"GetStyles":function(B,A){A.getstyles={formats:[]};this.readChildNodes(B,A.getstyles)},"PutStyles":function(B,A){A.putstyles={formats:[]};this.readChildNodes(B,A.putstyles)},"UserDefinedSymbolization":function(B,A){var C={supportSLD:parseInt(B.getAttribute("SupportSLD"))==1,userLayer:parseInt(B.getAttribute("UserLayer"))==1,userStyle:parseInt(B.getAttribute("UserStyle"))==1,remoteWFS:parseInt(B.getAttribute("RemoteWFS"))==1};A.userSymbols=C},"LatLonBoundingBox":function(B,A){A.llbbox=[parseFloat(B.getAttribute("minx")),parseFloat(B.getAttribute("miny")),parseFloat(B.getAttribute("maxx")),parseFloat(B.getAttribute("maxy"))]},"BoundingBox":function(B,A){var C=OpenLayers.Format.WMSCapabilities.v1.prototype.readers["wms"].BoundingBox.apply(this,[B,A]);C.srs=B.getAttribute("SRS");A.bbox[C.srs]=C},"ScaleHint":function(C,B){var A=C.getAttribute("min");var F=C.getAttribute("max");var E=Math.pow(2,0.5);var D=OpenLayers.INCHES_PER_UNIT["m"];if(A!=0){B.maxScale=parseFloat(((A/E)*D*OpenLayers.DOTS_PER_INCH).toPrecision(13))}if(F!=Number.POSITIVE_INFINITY){B.minScale=parseFloat(((F/E)*D*OpenLayers.DOTS_PER_INCH).toPrecision(13))}},"Dimension":function(B,A){var C=B.getAttribute("name").toLowerCase();var D={name:C,units:B.getAttribute("units"),unitsymbol:B.getAttribute("unitSymbol")};A.dimensions[D.name]=D},"Extent":function(B,A){var C=B.getAttribute("name").toLowerCase();if(C in A["dimensions"]){var E=A.dimensions[C];E.nearestVal=B.getAttribute("nearestValue")==="1";E.multipleVal=B.getAttribute("multipleValues")==="1";E.current=B.getAttribute("current")==="1";E["default"]=B.getAttribute("default")||"";var D=this.getChildValue(B);E.values=D.split(",")}}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers["wms"])},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1"});OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.0",readers:{"wms":OpenLayers.Util.applyDefaults({"SRS":function(C,B){var F=this.getChildValue(C);var E=F.split(/ +/);for(var A=0,D=E.length;A<D;A++){B.srs[E[A]]=true}}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers["wms"])},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_0"});OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,readFormat:null,readOptions:null,initialize:function(A){OpenLayers.Protocol.prototype.initialize.apply(this,[A]);if(!A.format){this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName,srsName:this.srsName,schema:this.schema},this.formatOptions))}if(!A.geometryName&&parseFloat(this.format.version)>1){this.setGeometryName(null)}},destroy:function(){if(this.options&&!this.options.format){this.format.destroy()}this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(A){OpenLayers.Protocol.prototype.read.apply(this,arguments);A=OpenLayers.Util.extend({},A);OpenLayers.Util.applyDefaults(A,this.options||{});var B=new OpenLayers.Protocol.Response({requestType:"read"});var C=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",A)]);B.priv=OpenLayers.Request.POST({url:A.url,callback:this.createCallback(this.handleRead,B,A),params:A.params,headers:A.headers,data:C});return B},setFeatureType:function(A){this.featureType=A;this.format.featureType=A},setGeometryName:function(A){this.geometryName=A;this.format.geometryName=A},handleRead:function(D,B){B=OpenLayers.Util.extend({},B);OpenLayers.Util.applyDefaults(B,this.options);if(B.callback){var A=D.priv;if(A.status>=200&&A.status<300){var C=this.parseResponse(A,B.readOptions);if(C&&C.success!==false){if(B.readOptions&&B.readOptions.output=="object"){OpenLayers.Util.extend(D,C)}else{D.features=C}D.code=OpenLayers.Protocol.Response.SUCCESS}else{D.code=OpenLayers.Protocol.Response.FAILURE;D.error=C}}else{D.code=OpenLayers.Protocol.Response.FAILURE}B.callback.call(B.scope,D)}},parseResponse:function(B,C){var E=B.responseXML;if(!E||!E.documentElement){E=B.responseText}if(!E||E.length<=0){return null}var D=(this.readFormat!==null)?this.readFormat.read(E):this.format.read(E,C);if(!this.featureNS){var A=this.readFormat||this.format;this.featureNS=A.featureNS;A.autoConfig=false;if(!this.geometryName){this.setGeometryName(A.geometryName)}}return D},commit:function(A,B){B=OpenLayers.Util.extend({},B);OpenLayers.Util.applyDefaults(B,this.options);var C=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:A});C.priv=OpenLayers.Request.POST({url:B.url,headers:B.headers,data:this.format.write(A,B),callback:this.createCallback(this.handleCommit,C,B)});return C},handleCommit:function(D,C){if(C.callback){var B=D.priv;var E=B.responseXML;if(!E||!E.documentElement){E=B.responseText}var A=this.format.read(E)||{};D.insertIds=A.insertIds||[];if(A.success){D.code=OpenLayers.Protocol.Response.SUCCESS}else{D.code=OpenLayers.Protocol.Response.FAILURE;D.error=A}C.callback.call(C.scope,D)}},filterDelete:function(D,C){C=OpenLayers.Util.extend({},C);OpenLayers.Util.applyDefaults(C,this.options);var F=new OpenLayers.Protocol.Response({requestType:"commit"});var A=this.format.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version}});var B=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(C.featureNS?this.featurePrefix+":":"")+C.featureType}});if(C.featureNS){B.setAttribute("xmlns:"+this.featurePrefix,C.featureNS)}var E=this.format.writeNode("ogc:Filter",D);B.appendChild(E);A.appendChild(B);var G=OpenLayers.Format.XML.prototype.write.apply(this.format,[A]);return OpenLayers.Request.POST({url:this.url,callback:C.callback||function(){},data:G})},abort:function(A){if(A){A.priv.abort()}},CLASS_NAME:"OpenLayers.Protocol.WFS.v1"});OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{"click":{"in":"click","out":"clickout"},"mousemove":{"in":"over","out":"out"},"dblclick":{"in":"dblclick","out":null},"mousedown":{"in":null,"out":null},"mouseup":{"in":null,"out":null},"touchstart":{"in":"click","out":"clickout"}},feature:null,lastFeature:null,down:null,up:null,clickTolerance:4,geometryTypes:null,stopClick:true,stopDown:true,stopUp:false,initialize:function(C,B,D,A){OpenLayers.Handler.prototype.initialize.apply(this,[C,D,A]);this.layer=B},touchstart:function(A){this.startTouch();return OpenLayers.Event.isMultiTouch(A)?true:this.mousedown(A)},touchmove:function(A){OpenLayers.Event.preventDefault(A)},mousedown:function(A){if(OpenLayers.Event.isLeftClick(A)||OpenLayers.Event.isSingleTouch(A)){this.down=A.xy}return this.handle(A)?!this.stopDown:true},mouseup:function(A){this.up=A.xy;return this.handle(A)?!this.stopUp:true},click:function(A){return this.handle(A)?!this.stopClick:true},mousemove:function(A){if(!this.callbacks["over"]&&!this.callbacks["out"]){return true}this.handle(A);return true},dblclick:function(A){return !this.handle(A)},geometryTypeMatches:function(A){return this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,A.geometry.CLASS_NAME)>-1},handle:function(D){if(this.feature&&!this.feature.layer){this.feature=null}var A=D.type;var C=false;var F=!!(this.feature);var E=(A=="click"||A=="dblclick"||A=="touchstart");this.feature=this.layer.getFeatureFromEvent(D);if(this.feature&&!this.feature.layer){this.feature=null}if(this.lastFeature&&!this.lastFeature.layer){this.lastFeature=null}if(this.feature){if(A==="touchstart"){OpenLayers.Event.preventDefault(D)}var B=(this.feature!=this.lastFeature);if(this.geometryTypeMatches(this.feature)){if(F&&B){if(this.lastFeature){this.triggerCallback(A,"out",[this.lastFeature])}this.triggerCallback(A,"in",[this.feature])}else{if(!F||E){this.triggerCallback(A,"in",[this.feature])}}this.lastFeature=this.feature;C=true}else{if(this.lastFeature&&(F&&B||E)){this.triggerCallback(A,"out",[this.lastFeature])}this.feature=null}}else{if(this.lastFeature&&(F||E)){this.triggerCallback(A,"out",[this.lastFeature])}}return C},triggerCallback:function(A,C,E){var B=this.EVENTMAP[A][C];if(B){if(A=="click"&&this.up&&this.down){var D=Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2));if(D<=this.clickTolerance){this.callback(B,E)}this.up=this.down=null}else{this.callback(B,E)}}},activate:function(){var A=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.moveLayerToTop();this.map.events.on({"removelayer":this.handleMapEvents,"changelayer":this.handleMapEvents,scope:this});A=true}return A},deactivate:function(){var A=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.moveLayerBack();this.feature=null;this.lastFeature=null;this.down=null;this.up=null;this.map.events.un({"removelayer":this.handleMapEvents,"changelayer":this.handleMapEvents,scope:this});A=true}return A},handleMapEvents:function(A){if(A.type=="removelayer"||A.property=="order"){this.moveLayerToTop()}},moveLayerToTop:function(){var A=Math.max(this.map.Z_INDEX_BASE["Feature"]-1,this.layer.getZIndex())+1;this.layer.setZIndex(A)},moveLayerBack:function(){var A=this.layer.getZIndex()-1;if(A>=this.map.Z_INDEX_BASE["Feature"]){this.layer.setZIndex(A)}else{this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))}},CLASS_NAME:"OpenLayers.Handler.Feature"});OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:false,layers:null,display:function(){},getFeatureFromEvent:function(D){var C=this.layers;var A;for(var B=0;B<C.length;B++){A=C[B].getFeatureFromEvent(D);if(A){return A}}},setMap:function(A){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);this.collectRoots();A.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(A){A.events.unregister("changelayer",this,this.handleChangeLayer);this.resetRoots();OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){var B;for(var A=0;A<this.map.layers.length;++A){B=this.map.layers[A];if(OpenLayers.Util.indexOf(this.layers,B)!=-1){B.renderer.moveRoot(this.renderer)}}},resetRoots:function(){var B;for(var A=0;A<this.layers.length;++A){B=this.layers[A];if(this.renderer&&B.renderer.getRenderLayerId()==this.id){this.renderer.moveRoot(B.renderer)}}},handleChangeLayer:function(A){var B=A.layer;if(A.property=="order"&&OpenLayers.Util.indexOf(this.layers,B)!=-1){this.resetRoots();this.collectRoots()}},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"});OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:false,clickout:true,toggle:false,hover:false,highlightOnly:false,box:false,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(A,B){OpenLayers.Control.prototype.initialize.apply(this,[B]);if(this.scope===null){this.scope=this}this.initLayer(A);var C={click:this.clickFeature,clickout:this.clickoutFeature};if(this.hover){C.over=this.overFeature;C.out=this.outFeature}this.callbacks=OpenLayers.Util.extend(C,this.callbacks);this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})};if(this.box){this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"})}},initLayer:function(A){if(OpenLayers.Util.isArray(A)){this.layers=A;this.layer=new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:A})}else{this.layer=A}},destroy:function(){if(this.active&&this.layers){this.map.removeLayer(this.layer)}OpenLayers.Control.prototype.destroy.apply(this,arguments);if(this.layers){this.layer.destroy()}},activate:function(){if(!this.active){if(this.layers){this.map.addLayer(this.layer)}this.handlers.feature.activate();if(this.box&&this.handlers.box){this.handlers.box.activate()}}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active){this.handlers.feature.deactivate();if(this.handlers.box){this.handlers.box.deactivate()}if(this.layers){this.map.removeLayer(this.layer)}}return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(E){var C=this.layers||[this.layer],A,B,D,F;for(D=0;D<C.length;++D){A=C[D];F=0;if(A.selectedFeatures!=null){while(A.selectedFeatures.length>F){B=A.selectedFeatures[F];if(!E||E.except!=B){this.unselect(B)}else{++F}}}}},clickFeature:function(A){if(!this.hover){var B=(OpenLayers.Util.indexOf(A.layer.selectedFeatures,A)>-1);if(B){if(this.toggleSelect()){this.unselect(A)}else{if(!this.multipleSelect()){this.unselectAll({except:A})}}}else{if(!this.multipleSelect()){this.unselectAll({except:A})}this.select(A)}}},multipleSelect:function(){return this.multiple||(this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey])},toggleSelect:function(){return this.toggle||(this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey])},clickoutFeature:function(A){if(!this.hover&&this.clickout){this.unselectAll()}},overFeature:function(A){var B=A.layer;if(this.hover){if(this.highlightOnly){this.highlight(A)}else{if(OpenLayers.Util.indexOf(B.selectedFeatures,A)==-1){this.select(A)}}}},outFeature:function(A){if(this.hover){if(this.highlightOnly){if(A._lastHighlighter==this.id){if(A._prevHighlighter&&A._prevHighlighter!=this.id){delete A._lastHighlighter;var B=this.map.getControl(A._prevHighlighter);if(B){B.highlight(A)}}else{this.unhighlight(A)}}}else{this.unselect(A)}}},highlight:function(A){var C=A.layer;var B=this.events.triggerEvent("beforefeaturehighlighted",{feature:A});if(B!==false){A._prevHighlighter=A._lastHighlighter;A._lastHighlighter=this.id;var D=this.selectStyle||this.renderIntent;C.drawFeature(A,D);this.events.triggerEvent("featurehighlighted",{feature:A})}},unhighlight:function(A){var B=A.layer;if(A._prevHighlighter==undefined){delete A._lastHighlighter}else{if(A._prevHighlighter==this.id){delete A._prevHighlighter}else{A._lastHighlighter=A._prevHighlighter;delete A._prevHighlighter}}B.drawFeature(A,A.style||A.layer.style||"default");this.events.triggerEvent("featureunhighlighted",{feature:A})},select:function(A){var B=this.onBeforeSelect.call(this.scope,A);var C=A.layer;if(B!==false){B=C.events.triggerEvent("beforefeatureselected",{feature:A});if(B!==false){C.selectedFeatures.push(A);this.highlight(A);if(!this.handlers.feature.lastFeature){this.handlers.feature.lastFeature=C.selectedFeatures[0]}C.events.triggerEvent("featureselected",{feature:A});this.onSelect.call(this.scope,A)}}},unselect:function(A){var B=A.layer;this.unhighlight(A);OpenLayers.Util.removeItem(B.selectedFeatures,A);B.events.triggerEvent("featureunselected",{feature:A});this.onUnselect.call(this.scope,A)},selectBox:function(G){if(G instanceof OpenLayers.Bounds){var H=this.map.getLonLatFromPixel({x:G.left,y:G.bottom});var D=this.map.getLonLatFromPixel({x:G.right,y:G.top});var C=new OpenLayers.Bounds(H.lon,H.lat,D.lon,D.lat);if(!this.multipleSelect()){this.unselectAll()}var K=this.multiple;this.multiple=true;var J=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:J});var F;for(var A=0;A<J.length;++A){F=J[A];for(var E=0,B=F.features.length;E<B;++E){var I=F.features[E];if(!I.getVisibility()){continue}if(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,I.geometry.CLASS_NAME)>-1){if(C.toGeometry().intersects(I.geometry)){if(OpenLayers.Util.indexOf(F.selectedFeatures,I)==-1){this.select(I)}}}}}this.multiple=K;this.events.triggerEvent("boxselectionend",{layers:J})}},setMap:function(A){this.handlers.feature.setMap(A);if(this.box){this.handlers.box.setMap(A)}OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(B){var A=this.active;this.unselectAll();this.deactivate();if(this.layers){this.layer.destroy();this.layers=null}this.initLayer(B);this.handlers.feature.layer=this.layer;if(A){this.activate()}},CLASS_NAME:"OpenLayers.Control.SelectFeature"});OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:false,citeCompliant:false,mouseDown:false,stoppedDown:null,lastDown:null,lastUp:null,persist:false,stopDown:false,stopUp:false,layerOptions:null,pixelTolerance:5,lastTouchPx:null,initialize:function(B,C,A){if(!(A&&A.layerOptions&&A.layerOptions.styleMap)){this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})}OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,arguments)){return false}var A=OpenLayers.Util.extend({displayInLayerSwitcher:false,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,A);this.map.addLayer(this.layer);return true},createFeature:function(A){var B=this.layer.getLonLatFromViewPortPx(A);var C=new OpenLayers.Geometry.Point(B.lon,B.lat);this.point=new OpenLayers.Feature.Vector(C);this.callback("create",[this.point.geometry,this.point]);this.point.geometry.clearBounds();this.layer.addFeatures([this.point],{silent:true})},deactivate:function(){if(!OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){return false}this.cancel();if(this.layer.map!=null){this.destroyFeature(true);this.layer.destroy(false)}this.layer=null;return true},destroyFeature:function(A){if(this.layer&&(A||!this.persist)){this.layer.destroyFeatures()}this.point=null},destroyPersistedFeature:function(){var A=this.layer;if(A&&A.features.length>1){this.layer.features[0].destroy()}},finalize:function(B){var A=B?"cancel":"done";this.mouseDown=false;this.lastDown=null;this.lastUp=null;this.lastTouchPx=null;this.callback(A,[this.geometryClone()]);this.destroyFeature(B)},cancel:function(){this.finalize(true)},click:function(A){OpenLayers.Event.stop(A);return false},dblclick:function(A){OpenLayers.Event.stop(A);return false},modifyFeature:function(A){if(!this.point){this.createFeature(A)}var B=this.layer.getLonLatFromViewPortPx(A);this.point.geometry.x=B.lon;this.point.geometry.y=B.lat;this.callback("modify",[this.point.geometry,this.point,false]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var A=this.point&&this.point.geometry;if(A&&this.multi){A=new OpenLayers.Geometry.MultiPoint([A])}return A},geometryClone:function(){var A=this.getGeometry();return A&&A.clone()},mousedown:function(A){return this.down(A)},touchstart:function(A){this.startTouch();this.lastTouchPx=A.xy;return this.down(A)},mousemove:function(A){return this.move(A)},touchmove:function(A){this.lastTouchPx=A.xy;return this.move(A)},mouseup:function(A){return this.up(A)},touchend:function(A){A.xy=this.lastTouchPx;return this.up(A)},down:function(A){this.mouseDown=true;this.lastDown=A.xy;if(!this.touch){this.modifyFeature(A.xy)}this.stoppedDown=this.stopDown;return !this.stopDown},move:function(A){if(!this.touch&&(!this.mouseDown||this.stoppedDown)){this.modifyFeature(A.xy)}return true},up:function(A){this.mouseDown=false;this.stoppedDown=this.stopDown;if(!this.checkModifiers(A)){return true}if(this.lastUp&&this.lastUp.equals(A.xy)){return true}if(this.lastDown&&this.passesTolerance(this.lastDown,A.xy,this.pixelTolerance)){if(this.touch){this.modifyFeature(A.xy)}if(this.persist){this.destroyPersistedFeature()}this.lastUp=A.xy;this.finalize();return !this.stopUp}else{return true}},mouseout:function(A){if(OpenLayers.Util.mouseLeft(A,this.map.viewPortDiv)){this.stoppedDown=this.stopDown;this.mouseDown=false}},passesTolerance:function(E,B,A){var C=true;if(A!=null&&E&&B){var D=E.distanceTo(B);if(D>A){C=false}}return C},CLASS_NAME:"OpenLayers.Handler.Point"});OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,maxVertices:null,doubleTouchTolerance:20,freehand:false,freehandToggle:"shiftKey",timerId:null,redoStack:null,createFeature:function(A){var B=this.layer.getLonLatFromViewPortPx(A);var C=new OpenLayers.Geometry.Point(B.lon,B.lat);this.point=new OpenLayers.Feature.Vector(C);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.line,this.point],{silent:true})},destroyFeature:function(A){OpenLayers.Handler.Point.prototype.destroyFeature.call(this,A);this.line=null},destroyPersistedFeature:function(){var A=this.layer;if(A&&A.features.length>2){this.layer.features[0].destroy()}},removePoint:function(){if(this.point){this.layer.removeFeatures([this.point])}},addPoint:function(A){this.layer.removeFeatures([this.point]);var B=this.layer.getLonLatFromViewPortPx(A);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(B.lon,B.lat));this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length);this.layer.addFeatures([this.point]);this.callback("point",[this.point.geometry,this.getGeometry()]);this.callback("modify",[this.point.geometry,this.getSketch()]);this.drawFeature();delete this.redoStack},insertXY:function(A,B){this.line.geometry.addComponent(new OpenLayers.Geometry.Point(A,B),this.getCurrentPointIndex());this.drawFeature();delete this.redoStack},insertDeltaXY:function(B,D){var C=this.getCurrentPointIndex()-1;var A=this.line.geometry.components[C];if(A&&!isNaN(A.x)&&!isNaN(A.y)){this.insertXY(A.x+B,A.y+D)}},insertDirectionLength:function(D,A){D*=Math.PI/180;var B=A*Math.cos(D);var C=A*Math.sin(D);this.insertDeltaXY(B,C)},insertDeflectionLength:function(C,A){var D=this.getCurrentPointIndex()-1;if(D>0){var B=this.line.geometry.components[D];var F=this.line.geometry.components[D-1];var E=Math.atan2(B.y-F.y,B.x-F.x);this.insertDirectionLength((E*180/Math.PI)+C,A)}},getCurrentPointIndex:function(){return this.line.geometry.components.length-1},undo:function(){var D=this.line.geometry;var E=D.components;var C=this.getCurrentPointIndex()-1;var G=E[C];var B=D.removeComponent(G);if(B){if(this.touch&&C>0){E=D.components;var A=E[C-1];var H=this.getCurrentPointIndex();var F=E[H];F.x=A.x;F.y=A.y}if(!this.redoStack){this.redoStack=[]}this.redoStack.push(G);this.drawFeature()}return B},redo:function(){var A=this.redoStack&&this.redoStack.pop();if(A){this.line.geometry.addComponent(A,this.getCurrentPointIndex());this.drawFeature()}return !!A},freehandMode:function(A){return(this.freehandToggle&&A[this.freehandToggle])?!this.freehand:this.freehand},modifyFeature:function(A,C){if(!this.line){this.createFeature(A)}var B=this.layer.getLonLatFromViewPortPx(A);this.point.geometry.x=B.lon;this.point.geometry.y=B.lat;this.callback("modify",[this.point.geometry,this.getSketch(),C]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var A=this.line&&this.line.geometry;if(A&&this.multi){A=new OpenLayers.Geometry.MultiLineString([A])}return A},touchstart:function(A){if(this.timerId&&this.passesTolerance(this.lastTouchPx,A.xy,this.doubleTouchTolerance)){this.finishGeometry();window.clearTimeout(this.timerId);this.timerId=null;return false}else{if(this.timerId){window.clearTimeout(this.timerId);this.timerId=null}this.timerId=window.setTimeout(OpenLayers.Function.bind(function(){this.timerId=null},this),300);return OpenLayers.Handler.Point.prototype.touchstart.call(this,A)}},down:function(A){var B=this.stopDown;if(this.freehandMode(A)){B=true;if(this.touch){this.modifyFeature(A.xy,!!this.lastUp);OpenLayers.Event.stop(A)}}if(!this.touch&&(!this.lastDown||!this.passesTolerance(this.lastDown,A.xy,this.pixelTolerance))){this.modifyFeature(A.xy,!!this.lastUp)}this.mouseDown=true;this.lastDown=A.xy;this.stoppedDown=B;return !B},move:function(A){if(this.stoppedDown&&this.freehandMode(A)){if(this.persist){this.destroyPersistedFeature()}if(this.maxVertices&&this.line&&this.line.geometry.components.length===this.maxVertices){this.removePoint();this.finalize()}else{this.addPoint(A.xy)}return false}if(!this.touch&&(!this.mouseDown||this.stoppedDown)){this.modifyFeature(A.xy,!!this.lastUp)}return true},up:function(A){if(this.mouseDown&&(!this.lastUp||!this.lastUp.equals(A.xy))){if(this.stoppedDown&&this.freehandMode(A)){if(this.persist){this.destroyPersistedFeature()}this.removePoint();this.finalize()}else{if(this.passesTolerance(this.lastDown,A.xy,this.pixelTolerance)){if(this.touch){this.modifyFeature(A.xy)}if(this.lastUp==null&&this.persist){this.destroyPersistedFeature()}this.addPoint(A.xy);this.lastUp=A.xy;if(this.line.geometry.components.length===this.maxVertices+1){this.finishGeometry()}}}}this.stoppedDown=this.stopDown;this.mouseDown=false;return !this.stopUp},finishGeometry:function(){var A=this.line.geometry.components.length-1;this.line.geometry.removeComponent(this.line.geometry.components[A]);this.removePoint();this.finalize()},dblclick:function(A){if(!this.freehandMode(A)){this.finishGeometry()}return false},CLASS_NAME:"OpenLayers.Handler.Path"});OpenLayers.Spherical=OpenLayers.Spherical||{};OpenLayers.Spherical.DEFAULT_RADIUS=6378137;OpenLayers.Spherical.computeDistanceBetween=function(B,D,E){var C=E||OpenLayers.Spherical.DEFAULT_RADIUS;var F=Math.sin(Math.PI*(D.lon-B.lon)/360);var A=Math.sin(Math.PI*(D.lat-B.lat)/360);var G=A*A+F*F*Math.cos(Math.PI*B.lat/180)*Math.cos(Math.PI*D.lat/180);return 2*C*Math.atan2(Math.sqrt(G),Math.sqrt(1-G))};OpenLayers.Spherical.computeHeading=function(A,B){var D=Math.sin(Math.PI*(A.lon-B.lon)/180)*Math.cos(Math.PI*B.lat/180);var C=Math.cos(Math.PI*A.lat/180)*Math.sin(Math.PI*B.lat/180)-Math.sin(Math.PI*A.lat/180)*Math.cos(Math.PI*B.lat/180)*Math.cos(Math.PI*(A.lon-B.lon)/180);return 180*Math.atan2(D,C)/Math.PI};OpenLayers.Control.CacheWrite=OpenLayers.Class(OpenLayers.Control,{layers:null,imageFormat:"image/png",quotaRegEx:(/quota/i),setMap:function(B){OpenLayers.Control.prototype.setMap.apply(this,arguments);var A,C=this.layers||B.layers;for(A=C.length-1;A>=0;--A){this.addLayer({layer:C[A]})}if(!this.layers){B.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})}},addLayer:function(A){A.layer.events.on({tileloadstart:this.makeSameOrigin,tileloaded:this.onTileLoaded,scope:this})},removeLayer:function(A){A.layer.events.un({tileloadstart:this.makeSameOrigin,tileloaded:this.onTileLoaded,scope:this})},makeSameOrigin:function(B){if(this.active){var C=B.tile;if(C instanceof OpenLayers.Tile.Image&&!C.crossOriginKeyword&&C.url.substr(0,5)!=="data:"){var A=OpenLayers.Request.makeSameOrigin(C.url,OpenLayers.ProxyHost);OpenLayers.Control.CacheWrite.urlMap[A]=C.url;C.url=A}}},onTileLoaded:function(A){if(this.active&&!A.aborted&&A.tile instanceof OpenLayers.Tile.Image&&A.tile.url.substr(0,5)!=="data:"){this.cache({tile:A.tile});delete OpenLayers.Control.CacheWrite.urlMap[A.tile.url]}},cache:function(B){if(window.localStorage){var E=B.tile;try{var A=E.getCanvasContext();if(A){var F=OpenLayers.Control.CacheWrite.urlMap;var G=F[E.url]||E.url;window.localStorage.setItem("olCache_"+G,A.canvas.toDataURL(this.imageFormat))}}catch(D){var C=D.name||D.message;if(C&&this.quotaRegEx.test(C)){this.events.triggerEvent("cachefull",{tile:E})}else{OpenLayers.Console.error(D.toString())}}}},destroy:function(){if(this.layers||this.map){var A,B=this.layers||this.map.layers;for(A=B.length-1;A>=0;--A){this.removeLayer({layer:B[A]})}}if(this.map){this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})}OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheWrite"});OpenLayers.Control.CacheWrite.clearCache=function(){if(!window.localStorage){return}var B,A;for(B=window.localStorage.length-1;B>=0;--B){A=window.localStorage.key(B);if(A.substr(0,8)==="olCache_"){window.localStorage.removeItem(A)}}};OpenLayers.Control.CacheWrite.urlMap={};OpenLayers.Format.Context=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{layerOptions:null,layerParams:null,read:function(E,D){var A=OpenLayers.Format.XML.VersionedOGC.prototype.read.apply(this,arguments);var B;if(D&&D.map){this.context=A;if(D.map instanceof OpenLayers.Map){B=this.mergeContextToMap(A,D.map)}else{var C=D.map;if(OpenLayers.Util.isElement(C)||typeof C=="string"){C={div:C}}B=this.contextToMap(A,C)}}else{B=A}return B},getLayerFromContext:function(G){var D,H;var F={queryable:G.queryable,visibility:G.visibility,maxExtent:G.maxExtent,metadata:OpenLayers.Util.applyDefaults(G.metadata,{styles:G.styles,formats:G.formats,"abstract":G["abstract"],dataURL:G.dataURL}),numZoomLevels:G.numZoomLevels,units:G.units,isBaseLayer:G.isBaseLayer,opacity:G.opacity,displayInLayerSwitcher:G.displayInLayerSwitcher,singleTile:G.singleTile,tileSize:(G.tileSize)?new OpenLayers.Size(G.tileSize.width,G.tileSize.height):undefined,minScale:G.minScale||G.maxScaleDenominator,maxScale:G.maxScale||G.minScaleDenominator,srs:G.srs,dimensions:G.dimensions,metadataURL:G.metadataURL};if(this.layerOptions){OpenLayers.Util.applyDefaults(F,this.layerOptions)}var E={layers:G.name,transparent:G.transparent,version:G.version};if(G.formats&&G.formats.length>0){E.format=G.formats[0].value;for(D=0,H=G.formats.length;D<H;D++){var A=G.formats[D];if(A.current==true){E.format=A.value;break}}}if(G.styles&&G.styles.length>0){for(D=0,H=G.styles.length;D<H;D++){var C=G.styles[D];if(C.current==true){if(C.href){E.sld=C.href}else{if(C.body){E.sld_body=C.body}else{E.styles=C.name}}break}}}if(this.layerParams){OpenLayers.Util.applyDefaults(E,this.layerParams)}var I=null;var B=G.service;if(B==OpenLayers.Format.Context.serviceTypes.WFS){F.strategies=[new OpenLayers.Strategy.BBOX()];F.protocol=new OpenLayers.Protocol.WFS({url:G.url,featurePrefix:G.name.split(":")[0],featureType:G.name.split(":").pop()});I=new OpenLayers.Layer.Vector(G.title||G.name,F)}else{if(B==OpenLayers.Format.Context.serviceTypes.KML){F.strategies=[new OpenLayers.Strategy.Fixed()];F.protocol=new OpenLayers.Protocol.HTTP({url:G.url,format:new OpenLayers.Format.KML()});I=new OpenLayers.Layer.Vector(G.title||G.name,F)}else{if(B==OpenLayers.Format.Context.serviceTypes.GML){F.strategies=[new OpenLayers.Strategy.Fixed()];F.protocol=new OpenLayers.Protocol.HTTP({url:G.url,format:new OpenLayers.Format.GML()});I=new OpenLayers.Layer.Vector(G.title||G.name,F)}else{if(G.features){I=new OpenLayers.Layer.Vector(G.title||G.name,F);I.addFeatures(G.features)}else{if(G.categoryLayer!==true){I=new OpenLayers.Layer.WMS(G.title||G.name,G.url,E,F)}}}}}return I},getLayersFromContext:function(C){var B=[];for(var A=0,E=C.length;A<E;A++){var D=this.getLayerFromContext(C[A]);if(D!==null){B.push(D)}}return B},contextToMap:function(A,C){C=OpenLayers.Util.applyDefaults({maxExtent:A.maxExtent,projection:A.projection,units:A.units},C);if(C.maxExtent){C.maxResolution=C.maxExtent.getWidth()/OpenLayers.Map.TILE_WIDTH}var D={contactInformation:A.contactInformation,"abstract":A["abstract"],keywords:A.keywords,logo:A.logo,descriptionURL:A.descriptionURL};C.metadata=D;var B=new OpenLayers.Map(C);B.addLayers(this.getLayersFromContext(A.layersContext));B.setCenter(A.bounds.getCenterLonLat(),B.getZoomForExtent(A.bounds,true));return B},mergeContextToMap:function(A,B){B.addLayers(this.getLayersFromContext(A.layersContext));return B},write:function(A,B){A=this.toContext(A);return OpenLayers.Format.XML.VersionedOGC.prototype.write.apply(this,arguments)},CLASS_NAME:"OpenLayers.Format.Context"});OpenLayers.Format.Context.serviceTypes={"WMS":"urn:ogc:serviceType:WMS","WFS":"urn:ogc:serviceType:WFS","WCS":"urn:ogc:serviceType:WCS","GML":"urn:ogc:serviceType:GML","SLD":"urn:ogc:serviceType:SLD","FES":"urn:ogc:serviceType:FES","KML":"urn:ogc:serviceType:KML"};OpenLayers.Format.WMC=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"1.1.0",layerToContext:function(C){var F=this.getParser();var G={queryable:C.queryable,visibility:C.visibility,name:C.params["LAYERS"],title:C.name,"abstract":C.metadata["abstract"],dataURL:C.metadata.dataURL,metadataURL:C.metadataURL,server:{version:C.params["VERSION"],url:C.url},maxExtent:C.maxExtent,transparent:C.params["TRANSPARENT"],numZoomLevels:C.numZoomLevels,units:C.units,isBaseLayer:C.isBaseLayer,opacity:C.opacity==1?undefined:C.opacity,displayInLayerSwitcher:C.displayInLayerSwitcher,singleTile:C.singleTile,tileSize:(C.singleTile||!C.tileSize)?undefined:{width:C.tileSize.w,height:C.tileSize.h},minScale:(C.options.resolutions||C.options.scales||C.options.maxResolution||C.options.minScale)?C.minScale:undefined,maxScale:(C.options.resolutions||C.options.scales||C.options.minResolution||C.options.maxScale)?C.maxScale:undefined,formats:[],styles:[],srs:C.srs,dimensions:C.dimensions};if(C.metadata.servertitle){G.server.title=C.metadata.servertitle}if(C.metadata.formats&&C.metadata.formats.length>0){for(var A=0,D=C.metadata.formats.length;A<D;A++){var B=C.metadata.formats[A];G.formats.push({value:B.value,current:(B.value==C.params["FORMAT"])})}}else{G.formats.push({value:C.params["FORMAT"],current:true})}if(C.metadata.styles&&C.metadata.styles.length>0){for(var A=0,D=C.metadata.styles.length;A<D;A++){var E=C.metadata.styles[A];if((E.href==C.params["SLD"])||(E.body==C.params["SLD_BODY"])||(E.name==C.params["STYLES"])){E.current=true}else{E.current=false}G.styles.push(E)}}else{G.styles.push({href:C.params["SLD"],body:C.params["SLD_BODY"],name:C.params["STYLES"]||F.defaultStyleName,title:F.defaultStyleTitle,current:true})}return G},toContext:function(B){var A={};var C=B.layers;if(B.CLASS_NAME=="OpenLayers.Map"){var G=B.metadata||{};A.size=B.getSize();A.bounds=B.getExtent();A.projection=B.projection;A.title=B.title;A.keywords=G.keywords;A["abstract"]=G["abstract"];A.logo=G.logo;A.descriptionURL=G.descriptionURL;A.contactInformation=G.contactInformation;A.maxExtent=B.maxExtent}else{OpenLayers.Util.applyDefaults(A,B);if(A.layers!=undefined){delete (A.layers)}}if(A.layersContext==undefined){A.layersContext=[]}if(C!=undefined&&OpenLayers.Util.isArray(C)){for(var D=0,F=C.length;D<F;D++){var E=C[D];if(E instanceof OpenLayers.Layer.WMS){A.layersContext.push(this.layerToContext(E))}}}return A},CLASS_NAME:"OpenLayers.Format.WMC"});OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"",getNamespacePrefix:function(B){var A=null;if(B==null){A=this.namespaces[this.defaultPrefix]}else{for(A in this.namespaces){if(this.namespaces[A]==B){break}}}return A},defaultPrefix:"wmc",rootPrefix:null,defaultStyleName:"",defaultStyleTitle:"Default",initialize:function(A){OpenLayers.Format.XML.prototype.initialize.apply(this,[A])},read:function(C){if(typeof C=="string"){C=OpenLayers.Format.XML.prototype.read.apply(this,[C])}var B=C.documentElement;this.rootPrefix=B.prefix;var A={version:B.getAttribute("version")};this.runChildNodes(A,B);return A},runChildNodes:function(F,D){var A=D.childNodes;var H,B,E,I;for(var C=0,G=A.length;C<G;++C){H=A[C];if(H.nodeType==1){E=this.getNamespacePrefix(H.namespaceURI);I=H.nodeName.split(":").pop();B=this["read_"+E+"_"+I];if(B){B.apply(this,[F,H])}}}},read_wmc_General:function(A,B){this.runChildNodes(A,B)},read_wmc_BoundingBox:function(A,B){A.projection=B.getAttribute("SRS");A.bounds=new OpenLayers.Bounds(B.getAttribute("minx"),B.getAttribute("miny"),B.getAttribute("maxx"),B.getAttribute("maxy"))},read_wmc_LayerList:function(A,B){A.layersContext=[];this.runChildNodes(A,B)},read_wmc_Layer:function(A,B){var C={visibility:(B.getAttribute("hidden")!="1"),queryable:(B.getAttribute("queryable")=="1"),formats:[],styles:[],metadata:{}};this.runChildNodes(C,B);A.layersContext.push(C)},read_wmc_Extension:function(A,B){this.runChildNodes(A,B)},read_ol_units:function(B,A){B.units=this.getChildValue(A)},read_ol_maxExtent:function(A,C){var B=new OpenLayers.Bounds(C.getAttribute("minx"),C.getAttribute("miny"),C.getAttribute("maxx"),C.getAttribute("maxy"));A.maxExtent=B},read_ol_transparent:function(B,A){B.transparent=this.getChildValue(A)},read_ol_numZoomLevels:function(B,A){B.numZoomLevels=parseInt(this.getChildValue(A))},read_ol_opacity:function(B,A){B.opacity=parseFloat(this.getChildValue(A))},read_ol_singleTile:function(B,A){B.singleTile=(this.getChildValue(A)=="true")},read_ol_tileSize:function(C,B){var A={"width":B.getAttribute("width"),"height":B.getAttribute("height")};C.tileSize=A},read_ol_isBaseLayer:function(B,A){B.isBaseLayer=(this.getChildValue(A)=="true")},read_ol_displayInLayerSwitcher:function(B,A){B.displayInLayerSwitcher=(this.getChildValue(A)=="true")},read_wmc_Server:function(B,A){B.version=A.getAttribute("version");B.url=this.getOnlineResource_href(A);B.metadata.servertitle=A.getAttribute("title")},read_wmc_FormatList:function(B,A){this.runChildNodes(B,A)},read_wmc_Format:function(C,B){var A={value:this.getChildValue(B)};if(B.getAttribute("current")=="1"){A.current=true}C.formats.push(A)},read_wmc_StyleList:function(B,A){this.runChildNodes(B,A)},read_wmc_Style:function(C,A){var B={};this.runChildNodes(B,A);if(A.getAttribute("current")=="1"){B.current=true}C.styles.push(B)},read_wmc_SLD:function(B,A){this.runChildNodes(B,A)},read_sld_StyledLayerDescriptor:function(A,B){var C=OpenLayers.Format.XML.prototype.write.apply(this,[B]);A.body=C},read_sld_FeatureTypeStyle:function(A,B){var C=OpenLayers.Format.XML.prototype.write.apply(this,[B]);A.body=C},read_wmc_OnlineResource:function(A,B){A.href=this.getAttributeNS(B,this.namespaces.xlink,"href")},read_wmc_Name:function(A,B){var C=this.getChildValue(B);if(C){A.name=C}},read_wmc_Title:function(A,B){var C=this.getChildValue(B);if(C){A.title=C}},read_wmc_MetadataURL:function(B,A){B.metadataURL=this.getOnlineResource_href(A)},read_wmc_KeywordList:function(A,B){A.keywords=[];this.runChildNodes(A.keywords,B)},read_wmc_Keyword:function(B,A){B.push(this.getChildValue(A))},read_wmc_Abstract:function(A,B){var C=this.getChildValue(B);if(C){A["abstract"]=C}},read_wmc_LogoURL:function(A,B){A.logo={width:B.getAttribute("width"),height:B.getAttribute("height"),format:B.getAttribute("format"),href:this.getOnlineResource_href(B)}},read_wmc_DescriptionURL:function(A,B){A.descriptionURL=this.getOnlineResource_href(B)},read_wmc_ContactInformation:function(B,C){var A={};this.runChildNodes(A,C);B.contactInformation=A},read_wmc_ContactPersonPrimary:function(A,B){var C={};this.runChildNodes(C,B);A.personPrimary=C},read_wmc_ContactPerson:function(C,B){var A=this.getChildValue(B);if(A){C.person=A}},read_wmc_ContactOrganization:function(B,A){var C=this.getChildValue(A);if(C){B.organization=C}},read_wmc_ContactPosition:function(A,B){var C=this.getChildValue(B);if(C){A.position=C}},read_wmc_ContactAddress:function(A,C){var B={};this.runChildNodes(B,C);A.contactAddress=B},read_wmc_AddressType:function(B,C){var A=this.getChildValue(C);if(A){B.type=A}},read_wmc_Address:function(A,C){var B=this.getChildValue(C);if(B){A.address=B}},read_wmc_City:function(A,C){var B=this.getChildValue(C);if(B){A.city=B}},read_wmc_StateOrProvince:function(A,B){var C=this.getChildValue(B);if(C){A.stateOrProvince=C}},read_wmc_PostCode:function(B,C){var A=this.getChildValue(C);if(A){B.postcode=A}},read_wmc_Country:function(A,B){var C=this.getChildValue(B);if(C){A.country=C}},read_wmc_ContactVoiceTelephone:function(B,C){var A=this.getChildValue(C);if(A){B.phone=A}},read_wmc_ContactFacsimileTelephone:function(A,B){var C=this.getChildValue(B);if(C){A.fax=C}},read_wmc_ContactElectronicMailAddress:function(A,B){var C=this.getChildValue(B);if(C){A.email=C}},read_wmc_DataURL:function(B,A){B.dataURL=this.getOnlineResource_href(A)},read_wmc_LegendURL:function(C,B){var A={width:B.getAttribute("width"),height:B.getAttribute("height"),format:B.getAttribute("format"),href:this.getOnlineResource_href(B)};C.legend=A},read_wmc_DimensionList:function(B,A){B.dimensions={};this.runChildNodes(B.dimensions,A)},read_wmc_Dimension:function(C,A){var B=A.getAttribute("name").toLowerCase();var D={name:B,units:A.getAttribute("units")||"",unitSymbol:A.getAttribute("unitSymbol")||"",userValue:A.getAttribute("userValue")||"",nearestValue:A.getAttribute("nearestValue")==="1",multipleValues:A.getAttribute("multipleValues")==="1",current:A.getAttribute("current")==="1","default":A.getAttribute("default")||""};var E=this.getChildValue(A);D.values=E.split(",");C[D.name]=D},write:function(A,C){var B=this.createElementDefaultNS("ViewContext");this.setAttributes(B,{version:this.VERSION,id:(C&&typeof C.id=="string")?C.id:OpenLayers.Util.createUniqueID("OpenLayers_Context_")});this.setAttributeNS(B,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);B.appendChild(this.write_wmc_General(A));B.appendChild(this.write_wmc_LayerList(A));return OpenLayers.Format.XML.prototype.write.apply(this,[B])},createElementDefaultNS:function(C,D,A){var B=this.createElementNS(this.namespaces[this.defaultPrefix],C);if(D){B.appendChild(this.createTextNode(D))}if(A){this.setAttributes(B,A)}return B},setAttributes:function(B,A){var D;for(var C in A){D=A[C].toString();if(D.match(/[A-Z]/)){this.setAttributeNS(B,null,C,D)}else{B.setAttribute(C,D)}}},write_wmc_General:function(A){var C=this.createElementDefaultNS("General");if(A.size){C.appendChild(this.createElementDefaultNS("Window",null,{width:A.size.w,height:A.size.h}))}var B=A.bounds;C.appendChild(this.createElementDefaultNS("BoundingBox",null,{minx:B.left.toPrecision(18),miny:B.bottom.toPrecision(18),maxx:B.right.toPrecision(18),maxy:B.top.toPrecision(18),SRS:A.projection}));C.appendChild(this.createElementDefaultNS("Title",A.title));if(A.keywords){C.appendChild(this.write_wmc_KeywordList(A.keywords))}if(A["abstract"]){C.appendChild(this.createElementDefaultNS("Abstract",A["abstract"]))}if(A.logo){C.appendChild(this.write_wmc_URLType("LogoURL",A.logo.href,A.logo))}if(A.descriptionURL){C.appendChild(this.write_wmc_URLType("DescriptionURL",A.descriptionURL))}if(A.contactInformation){C.appendChild(this.write_wmc_ContactInformation(A.contactInformation))}C.appendChild(this.write_ol_MapExtension(A));return C},write_wmc_KeywordList:function(D){var B=this.createElementDefaultNS("KeywordList");for(var A=0,C=D.length;A<C;A++){B.appendChild(this.createElementDefaultNS("Keyword",D[A]))}return B},write_wmc_ContactInformation:function(A){var B=this.createElementDefaultNS("ContactInformation");if(A.personPrimary){B.appendChild(this.write_wmc_ContactPersonPrimary(A.personPrimary))}if(A.position){B.appendChild(this.createElementDefaultNS("ContactPosition",A.position))}if(A.contactAddress){B.appendChild(this.write_wmc_ContactAddress(A.contactAddress))}if(A.phone){B.appendChild(this.createElementDefaultNS("ContactVoiceTelephone",A.phone))}if(A.fax){B.appendChild(this.createElementDefaultNS("ContactFacsimileTelephone",A.fax))}if(A.email){B.appendChild(this.createElementDefaultNS("ContactElectronicMailAddress",A.email))}return B},write_wmc_ContactPersonPrimary:function(B){var A=this.createElementDefaultNS("ContactPersonPrimary");if(B.person){A.appendChild(this.createElementDefaultNS("ContactPerson",B.person))}if(B.organization){A.appendChild(this.createElementDefaultNS("ContactOrganization",B.organization))}return A},write_wmc_ContactAddress:function(A){var B=this.createElementDefaultNS("ContactAddress");if(A.type){B.appendChild(this.createElementDefaultNS("AddressType",A.type))}if(A.address){B.appendChild(this.createElementDefaultNS("Address",A.address))}if(A.city){B.appendChild(this.createElementDefaultNS("City",A.city))}if(A.stateOrProvince){B.appendChild(this.createElementDefaultNS("StateOrProvince",A.stateOrProvince))}if(A.postcode){B.appendChild(this.createElementDefaultNS("PostCode",A.postcode))}if(A.country){B.appendChild(this.createElementDefaultNS("Country",A.country))}return B},write_ol_MapExtension:function(A){var C=this.createElementDefaultNS("Extension");var B=A.maxExtent;if(B){var D=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(D,{minx:B.left.toPrecision(18),miny:B.bottom.toPrecision(18),maxx:B.right.toPrecision(18),maxy:B.top.toPrecision(18)});C.appendChild(D)}return C},write_wmc_LayerList:function(A){var C=this.createElementDefaultNS("LayerList");for(var B=0,D=A.layersContext.length;B<D;++B){C.appendChild(this.write_wmc_Layer(A.layersContext[B]))}return C},write_wmc_Layer:function(A){var B=this.createElementDefaultNS("Layer",null,{queryable:A.queryable?"1":"0",hidden:A.visibility?"0":"1"});B.appendChild(this.write_wmc_Server(A));B.appendChild(this.createElementDefaultNS("Name",A.name));B.appendChild(this.createElementDefaultNS("Title",A.title));if(A["abstract"]){B.appendChild(this.createElementDefaultNS("Abstract",A["abstract"]))}if(A.dataURL){B.appendChild(this.write_wmc_URLType("DataURL",A.dataURL))}if(A.metadataURL){B.appendChild(this.write_wmc_URLType("MetadataURL",A.metadataURL))}return B},write_wmc_LayerExtension:function(C){var F=this.createElementDefaultNS("Extension");var B=C.maxExtent;var A=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(A,{minx:B.left.toPrecision(18),miny:B.bottom.toPrecision(18),maxx:B.right.toPrecision(18),maxy:B.top.toPrecision(18)});F.appendChild(A);if(C.tileSize&&!C.singleTile){var D=this.createElementNS(this.namespaces.ol,"ol:tileSize");this.setAttributes(D,C.tileSize);F.appendChild(D)}var G=["transparent","numZoomLevels","units","isBaseLayer","opacity","displayInLayerSwitcher","singleTile"];var H;for(var E=0,I=G.length;E<I;++E){H=this.createOLPropertyNode(C,G[E]);if(H){F.appendChild(H)}}return F},createOLPropertyNode:function(A,C){var B=null;if(A[C]!=null){B=this.createElementNS(this.namespaces.ol,"ol:"+C);B.appendChild(this.createTextNode(A[C].toString()))}return B},write_wmc_Server:function(A){var D=A.server;var C=this.createElementDefaultNS("Server");var B={service:"OGC:WMS",version:D.version};if(D.title){B.title=D.title}this.setAttributes(C,B);C.appendChild(this.write_wmc_OnlineResource(D.url));return C},write_wmc_URLType:function(E,B,F){var C=this.createElementDefaultNS(E);C.appendChild(this.write_wmc_OnlineResource(B));if(F){var D=["width","height","format"];for(var A=0;A<D.length;A++){if(D[A] in F){C.setAttribute(D[A],F[D[A]])}}}return C},write_wmc_DimensionList:function(D){var G=this.createElementDefaultNS("DimensionList");var B={name:true,units:true,unitSymbol:true,userValue:true};for(var E in D.dimensions){var F={};var C=D.dimensions[E];for(var A in C){if(typeof C[A]=="boolean"){F[A]=Number(C[A])}else{F[A]=C[A]}}var H="";if(F.values){H=F.values.join(",");delete F.values}G.appendChild(this.createElementDefaultNS("Dimension",H,F))}return G},write_wmc_FormatList:function(B){var D=this.createElementDefaultNS("FormatList");for(var C=0,E=B.formats.length;C<E;C++){var A=B.formats[C];D.appendChild(this.createElementDefaultNS("Format",A.value,(A.current&&A.current==true)?{current:"1"}:null))}return D},write_wmc_StyleList:function(G){var H=this.createElementDefaultNS("StyleList");var D=G.styles;if(D&&OpenLayers.Util.isArray(D)){var I;for(var E=0,J=D.length;E<J;E++){var A=D[E];var F=this.createElementDefaultNS("Style",null,(A.current&&A.current==true)?{current:"1"}:null);if(A.href){I=this.createElementDefaultNS("SLD");if(A.name){I.appendChild(this.createElementDefaultNS("Name",A.name))}if(A.title){I.appendChild(this.createElementDefaultNS("Title",A.title))}if(A.legend){I.appendChild(this.write_wmc_URLType("LegendURL",A.legend.href,A.legend))}var B=this.write_wmc_OnlineResource(A.href);I.appendChild(B);F.appendChild(I)}else{if(A.body){I=this.createElementDefaultNS("SLD");if(A.name){I.appendChild(this.createElementDefaultNS("Name",A.name))}if(A.title){I.appendChild(this.createElementDefaultNS("Title",A.title))}if(A.legend){I.appendChild(this.write_wmc_URLType("LegendURL",A.legend.href,A.legend))}var C=OpenLayers.Format.XML.prototype.read.apply(this,[A.body]);var K=C.documentElement;if(I.ownerDocument&&I.ownerDocument.importNode){K=I.ownerDocument.importNode(K,true)}I.appendChild(K);F.appendChild(I)}else{F.appendChild(this.createElementDefaultNS("Name",A.name));F.appendChild(this.createElementDefaultNS("Title",A.title));if(A["abstract"]){F.appendChild(this.createElementDefaultNS("Abstract",A["abstract"]))}if(A.legend){F.appendChild(this.write_wmc_URLType("LegendURL",A.legend.href,A.legend))}}}H.appendChild(F)}}return H},write_wmc_OnlineResource:function(A){var B=this.createElementDefaultNS("OnlineResource");this.setAttributeNS(B,this.namespaces.xlink,"xlink:type","simple");this.setAttributeNS(B,this.namespaces.xlink,"xlink:href",A);return B},getOnlineResource_href:function(B){var A={};var C=B.getElementsByTagName("OnlineResource");if(C.length>0){this.read_wmc_OnlineResource(A,C[0])}return A.href},CLASS_NAME:"OpenLayers.Format.WMC.v1"});OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,{slideFactor:50,slideRatio:null,initialize:function(A){OpenLayers.Control.Panel.prototype.initialize.apply(this,[A]);var A={slideFactor:this.slideFactor,slideRatio:this.slideRatio};this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH,A),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH,A),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST,A),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST,A)])},CLASS_NAME:"OpenLayers.Control.PanPanel"});OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({"removelayer":this.updateAttribution,"addlayer":this.updateAttribution,"changelayer":this.updateAttribution,"changebaselayer":this.updateAttribution,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.map.events.on({"changebaselayer":this.updateAttribution,"changelayer":this.updateAttribution,"addlayer":this.updateAttribution,"removelayer":this.updateAttribution,scope:this});this.updateAttribution();return this.div},updateAttribution:function(){var D=[];if(this.map&&this.map.layers){for(var A=0,C=this.map.layers.length;A<C;A++){var B=this.map.layers[A];if(B.attribution&&B.getVisibility()){if(OpenLayers.Util.indexOf(D,B.attribution)===-1){D.push(B.attribution)}}}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:D.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"});OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:0.0035,nbPoints:100,delay:200,points:undefined,timerId:undefined,initialize:function(A){OpenLayers.Util.extend(this,A)},begin:function(){OpenLayers.Animation.stop(this.timerId);this.timerId=undefined;this.points=[]},update:function(A){this.points.unshift({xy:A,tick:new Date().getTime()});if(this.points.length>this.nbPoints){this.points.pop()}},end:function(D){var F,A=new Date().getTime();for(var E=0,G=this.points.length,J;E<G;E++){J=this.points[E];if(A-J.tick>this.delay){break}F=J}if(!F){return}var B=new Date().getTime()-F.tick;var H=Math.sqrt(Math.pow(D.x-F.xy.x,2)+Math.pow(D.y-F.xy.y,2));var C=H/B;if(C==0||C<this.threshold){return}var I=Math.asin((D.y-F.xy.y)/H);if(F.xy.x<=D.x){I=Math.PI-I}return{speed:C,theta:I}},move:function(G,A){var H=G.speed;var F=Math.cos(G.theta);var D=-Math.sin(G.theta);var C=new Date().getTime();var E=0;var I=0;var B=function(){if(this.timerId==null){return}var M=new Date().getTime()-C;var J=(-this.deceleration*Math.pow(M,2))/2+H*M;var L=J*F;var N=J*D;var O={};O.end=false;var K=-this.deceleration*M+H;if(K<=0){OpenLayers.Animation.stop(this.timerId);this.timerId=null;O.end=true}O.x=L-E;O.y=N-I;E=L;I=N;A(O.x,O.y,O.end)};this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(B,this))},CLASS_NAME:"OpenLayers.Kinetic"});OpenLayers.Format.WPSExecute=OpenLayers.Class(OpenLayers.Format.XML,OpenLayers.Format.Filter.v1_1_0,{namespaces:{ows:"http://www.opengis.net/ows/1.1",gml:"http://www.opengis.net/gml",wps:"http://www.opengis.net/wps/1.0.0",wfs:"http://www.opengis.net/wfs",ogc:"http://www.opengis.net/ogc",wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",schemaLocationAttr:function(A){return undefined},write:function(B){var C;if(window.ActiveXObject){C=new ActiveXObject("Microsoft.XMLDOM");this.xmldom=C}else{C=document.implementation.createDocument("","",null)}var A=this.writeNode("wps:Execute",B,C);this.setAttributeNS(A,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[A])},read:function(B){if(typeof B=="string"){B=OpenLayers.Format.XML.prototype.read.apply(this,[B])}if(B&&B.nodeType==9){B=B.documentElement}var A={};this.readNode(B,A);return A},writers:{"wps":{"Execute":function(B){var A=this.createElementNSPlus("wps:Execute",{attributes:{version:this.VERSION,service:"WPS"}});this.writeNode("ows:Identifier",B.identifier,A);this.writeNode("wps:DataInputs",B.dataInputs,A);this.writeNode("wps:ResponseForm",B.responseForm,A);return A},"ResponseForm":function(B){var A=this.createElementNSPlus("wps:ResponseForm",{});if(B.rawDataOutput){this.writeNode("wps:RawDataOutput",B.rawDataOutput,A)}if(B.responseDocument){this.writeNode("wps:ResponseDocument",B.responseDocument,A)}return A},"ResponseDocument":function(B){var C=this.createElementNSPlus("wps:ResponseDocument",{attributes:{storeExecuteResponse:B.storeExecuteResponse,lineage:B.lineage,status:B.status}});if(B.outputs){for(var A=0,D=B.outputs.length;A<D;A++){this.writeNode("wps:Output",B.outputs[A],C)}}return C},"Output":function(B){var A=this.createElementNSPlus("wps:Output",{attributes:{asReference:B.asReference,mimeType:B.mimeType,encoding:B.encoding,schema:B.schema}});this.writeNode("ows:Identifier",B.identifier,A);this.writeNode("ows:Title",B.title,A);this.writeNode("ows:Abstract",B["abstract"],A);return A},"RawDataOutput":function(A){var B=this.createElementNSPlus("wps:RawDataOutput",{attributes:{mimeType:A.mimeType,encoding:A.encoding,schema:A.schema}});this.writeNode("ows:Identifier",A.identifier,B);return B},"DataInputs":function(C){var B=this.createElementNSPlus("wps:DataInputs",{});for(var A=0,D=C.length;A<D;++A){this.writeNode("wps:Input",C[A],B)}return B},"Input":function(B){var A=this.createElementNSPlus("wps:Input",{});this.writeNode("ows:Identifier",B.identifier,A);if(B.title){this.writeNode("ows:Title",B.title,A)}if(B.data){this.writeNode("wps:Data",B.data,A)}if(B.reference){this.writeNode("wps:Reference",B.reference,A)}if(B.boundingBoxData){this.writeNode("wps:BoundingBoxData",B.boundingBoxData,A)}return A},"Data":function(B){var A=this.createElementNSPlus("wps:Data",{});if(B.literalData){this.writeNode("wps:LiteralData",B.literalData,A)}else{if(B.complexData){this.writeNode("wps:ComplexData",B.complexData,A)}else{if(B.boundingBoxData){this.writeNode("ows:BoundingBox",B.boundingBoxData,A)}}}return A},"LiteralData":function(B){var A=this.createElementNSPlus("wps:LiteralData",{attributes:{uom:B.uom},value:B.value});return A},"ComplexData":function(B){var A=this.createElementNSPlus("wps:ComplexData",{attributes:{mimeType:B.mimeType,encoding:B.encoding,schema:B.schema}});var C=B.value;if(typeof C==="string"){A.appendChild(this.getXMLDoc().createCDATASection(B.value))}else{A.appendChild(C)}return A},"Reference":function(B){var A=this.createElementNSPlus("wps:Reference",{attributes:{mimeType:B.mimeType,"xlink:href":B.href,method:B.method,encoding:B.encoding,schema:B.schema}});if(B.body){this.writeNode("wps:Body",B.body,A)}return A},"BoundingBoxData":function(B,A){this.writers["ows"]["BoundingBox"].apply(this,[B,A,"wps:BoundingBoxData"])},"Body":function(A){var B=this.createElementNSPlus("wps:Body",{});if(A.wcs){this.writeNode("wcs:GetCoverage",A.wcs,B)}else{if(A.wfs){this.featureType=A.wfs.featureType;this.version=A.wfs.version;this.writeNode("wfs:GetFeature",A.wfs,B)}else{this.writeNode("wps:Execute",A,B)}}return B}},"wcs":OpenLayers.Format.WCSGetCoverage.prototype.writers.wcs,"wfs":OpenLayers.Format.WFST.v1_1_0.prototype.writers.wfs,"ogc":OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc,"ows":OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},readers:{"wps":{"ExecuteResponse":function(B,A){A.executeResponse={lang:B.getAttribute("lang"),statusLocation:B.getAttribute("statusLocation"),serviceInstance:B.getAttribute("serviceInstance"),service:B.getAttribute("service")};this.readChildNodes(B,A.executeResponse)},"Process":function(B,A){A.process={};this.readChildNodes(B,A.process)},"Status":function(B,A){A.status={creationTime:B.getAttribute("creationTime")};this.readChildNodes(B,A.status)},"ProcessSucceeded":function(B,A){A.processSucceeded=true},"ProcessOutputs":function(B,A){A.processOutputs=[];this.readChildNodes(B,A.processOutputs)},"Output":function(B,A){var C={};this.readChildNodes(B,C);A.push(C)},"Reference":function(A,B){B.reference={href:A.getAttribute("href"),mimeType:A.getAttribute("mimeType"),encoding:A.getAttribute("encoding"),schema:A.getAttribute("schema")}},"Data":function(A,B){B.data={};this.readChildNodes(A,B)},"LiteralData":function(A,B){B.literalData={dataType:A.getAttribute("dataType"),uom:A.getAttribute("uom"),value:this.getChildValue(A)}},"ComplexData":function(B,C){C.complexData={mimeType:B.getAttribute("mimeType"),schema:B.getAttribute("schema"),encoding:B.getAttribute("encoding"),value:""};if(this.isSimpleContent(B)){var A;for(A=B.firstChild;A;A=A.nextSibling){switch(A.nodeType){case 3:case 4:C.complexData.value+=A.nodeValue}}}else{for(A=B.firstChild;A;A=A.nextSibling){if(A.nodeType==1){C.complexData.value=A}}}},"BoundingBox":function(A,B){B.boundingBoxData={dimensions:A.getAttribute("dimensions"),crs:A.getAttribute("crs")};this.readChildNodes(A,B.boundingBoxData)}},"ows":OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers["ows"]},CLASS_NAME:"OpenLayers.Format.WPSExecute"});OpenLayers.Layer.GeoRSS=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,icon:null,popupSize:null,useFeedTitle:true,initialize:function(C,A,B){OpenLayers.Layer.Markers.prototype.initialize.apply(this,[C,B]);this.location=A;this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadRSS:function(){if(!this.loaded){this.events.triggerEvent("loadstart");OpenLayers.Request.GET({url:this.location,success:this.parseData,scope:this});this.loaded=true}},moveTo:function(B,A,C){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadRSS()}},parseData:function(B){var I=B.responseXML;if(!I||!I.documentElement){I=OpenLayers.Format.XML.prototype.read(B.responseText)}if(this.useFeedTitle){var P=null;try{P=I.getElementsByTagNameNS("*","title")[0].firstChild.nodeValue}catch(D){P=I.getElementsByTagName("title")[0].firstChild.nodeValue}if(P){this.setName(P)}}var M={};OpenLayers.Util.extend(M,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){M.externalProjection=this.projection;M.internalProjection=this.map.getProjectionObject()}var L=new OpenLayers.Format.GeoRSS(M);var Q=L.read(I);for(var F=0,C=Q.length;F<C;F++){var N={};var H=Q[F];if(!H.geometry){continue}var G=H.attributes.title?H.attributes.title:"Untitled";var K=H.attributes.description?H.attributes.description:"No description.";var J=H.attributes.link?H.attributes.link:"";var E=H.geometry.getBounds().getCenterLonLat();N.icon=this.icon==null?OpenLayers.Marker.defaultIcon():this.icon.clone();N.popupSize=this.popupSize?this.popupSize.clone():new OpenLayers.Size(250,120);if(G||K){N.title=G;N.description=K;var O='<div class="olLayerGeoRSSClose">[x]</div>';O+='<div class="olLayerGeoRSSTitle">';if(J){O+='<a class="link" href="'+J+'" target="_blank">'}O+=G;if(J){O+="</a>"}O+="</div>";O+='<div style="" class="olLayerGeoRSSDescription">';O+=K;O+="</div>";N["popupContentHTML"]=O}var H=new OpenLayers.Feature(this,E,N);this.features.push(H);var A=H.createMarker();A.events.register("click",H,this.markerClick);this.addMarker(A)}this.events.triggerEvent("loadend")},markerClick:function(B){var C=(this==this.layer.selectedFeature);this.layer.selectedFeature=(!C)?this:null;for(var A=0,D=this.layer.map.popups.length;A<D;A++){this.layer.map.removePopup(this.layer.map.popups[A])}if(!C){var E=this.createPopup();OpenLayers.Event.observe(E.div,"click",OpenLayers.Function.bind(function(){for(var F=0,G=this.layer.map.popups.length;F<G;F++){this.layer.map.removePopup(this.layer.map.popups[F])}},this));this.layer.map.addPopup(E)}OpenLayers.Event.stop(B)},clearFeatures:function(){if(this.features!=null){while(this.features.length>0){var A=this.features[0];OpenLayers.Util.removeItem(this.features,A);A.destroy()}}},CLASS_NAME:"OpenLayers.Layer.GeoRSS"});OpenLayers.Symbolizer.Point=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(A){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Point"});OpenLayers.Symbolizer.Line=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(A){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Line"});OpenLayers.Symbolizer.Text=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(A){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Text"});OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,{namespaces:{sld:"http://www.opengis.net/sld",ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"sld",schemaLocation:null,multipleSymbolizers:false,featureTypeCounter:null,defaultSymbolizer:{fillColor:"#808080",fillOpacity:1,strokeColor:"#000000",strokeOpacity:1,strokeWidth:1,strokeDashstyle:"solid",pointRadius:3,graphicName:"square"},read:function(C,B){B=OpenLayers.Util.applyDefaults(B,this.options);var A={namedLayers:B.namedLayersAsArray===true?[]:{}};this.readChildNodes(C,A);return A},readers:OpenLayers.Util.applyDefaults({"sld":{"StyledLayerDescriptor":function(B,A){A.version=B.getAttribute("version");this.readChildNodes(B,A)},"Name":function(B,A){A.name=this.getChildValue(B)},"Title":function(B,A){A.title=this.getChildValue(B)},"Abstract":function(B,A){A.description=this.getChildValue(B)},"NamedLayer":function(C,A){var D={userStyles:[],namedStyles:[]};this.readChildNodes(C,D);for(var B=0,E=D.userStyles.length;B<E;++B){D.userStyles[B].layerName=D.name}if(OpenLayers.Util.isArray(A.namedLayers)){A.namedLayers.push(D)}else{A.namedLayers[D.name]=D}},"NamedStyle":function(A,B){B.namedStyles.push(this.getChildName(A.firstChild))},"UserStyle":function(B,C){var A={defaultsPerSymbolizer:true,rules:[]};this.featureTypeCounter=-1;this.readChildNodes(B,A);var D;if(this.multipleSymbolizers){delete A.defaultsPerSymbolizer;D=new OpenLayers.Style2(A)}else{D=new OpenLayers.Style(this.defaultSymbolizer,A)}C.userStyles.push(D)},"IsDefault":function(A,B){if(this.getChildValue(A)=="1"){B.isDefault=true}},"FeatureTypeStyle":function(B,C){++this.featureTypeCounter;var A={rules:this.multipleSymbolizers?C.rules:[]};this.readChildNodes(B,A);if(!this.multipleSymbolizers){C.rules=A.rules}},"Rule":function(C,B){var D;if(this.multipleSymbolizers){D={symbolizers:[]}}var A=new OpenLayers.Rule(D);this.readChildNodes(C,A);B.rules.push(A)},"ElseFilter":function(B,A){A.elseFilter=true},"MinScaleDenominator":function(B,A){A.minScaleDenominator=parseFloat(this.getChildValue(B))},"MaxScaleDenominator":function(B,A){A.maxScaleDenominator=parseFloat(this.getChildValue(B))},"TextSymbolizer":function(B,A){var C={};this.readChildNodes(B,C);if(this.multipleSymbolizers){C.zIndex=this.featureTypeCounter;A.symbolizers.push(new OpenLayers.Symbolizer.Text(C))}else{A.symbolizer["Text"]=OpenLayers.Util.applyDefaults(C,A.symbolizer["Text"])}},"LabelPlacement":function(B,A){this.readChildNodes(B,A)},"PointPlacement":function(B,A){var D={};this.readChildNodes(B,D);D.labelRotation=D.rotation;delete D.rotation;var C,E=A.labelAnchorPointX,F=A.labelAnchorPointY;if(E<=1/3){C="l"}else{if(E>1/3&&E<2/3){C="c"}else{if(E>=2/3){C="r"}}}if(F<=1/3){C+="b"}else{if(F>1/3&&F<2/3){C+="m"}else{if(F>=2/3){C+="t"}}}D.labelAlign=C;OpenLayers.Util.applyDefaults(A,D)},"AnchorPoint":function(B,A){this.readChildNodes(B,A)},"AnchorPointX":function(B,A){var C=this.readers.ogc._expression.call(this,B);if(C){A.labelAnchorPointX=C}},"AnchorPointY":function(B,A){var C=this.readers.ogc._expression.call(this,B);if(C){A.labelAnchorPointY=C}},"Displacement":function(B,A){this.readChildNodes(B,A)},"DisplacementX":function(B,A){var C=this.readers.ogc._expression.call(this,B);if(C){A.labelXOffset=C}},"DisplacementY":function(C,B){var A=this.readers.ogc._expression.call(this,C);if(A){B.labelYOffset=A}},"LinePlacement":function(B,A){this.readChildNodes(B,A)},"PerpendicularOffset":function(C,A){var B=this.readers.ogc._expression.call(this,C);if(B){A.labelPerpendicularOffset=B}},"Label":function(B,A){var C=this.readers.ogc._expression.call(this,B);if(C){A.label=C}},"Font":function(B,A){this.readChildNodes(B,A)},"Halo":function(B,A){var C={};this.readChildNodes(B,C);A.haloRadius=C.haloRadius;A.haloColor=C.fillColor;A.haloOpacity=C.fillOpacity},"Radius":function(B,A){var C=this.readers.ogc._expression.call(this,B);if(C!=null){A.haloRadius=C}},"RasterSymbolizer":function(B,A){var C={};this.readChildNodes(B,C);if(this.multipleSymbolizers){C.zIndex=this.featureTypeCounter;A.symbolizers.push(new OpenLayers.Symbolizer.Raster(C))}else{A.symbolizer["Raster"]=OpenLayers.Util.applyDefaults(C,A.symbolizer["Raster"])}},"Geometry":function(B,A){A.geometry={};this.readChildNodes(B,A.geometry)},"ColorMap":function(B,A){A.colorMap=[];this.readChildNodes(B,A.colorMap)},"ColorMapEntry":function(C,A){var D=C.getAttribute("quantity");var B=C.getAttribute("opacity");A.push({color:C.getAttribute("color"),quantity:D!==null?parseFloat(D):undefined,label:C.getAttribute("label")||undefined,opacity:B!==null?parseFloat(B):undefined})},"LineSymbolizer":function(B,A){var C={};this.readChildNodes(B,C);if(this.multipleSymbolizers){C.zIndex=this.featureTypeCounter;A.symbolizers.push(new OpenLayers.Symbolizer.Line(C))}else{A.symbolizer["Line"]=OpenLayers.Util.applyDefaults(C,A.symbolizer["Line"])}},"PolygonSymbolizer":function(B,A){var C={fill:false,stroke:false};if(!this.multipleSymbolizers){C=A.symbolizer["Polygon"]||C}this.readChildNodes(B,C);if(this.multipleSymbolizers){C.zIndex=this.featureTypeCounter;A.symbolizers.push(new OpenLayers.Symbolizer.Polygon(C))}else{A.symbolizer["Polygon"]=C}},"PointSymbolizer":function(B,A){var C={fill:false,stroke:false,graphic:false};if(!this.multipleSymbolizers){C=A.symbolizer["Point"]||C}this.readChildNodes(B,C);if(this.multipleSymbolizers){C.zIndex=this.featureTypeCounter;A.symbolizers.push(new OpenLayers.Symbolizer.Point(C))}else{A.symbolizer["Point"]=C}},"Stroke":function(B,A){A.stroke=true;this.readChildNodes(B,A)},"Fill":function(B,A){A.fill=true;this.readChildNodes(B,A)},"CssParameter":function(C,B){var D=C.getAttribute("name");var A=this.cssMap[D];if(B.label){if(D==="fill"){A="fontColor"}else{if(D==="fill-opacity"){A="fontOpacity"}}}if(A){var E=this.readers.ogc._expression.call(this,C);if(E){B[A]=E}}},"Graphic":function(F,I){I.graphic=true;var E={};this.readChildNodes(F,E);var G=["stroke","strokeColor","strokeWidth","strokeOpacity","strokeLinecap","fill","fillColor","fillOpacity","graphicName","rotation","graphicFormat"];var A,C;for(var D=0,H=G.length;D<H;++D){A=G[D];C=E[A];if(C!=undefined){I[A]=C}}if(E.opacity!=undefined){I.graphicOpacity=E.opacity}if(E.size!=undefined){var B=E.size/2;if(isNaN(B)){I.graphicWidth=E.size}else{I.pointRadius=E.size/2}}if(E.href!=undefined){I.externalGraphic=E.href}if(E.rotation!=undefined){I.rotation=E.rotation}},"ExternalGraphic":function(B,A){this.readChildNodes(B,A)},"Mark":function(B,A){this.readChildNodes(B,A)},"WellKnownName":function(B,A){A.graphicName=this.getChildValue(B)},"Opacity":function(B,A){var C=this.readers.ogc._expression.call(this,B);if(C){A.opacity=C}},"Size":function(C,B){var A=this.readers.ogc._expression.call(this,C);if(A){B.size=A}},"Rotation":function(B,A){var C=this.readers.ogc._expression.call(this,B);if(C){A.rotation=C}},"OnlineResource":function(B,A){A.href=this.getAttributeNS(B,this.namespaces.xlink,"href")},"Format":function(B,A){A.graphicFormat=this.getChildValue(B)}}},OpenLayers.Format.Filter.v1_0_0.prototype.readers),cssMap:{"stroke":"strokeColor","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","stroke-linecap":"strokeLinecap","stroke-dasharray":"strokeDashstyle","fill":"fillColor","fill-opacity":"fillOpacity","font-family":"fontFamily","font-size":"fontSize","font-weight":"fontWeight","font-style":"fontStyle"},getCssProperty:function(C){var A=null;for(var B in this.cssMap){if(this.cssMap[B]==C){A=B;break}}return A},getGraphicFormat:function(A){var C,B;for(var D in this.graphicFormats){if(this.graphicFormats[D].test(A)){C=D;break}}return C||this.defaultGraphicFormat},defaultGraphicFormat:"image/png",graphicFormats:{"image/jpeg":/\.jpe?g$/i,"image/gif":/\.gif$/i,"image/png":/\.png$/i},write:function(A){return this.writers.sld.StyledLayerDescriptor.apply(this,[A])},writers:OpenLayers.Util.applyDefaults({"sld":{"_OGCExpression":function(A,C){var F=this.createElementNSPlus(A);var B=typeof C=="string"?C.split("${"):[C];F.appendChild(this.createTextNode(B[0]));var H,E;for(var D=1,G=B.length;D<G;D++){H=B[D];E=H.indexOf("}");if(E>0){this.writeNode("ogc:PropertyName",{property:H.substring(0,E)},F);F.appendChild(this.createTextNode(H.substring(++E)))}else{F.appendChild(this.createTextNode("${"+H))}}return F},"StyledLayerDescriptor":function(A){var B=this.createElementNSPlus("sld:StyledLayerDescriptor",{attributes:{"version":this.VERSION,"xsi:schemaLocation":this.schemaLocation}});B.setAttribute("xmlns:ogc",this.namespaces.ogc);B.setAttribute("xmlns:gml",this.namespaces.gml);if(A.name){this.writeNode("Name",A.name,B)}if(A.title){this.writeNode("Title",A.title,B)}if(A.description){this.writeNode("Abstract",A.description,B)}if(OpenLayers.Util.isArray(A.namedLayers)){for(var C=0,E=A.namedLayers.length;C<E;++C){this.writeNode("NamedLayer",A.namedLayers[C],B)}}else{for(var D in A.namedLayers){this.writeNode("NamedLayer",A.namedLayers[D],B)}}return B},"Name":function(A){return this.createElementNSPlus("sld:Name",{value:A})},"Title":function(A){return this.createElementNSPlus("sld:Title",{value:A})},"Abstract":function(A){return this.createElementNSPlus("sld:Abstract",{value:A})},"NamedLayer":function(C){var B=this.createElementNSPlus("sld:NamedLayer");this.writeNode("Name",C.name,B);if(C.namedStyles){for(var A=0,D=C.namedStyles.length;A<D;++A){this.writeNode("NamedStyle",C.namedStyles[A],B)}}if(C.userStyles){for(var A=0,D=C.userStyles.length;A<D;++A){this.writeNode("UserStyle",C.userStyles[A],B)}}return B},"NamedStyle":function(B){var A=this.createElementNSPlus("sld:NamedStyle");this.writeNode("Name",B,A);return A},"UserStyle":function(H){var I=this.createElementNSPlus("sld:UserStyle");if(H.name){this.writeNode("Name",H.name,I)}if(H.title){this.writeNode("Title",H.title,I)}if(H.description){this.writeNode("Abstract",H.description,I)}if(H.isDefault){this.writeNode("IsDefault",H.isDefault,I)}if(this.multipleSymbolizers&&H.rules){var J={0:[]};var C=[0];var L,A,N,K,B;for(var G=0,E=H.rules.length;G<E;++G){L=H.rules[G];if(L.symbolizers){A={};for(var F=0,M=L.symbolizers.length;F<M;++F){N=L.symbolizers[F];K=N.zIndex;if(!(K in A)){B=L.clone();B.symbolizers=[];A[K]=B}A[K].symbolizers.push(N.clone())}for(K in A){if(!(K in J)){C.push(K);J[K]=[]}J[K].push(A[K])}}else{J[0].push(L.clone())}}C.sort();var D;for(var G=0,E=C.length;G<E;++G){D=J[C[G]];if(D.length>0){B=H.clone();B.rules=J[C[G]];this.writeNode("FeatureTypeStyle",B,I)}}}else{this.writeNode("FeatureTypeStyle",H,I)}return I},"IsDefault":function(A){return this.createElementNSPlus("sld:IsDefault",{value:(A)?"1":"0"})},"FeatureTypeStyle":function(C){var B=this.createElementNSPlus("sld:FeatureTypeStyle");for(var A=0,D=C.rules.length;A<D;++A){this.writeNode("Rule",C.rules[A],B)}return B},"Rule":function(D){var E=this.createElementNSPlus("sld:Rule");if(D.name){this.writeNode("Name",D.name,E)}if(D.title){this.writeNode("Title",D.title,E)}if(D.description){this.writeNode("Abstract",D.description,E)}if(D.elseFilter){this.writeNode("ElseFilter",null,E)}else{if(D.filter){this.writeNode("ogc:Filter",D.filter,E)}}if(D.minScaleDenominator!=undefined){this.writeNode("MinScaleDenominator",D.minScaleDenominator,E)}if(D.maxScaleDenominator!=undefined){this.writeNode("MaxScaleDenominator",D.maxScaleDenominator,E)}var G,H;if(this.multipleSymbolizers&&D.symbolizers){var H;for(var C=0,A=D.symbolizers.length;C<A;++C){H=D.symbolizers[C];G=H.CLASS_NAME.split(".").pop();this.writeNode(G+"Symbolizer",H,E)}}else{var B=OpenLayers.Style.SYMBOLIZER_PREFIXES;for(var C=0,F=B.length;C<F;++C){G=B[C];H=D.symbolizer[G];if(H){this.writeNode(G+"Symbolizer",H,E)}}}return E},"ElseFilter":function(){return this.createElementNSPlus("sld:ElseFilter")},"MinScaleDenominator":function(A){return this.createElementNSPlus("sld:MinScaleDenominator",{value:A})},"MaxScaleDenominator":function(A){return this.createElementNSPlus("sld:MaxScaleDenominator",{value:A})},"LineSymbolizer":function(A){var B=this.createElementNSPlus("sld:LineSymbolizer");this.writeNode("Stroke",A,B);return B},"Stroke":function(A){var B=this.createElementNSPlus("sld:Stroke");if(A.strokeColor!=undefined){this.writeNode("CssParameter",{symbolizer:A,key:"strokeColor"},B)}if(A.strokeOpacity!=undefined){this.writeNode("CssParameter",{symbolizer:A,key:"strokeOpacity"},B)}if(A.strokeWidth!=undefined){this.writeNode("CssParameter",{symbolizer:A,key:"strokeWidth"},B)}if(A.strokeDashstyle!=undefined&&A.strokeDashstyle!=="solid"){this.writeNode("CssParameter",{symbolizer:A,key:"strokeDashstyle"},B)}if(A.strokeLinecap!=undefined){this.writeNode("CssParameter",{symbolizer:A,key:"strokeLinecap"},B)}return B},"CssParameter":function(A){return this.createElementNSPlus("sld:CssParameter",{attributes:{name:this.getCssProperty(A.key)},value:A.symbolizer[A.key]})},"TextSymbolizer":function(A){var B=this.createElementNSPlus("sld:TextSymbolizer");if(A.label!=null){this.writeNode("Label",A.label,B)}if(A.fontFamily!=null||A.fontSize!=null||A.fontWeight!=null||A.fontStyle!=null){this.writeNode("Font",A,B)}if(A.labelAnchorPointX!=null||A.labelAnchorPointY!=null||A.labelAlign!=null||A.labelXOffset!=null||A.labelYOffset!=null||A.labelRotation!=null||A.labelPerpendicularOffset!=null){this.writeNode("LabelPlacement",A,B)}if(A.haloRadius!=null||A.haloColor!=null||A.haloOpacity!=null){this.writeNode("Halo",A,B)}if(A.fontColor!=null||A.fontOpacity!=null){this.writeNode("Fill",{fillColor:A.fontColor,fillOpacity:A.fontOpacity},B)}return B},"LabelPlacement":function(A){var B=this.createElementNSPlus("sld:LabelPlacement");if((A.labelAnchorPointX!=null||A.labelAnchorPointY!=null||A.labelAlign!=null||A.labelXOffset!=null||A.labelYOffset!=null||A.labelRotation!=null)&&A.labelPerpendicularOffset==null){this.writeNode("PointPlacement",A,B)}if(A.labelPerpendicularOffset!=null){this.writeNode("LinePlacement",A,B)}return B},"LinePlacement":function(A){var B=this.createElementNSPlus("sld:LinePlacement");this.writeNode("PerpendicularOffset",A.labelPerpendicularOffset,B);return B},"PerpendicularOffset":function(A){return this.createElementNSPlus("sld:PerpendicularOffset",{value:A})},"PointPlacement":function(A){var B=this.createElementNSPlus("sld:PointPlacement");if(A.labelAnchorPointX!=null||A.labelAnchorPointY!=null||A.labelAlign!=null){this.writeNode("AnchorPoint",A,B)}if(A.labelXOffset!=null||A.labelYOffset!=null){this.writeNode("Displacement",A,B)}if(A.labelRotation!=null){this.writeNode("Rotation",A.labelRotation,B)}return B},"AnchorPoint":function(A){var B=this.createElementNSPlus("sld:AnchorPoint");var C=A.labelAnchorPointX,D=A.labelAnchorPointY;if(C!=null){this.writeNode("AnchorPointX",C,B)}if(D!=null){this.writeNode("AnchorPointY",D,B)}if(C==null&&D==null){var F=A.labelAlign.substr(0,1),E=A.labelAlign.substr(1,1);if(F==="l"){C=0}else{if(F==="c"){C=0.5}else{if(F==="r"){C=1}}}if(E==="b"){D=0}else{if(E==="m"){D=0.5}else{if(E==="t"){D=1}}}this.writeNode("AnchorPointX",C,B);this.writeNode("AnchorPointY",D,B)}return B},"AnchorPointX":function(A){return this.createElementNSPlus("sld:AnchorPointX",{value:A})},"AnchorPointY":function(A){return this.createElementNSPlus("sld:AnchorPointY",{value:A})},"Displacement":function(A){var B=this.createElementNSPlus("sld:Displacement");if(A.labelXOffset!=null){this.writeNode("DisplacementX",A.labelXOffset,B)}if(A.labelYOffset!=null){this.writeNode("DisplacementY",A.labelYOffset,B)}return B},"DisplacementX":function(A){return this.createElementNSPlus("sld:DisplacementX",{value:A})},"DisplacementY":function(A){return this.createElementNSPlus("sld:DisplacementY",{value:A})},"Font":function(A){var B=this.createElementNSPlus("sld:Font");if(A.fontFamily){this.writeNode("CssParameter",{symbolizer:A,key:"fontFamily"},B)}if(A.fontSize){this.writeNode("CssParameter",{symbolizer:A,key:"fontSize"},B)}if(A.fontWeight){this.writeNode("CssParameter",{symbolizer:A,key:"fontWeight"},B)}if(A.fontStyle){this.writeNode("CssParameter",{symbolizer:A,key:"fontStyle"},B)}return B},"Label":function(A){return this.writers.sld._OGCExpression.call(this,"sld:Label",A)},"Halo":function(A){var B=this.createElementNSPlus("sld:Halo");if(A.haloRadius){this.writeNode("Radius",A.haloRadius,B)}if(A.haloColor||A.haloOpacity){this.writeNode("Fill",{fillColor:A.haloColor,fillOpacity:A.haloOpacity},B)}return B},"Radius":function(A){return this.createElementNSPlus("sld:Radius",{value:A})},"RasterSymbolizer":function(A){var B=this.createElementNSPlus("sld:RasterSymbolizer");if(A.geometry){this.writeNode("Geometry",A.geometry,B)}if(A.opacity){this.writeNode("Opacity",A.opacity,B)}if(A.colorMap){this.writeNode("ColorMap",A.colorMap,B)}return B},"Geometry":function(B){var A=this.createElementNSPlus("sld:Geometry");if(B.property){this.writeNode("ogc:PropertyName",B,A)}return A},"ColorMap":function(A){var C=this.createElementNSPlus("sld:ColorMap");for(var B=0,D=A.length;B<D;++B){this.writeNode("ColorMapEntry",A[B],C)}return C},"ColorMapEntry":function(A){var B=this.createElementNSPlus("sld:ColorMapEntry");var C=A;B.setAttribute("color",C.color);C.opacity!==undefined&&B.setAttribute("opacity",parseFloat(C.opacity));C.quantity!==undefined&&B.setAttribute("quantity",parseFloat(C.quantity));C.label!==undefined&&B.setAttribute("label",C.label);return B},"PolygonSymbolizer":function(A){var B=this.createElementNSPlus("sld:PolygonSymbolizer");if(A.fill!==false){this.writeNode("Fill",A,B)}if(A.stroke!==false){this.writeNode("Stroke",A,B)}return B},"Fill":function(A){var B=this.createElementNSPlus("sld:Fill");if(A.fillColor){this.writeNode("CssParameter",{symbolizer:A,key:"fillColor"},B)}if(A.fillOpacity!=null){this.writeNode("CssParameter",{symbolizer:A,key:"fillOpacity"},B)}return B},"PointSymbolizer":function(A){var B=this.createElementNSPlus("sld:PointSymbolizer");this.writeNode("Graphic",A,B);return B},"Graphic":function(A){var B=this.createElementNSPlus("sld:Graphic");if(A.externalGraphic!=undefined){this.writeNode("ExternalGraphic",A,B)}else{this.writeNode("Mark",A,B)}if(A.graphicOpacity!=undefined){this.writeNode("Opacity",A.graphicOpacity,B)}if(A.pointRadius!=undefined){this.writeNode("Size",A.pointRadius*2,B)}else{if(A.graphicWidth!=undefined){this.writeNode("Size",A.graphicWidth,B)}}if(A.rotation!=undefined){this.writeNode("Rotation",A.rotation,B)}return B},"ExternalGraphic":function(B){var C=this.createElementNSPlus("sld:ExternalGraphic");this.writeNode("OnlineResource",B.externalGraphic,C);var A=B.graphicFormat||this.getGraphicFormat(B.externalGraphic);this.writeNode("Format",A,C);return C},"Mark":function(A){var B=this.createElementNSPlus("sld:Mark");if(A.graphicName){this.writeNode("WellKnownName",A.graphicName,B)}if(A.fill!==false){this.writeNode("Fill",A,B)}if(A.stroke!==false){this.writeNode("Stroke",A,B)}return B},"WellKnownName":function(A){return this.createElementNSPlus("sld:WellKnownName",{value:A})},"Opacity":function(A){return this.createElementNSPlus("sld:Opacity",{value:A})},"Size":function(A){return this.writers.sld._OGCExpression.call(this,"sld:Size",A)},"Rotation":function(A){return this.createElementNSPlus("sld:Rotation",{value:A})},"OnlineResource":function(A){return this.createElementNSPlus("sld:OnlineResource",{attributes:{"xlink:type":"simple","xlink:href":A}})},"Format":function(A){return this.createElementNSPlus("sld:Format",{value:A})}}},OpenLayers.Format.Filter.v1_0_0.prototype.writers),CLASS_NAME:"OpenLayers.Format.SLD.v1"});OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:true,encodeBBOX:false,noMagic:false,yx:{},initialize:function(C,A,E,B){var D=[];E=OpenLayers.Util.upperCaseObject(E);if(parseFloat(E.VERSION)>=1.3&&!E.EXCEPTIONS){E.EXCEPTIONS="INIMAGE"}D.push(C,A,E,B);OpenLayers.Layer.Grid.prototype.initialize.apply(this,D);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(!this.noMagic&&this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if((B==null)||(!B.isBaseLayer)){this.isBaseLayer=false}if(this.params.FORMAT=="image/jpeg"){this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"}}},clone:function(A){if(A==null){A=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions())}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);return A},reverseAxisOrder:function(){var A=this.projection.getCode();return parseFloat(this.params.VERSION)>=1.3&&!!(this.yx[A]||(OpenLayers.Projection.defaults[A]&&OpenLayers.Projection.defaults[A].yx))},getURL:function(B){B=this.adjustBounds(B);var E=this.getImageSize();var D={};var C=this.reverseAxisOrder();D.BBOX=this.encodeBBOX?B.toBBOX(null,C):B.toArray(C);D.WIDTH=E.w;D.HEIGHT=E.h;var A=this.getFullRequestString(D);return A},mergeNewParams:function(B){var A=OpenLayers.Util.upperCaseObject(B);var C=[A];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,C)},getFullRequestString:function(B,C){var D=this.map.getProjectionObject();var A=this.projection&&this.projection.equals(D)?this.projection.getCode():D.getCode();var E=(A=="none")?null:A;if(parseFloat(this.params.VERSION)>=1.3){this.params.CRS=E}else{this.params.SRS=E}if(typeof this.params.TRANSPARENT=="boolean"){B.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE"}return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"});OpenLayers.Layer.KaMap=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,DEFAULT_PARAMS:{i:"jpeg",map:""},initialize:function(C,A,D,B){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getURL:function(C){C=this.adjustBounds(C);var B=this.map.getResolution();var E=Math.round((this.map.getScale()*10000))/10000;var A=Math.round(C.left/B);var D=-Math.round(C.top/B);return this.getFullRequestString({t:D,l:A,s:E})},calculateGridLayout:function(B,E,H){var C=H*this.tileSize.w;var F=H*this.tileSize.h;var G=B.left;var D=Math.floor(G/C)-this.buffer;var I=B.top;var A=Math.floor(I/F)+this.buffer;return{tilelon:C,tilelat:F,startcol:D,startrow:A}},getTileBoundsForGridIndex:function(G,H){var D=this.getTileOrigin();var A=this.gridLayout;var B=A.tilelon;var C=A.tilelat;var E=(A.startcol+H)*B;var F=(A.startrow-G)*C;return new OpenLayers.Bounds(E,F,E+B,F+C)},clone:function(A){if(A==null){A=new OpenLayers.Layer.KaMap(this.name,this.url,this.params,this.getOptions())}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);if(this.tileSize!=null){A.tileSize=this.tileSize.clone()}A.grid=[];return A},getTileBounds:function(B){var E=this.getResolution();var F=E*this.tileSize.w;var C=E*this.tileSize.h;var A=this.getLonLatFromViewPortPx(B);var D=F*Math.floor(A.lon/F);var G=C*Math.floor(A.lat/C);return new OpenLayers.Bounds(D,G,D+F,G+C)},CLASS_NAME:"OpenLayers.Layer.KaMap"});OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd",initialize:function(A){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[A])},read_sld_MinScaleDenominator:function(C,B){var A=parseFloat(this.getChildValue(B));if(A>0){C.maxScale=A}},read_sld_MaxScaleDenominator:function(B,A){B.minScale=parseFloat(this.getChildValue(A))},read_wmc_SRS:function(B,A){if(!("srs" in B)){B.srs={}}B.srs[this.getChildValue(A)]=true},write_wmc_Layer:function(B){var C=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[B]);if(B.maxScale){var A=this.createElementNS(this.namespaces.sld,"sld:MinScaleDenominator");A.appendChild(this.createTextNode(B.maxScale.toPrecision(16)));C.appendChild(A)}if(B.minScale){var E=this.createElementNS(this.namespaces.sld,"sld:MaxScaleDenominator");E.appendChild(this.createTextNode(B.minScale.toPrecision(16)));C.appendChild(E)}if(B.srs){for(var D in B.srs){C.appendChild(this.createElementDefaultNS("SRS",D))}}C.appendChild(this.write_wmc_FormatList(B));C.appendChild(this.write_wmc_StyleList(B));if(B.dimensions){C.appendChild(this.write_wmc_DimensionList(B))}C.appendChild(this.write_wmc_LayerExtension(B));return C},CLASS_NAME:"OpenLayers.Format.WMC.v1_1_0"});OpenLayers.Format.XLS=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",stringifyOutput:true,CLASS_NAME:"OpenLayers.Format.XLS"});OpenLayers.Format.XLS.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xls:"http://www.opengis.net/xls",gml:"http://www.opengis.net/gml",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},xy:true,defaultPrefix:"xls",schemaLocation:null,read:function(C,A){A=OpenLayers.Util.applyDefaults(A,this.options);var B={};this.readChildNodes(C,B);return B},readers:{"xls":{"XLS":function(A,B){B.version=A.getAttribute("version");this.readChildNodes(A,B)},"Response":function(A,B){this.readChildNodes(A,B)},"GeocodeResponse":function(A,B){B.responseLists=[];this.readChildNodes(A,B)},"GeocodeResponseList":function(B,C){var A={features:[],numberOfGeocodedAddresses:parseInt(B.getAttribute("numberOfGeocodedAddresses"))};C.responseLists.push(A);this.readChildNodes(B,A)},"GeocodedAddress":function(C,A){var B=new OpenLayers.Feature.Vector();A.features.push(B);this.readChildNodes(C,B);B.geometry=B.components[0]},"GeocodeMatchCode":function(B,A){A.attributes.matchCode={accuracy:parseFloat(B.getAttribute("accuracy")),matchType:B.getAttribute("matchType")}},"Address":function(C,A){var B={countryCode:C.getAttribute("countryCode"),addressee:C.getAttribute("addressee"),street:[],place:[]};A.attributes.address=B;this.readChildNodes(C,B)},"freeFormAddress":function(B,A){A.freeFormAddress=this.getChildValue(B)},"StreetAddress":function(B,A){this.readChildNodes(B,A)},"Building":function(B,A){A.building={"number":B.getAttribute("number"),subdivision:B.getAttribute("subdivision"),buildingName:B.getAttribute("buildingName")}},"Street":function(B,A){A.street.push(this.getChildValue(B))},"Place":function(B,A){A.place[B.getAttribute("type")]=this.getChildValue(B)},"PostalCode":function(B,A){A.postalCode=this.getChildValue(B)}},"gml":OpenLayers.Format.GML.v3.prototype.readers.gml},write:function(A){return this.writers.xls.XLS.apply(this,[A])},writers:{"xls":{"XLS":function(B){var A=this.createElementNSPlus("xls:XLS",{attributes:{"version":this.VERSION,"xsi:schemaLocation":this.schemaLocation}});this.writeNode("RequestHeader",B.header,A);this.writeNode("Request",B,A);return A},"RequestHeader":function(A){return this.createElementNSPlus("xls:RequestHeader")},"Request":function(A){var B=this.createElementNSPlus("xls:Request",{attributes:{methodName:"GeocodeRequest",requestID:A.requestID||"",version:this.VERSION}});this.writeNode("GeocodeRequest",A.addresses,B);return B},"GeocodeRequest":function(D){var B=this.createElementNSPlus("xls:GeocodeRequest");for(var A=0,C=D.length;A<C;A++){this.writeNode("Address",D[A],B)}return B},"Address":function(A){var B=this.createElementNSPlus("xls:Address",{attributes:{countryCode:A.countryCode}});if(A.freeFormAddress){this.writeNode("freeFormAddress",A.freeFormAddress,B)}else{if(A.street){this.writeNode("StreetAddress",A,B)}if(A.municipality){this.writeNode("Municipality",A.municipality,B)}if(A.countrySubdivision){this.writeNode("CountrySubdivision",A.countrySubdivision,B)}if(A.postalCode){this.writeNode("PostalCode",A.postalCode,B)}}return B},"freeFormAddress":function(A){return this.createElementNSPlus("freeFormAddress",{value:A})},"StreetAddress":function(C){var D=this.createElementNSPlus("xls:StreetAddress");if(C.building){this.writeNode(D,"Building",C.building)}var A=C.street;if(!(OpenLayers.Util.isArray(A))){A=[A]}for(var B=0,E=A.length;B<E;B++){this.writeNode("Street",A[B],D)}return D},"Building":function(A){return this.createElementNSPlus("xls:Building",{attributes:{"number":A["number"],"subdivision":A.subdivision,"buildingName":A.buildingName}})},"Street":function(A){return this.createElementNSPlus("xls:Street",{value:A})},"Municipality":function(A){return this.createElementNSPlus("xls:Place",{attributes:{type:"Municipality"},value:A})},"CountrySubdivision":function(A){return this.createElementNSPlus("xls:Place",{attributes:{type:"CountrySubdivision"},value:A})},"PostalCode":function(A){return this.createElementNSPlus("xls:PostalCode",{value:A})}}},CLASS_NAME:"OpenLayers.Format.XLS.v1"});OpenLayers.Format.XLS.v1_1_0=OpenLayers.Class(OpenLayers.Format.XLS.v1,{VERSION:"1.1",schemaLocation:"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.1.0/LocationUtilityService.xsd",CLASS_NAME:"OpenLayers.Format.XLS.v1_1_0"});OpenLayers.Format.XLS.v1_1=OpenLayers.Format.XLS.v1_1_0;OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15000,translationParameters:null,symbolMetrics:null,initialize:function(A){if(!this.supported()){return}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments);this.translationParameters={x:0,y:0};this.symbolMetrics={}},supported:function(){var A="http://www.w3.org/TR/SVG11/feature#";return(document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(A+"SVG","1.1")||document.implementation.hasFeature(A+"BasicStructure","1.1")))},inValidRange:function(D,E,B){var A=D+(B?0:this.translationParameters.x);var C=E+(B?0:this.translationParameters.y);return(A>=-this.MAX_PIXEL&&A<=this.MAX_PIXEL&&C>=-this.MAX_PIXEL&&C<=this.MAX_PIXEL)},setExtent:function(B,G){var E=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var F=this.getResolution(),D=-B.left/F,C=B.top/F;if(G){this.left=D;this.top=C;var H="0 0 "+this.size.w+" "+this.size.h;this.rendererRoot.setAttributeNS(null,"viewBox",H);this.translate(this.xOffset,0);return true}else{var A=this.translate(D-this.left+this.xOffset,C-this.top);if(!A){this.setExtent(B,true)}return E&&A}},translate:function(A,B){if(!this.inValidRange(A,B,true)){return false}else{var C="";if(A||B){C="translate("+A+","+B+")"}this.root.setAttributeNS(null,"transform",C);this.translationParameters={x:A,y:B};return true}},setSize:function(A){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,"width",this.size.w);this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(C,B){var A=null;switch(C.CLASS_NAME){case"OpenLayers.Geometry.Point":if(B.externalGraphic){A="image"}else{if(this.isComplexSymbol(B.graphicName)){A="svg"}else{A="circle"}}break;case"OpenLayers.Geometry.Rectangle":A="rect";break;case"OpenLayers.Geometry.LineString":A="polyline";break;case"OpenLayers.Geometry.LinearRing":A="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":A="path";break;default:break}return A},setStyle:function(O,U,P){U=U||O._style;P=P||O._options;var J=U.title||U.graphicTitle;if(J){O.setAttributeNS(null,"title",J);var C=O.getElementsByTagName("title");if(C.length>0){C[0].firstChild.textContent=J}else{var R=this.nodeFactory(null,"title");R.textContent=J;O.appendChild(R)}}var A=parseFloat(O.getAttributeNS(null,"r"));var Q=1;var M;if(O._geometryClass=="OpenLayers.Geometry.Point"&&A){O.style.visibility="";if(U.graphic===false){O.style.visibility="hidden"}else{if(U.externalGraphic){M=this.getPosition(O);if(U.graphicWidth&&U.graphicHeight){O.setAttributeNS(null,"preserveAspectRatio","none")}var F=U.graphicWidth||U.graphicHeight;var S=U.graphicHeight||U.graphicWidth;F=F?F:U.pointRadius*2;S=S?S:U.pointRadius*2;var E=(U.graphicXOffset!=undefined)?U.graphicXOffset:-(0.5*F);var T=(U.graphicYOffset!=undefined)?U.graphicYOffset:-(0.5*S);var I=U.graphicOpacity||U.fillOpacity;O.setAttributeNS(null,"x",(M.x+E).toFixed());O.setAttributeNS(null,"y",(M.y+T).toFixed());O.setAttributeNS(null,"width",F);O.setAttributeNS(null,"height",S);O.setAttributeNS(this.xlinkns,"xlink:href",U.externalGraphic);O.setAttributeNS(null,"style","opacity: "+I);O.onclick=OpenLayers.Event.preventDefault}else{if(this.isComplexSymbol(U.graphicName)){var K=U.pointRadius*3;var D=K*2;var H=this.importSymbol(U.graphicName);M=this.getPosition(O);Q=this.symbolMetrics[H.id][0]*3/D;var N=O.parentNode;var B=O.nextSibling;if(N){N.removeChild(O)}O.firstChild&&O.removeChild(O.firstChild);O.appendChild(H.firstChild.cloneNode(true));O.setAttributeNS(null,"viewBox",H.getAttributeNS(null,"viewBox"));O.setAttributeNS(null,"width",D);O.setAttributeNS(null,"height",D);O.setAttributeNS(null,"x",M.x-K);O.setAttributeNS(null,"y",M.y-K);if(B){N.insertBefore(O,B)}else{if(N){N.appendChild(O)}}}else{O.setAttributeNS(null,"r",U.pointRadius)}}}var G=U.rotation;if((G!==undefined||O._rotation!==undefined)&&M){O._rotation=G;G|=0;if(O.nodeName!=="svg"){O.setAttributeNS(null,"transform","rotate("+G+" "+M.x+" "+M.y+")")}else{var L=this.symbolMetrics[H.id];O.firstChild.setAttributeNS(null,"transform","rotate("+G+" "+L[1]+" "+L[2]+")")}}}if(P.isFilled){O.setAttributeNS(null,"fill",U.fillColor);O.setAttributeNS(null,"fill-opacity",U.fillOpacity)}else{O.setAttributeNS(null,"fill","none")}if(P.isStroked){O.setAttributeNS(null,"stroke",U.strokeColor);O.setAttributeNS(null,"stroke-opacity",U.strokeOpacity);O.setAttributeNS(null,"stroke-width",U.strokeWidth*Q);O.setAttributeNS(null,"stroke-linecap",U.strokeLinecap||"round");O.setAttributeNS(null,"stroke-linejoin","round");U.strokeDashstyle&&O.setAttributeNS(null,"stroke-dasharray",this.dashStyle(U,Q))}else{O.setAttributeNS(null,"stroke","none")}if(U.pointerEvents){O.setAttributeNS(null,"pointer-events",U.pointerEvents)}if(U.cursor!=null){O.setAttributeNS(null,"cursor",U.cursor)}return O},dashStyle:function(B,D){var C=B.strokeWidth*D;var A=B.strokeDashstyle;switch(A){case"solid":return"none";case"dot":return[1,4*C].join();case"dash":return[4*C,4*C].join();case"dashdot":return[4*C,4*C,1,4*C].join();case"longdash":return[8*C,4*C].join();case"longdashdot":return[8*C,4*C,1,4*C].join();default:return OpenLayers.String.trim(A).replace(/\s+/g,",")}},createNode:function(A,C){var B=document.createElementNS(this.xmlns,A);if(C){B.setAttributeNS(null,"id",C)}return B},nodeTypeCompare:function(B,A){return(A==B.nodeName)},createRenderRoot:function(){var A=this.nodeFactory(this.container.id+"_svgRoot","svg");A.style.display="block";return A},createRoot:function(A){return this.nodeFactory(this.container.id+A,"g")},createDefs:function(){var A=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(A);return A},drawPoint:function(A,B){return this.drawCircle(A,B,1)},drawCircle:function(A,B,D){var C=this.getResolution();var E=((B.x-this.featureDx)/C+this.left);var F=(this.top-B.y/C);if(this.inValidRange(E,F)){A.setAttributeNS(null,"cx",E);A.setAttributeNS(null,"cy",F);A.setAttributeNS(null,"r",D);return A}else{return false}},drawLineString:function(B,C){var A=this.getComponentsString(C.components);if(A.path){B.setAttributeNS(null,"points",A.path);return(A.complete?B:null)}else{return false}},drawLinearRing:function(B,C){var A=this.getComponentsString(C.components);if(A.path){B.setAttributeNS(null,"points",A.path);return(A.complete?B:null)}else{return false}},drawPolygon:function(D,B){var I="";var H=true;var F=true;var A,E;for(var C=0,G=B.components.length;C<G;C++){I+=" M";A=this.getComponentsString(B.components[C].components," ");E=A.path;if(E){I+=" "+E;F=A.complete&&F}else{H=false}}I+=" z";if(H){D.setAttributeNS(null,"d",I);D.setAttributeNS(null,"fill-rule","evenodd");return F?D:null}else{return false}},drawRectangle:function(A,B){var C=this.getResolution();var D=((B.x-this.featureDx)/C+this.left);var E=(this.top-B.y/C);if(this.inValidRange(D,E)){A.setAttributeNS(null,"x",D);A.setAttributeNS(null,"y",E);A.setAttributeNS(null,"width",B.width/C);A.setAttributeNS(null,"height",B.height/C);return A}else{return false}},drawText:function(D,J,N){var B=(!!J.labelOutlineWidth);if(B){var A=OpenLayers.Util.extend({},J);A.fontColor=A.labelOutlineColor;A.fontStrokeColor=A.labelOutlineColor;A.fontStrokeWidth=J.labelOutlineWidth;if(J.labelOutlineOpacity){A.fontOpacity=J.labelOutlineOpacity}delete A.labelOutlineWidth;this.drawText(D,A,N)}var L=this.getResolution();var M=((N.x-this.featureDx)/L+this.left);var O=(N.y/L-this.top);var P=(B)?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX;var K=this.nodeFactory(D+P,"text");K.setAttributeNS(null,"x",M);K.setAttributeNS(null,"y",-O);if(J.fontColor){K.setAttributeNS(null,"fill",J.fontColor)}if(J.fontStrokeColor){K.setAttributeNS(null,"stroke",J.fontStrokeColor)}if(J.fontStrokeWidth){K.setAttributeNS(null,"stroke-width",J.fontStrokeWidth)}if(J.fontOpacity){K.setAttributeNS(null,"opacity",J.fontOpacity)}if(J.fontFamily){K.setAttributeNS(null,"font-family",J.fontFamily)}if(J.fontSize){K.setAttributeNS(null,"font-size",J.fontSize)}if(J.fontWeight){K.setAttributeNS(null,"font-weight",J.fontWeight)}if(J.fontStyle){K.setAttributeNS(null,"font-style",J.fontStyle)}if(J.labelSelect===true){K.setAttributeNS(null,"pointer-events","visible");K._featureId=D}else{K.setAttributeNS(null,"pointer-events","none")}var H=J.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;K.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[H[0]]||"middle");if(OpenLayers.IS_GECKO===true){K.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[H[1]]||"central")}var G=J.label.split("\n");var F=G.length;while(K.childNodes.length>F){K.removeChild(K.lastChild)}for(var I=0;I<F;I++){var C=this.nodeFactory(D+P+"_tspan_"+I,"tspan");if(J.labelSelect===true){C._featureId=D;C._geometry=N;C._geometryClass=N.CLASS_NAME}if(OpenLayers.IS_GECKO===false){C.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[H[1]]||"-35%")}C.setAttribute("x",M);if(I==0){var E=OpenLayers.Renderer.SVG.LABEL_VFACTOR[H[1]];if(E==null){E=-0.5}C.setAttribute("dy",(E*(F-1))+"em")}else{C.setAttribute("dy","1em")}C.textContent=(G[I]==="")?" ":G[I];if(!C.parentNode){K.appendChild(C)}}if(!K.parentNode){this.textRoot.appendChild(K)}},getComponentsString:function(D,B){var A=[];var G=true;var H=D.length;var I=[];var C,E;for(var F=0;F<H;F++){E=D[F];A.push(E);C=this.getShortString(E);if(C){I.push(C)}else{if(F>0){if(this.getShortString(D[F-1])){I.push(this.clipLine(D[F],D[F-1]))}}if(F<H-1){if(this.getShortString(D[F+1])){I.push(this.clipLine(D[F],D[F+1]))}}G=false}}return{path:I.join(B||","),complete:G}},clipLine:function(A,I){if(I.equals(A)){return""}var J=this.getResolution();var D=this.MAX_PIXEL-this.translationParameters.x;var G=this.MAX_PIXEL-this.translationParameters.y;var B=(I.x-this.featureDx)/J+this.left;var C=this.top-I.y/J;var E=(A.x-this.featureDx)/J+this.left;var F=this.top-A.y/J;var H;if(E<-D||E>D){H=(F-C)/(E-B);E=E<0?-D:D;F=C+(E-B)*H}if(F<-G||F>G){H=(E-B)/(F-C);F=F<0?-G:G;E=B+(F-C)*H}return E+","+F},getShortString:function(A){var C=this.getResolution();var B=((A.x-this.featureDx)/C+this.left);var D=(this.top-A.y/C);if(this.inValidRange(B,D)){return B+","+D}else{return false}},getPosition:function(A){return({x:parseFloat(A.getAttributeNS(null,"cx")),y:parseFloat(A.getAttributeNS(null,"cy"))})},importSymbol:function(K){if(!this.defs){this.defs=this.createDefs()}var H=this.container.id+"-"+K;var D=document.getElementById(H);if(D!=null){return D}var C=OpenLayers.Renderer.symbol[K];if(!C){throw new Error(K+" is not a valid symbol name")}var F=this.nodeFactory(H,"symbol");var G=this.nodeFactory(null,"polygon");F.appendChild(G);var N=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);var I=[];var L,J;for(var E=0;E<C.length;E=E+2){L=C[E];J=C[E+1];N.left=Math.min(N.left,L);N.bottom=Math.min(N.bottom,J);N.right=Math.max(N.right,L);N.top=Math.max(N.top,J);I.push(L,",",J)}G.setAttributeNS(null,"points",I.join(" "));var B=N.getWidth();var A=N.getHeight();var M=[N.left-B,N.bottom-A,B*3,A*3];F.setAttributeNS(null,"viewBox",M.join(" "));this.symbolMetrics[H]=[Math.max(B,A),N.getCenterLonLat().lon,N.getCenterLonLat().lat];this.defs.appendChild(F);return F},getFeatureIdFromEvent:function(B){var A=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!A){var C=B.target;A=C.parentNode&&C!=this.rendererRoot?C.parentNode._featureId:undefined}return A},CLASS_NAME:"OpenLayers.Renderer.SVG"});OpenLayers.Renderer.SVG.LABEL_ALIGN={"l":"start","r":"end","b":"bottom","t":"hanging"};OpenLayers.Renderer.SVG.LABEL_VSHIFT={"t":"-70%","b":"0"};OpenLayers.Renderer.SVG.LABEL_VFACTOR={"t":0,"b":-1};OpenLayers.Renderer.SVG.preventDefault=function(A){OpenLayers.Event.preventDefault(A)};OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd",CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0"});OpenLayers.Format.OWSContext=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"0.3.1",getVersion:function(A,B){var C=OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this,arguments);if(C==="0.3.0"){C=this.defaultVersion}return C},toContext:function(B){var A={};if(B.CLASS_NAME=="OpenLayers.Map"){A.bounds=B.getExtent();A.maxExtent=B.maxExtent;A.projection=B.projection;A.size=B.getSize();A.layers=B.layers}return A},CLASS_NAME:"OpenLayers.Format.OWSContext"});OpenLayers.Format.OWSContext.v0_3_1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{owc:"http://www.opengis.net/ows-context",gml:"http://www.opengis.net/gml",kml:"http://www.opengis.net/kml/2.2",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},VERSION:"0.3.1",schemaLocation:"http://www.opengis.net/ows-context http://www.ogcnetwork.net/schemas/owc/0.3.1/owsContext.xsd",defaultPrefix:"owc",extractAttributes:true,xy:true,regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},featureNS:"http://mapserver.gis.umn.edu/mapserver",featureType:"vector",geometryName:"geometry",nestingLayerLookup:null,initialize:function(A){OpenLayers.Format.XML.prototype.initialize.apply(this,[A]);OpenLayers.Format.GML.v2.prototype.setGeometryTypes.call(this)},setNestingPath:function(C){if(C.layersContext){for(var B=0,D=C.layersContext.length;B<D;B++){var F=C.layersContext[B];var E=[];var A=C.title||"";if(C.metadata&&C.metadata.nestingPath){E=C.metadata.nestingPath.slice()}if(A!=""){E.push(A)}F.metadata.nestingPath=E;if(F.layersContext){this.setNestingPath(F)}}}},decomposeNestingPath:function(A){var B=[];if(OpenLayers.Util.isArray(A)){var C=A.slice();while(C.length>0){B.push(C.slice());C.pop()}B.reverse()}return B},read:function(C){if(typeof C=="string"){C=OpenLayers.Format.XML.prototype.read.apply(this,[C])}if(C&&C.nodeType==9){C=C.documentElement}var A={};this.readNode(C,A);this.setNestingPath({layersContext:A.layersContext});var B=[];this.processLayer(B,A);delete A.layersContext;A.layersContext=B;return A},processLayer:function(A,D){if(D.layersContext){for(var B=0,E=D.layersContext.length;B<E;B++){var C=D.layersContext[B];A.push(C);if(C.layersContext){this.processLayer(A,C)}}}},write:function(A,C){var D="OWSContext";this.nestingLayerLookup={};C=C||{};OpenLayers.Util.applyDefaults(C,A);var B=this.writeNode(D,C);this.nestingLayerLookup=null;this.setAttributeNS(B,this.namespaces["xsi"],"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[B])},readers:{"kml":{"Document":function(B,A){A.features=new OpenLayers.Format.KML({kmlns:this.namespaces.kml,extractStyles:true}).read(B)}},"owc":{"OWSContext":function(B,A){this.readChildNodes(B,A)},"General":function(B,A){this.readChildNodes(B,A)},"ResourceList":function(B,A){this.readChildNodes(B,A)},"Layer":function(B,A){var C={metadata:{},visibility:(B.getAttribute("hidden")!="1"),queryable:(B.getAttribute("queryable")=="1"),opacity:((B.getAttribute("opacity")!=null)?parseFloat(B.getAttribute("opacity")):null),name:B.getAttribute("name"),categoryLayer:(B.getAttribute("name")==null),formats:[],styles:[]};if(!A.layersContext){A.layersContext=[]}A.layersContext.push(C);this.readChildNodes(B,C)},"InlineGeometry":function(D,B){B.features=[];var C=this.getElementsByTagNameNS(D,this.namespaces.gml,"featureMember");var A;if(C.length>=1){A=C[0]}if(A&&A.firstChild){var E=(A.firstChild.nextSibling)?A.firstChild.nextSibling:A.firstChild;this.setNamespace("feature",E.namespaceURI);this.featureType=E.localName||E.nodeName.split(":").pop();this.readChildNodes(D,B)}},"Server":function(B,A){if((!A.service&&!A.version)||(A.service!=OpenLayers.Format.Context.serviceTypes.WMS)){A.service=B.getAttribute("service");A.version=B.getAttribute("version");this.readChildNodes(B,A)}},"Name":function(B,A){A.name=this.getChildValue(B);this.readChildNodes(B,A)},"Title":function(B,A){A.title=this.getChildValue(B);this.readChildNodes(B,A)},"StyleList":function(B,A){this.readChildNodes(B,A.styles)},"Style":function(B,A){var C={};A.push(C);this.readChildNodes(B,C)},"LegendURL":function(C,A){var B={};A.legend=B;this.readChildNodes(C,B)},"OnlineResource":function(B,A){A.url=this.getAttributeNS(B,this.namespaces.xlink,"href");this.readChildNodes(B,A)}},"ows":OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows,"gml":OpenLayers.Format.GML.v2.prototype.readers.gml,"sld":OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld,"feature":OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{"owc":{"OWSContext":function(B){var A=this.createElementNSPlus("OWSContext",{attributes:{version:this.VERSION,id:B.id||OpenLayers.Util.createUniqueID("OpenLayers_OWSContext_")}});this.writeNode("General",B,A);this.writeNode("ResourceList",B,A);return A},"General":function(B){var A=this.createElementNSPlus("General");this.writeNode("ows:BoundingBox",B,A);this.writeNode("ows:Title",B.title||"OpenLayers OWSContext",A);return A},"ResourceList":function(E){var D=this.createElementNSPlus("ResourceList");for(var B=0,F=E.layers.length;B<F;B++){var A=E.layers[B];var C=this.decomposeNestingPath(A.metadata.nestingPath);this.writeNode("_Layer",{layer:A,subPaths:C},D)}return D},"Server":function(B){var A=this.createElementNSPlus("Server",{attributes:{version:B.version,service:B.service}});this.writeNode("OnlineResource",B,A);return A},"OnlineResource":function(B){var A=this.createElementNSPlus("OnlineResource",{attributes:{"xlink:href":B.url}});return A},"InlineGeometry":function(C){var B=this.createElementNSPlus("InlineGeometry"),E=C.getDataExtent();if(E!==null){this.writeNode("gml:boundedBy",E,B)}for(var A=0,D=C.features.length;A<D;A++){this.writeNode("gml:featureMember",C.features[A],B)}return B},"StyleList":function(C){var B=this.createElementNSPlus("StyleList");for(var A=0,D=C.length;A<D;A++){this.writeNode("Style",C[A],B)}return B},"Style":function(B){var A=this.createElementNSPlus("Style");this.writeNode("Name",B,A);this.writeNode("Title",B,A);if(B.legend){this.writeNode("LegendURL",B,A)}return A},"Name":function(A){var B=this.createElementNSPlus("Name",{value:A.name});return B},"Title":function(A){var B=this.createElementNSPlus("Title",{value:A.title});return B},"LegendURL":function(B){var A=this.createElementNSPlus("LegendURL");this.writeNode("OnlineResource",B.legend,A);return A},"_WMS":function(B){var A=this.createElementNSPlus("Layer",{attributes:{name:B.params.LAYERS,queryable:B.queryable?"1":"0",hidden:B.visibility?"0":"1",opacity:B.hasOwnProperty("opacity")?B.opacity:null}});this.writeNode("ows:Title",B.name,A);this.writeNode("ows:OutputFormat",B.params.FORMAT,A);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WMS,version:B.params.VERSION,url:B.url},A);if(B.metadata.styles&&B.metadata.styles.length>0){this.writeNode("StyleList",B.metadata.styles,A)}return A},"_Layer":function(D){var A,B,C,E;A=D.layer;B=D.subPaths;C=null;E=null;if(B.length>0){var G=B[0].join("/");var F=G.lastIndexOf("/");C=this.nestingLayerLookup[G];E=(F>0)?G.substring(F+1,G.length):G;if(!C){C=this.createElementNSPlus("Layer");this.writeNode("ows:Title",E,C);this.nestingLayerLookup[G]=C}D.subPaths.shift();this.writeNode("_Layer",D,C);return C}else{if(A instanceof OpenLayers.Layer.WMS){C=this.writeNode("_WMS",A)}else{if(A instanceof OpenLayers.Layer.Vector){if(A.protocol instanceof OpenLayers.Protocol.WFS.v1){C=this.writeNode("_WFS",A)}else{if(A.protocol instanceof OpenLayers.Protocol.HTTP){if(A.protocol.format instanceof OpenLayers.Format.GML){A.protocol.format.version="2.1.2";C=this.writeNode("_GML",A)}else{if(A.protocol.format instanceof OpenLayers.Format.KML){A.protocol.format.version="2.2";C=this.writeNode("_KML",A)}}}else{this.setNamespace("feature",this.featureNS);C=this.writeNode("_InlineGeometry",A)}}}}if(A.options.maxScale){this.writeNode("sld:MinScaleDenominator",A.options.maxScale,C)}if(A.options.minScale){this.writeNode("sld:MaxScaleDenominator",A.options.minScale,C)}this.nestingLayerLookup[A.name]=C;return C}},"_WFS":function(B){var A=this.createElementNSPlus("Layer",{attributes:{name:B.protocol.featurePrefix+":"+B.protocol.featureType,hidden:B.visibility?"0":"1"}});this.writeNode("ows:Title",B.name,A);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WFS,version:B.protocol.version,url:B.protocol.url},A);return A},"_InlineGeometry":function(B){var A=this.createElementNSPlus("Layer",{attributes:{name:this.featureType,hidden:B.visibility?"0":"1"}});this.writeNode("ows:Title",B.name,A);this.writeNode("InlineGeometry",B,A);return A},"_GML":function(B){var A=this.createElementNSPlus("Layer");this.writeNode("ows:Title",B.name,A);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.GML,url:B.protocol.url,version:B.protocol.format.version},A);return A},"_KML":function(B){var A=this.createElementNSPlus("Layer");this.writeNode("ows:Title",B.name,A);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.KML,version:B.protocol.format.version,url:B.protocol.url},A);return A}},"gml":OpenLayers.Util.applyDefaults({"boundedBy":function(A){var B=this.createElementNSPlus("gml:boundedBy");this.writeNode("gml:Box",A,B);return B}},OpenLayers.Format.GML.v2.prototype.writers.gml),"ows":OpenLayers.Format.OWSCommon.v1_0_0.prototype.writers.ows,"sld":OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld,"feature":OpenLayers.Format.GML.v2.prototype.writers.feature},CLASS_NAME:"OpenLayers.Format.OWSContext.v0_3_1"});OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:false,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:false,fixPadding:function(){if(typeof this.padding=="number"){this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding)}},panMapIfOutOfView:false,keepInMap:false,closeOnMove:false,map:null,initialize:function(G,B,D,E,C,F){if(G==null){G=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")}this.id=G;this.lonlat=B;this.contentSize=(D!=null)?D:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT);if(E!=null){this.contentHTML=E}this.backgroundColor=OpenLayers.Popup.COLOR;this.opacity=OpenLayers.Popup.OPACITY;this.border=OpenLayers.Popup.BORDER;this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,null);this.div.className=this.displayClass;var A=this.id+"_GroupDiv";this.groupDiv=OpenLayers.Util.createDiv(A,null,null,null,"relative",null,null);var G=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(G,null,this.contentSize.clone(),null,"relative");this.contentDiv.className=this.contentDisplayClass;this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);if(C){this.addCloseBox(F)}this.registerEvents()},destroy:function(){this.id=null;this.lonlat=null;this.size=null;this.contentHTML=null;this.backgroundColor=null;this.opacity=null;this.border=null;if(this.closeOnMove&&this.map){this.map.events.unregister("movestart",this,this.hide)}this.events.destroy();this.events=null;if(this.closeDiv){OpenLayers.Event.stopObservingElement(this.closeDiv);this.groupDiv.removeChild(this.closeDiv)}this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;if(this.map!=null){this.map.removePopup(this)}this.map=null;this.div=null;this.autoSize=null;this.minSize=null;this.maxSize=null;this.padding=null;this.panMapIfOutOfView=null},draw:function(A){if(A==null){if((this.lonlat!=null)&&(this.map!=null)){A=this.map.getLayerPxFromLonLat(this.lonlat)}}if(this.closeOnMove){this.map.events.register("movestart",this,this.hide)}if(!this.disableFirefoxOverflowHack&&OpenLayers.BROWSER_NAME=="firefox"){this.map.events.register("movestart",this,function(){var C=document.defaultView.getComputedStyle(this.contentDiv,null);var B=C.getPropertyValue("overflow");if(B!="hidden"){this.contentDiv._oldOverflow=B;this.contentDiv.style.overflow="hidden"}});this.map.events.register("moveend",this,function(){var B=this.contentDiv._oldOverflow;if(B){this.contentDiv.style.overflow=B;this.contentDiv._oldOverflow=null}})}this.moveTo(A);if(!this.autoSize&&!this.size){this.setSize(this.contentSize)}this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();if(this.panMapIfOutOfView){this.panIntoView()}return this.div},updatePosition:function(){if((this.lonlat)&&(this.map)){var A=this.map.getLayerPxFromLonLat(this.lonlat);if(A){this.moveTo(A)}}},moveTo:function(A){if((A!=null)&&(this.div!=null)){this.div.style.left=A.x+"px";this.div.style.top=A.y+"px"}},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){if(this.visible()){this.hide()}else{this.show()}},show:function(){this.div.style.display="";if(this.panMapIfOutOfView){this.panIntoView()}},hide:function(){this.div.style.display="none"},setSize:function(E){this.size=E.clone();var A=this.getContentDivPadding();var C=A.left+A.right;var B=A.top+A.bottom;this.fixPadding();C+=this.padding.left+this.padding.right;B+=this.padding.top+this.padding.bottom;if(this.closeDiv){var D=parseInt(this.closeDiv.style.width);C+=D+A.right}this.size.w+=C;this.size.h+=B;if(OpenLayers.BROWSER_NAME=="msie"){this.contentSize.w+=A.left+A.right;this.contentSize.h+=A.bottom+A.top}if(this.div!=null){this.div.style.width=this.size.w+"px";this.div.style.height=this.size.h+"px"}if(this.contentDiv!=null){this.contentDiv.style.width=E.w+"px";this.contentDiv.style.height=E.h+"px"}},updateSize:function(){var I="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>";var H=(this.map)?this.map.div:document.body;var F=OpenLayers.Util.getRenderedDimensions(I,null,{displayClass:this.displayClass,containerElement:H});var B=this.getSafeContentSize(F);var C=null;if(B.equals(F)){C=F}else{var D={w:(B.w<F.w)?B.w:null,h:(B.h<F.h)?B.h:null};if(D.w&&D.h){C=B}else{var A=OpenLayers.Util.getRenderedDimensions(I,D,{displayClass:this.contentDisplayClass,containerElement:H});var E=OpenLayers.Element.getStyle(this.contentDiv,"overflow");if((E!="hidden")&&(A.equals(B))){var G=OpenLayers.Util.getScrollbarWidth();if(D.w){A.h+=G}else{A.w+=G}}C=this.getSafeContentSize(A)}}this.setSize(C)},setBackgroundColor:function(A){if(A!=undefined){this.backgroundColor=A}if(this.div!=null){this.div.style.backgroundColor=this.backgroundColor}},setOpacity:function(A){if(A!=undefined){this.opacity=A}if(this.div!=null){this.div.style.opacity=this.opacity;this.div.style.filter="alpha(opacity="+this.opacity*100+")"}},setBorder:function(A){if(A!=undefined){this.border=A}if(this.div!=null){this.div.style.border=this.border}},setContentHTML:function(A){if(A!=null){this.contentHTML=A}if((this.contentDiv!=null)&&(this.contentHTML!=null)&&(this.contentHTML!=this.contentDiv.innerHTML)){this.contentDiv.innerHTML=this.contentHTML;if(this.autoSize){this.registerImageListeners();this.updateSize()}}},registerImageListeners:function(){var D=function(){if(this.popup.id===null){return}this.popup.updateSize();if(this.popup.visible()&&this.popup.panMapIfOutOfView){this.popup.panIntoView()}OpenLayers.Event.stopObserving(this.img,"load",this.img._onImgLoad)};var F=this.contentDiv.getElementsByTagName("img");for(var B=0,E=F.length;B<E;B++){var C=F[B];if(C.width==0||C.height==0){var A={"popup":this,"img":C};C._onImgLoad=OpenLayers.Function.bind(D,A);OpenLayers.Event.observe(C,"load",C._onImgLoad)}}},getSafeContentSize:function(C){var D=C.clone();var G=this.getContentDivPadding();var K=G.left+G.right;var B=G.top+G.bottom;this.fixPadding();K+=this.padding.left+this.padding.right;B+=this.padding.top+this.padding.bottom;if(this.closeDiv){var A=parseInt(this.closeDiv.style.width);K+=A+G.right}if(this.minSize){D.w=Math.max(D.w,(this.minSize.w-K));D.h=Math.max(D.h,(this.minSize.h-B))}if(this.maxSize){D.w=Math.min(D.w,(this.maxSize.w-K));D.h=Math.min(D.h,(this.maxSize.h-B))}if(this.map&&this.map.size){var I=0,H=0;if(this.keepInMap&&!this.panMapIfOutOfView){var J=this.map.getPixelFromLonLat(this.lonlat);switch(this.relativePosition){case"tr":I=J.x;H=this.map.size.h-J.y;break;case"tl":I=this.map.size.w-J.x;H=this.map.size.h-J.y;break;case"bl":I=this.map.size.w-J.x;H=J.y;break;case"br":I=J.x;H=J.y;break;default:I=J.x;H=this.map.size.h-J.y;break}}var F=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-B-H;var E=this.map.size.w-this.map.paddingForPopups.left-this.map.paddingForPopups.right-K-I;D.w=Math.min(D.w,E);D.h=Math.min(D.h,F)}return D},getContentDivPadding:function(){var A=this._contentDivPadding;if(!A){if(this.div.parentNode==null){this.div.style.display="none";document.body.appendChild(this.div)}A=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv,"padding-top"));this._contentDivPadding=A;if(this.div.parentNode==document.body){document.body.removeChild(this.div);this.div.style.display=""}}return A},addCloseBox:function(A){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,{w:17,h:17});this.closeDiv.className="olPopupCloseBox";var B=this.getContentDivPadding();this.closeDiv.style.right=B.right+"px";this.closeDiv.style.top=B.top+"px";this.groupDiv.appendChild(this.closeDiv);var C=A||function(D){this.hide();OpenLayers.Event.stop(D)};OpenLayers.Event.observe(this.closeDiv,"touchend",OpenLayers.Function.bindAsEventListener(C,this));OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(C,this))},panIntoView:function(){var A=this.map.getSize();var D=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top)));var C=D.clone();if(D.x<this.map.paddingForPopups.left){C.x=this.map.paddingForPopups.left}else{if((D.x+this.size.w)>(A.w-this.map.paddingForPopups.right)){C.x=A.w-this.map.paddingForPopups.right-this.size.w}}if(D.y<this.map.paddingForPopups.top){C.y=this.map.paddingForPopups.top}else{if((D.y+this.size.h)>(A.h-this.map.paddingForPopups.bottom)){C.y=A.h-this.map.paddingForPopups.bottom-this.size.h}}var B=D.x-C.x;var E=D.y-C.y;this.map.pan(B,E)},registerEvents:function(){this.events=new OpenLayers.Events(this,this.div,null,true);function A(B){OpenLayers.Event.stop(B,true)}this.events.on({"mousedown":this.onmousedown,"mousemove":this.onmousemove,"mouseup":this.onmouseup,"click":this.onclick,"mouseout":this.onmouseout,"dblclick":this.ondblclick,"touchstart":A,scope:this})},onmousedown:function(A){this.mousedown=true;OpenLayers.Event.stop(A,true)},onmousemove:function(A){if(this.mousedown){OpenLayers.Event.stop(A,true)}},onmouseup:function(A){if(this.mousedown){this.mousedown=false;OpenLayers.Event.stop(A,true)}},onclick:function(A){OpenLayers.Event.stop(A,true)},onmouseout:function(A){this.mousedown=false},ondblclick:function(A){OpenLayers.Event.stop(A,true)},CLASS_NAME:"OpenLayers.Popup"});OpenLayers.Popup.WIDTH=200;OpenLayers.Popup.HEIGHT=200;OpenLayers.Popup.COLOR="white";OpenLayers.Popup.OPACITY=1;OpenLayers.Popup.BORDER="0px";OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:false,draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.eTop){this.eTop=document.createElement("div");this.eTop.className=this.displayClass+"Top";var A=this.topInUnits.length;this.div.appendChild(this.eTop);if((this.topOutUnits=="")||(this.topInUnits=="")){this.eTop.style.visibility="hidden"}else{this.eTop.style.visibility="visible"}this.eBottom=document.createElement("div");this.eBottom.className=this.displayClass+"Bottom";this.div.appendChild(this.eBottom);if((this.bottomOutUnits=="")||(this.bottomInUnits=="")){this.eBottom.style.visibility="hidden"}else{this.eBottom.style.visibility="visible"}}this.map.events.register("moveend",this,this.update);this.update();return this.div},getBarLen:function(E){var A=parseInt(Math.log(E)/Math.log(10));var B=Math.pow(10,A);var D=parseInt(E/B);var C;if(D>5){C=5}else{if(D>2){C=2}else{C=1}}return C*B},update:function(){var M=this.map.getResolution();if(!M){return}var L=this.map.getUnits();var F=OpenLayers.INCHES_PER_UNIT;var A=this.maxWidth*M*F[L];var N=1;if(this.geodesic===true){var O=(this.map.getGeodesicPixelSize().w||1e-06)*this.maxWidth;var D=A/F["km"];N=O/D;A*=N}var I;var H;if(A>100000){I=this.topOutUnits;H=this.bottomOutUnits}else{I=this.topInUnits;H=this.bottomInUnits}var C=A/F[I];var K=A/F[H];var G=this.getBarLen(C);var E=this.getBarLen(K);C=G/F[L]*F[I];K=E/F[L]*F[H];var J=C/M/N;var B=K/M/N;if(this.eBottom.style.visibility=="visible"){this.eBottom.style.width=Math.round(B)+"px";this.eBottom.innerHTML=E+" "+H}if(this.eTop.style.visibility=="visible"){this.eTop.style.width=Math.round(J)+"px";this.eTop.innerHTML=G+" "+I}},CLASS_NAME:"OpenLayers.Control.ScaleLine"});OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(C,A,B,D){this.url=C;this.size=A||{w:20,h:20};this.offset=B||{x:-(this.size.w/2),y:-(this.size.h/2)};this.calculateOffset=D;var E=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(E)},destroy:function(){this.erase();OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild);this.imageDiv.innerHTML="";this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset)},setSize:function(A){if(A!=null){this.size=A}this.draw()},setUrl:function(A){if(A!=null){this.url=A}this.draw()},draw:function(A){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute");this.moveTo(A);return this.imageDiv},erase:function(){if(this.imageDiv!=null&&this.imageDiv.parentNode!=null){OpenLayers.Element.remove(this.imageDiv)}},setOpacity:function(A){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,A)},moveTo:function(A){if(A!=null){this.px=A}if(this.imageDiv!=null){if(this.px==null){this.display(false)}else{if(this.calculateOffset){this.offset=this.calculateOffset(this.size)}OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,{x:this.px.x+this.offset.x,y:this.px.y+this.offset.y})}}},display:function(A){this.imageDiv.style.display=(A)?"":"none"},isDrawn:function(){var A=(this.imageDiv&&this.imageDiv.parentNode&&(this.imageDiv.parentNode.nodeType!=11));return A},CLASS_NAME:"OpenLayers.Icon"});OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(A,C){this.lonlat=A;var B=(C)?C:OpenLayers.Marker.defaultIcon();if(this.icon==null){this.icon=B}else{this.icon.url=B.url;this.icon.size=B.size;this.icon.offset=B.offset;this.icon.calculateOffset=B.calculateOffset}this.events=new OpenLayers.Events(this,this.icon.imageDiv)},destroy:function(){this.erase();this.map=null;this.events.destroy();this.events=null;if(this.icon!=null){this.icon.destroy();this.icon=null}},draw:function(A){return this.icon.draw(A)},erase:function(){if(this.icon!=null){this.icon.erase()}},moveTo:function(A){if((A!=null)&&(this.icon!=null)){this.icon.moveTo(A)}this.lonlat=this.map.getLonLatFromLayerPx(A)},isDrawn:function(){var A=(this.icon&&this.icon.isDrawn());return A},onScreen:function(){var B=false;if(this.map){var A=this.map.getExtent();B=A.containsLonLat(this.lonlat)}return B},inflate:function(A){if(this.icon){this.icon.setSize({w:this.icon.size.w*A,h:this.icon.size.h*A})}},setOpacity:function(A){this.icon.setOpacity(A)},setUrl:function(A){this.icon.setUrl(A)},display:function(A){this.icon.display(A)},CLASS_NAME:"OpenLayers.Marker"});OpenLayers.Marker.defaultIcon=function(){return new OpenLayers.Icon(OpenLayers.Util.getImageLocation("marker.png"),{w:21,h:25},{x:-10.5,y:-25})};OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,format:"image/png",serverResolutions:null,initialize:function(C,A,D,B){this.layername=D;OpenLayers.Layer.Grid.prototype.initialize.apply(this,[C,A,{},B]);this.extension=this.format.split("/")[1].toLowerCase();this.extension=(this.extension=="jpg")?"jpeg":this.extension},clone:function(A){if(A==null){A=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.getOptions())}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);return A},getURL:function(D){var E=this.getServerResolution();var J=this.maxExtent;var F=this.tileSize;var B=Math.round((D.left-J.left)/(E*F.w));var C=Math.round((D.bottom-J.bottom)/(E*F.h));var A=this.serverResolutions!=null?OpenLayers.Util.indexOf(this.serverResolutions,E):this.map.getZoom();var G=[this.layername,OpenLayers.Number.zeroPad(A,2),OpenLayers.Number.zeroPad(parseInt(B/1000000),3),OpenLayers.Number.zeroPad((parseInt(B/1000)%1000),3),OpenLayers.Number.zeroPad((parseInt(B)%1000),3),OpenLayers.Number.zeroPad(parseInt(C/1000000),3),OpenLayers.Number.zeroPad((parseInt(C/1000)%1000),3),OpenLayers.Number.zeroPad((parseInt(C)%1000),3)+"."+this.extension];var H=G.join("/");var I=this.url;if(OpenLayers.Util.isArray(I)){I=this.selectUrl(H,I)}I=(I.charAt(I.length-1)=="/")?I:I+"/";return I+H},CLASS_NAME:"OpenLayers.Layer.TileCache"});OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,{features:null,length:10,num:null,paging:false,activate:function(){var A=OpenLayers.Strategy.prototype.activate.call(this);if(A){this.layer.events.on({"beforefeaturesadded":this.cacheFeatures,scope:this})}return A},deactivate:function(){var A=OpenLayers.Strategy.prototype.deactivate.call(this);if(A){this.clearCache();this.layer.events.un({"beforefeaturesadded":this.cacheFeatures,scope:this})}return A},cacheFeatures:function(A){if(!this.paging){this.clearCache();this.features=A.features;this.pageNext(A)}},clearCache:function(){if(this.features){for(var A=0;A<this.features.length;++A){this.features[A].destroy()}}this.features=null;this.num=null},pageCount:function(){var A=this.features?this.features.length:0;return Math.ceil(A/this.length)},pageNum:function(){return this.num},pageLength:function(A){if(A&&A>0){this.length=A}return this.length},pageNext:function(A){var C=false;if(this.features){if(this.num===null){this.num=-1}var B=(this.num+1)*this.length;C=this.page(B,A)}return C},pagePrevious:function(){var B=false;if(this.features){if(this.num===null){this.num=this.pageCount()}var A=(this.num-1)*this.length;B=this.page(A)}return B},page:function(D,C){var E=false;if(this.features){if(D>=0&&D<this.features.length){var B=Math.floor(D/this.length);if(B!=this.num){this.paging=true;var A=this.features.slice(D,D+this.length);this.layer.removeFeatures(this.layer.features);this.num=B;if(C&&C.features){C.features=A}else{this.layer.addFeatures(A)}this.paging=false;E=true}}}return E},CLASS_NAME:"OpenLayers.Strategy.Paging"});OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(B,A){},onDrag:function(B,A){},onComplete:function(B,A){},onEnter:function(A){},onLeave:function(A){},documentDrag:false,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(B,A){OpenLayers.Control.prototype.initialize.apply(this,[A]);this.layer=B;this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature,up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({click:this.clickFeature,clickout:this.clickoutFeature,over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},clickFeature:function(A){if(this.handlers.feature.touch&&!this.over&&this.overFeature(A)){this.handlers.drag.dragstart(this.handlers.feature.evt);this.handlers.drag.stopDown=false}},clickoutFeature:function(A){if(this.handlers.feature.touch&&this.over){this.outFeature(A);this.handlers.drag.stopDown=true}},destroy:function(){this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return(this.handlers.feature.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments))},deactivate:function(){this.handlers.drag.deactivate();this.handlers.feature.deactivate();this.feature=null;this.dragging=false;this.lastPixel=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over");return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(A){var B=false;if(!this.handlers.drag.dragging){this.feature=A;this.handlers.drag.activate();B=true;this.over=true;OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over");this.onEnter(A)}else{if(this.feature.id==A.id){this.over=true}else{this.over=false}}return B},downFeature:function(A){this.lastPixel=A;this.onStart(this.feature,A)},moveFeature:function(A){var B=this.map.getResolution();this.feature.geometry.move(B*(A.x-this.lastPixel.x),B*(this.lastPixel.y-A.y));this.layer.drawFeature(this.feature);this.lastPixel=A;this.onDrag(this.feature,A)},upFeature:function(A){if(!this.over){this.handlers.drag.deactivate()}},doneDragging:function(A){this.onComplete(this.feature,A)},outFeature:function(A){if(!this.handlers.drag.dragging){this.over=false;this.handlers.drag.deactivate();OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over");this.onLeave(A);this.feature=null}else{if(this.feature.id==A.id){this.over=false}}},cancel:function(){this.handlers.drag.deactivate();this.over=false},setMap:function(A){this.handlers.drag.setMap(A);this.handlers.feature.setMap(A);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.DragFeature"});OpenLayers.Control.TransformFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,layer:null,preserveAspectRatio:false,rotate:true,feature:null,renderIntent:"temporary",rotationHandleSymbolizer:null,box:null,center:null,scale:1,ratio:1,rotation:0,handles:null,rotationHandles:null,dragControl:null,irregular:false,initialize:function(B,A){OpenLayers.Control.prototype.initialize.apply(this,[A]);this.layer=B;if(!this.rotationHandleSymbolizer){this.rotationHandleSymbolizer={stroke:false,pointRadius:10,fillOpacity:0,cursor:"pointer"}}this.createBox();this.createControl()},activate:function(){var A=false;if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.dragControl.activate();this.layer.addFeatures([this.box]);this.rotate&&this.layer.addFeatures(this.rotationHandles);this.layer.addFeatures(this.handles);A=true}return A},deactivate:function(){var A=false;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.handles);this.rotate&&this.layer.removeFeatures(this.rotationHandles);this.layer.removeFeatures([this.box]);this.dragControl.deactivate();A=true}return A},setMap:function(A){this.dragControl.setMap(A);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setFeature:function(B,D){D=OpenLayers.Util.applyDefaults(D,{rotation:0,scale:1,ratio:1});var G=this.rotation;var H=this.center;OpenLayers.Util.extend(this,D);var J=this.events.triggerEvent("beforesetfeature",{feature:B});if(J===false){return}this.feature=B;this.activate();this._setfeature=true;var I=this.feature.geometry.getBounds();this.box.move(I.getCenterLonLat());this.box.geometry.rotate(-G,H);this._angle=0;var A;if(this.rotation){var F=B.geometry.clone();F.rotate(-this.rotation,this.center);var E=new OpenLayers.Feature.Vector(F.getBounds().toGeometry());E.geometry.rotate(this.rotation,this.center);this.box.geometry.rotate(this.rotation,this.center);this.box.move(E.geometry.getBounds().getCenterLonLat());var C=E.geometry.components[0].components[0];A=C.getBounds().getCenterLonLat()}else{A=new OpenLayers.LonLat(I.left,I.bottom)}this.handles[0].move(A);delete this._setfeature;this.events.triggerEvent("setfeature",{feature:B})},unsetFeature:function(){if(this.active){this.deactivate()}else{this.feature=null;this.rotation=0;this.scale=1;this.ratio=1}},createBox:function(){var L=this;this.center=new OpenLayers.Geometry.Point(0,0);this.box=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-1,-1),new OpenLayers.Geometry.Point(0,-1),new OpenLayers.Geometry.Point(1,-1),new OpenLayers.Geometry.Point(1,0),new OpenLayers.Geometry.Point(1,1),new OpenLayers.Geometry.Point(0,1),new OpenLayers.Geometry.Point(-1,1),new OpenLayers.Geometry.Point(-1,0),new OpenLayers.Geometry.Point(-1,-1)]),null,typeof this.renderIntent=="string"?null:this.renderIntent);this.box.geometry.move=function(N,O){L._moving=true;OpenLayers.Geometry.LineString.prototype.move.apply(this,arguments);L.center.move(N,O);delete L._moving};var E=function(N,O){OpenLayers.Geometry.Point.prototype.move.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.move(N,O);this._handle.geometry.move(N,O)};var M=function(P,O,N){OpenLayers.Geometry.Point.prototype.resize.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.resize(P,O,N);this._handle.geometry.resize(P,O,N)};var I=function(O,N){OpenLayers.Geometry.Point.prototype.rotate.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.rotate(O,N);this._handle.geometry.rotate(O,N)};var K=function(c,d){var Q=this.x,Y=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,c,d);if(L._moving){return}var U=L.dragControl.handlers.drag.evt;var P=!L._setfeature&&L.preserveAspectRatio;var X=!P&&!(U&&U.shiftKey);var N=new OpenLayers.Geometry.Point(Q,Y);var T=L.center;this.rotate(-L.rotation,T);N.rotate(-L.rotation,T);var b=this.x-T.x;var S=this.y-T.y;var a=b-(this.x-N.x);var R=S-(this.y-N.y);if(L.irregular&&!L._setfeature){b-=(this.x-N.x)/2;S-=(this.y-N.y)/2}this.x=Q;this.y=Y;var W,e=1;if(X){W=Math.abs(R)<1e-05?1:S/R;e=(Math.abs(a)<1e-05?1:(b/a))/W}else{var Z=Math.sqrt((a*a)+(R*R));var V=Math.sqrt((b*b)+(S*S));W=V/Z}L._moving=true;L.box.geometry.rotate(-L.rotation,T);delete L._moving;L.box.geometry.resize(W,T,e);L.box.geometry.rotate(L.rotation,T);L.transformFeature({scale:W,ratio:e});if(L.irregular&&!L._setfeature){var O=T.clone();O.x+=Math.abs(Q-T.x)<1e-05?0:(this.x-Q);O.y+=Math.abs(Y-T.y)<1e-05?0:(this.y-Y);L.box.geometry.move(this.x-Q,this.y-Y);L.transformFeature({center:O})}};var J=function(Y,Z){var N=this.x,W=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,Y,Z);if(L._moving){return}var O=L.dragControl.handlers.drag.evt;var b=(O&&O.shiftKey)?45:1;var T=L.center;var U=this.x-T.x;var R=this.y-T.y;var V=U-Y;var Q=R-Z;this.x=N;this.y=W;var P=Math.atan2(Q,V);var S=Math.atan2(R,U);var X=S-P;X*=180/Math.PI;L._angle=(L._angle+X)%360;var a=L.rotation%b;if(Math.abs(L._angle)>=b||a!==0){X=Math.round(L._angle/b)*b-a;L._angle=0;L.box.geometry.rotate(X,T);L.transformFeature({rotation:X})}};var F=new Array(8);var C=new Array(4);var H,D,B;var A=["sw","s","se","e","ne","n","nw","w"];for(var G=0;G<8;++G){H=this.box.geometry.components[G];D=new OpenLayers.Feature.Vector(H.clone(),{role:A[G]+"-resize"},typeof this.renderIntent=="string"?null:this.renderIntent);if(G%2==0){B=new OpenLayers.Feature.Vector(H.clone(),{role:A[G]+"-rotate"},typeof this.rotationHandleSymbolizer=="string"?null:this.rotationHandleSymbolizer);B.geometry.move=J;H._rotationHandle=B;C[G/2]=B}H.move=E;H.resize=M;H.rotate=I;D.geometry.move=K;H._handle=D;F[G]=D}this.rotationHandles=C;this.handles=F},createControl:function(){var A=this;this.dragControl=new OpenLayers.Control.DragFeature(this.layer,{documentDrag:true,moveFeature:function(B){if(this.feature===A.feature){this.feature=A.box}OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},onDrag:function(C,B){if(C===A.box){A.transformFeature({center:A.center})}},onStart:function(C,B){var E=!A.geometryTypes||OpenLayers.Util.indexOf(A.geometryTypes,C.geometry.CLASS_NAME)!==-1;var D=OpenLayers.Util.indexOf(A.handles,C);D+=OpenLayers.Util.indexOf(A.rotationHandles,C);if(C!==A.feature&&C!==A.box&&D==-2&&E){A.setFeature(C)}},onComplete:function(C,B){A.events.triggerEvent("transformcomplete",{feature:A.feature})}})},drawHandles:function(){var B=this.layer;for(var A=0;A<8;++A){if(this.rotate&&A%2===0){B.drawFeature(this.rotationHandles[A/2],this.rotationHandleSymbolizer)}B.drawFeature(this.handles[A],this.renderIntent)}},transformFeature:function(D){if(!this._setfeature){this.scale*=(D.scale||1);this.ratio*=(D.ratio||1);var B=this.rotation;this.rotation=(this.rotation+(D.rotation||0))%360;if(this.events.triggerEvent("beforetransform",D)!==false){var A=this.feature;var E=A.geometry;var C=this.center;E.rotate(-B,C);if(D.scale||D.ratio){E.resize(D.scale,C,D.ratio)}else{if(D.center){A.move(D.center.getBounds().getCenterLonLat())}}E.rotate(this.rotation,C);this.layer.drawFeature(A);A.toState(OpenLayers.State.UPDATE);this.events.triggerEvent("transform",D)}}this.layer.drawFeature(this.box,this.renderIntent);this.drawHandles()},destroy:function(){var B;for(var A=0;A<8;++A){B=this.box.geometry.components[A];B._handle.destroy();B._handle=null;B._rotationHandle&&B._rotationHandle.destroy();B._rotationHandle=null}this.center=null;this.feature=null;this.handles=null;this.rotationHandleSymbolizer=null;this.rotationHandles=null;this.box.destroy();this.box=null;this.layer=null;this.dragControl.destroy();this.dragControl=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.TransformFeature"});OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(B,C,A){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);if(this.dragHandler){this.dragHandler.destroy();this.dragHandler=null}},setMap:function(A){OpenLayers.Handler.prototype.setMap.apply(this,arguments);if(this.dragHandler){this.dragHandler.setMap(A)}},startBox:function(A){this.callback("start",[]);this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999});this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE["Popup"]-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(A){var C=this.dragHandler.start.x;var E=this.dragHandler.start.y;var F=Math.abs(C-A.x);var D=Math.abs(E-A.y);var B=this.getBoxOffsets();this.zoomBox.style.width=(F+B.width+1)+"px";this.zoomBox.style.height=(D+B.height+1)+"px";this.zoomBox.style.left=(A.x<C?C-F-B.left:C-B.left)+"px";this.zoomBox.style.top=(A.y<E?E-D-B.top:E-B.top)+"px"},endBox:function(E){var C;if(Math.abs(this.dragHandler.start.x-E.x)>5||Math.abs(this.dragHandler.start.y-E.y)>5){var F=this.dragHandler.start;var D=Math.min(F.y,E.y);var G=Math.max(F.y,E.y);var B=Math.min(F.x,E.x);var A=Math.max(F.x,E.x);C=new OpenLayers.Bounds(B,G,A,D)}else{C=this.dragHandler.start.clone()}this.removeBox();this.callback("done",[C])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.zoomBox=null;this.boxOffsets=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragHandler.activate();return true}else{return false}},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){if(this.dragHandler.deactivate()){if(this.zoomBox){this.removeBox()}}return true}else{return false}},getBoxOffsets:function(){if(!this.boxOffsets){var E=document.createElement("div");E.style.position="absolute";E.style.border="1px solid black";E.style.width="3px";document.body.appendChild(E);var D=E.clientWidth==3;document.body.removeChild(E);var B=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width"));var A=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width"));var C=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width"));var F=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:B,right:A,top:C,bottom:F,width:D===false?B+A:0,height:D===false?C+F:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"});OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:false,keyMask:null,alwaysZoom:false,zoomOnClick:true,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(S){if(S instanceof OpenLayers.Bounds){var O,E=S.getCenterPixel();if(!this.out){var G=this.map.getLonLatFromPixel({x:S.left,y:S.bottom});var F=this.map.getLonLatFromPixel({x:S.right,y:S.top});O=new OpenLayers.Bounds(G.lon,G.lat,F.lon,F.lat)}else{var A=S.right-S.left;var R=S.bottom-S.top;var C=Math.min((this.map.size.h/R),(this.map.size.w/A));var N=this.map.getExtent();var U=this.map.getLonLatFromPixel(E);var Q=U.lon-(N.getWidth()/2)*C;var K=U.lon+(N.getWidth()/2)*C;var B=U.lat-(N.getHeight()/2)*C;var T=U.lat+(N.getHeight()/2)*C;O=new OpenLayers.Bounds(Q,B,K,T)}var J=this.map.getZoom(),D=this.map.getSize(),H={x:D.w/2,y:D.h/2},P=this.map.getZoomForExtent(O),I=this.map.getResolution(),M=this.map.getResolutionForZoom(P);if(I==M){this.map.setCenter(this.map.getLonLatFromPixel(E))}else{var L={x:(I*E.x-M*H.x)/(I-M),y:(I*E.y-M*H.y)/(I-M)};this.map.zoomTo(P,L)}if(J==this.map.getZoom()&&this.alwaysZoom==true){this.map.zoomTo(J+(this.out?-1:1))}}else{if(this.zoomOnClick){if(!this.out){this.map.zoomTo(this.map.getZoom()+1,S)}else{this.map.zoomTo(this.map.getZoom()-1,S)}}}},CLASS_NAME:"OpenLayers.Control.ZoomBox"});OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:false,interval:0,documentDrag:false,kinetic:null,enableKinetic:true,kineticInterval:10,draw:function(){if(this.enableKinetic&&OpenLayers.Kinetic){var A={interval:this.kineticInterval};if(typeof this.enableKinetic==="object"){A=OpenLayers.Util.extend(A,this.enableKinetic)}this.kinetic=new OpenLayers.Kinetic(A)}this.handler=new OpenLayers.Handler.Drag(this,{"move":this.panMap,"done":this.panMapDone,"down":this.panMapStart},{interval:this.interval,documentDrag:this.documentDrag})},panMapStart:function(){if(this.enableKinetic&&this.kinetic){this.kinetic.begin()}},panMap:function(A){if(this.enableKinetic&&this.kinetic){this.kinetic.update(A)}this.panned=true;this.map.pan(this.handler.last.x-A.x,this.handler.last.y-A.y,{dragging:true,animate:false})},panMapDone:function(A){if(this.panned){var C=null;if(this.enableKinetic&&this.kinetic){C=this.kinetic.end(A)}this.map.pan(this.handler.last.x-A.x,this.handler.last.y-A.y,{dragging:!!C,animate:false});if(C){var B=this;this.kinetic.move(C,function(E,F,D){B.map.pan(E,F,{dragging:!D,animate:false})})}this.panned=false}},CLASS_NAME:"OpenLayers.Control.DragPan"});OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:false,zoomBox:null,zoomBoxEnabled:true,zoomWheelEnabled:true,mouseWheelOptions:null,handleRightClicks:false,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:true,initialize:function(A){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();if(this.dragPan){this.dragPan.destroy()}this.dragPan=null;if(this.zoomBox){this.zoomBox.destroy()}this.zoomBox=null;if(this.pinchZoom){this.pinchZoom.destroy()}this.pinchZoom=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();if(this.zoomWheelEnabled){this.handlers.wheel.activate()}this.handlers.click.activate();if(this.zoomBoxEnabled){this.zoomBox.activate()}if(this.pinchZoom){this.pinchZoom.activate()}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.pinchZoom){this.pinchZoom.deactivate()}this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){if(this.handleRightClicks){this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False}var C={"click":this.defaultClick,"dblclick":this.defaultDblClick,"dblrightclick":this.defaultDblRightClick};var A={"double":true,"stopDouble":true};this.handlers.click=new OpenLayers.Handler.Click(this,C,A);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();var B=this.map.fractionalZoom?{}:{cumulative:false,interval:50,maxDelta:6};this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},OpenLayers.Util.extend(B,this.mouseWheelOptions));if(OpenLayers.Control.PinchZoom){this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))}},defaultClick:function(A){if(A.lastTouches&&A.lastTouches.length==2){this.map.zoomOut()}},defaultDblClick:function(A){this.map.zoomTo(this.map.zoom+1,A.xy)},defaultDblRightClick:function(A){this.map.zoomTo(this.map.zoom-1,A.xy)},wheelChange:function(B,A){if(!this.map.fractionalZoom){A=Math.round(A)}var C=this.map.getZoom(),D=C+A;D=Math.max(D,0);D=Math.min(D,this.map.getNumZoomLevels());if(D===C){return}this.map.zoomTo(D,B.xy)},wheelUp:function(B,A){this.wheelChange(B,A||1)},wheelDown:function(B,A){this.wheelChange(B,A||-1)},disableZoomBox:function(){this.zoomBoxEnabled=false;this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=true;if(this.active){this.zoomBox.activate()}},disableZoomWheel:function(){this.zoomWheelEnabled=false;this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=true;if(this.active){this.handlers.wheel.activate()}},CLASS_NAME:"OpenLayers.Control.Navigation"});OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,multi:false,featureAdded:function(){},initialize:function(C,B,A){OpenLayers.Control.prototype.initialize.apply(this,[A]);this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(F,E){this.layer.events.triggerEvent("sketchmodified",{vertex:F,feature:E})},create:function(F,E){this.layer.events.triggerEvent("sketchstarted",{vertex:F,feature:E})}},this.callbacks);this.layer=C;this.handlerOptions=this.handlerOptions||{};this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{renderers:C.renderers,rendererOptions:C.rendererOptions});if(!("multi" in this.handlerOptions)){this.handlerOptions.multi=this.multi}var D=this.layer.styleMap&&this.layer.styleMap.styles.temporary;if(D){this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":D})})}this.handler=new B(this,this.callbacks,this.handlerOptions)},drawFeature:function(B){var A=new OpenLayers.Feature.Vector(B);var C=this.layer.events.triggerEvent("sketchcomplete",{feature:A});if(C!==false){A.state=OpenLayers.State.INSERT;this.layer.addFeatures([A]);this.featureAdded(A);this.events.triggerEvent("featureadded",{feature:A})}},insertXY:function(A,B){if(this.handler&&this.handler.line){this.handler.insertXY(A,B)}},insertDeltaXY:function(A,B){if(this.handler&&this.handler.line){this.handler.insertDeltaXY(A,B)}},insertDirectionLength:function(B,A){if(this.handler&&this.handler.line){this.handler.insertDirectionLength(B,A)}},insertDeflectionLength:function(B,A){if(this.handler&&this.handler.line){this.handler.insertDeflectionLength(B,A)}},undo:function(){return this.handler.undo&&this.handler.undo()},redo:function(){return this.handler.redo&&this.handler.redo()},finishSketch:function(){this.handler.finishGeometry()},cancel:function(){this.handler.cancel()},CLASS_NAME:"OpenLayers.Control.DrawFeature"});OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{holeModifier:null,drawingHole:false,polygon:null,createFeature:function(A){var B=this.layer.getLonLatFromViewPortPx(A);var C=new OpenLayers.Geometry.Point(B.lon,B.lat);this.point=new OpenLayers.Feature.Vector(C);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry]));this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.polygon,this.point],{silent:true})},addPoint:function(A){if(!this.drawingHole&&this.holeModifier&&this.evt&&this.evt[this.holeModifier]){var D=this.point.geometry;var B=this.control.layer.features;var F,E;for(var C=B.length-1;C>=0;--C){F=B[C].geometry;if((F instanceof OpenLayers.Geometry.Polygon||F instanceof OpenLayers.Geometry.MultiPolygon)&&F.intersects(D)){E=B[C];this.control.layer.removeFeatures([E],{silent:true});this.control.layer.events.registerPriority("sketchcomplete",this,this.finalizeInteriorRing);this.control.layer.events.registerPriority("sketchmodified",this,this.enforceTopology);E.geometry.addComponent(this.line.geometry);this.polygon=E;this.drawingHole=true;break}}}OpenLayers.Handler.Path.prototype.addPoint.apply(this,arguments)},getCurrentPointIndex:function(){return this.line.geometry.components.length-2},enforceTopology:function(B){var A=B.vertex;var D=this.line.geometry.components;if(!this.polygon.geometry.intersects(A)){var C=D[D.length-3];A.x=C.x;A.y=C.y}},finishGeometry:function(){var A=this.line.geometry.components.length-2;this.line.geometry.removeComponent(this.line.geometry.components[A]);this.removePoint();this.finalize()},finalizeInteriorRing:function(){var A=this.line.geometry;var F=(A.getArea()!==0);if(F){var E=this.polygon.geometry.components;for(var D=E.length-2;D>=0;--D){if(A.intersects(E[D])){F=false;break}}if(F){var G;outer:for(var D=E.length-2;D>0;--D){var H=E[D].components;for(var C=0,B=H.length;C<B;++C){if(A.containsPoint(H[C])){F=false;break outer}}}}}if(F){if(this.polygon.state!==OpenLayers.State.INSERT){this.polygon.state=OpenLayers.State.UPDATE}}else{this.polygon.geometry.removeComponent(A)}this.restoreFeature();return false},cancel:function(){if(this.drawingHole){this.polygon.geometry.removeComponent(this.line.geometry);this.restoreFeature(true)}return OpenLayers.Handler.Path.prototype.cancel.apply(this,arguments)},restoreFeature:function(A){this.control.layer.events.unregister("sketchcomplete",this,this.finalizeInteriorRing);this.control.layer.events.unregister("sketchmodified",this,this.enforceTopology);this.layer.removeFeatures([this.polygon],{silent:true});this.control.layer.addFeatures([this.polygon],{silent:true});this.drawingHole=false;if(!A){this.control.layer.events.triggerEvent("sketchcomplete",{feature:this.polygon})}},destroyFeature:function(A){OpenLayers.Handler.Path.prototype.destroyFeature.call(this,A);this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var A=this.polygon&&this.polygon.geometry;if(A&&this.multi){A=new OpenLayers.Geometry.MultiPolygon([A])}return A},CLASS_NAME:"OpenLayers.Handler.Polygon"});OpenLayers.Control.EditingToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{citeCompliant:false,initialize:function(C,B){OpenLayers.Control.Panel.prototype.initialize.apply(this,[B]);this.addControls([new OpenLayers.Control.Navigation()]);var A=[new OpenLayers.Control.DrawFeature(C,OpenLayers.Handler.Point,{displayClass:"olControlDrawFeaturePoint",handlerOptions:{citeCompliant:this.citeCompliant}}),new OpenLayers.Control.DrawFeature(C,OpenLayers.Handler.Path,{displayClass:"olControlDrawFeaturePath",handlerOptions:{citeCompliant:this.citeCompliant}}),new OpenLayers.Control.DrawFeature(C,OpenLayers.Handler.Polygon,{displayClass:"olControlDrawFeaturePolygon",handlerOptions:{citeCompliant:this.citeCompliant}})];this.addControls(A)},draw:function(){var A=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);if(this.defaultControl===null){this.defaultControl=this.controls[0]}return A},CLASS_NAME:"OpenLayers.Control.EditingToolbar"});OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,activate:function(){var A=OpenLayers.Strategy.prototype.activate.call(this);if(A){this.layer.events.on({"moveend":this.update,"refresh":this.update,"visibilitychanged":this.update,scope:this});this.update()}return A},deactivate:function(){var A=OpenLayers.Strategy.prototype.deactivate.call(this);if(A){this.layer.events.un({"moveend":this.update,"refresh":this.update,"visibilitychanged":this.update,scope:this})}return A},update:function(A){var B=this.getMapBounds();if(B!==null&&((A&&A.force)||(this.layer.visibility&&this.layer.calculateInRange()&&this.invalidBounds(B)))){this.calculateBounds(B);this.resolution=this.layer.map.getResolution();this.triggerRead(A)}},getMapBounds:function(){if(this.layer.map===null){return null}var A=this.layer.map.getExtent();if(A&&!this.layer.projection.equals(this.layer.map.getProjectionObject())){A=A.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection)}return A},invalidBounds:function(C){if(!C){C=this.getMapBounds()}var A=!this.bounds||!this.bounds.containsBounds(C);if(!A&&this.resFactor){var B=this.resolution/this.layer.map.getResolution();A=(B>=this.resFactor||B<=(1/this.resFactor))}return A},calculateBounds:function(D){if(!D){D=this.getMapBounds()}var B=D.getCenterLonLat();var A=D.getWidth()*this.ratio;var C=D.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(B.lon-(A/2),B.lat-(C/2),B.lon+(A/2),B.lat+(C/2))},triggerRead:function(B){if(this.response&&!(B&&B.noAbort===true)){this.layer.protocol.abort(this.response);this.layer.events.triggerEvent("loadend")}var A={filter:this.createFilter()};this.layer.events.triggerEvent("loadstart",A);this.response=this.layer.protocol.read(OpenLayers.Util.applyDefaults({filter:A.filter,callback:this.merge,scope:this},B))},createFilter:function(){var A=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});if(this.layer.filter){A=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.layer.filter,A]})}return A},merge:function(E){this.layer.destroyFeatures();if(E.success()){var A=E.features;if(A&&A.length>0){var F=this.layer.projection;var C=this.layer.map.getProjectionObject();if(!C.equals(F)){var G;for(var B=0,D=A.length;B<D;++B){G=A[B].geometry;if(G){G.transform(F,C)}}}this.layer.addFeatures(A)}}else{this.bounds=null}this.response=null;this.layer.events.triggerEvent("loadend",{response:E})},CLASS_NAME:"OpenLayers.Strategy.BBOX"});OpenLayers.Layer.WorldWind=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{},isBaseLayer:true,lzd:null,zoomLevels:null,initialize:function(C,A,G,E,F,B){this.lzd=G;this.zoomLevels=E;var D=[];D.push(C,A,F,B);OpenLayers.Layer.Grid.prototype.initialize.apply(this,D);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getZoom:function(){var B=this.map.getZoom();var A=this.map.getMaxExtent();B=B-Math.log(this.maxResolution/(this.lzd/512))/Math.log(2);return B},getURL:function(A){A=this.adjustBounds(A);var F=this.getZoom();var B=this.map.getMaxExtent();var E=this.lzd/Math.pow(2,this.getZoom());var C=Math.floor((A.left-B.left)/E);var D=Math.floor((A.bottom-B.bottom)/E);if(this.map.getResolution()<=(this.lzd/512)&&this.getZoom()<=this.zoomLevels){return this.getFullRequestString({L:F,X:C,Y:D})}else{return OpenLayers.Util.getImageLocation("blank.gif")}},CLASS_NAME:"OpenLayers.Layer.WorldWind"});OpenLayers.Protocol.CSW=function(B){B=OpenLayers.Util.applyDefaults(B,OpenLayers.Protocol.CSW.DEFAULTS);var A=OpenLayers.Protocol.CSW["v"+B.version.replace(/\./g,"_")];if(!A){throw"Unsupported CSW version: "+B.version}return new A(B)};OpenLayers.Protocol.CSW.DEFAULTS={"version":"2.0.2"};OpenLayers.Format.WMTSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",yx:{"urn:ogc:def:crs:EPSG::4326":true},createLayer:function(e,b){var Q;if(!("layer" in b)){throw new Error("Missing property 'layer' in configuration.")}var I=e.contents;var U=I.layers;var M;for(var H=0,O=I.layers.length;H<O;++H){if(I.layers[H].identifier===b.layer){M=I.layers[H];break}}if(!M){throw new Error("Layer not found")}var L=b.format;if(!L&&M.formats&&M.formats.length){L=M.formats[0]}var V;if(b.matrixSet){V=I.tileMatrixSets[b.matrixSet]}else{if(M.tileMatrixSetLinks.length>=1){V=I.tileMatrixSets[M.tileMatrixSetLinks[0].tileMatrixSet]}}if(!V){throw new Error("matrixSet not found")}var d;for(var H=0,O=M.styles.length;H<O;++H){d=M.styles[H];if(d.isDefault){break}}var X=b.requestEncoding;if(!X){X="KVP";if(e.operationsMetadata.GetTile.dcp.http){var G=e.operationsMetadata.GetTile.dcp.http;if(G.get[0].constraints){var W=G.get[0].constraints;var P=W.GetEncoding.allowedValues;if(!P.KVP&&(P.REST||P.RESTful)){X="REST"}}}}var T=[];var B=b.params||{};delete b.params;for(var Y=0,a=M.dimensions.length;Y<a;Y++){var J=M.dimensions[Y];T.push(J.identifier);if(!B.hasOwnProperty(J.identifier)){B[J.identifier]=J["default"]}}var F=b.projection||V.supportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3");var N=b.units||(F==="EPSG:4326"?"degrees":"m");var R=[];for(var K in V.matrixIds){if(V.matrixIds.hasOwnProperty(K)){R.push(V.matrixIds[K].scaleDenominator*0.00028/OpenLayers.METERS_PER_INCH/OpenLayers.INCHES_PER_UNIT[N])}}var A;if(X==="REST"&&M.resourceUrls){A=[];var c=M.resourceUrls,Z;for(var C=0,S=M.resourceUrls.length;C<S;++C){Z=M.resourceUrls[C];if(Z.format===L&&Z.resourceType==="tile"){A.push(Z.template)}}}else{var E=e.operationsMetadata.GetTile.dcp.http.get;A=[];var D;for(var H=0,O=E.length;H<O;H++){D=E[H].constraints;if(!D||(D&&D.GetEncoding.allowedValues[X])){A.push(E[H].url)}}}return new OpenLayers.Layer.WMTS(OpenLayers.Util.applyDefaults(b,{url:A,requestEncoding:X,name:M.title,style:d.identifier,format:L,matrixIds:V.matrixIds,matrixSet:V.identifier,projection:F,units:N,resolutions:b.isBaseLayer===false?undefined:R,serverResolutions:R,tileFullExtent:V.bounds,dimensions:T,params:B}))},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities"});OpenLayers.Layer.Google.v3={DEFAULTS:{sphericalMercator:true,projection:"EPSG:900913"},animationEnabled:true,loadMapObject:function(){if(!this.type){this.type=google.maps.MapTypeId.ROADMAP}var C;var A=OpenLayers.Layer.Google.cache[this.map.id];if(A){C=A.mapObject;++A.count}else{var B=this.map.getCenter();var E=document.createElement("div");E.className="olForeignContainer";E.style.width="100%";E.style.height="100%";C=new google.maps.Map(E,{center:B?new google.maps.LatLng(B.lat,B.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()||0,mapTypeId:this.type,disableDefaultUI:true,keyboardShortcuts:false,draggable:false,disableDoubleClickZoom:true,scrollwheel:false,streetViewControl:false});var D=document.createElement("div");D.style.width="100%";D.style.height="100%";C.controls[google.maps.ControlPosition.TOP_LEFT].push(D);A={googleControl:D,mapObject:C,count:1};OpenLayers.Layer.Google.cache[this.map.id]=A}this.mapObject=C;this.setGMapVisibility(this.visibility)},onMapResize:function(){if(this.visibility){google.maps.event.trigger(this.mapObject,"resize")}},setGMapVisibility:function(A){var I=OpenLayers.Layer.Google.cache[this.map.id];var D=this.map;if(I){var G=this.type;var H=D.layers;var C;for(var B=H.length-1;B>=0;--B){C=H[B];if(C instanceof OpenLayers.Layer.Google&&C.visibility===true&&C.inRange===true){G=C.type;A=true;break}}var E=this.mapObject.getDiv();if(A===true){if(E.parentNode!==D.div){if(!I.rendered){var F=this;google.maps.event.addListenerOnce(this.mapObject,"tilesloaded",function(){I.rendered=true;F.setGMapVisibility(F.getVisibility());F.moveTo(F.map.getCenter())})}else{D.div.appendChild(E);I.googleControl.appendChild(D.viewPortDiv);google.maps.event.trigger(this.mapObject,"resize")}}this.mapObject.setMapTypeId(G)}else{if(I.googleControl.hasChildNodes()){D.div.appendChild(D.viewPortDiv);D.div.removeChild(E)}}}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(C){var D=null;if(C!=null){var A=this.sphericalMercator?this.inverseMercator(C.bottom,C.left):new OpenLayers.LonLat(C.bottom,C.left);var B=this.sphericalMercator?this.inverseMercator(C.top,C.right):new OpenLayers.LonLat(C.top,C.right);D=new google.maps.LatLngBounds(new google.maps.LatLng(A.lat,A.lon),new google.maps.LatLng(B.lat,B.lon))}return D},getMapObjectLonLatFromMapObjectPixel:function(C){var D=this.map.getSize();var B=this.getLongitudeFromMapObjectLonLat(this.mapObject.center);var A=this.getLatitudeFromMapObjectLonLat(this.mapObject.center);var H=this.map.getResolution();var E=C.x-(D.w/2);var G=C.y-(D.h/2);var F=new OpenLayers.LonLat(B+E*H,A-G*H);if(this.wrapDateLine){F=F.wrapDateLine(this.maxExtent)}return this.getMapObjectLonLatFromLonLat(F.lon,F.lat)},getMapObjectPixelFromMapObjectLonLat:function(B){var A=this.getLongitudeFromMapObjectLonLat(B);var D=this.getLatitudeFromMapObjectLonLat(B);var C=this.map.getResolution();var E=this.map.getExtent();return this.getMapObjectPixelFromXY((1/C*(A-E.left)),(1/C*(E.top-D)))},setMapObjectCenter:function(B,C){if(this.animationEnabled===false&&C!=this.mapObject.zoom){var A=this.getMapContainer();google.maps.event.addListenerOnce(this.mapObject,"idle",function(){A.style.visibility=""});A.style.visibility="hidden"}this.mapObject.setOptions({center:B,zoom:C})},getMapObjectZoomFromMapObjectBounds:function(A){return this.mapObject.getBoundsZoomLevel(A)},getMapObjectLonLatFromLonLat:function(B,C){var D;if(this.sphericalMercator){var A=this.inverseMercator(B,C);D=new google.maps.LatLng(A.lat,A.lon)}else{D=new google.maps.LatLng(C,B)}return D},getMapObjectPixelFromXY:function(A,B){return new google.maps.Point(A,B)}};OpenLayers.Format.WPSDescribeProcess=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{wps:"http://www.opengis.net/wps/1.0.0",ows:"http://www.opengis.net/ows/1.1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",defaultPrefix:"wps",regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},read:function(B){if(typeof B=="string"){B=OpenLayers.Format.XML.prototype.read.apply(this,[B])}if(B&&B.nodeType==9){B=B.documentElement}var A={};this.readNode(B,A);return A},readers:{"wps":{"ProcessDescriptions":function(B,A){A.processDescriptions={};this.readChildNodes(B,A.processDescriptions)},"ProcessDescription":function(C,A){var D=this.getAttributeNS(C,this.namespaces.wps,"processVersion");var B={processVersion:D,statusSupported:(C.getAttribute("statusSupported")==="true"),storeSupported:(C.getAttribute("storeSupported")==="true")};this.readChildNodes(C,B);A[B.identifier]=B},"DataInputs":function(B,A){A.dataInputs=[];this.readChildNodes(B,A.dataInputs)},"ProcessOutputs":function(B,A){A.processOutputs=[];this.readChildNodes(B,A.processOutputs)},"Output":function(B,A){var C={};this.readChildNodes(B,C);A.push(C)},"ComplexOutput":function(A,B){B.complexOutput={};this.readChildNodes(A,B.complexOutput)},"LiteralOutput":function(A,B){B.literalOutput={};this.readChildNodes(A,B.literalOutput)},"Input":function(A,B){var C={maxOccurs:parseInt(A.getAttribute("maxOccurs")),minOccurs:parseInt(A.getAttribute("minOccurs"))};this.readChildNodes(A,C);B.push(C)},"BoundingBoxData":function(A,B){B.boundingBoxData={};this.readChildNodes(A,B.boundingBoxData)},"CRS":function(B,A){if(!A.CRSs){A.CRSs={}}A.CRSs[this.getChildValue(B)]=true},"LiteralData":function(A,B){B.literalData={};this.readChildNodes(A,B.literalData)},"ComplexData":function(A,B){B.complexData={};this.readChildNodes(A,B.complexData)},"Default":function(A,B){B["default"]={};this.readChildNodes(A,B["default"])},"Supported":function(A,B){B["supported"]={};this.readChildNodes(A,B["supported"])},"Format":function(C,B){var A={};this.readChildNodes(C,A);if(!B.formats){B.formats={}}B.formats[A.mimeType]=true},"MimeType":function(B,A){A.mimeType=this.getChildValue(B)}},"ows":OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers["ows"]},CLASS_NAME:"OpenLayers.Format.WPSDescribeProcess"});OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(A){this.regExes={"typeStr":/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,"spaces":/\s+/,"parenComma":/\)\s*,\s*\(/,"doubleParenComma":/\)\s*\)\s*,\s*\(\s*\(/,"trimParens":/^\s*\(?(.*?)\)?\s*$/};OpenLayers.Format.prototype.initialize.apply(this,[A])},read:function(F){var B,H,C;F=F.replace(/[\n\r]/g," ");var E=this.regExes.typeStr.exec(F);if(E){H=E[1].toLowerCase();C=E[2];if(this.parse[H]){B=this.parse[H].apply(this,[C])}if(this.internalProjection&&this.externalProjection){if(B&&B.CLASS_NAME=="OpenLayers.Feature.Vector"){B.geometry.transform(this.externalProjection,this.internalProjection)}else{if(B&&H!="geometrycollection"&&typeof B=="object"){for(var D=0,G=B.length;D<G;D++){var A=B[D];A.geometry.transform(this.externalProjection,this.internalProjection)}}}}}return B},write:function(A){var D,F,E;if(A.constructor==Array){D=A;E=true}else{D=[A];E=false}var B=[];if(E){B.push("GEOMETRYCOLLECTION(")}for(var C=0,G=D.length;C<G;++C){if(E&&C>0){B.push(",")}F=D[C].geometry;B.push(this.extractGeometry(F))}if(E){B.push(")")}return B.join("")},extractGeometry:function(C){var A=C.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[A]){return null}if(this.internalProjection&&this.externalProjection){C=C.clone();C.transform(this.internalProjection,this.externalProjection)}var B=A=="collection"?"GEOMETRYCOLLECTION":A.toUpperCase();var D=B+"("+this.extract[A].apply(this,[C])+")";return D},extract:{"point":function(A){return A.x+" "+A.y},"multipoint":function(A){var B=[];for(var C=0,D=A.components.length;C<D;++C){B.push("("+this.extract.point.apply(this,[A.components[C]])+")")}return B.join(",")},"linestring":function(C){var A=[];for(var B=0,D=C.components.length;B<D;++B){A.push(this.extract.point.apply(this,[C.components[B]]))}return A.join(",")},"multilinestring":function(C){var A=[];for(var B=0,D=C.components.length;B<D;++B){A.push("("+this.extract.linestring.apply(this,[C.components[B]])+")")}return A.join(",")},"polygon":function(D){var A=[];for(var B=0,C=D.components.length;B<C;++B){A.push("("+this.extract.linestring.apply(this,[D.components[B]])+")")}return A.join(",")},"multipolygon":function(C){var A=[];for(var B=0,D=C.components.length;B<D;++B){A.push("("+this.extract.polygon.apply(this,[C.components[B]])+")")}return A.join(",")},"collection":function(C){var A=[];for(var B=0,D=C.components.length;B<D;++B){A.push(this.extractGeometry.apply(this,[C.components[B]]))}return A.join(",")}},parse:{"point":function(B){var A=OpenLayers.String.trim(B).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(A[0],A[1]))},"multipoint":function(D){var B;var C=OpenLayers.String.trim(D).split(",");var F=[];for(var A=0,E=C.length;A<E;++A){B=C[A].replace(this.regExes.trimParens,"$1");F.push(this.parse.point.apply(this,[B]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(F))},"linestring":function(C){var B=OpenLayers.String.trim(C).split(",");var E=[];for(var A=0,D=B.length;A<D;++A){E.push(this.parse.point.apply(this,[B[A]]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(E))},"multilinestring":function(C){var E;var B=OpenLayers.String.trim(C).split(this.regExes.parenComma);var F=[];for(var A=0,D=B.length;A<D;++A){E=B[A].replace(this.regExes.trimParens,"$1");F.push(this.parse.linestring.apply(this,[E]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(F))},"polygon":function(C){var E,B,A;var G=OpenLayers.String.trim(C).split(this.regExes.parenComma);var D=[];for(var F=0,H=G.length;F<H;++F){E=G[F].replace(this.regExes.trimParens,"$1");B=this.parse.linestring.apply(this,[E]).geometry;A=new OpenLayers.Geometry.LinearRing(B.components);D.push(A)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(D))},"multipolygon":function(C){var E;var B=OpenLayers.String.trim(C).split(this.regExes.doubleParenComma);var F=[];for(var A=0,D=B.length;A<D;++A){E=B[A].replace(this.regExes.trimParens,"$1");F.push(this.parse.polygon.apply(this,[E]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(F))},"geometrycollection":function(C){C=C.replace(/,\s*([A-Za-z])/g,"|$1");var B=OpenLayers.String.trim(C).split("|");var E=[];for(var A=0,D=B.length;A<D;++A){E.push(OpenLayers.Format.WKT.prototype.read.apply(this,[B[A]]))}return E}},CLASS_NAME:"OpenLayers.Format.WKT"});OpenLayers.WPSProcess=OpenLayers.Class({client:null,server:null,identifier:null,description:null,localWPS:"http://geoserver/wps",formats:null,chained:0,executeCallbacks:null,initialize:function(A){OpenLayers.Util.extend(this,A);this.executeCallbacks=[];this.formats={"application/wkt":new OpenLayers.Format.WKT(),"application/json":new OpenLayers.Format.GeoJSON()}},describe:function(B){B=B||{};if(!this.description){this.client.describeProcess(this.server,this.identifier,function(C){if(!this.description){this.parseDescription(C)}if(B.callback){B.callback.call(B.scope,this.description)}},this)}else{if(B.callback){var A=this.description;window.setTimeout(function(){B.callback.call(B.scope,A)},0)}}},configure:function(A){this.describe({callback:function(){var E=this.description,B=A.inputs,F,C,D;for(C=0,D=E.dataInputs.length;C<D;++C){F=E.dataInputs[C];this.setInputData(F,B[F.identifier])}if(A.callback){A.callback.call(A.scope)}},scope:this});return this},execute:function(A){this.configure({inputs:A.inputs,callback:function(){var D=this;var C=this.getOutputIndex(D.description.processOutputs,A.output);D.setResponseForm({outputIndex:C});(function B(){OpenLayers.Util.removeItem(D.executeCallbacks,B);if(D.chained!==0){D.executeCallbacks.push(B);return}OpenLayers.Request.POST({url:D.client.servers[D.server].url,data:new OpenLayers.Format.WPSExecute().write(D.description),success:function(H){var I=D.description.processOutputs[C];var F=D.findMimeType(I.complexOutput.supported.formats);var E=D.formats[F].read(H.responseText);if(E instanceof OpenLayers.Feature.Vector){E=[E]}if(A.success){var G={};G[A.output||"result"]=E;A.success.call(A.scope,G)}},scope:D})})()},scope:this})},output:function(A){return new OpenLayers.WPSProcess.ChainLink({process:this,output:A})},parseDescription:function(A){var B=this.client.servers[this.server];this.description=new OpenLayers.Format.WPSDescribeProcess().read(B.processDescription[this.identifier]).processDescriptions[this.identifier]},setInputData:function(C,D){delete C.data;delete C.reference;if(D instanceof OpenLayers.WPSProcess.ChainLink){++this.chained;C.reference={method:"POST",href:D.process.server===this.server?this.localWPS:this.client.servers[D.process.server].url};D.process.describe({callback:function(){--this.chained;this.chainProcess(C,D)},scope:this})}else{C.data={};var A=C.complexData;if(A){var B=this.findMimeType(A.supported.formats);C.data.complexData={mimeType:B,value:this.formats[B].write(this.toFeatures(D))}}else{C.data.literalData={value:D}}}},setResponseForm:function(A){A=A||{};var B=this.description.processOutputs[A.outputIndex||0];this.description.responseForm={rawDataOutput:{identifier:B.identifier,mimeType:this.findMimeType(B.complexOutput.supported.formats,A.supportedFormats)}}},getOutputIndex:function(C,A){var D;if(A){for(var B=C.length-1;B>=0;--B){if(C[B].identifier===A){D=B;break}}}else{D=0}return D},chainProcess:function(B,C){var D=this.getOutputIndex(C.process.description.processOutputs,C.output);B.reference.mimeType=this.findMimeType(B.complexData.supported.formats,C.process.description.processOutputs[D].complexOutput.supported.formats);var A={};A[B.reference.mimeType]=true;C.process.setResponseForm({outputIndex:D,supportedFormats:A});B.reference.body=C.process.description;while(this.executeCallbacks.length>0){this.executeCallbacks[0]()}},toFeatures:function(B){var E=OpenLayers.Util.isArray(B);if(!E){B=[B]}var F=new Array(B.length),D;for(var A=0,C=B.length;A<C;++A){D=B[A];F[A]=D instanceof OpenLayers.Feature.Vector?D:new OpenLayers.Feature.Vector(D)}return E?F:F[0]},findMimeType:function(B,A){A=A||this.formats;for(var C in B){if(C in A){return C}}},CLASS_NAME:"OpenLayers.WPSProcess"});OpenLayers.WPSProcess.ChainLink=OpenLayers.Class({process:null,output:null,initialize:function(A){OpenLayers.Util.extend(this,A)},CLASS_NAME:"OpenLayers.WPSProcess.ChainLink"});OpenLayers.WPSClient=OpenLayers.Class({servers:null,version:"1.0.0",lazy:false,events:null,initialize:function(B){OpenLayers.Util.extend(this,B);this.events=new OpenLayers.Events(this);this.servers={};for(var A in B.servers){this.servers[A]=typeof B.servers[A]=="string"?{url:B.servers[A],version:this.version,processDescription:{}}:B.servers[A]}},execute:function(A){var B=this.getProcess(A.server,A.process);B.execute({inputs:A.inputs,success:A.success,scope:A.scope})},getProcess:function(A,B){var C=new OpenLayers.WPSProcess({client:this,server:A,identifier:B});if(!this.lazy){C.describe()}return C},describeProcess:function(B,C,A,E){var D=this.servers[B];if(!D.processDescription[C]){if(!(C in D.processDescription)){D.processDescription[C]=null;OpenLayers.Request.GET({url:D.url,params:{SERVICE:"WPS",VERSION:D.version,REQUEST:"DescribeProcess",IDENTIFIER:C},success:function(G){D.processDescription[C]=G.responseText;this.events.triggerEvent("describeprocess",{identifier:C,raw:G.responseText})},scope:this})}else{this.events.register("describeprocess",this,function F(G){if(G.identifier===C){this.events.unregister("describeprocess",this,F);A.call(E,G.raw)}})}}else{window.setTimeout(function(){A.call(E,D.processDescription[C])},0)}},destroy:function(){this.events.destroy();this.events=null;this.servers=null},CLASS_NAME:"OpenLayers.WPSClient"});OpenLayers.Format.CSWGetRecords.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{csw:"http://www.opengis.net/cat/csw/2.0.2",dc:"http://purl.org/dc/elements/1.1/",dct:"http://purl.org/dc/terms/",gmd:"http://www.isotc211.org/2005/gmd",geonet:"http://www.fao.org/geonetwork",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",requestId:null,resultType:null,outputFormat:null,outputSchema:null,startPosition:null,maxRecords:null,DistributedSearch:null,ResponseHandler:null,Query:null,regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},initialize:function(A){OpenLayers.Format.XML.prototype.initialize.apply(this,[A])},read:function(B){if(typeof B=="string"){B=OpenLayers.Format.XML.prototype.read.apply(this,[B])}if(B&&B.nodeType==9){B=B.documentElement}var A={};this.readNode(B,A);return A},readers:{"csw":{"GetRecordsResponse":function(B,A){A.records=[];this.readChildNodes(B,A);var C=this.getAttributeNS(B,"","version");if(C!=""){A.version=C}},"RequestId":function(B,A){A.RequestId=this.getChildValue(B)},"SearchStatus":function(C,B){B.SearchStatus={};var A=this.getAttributeNS(C,"","timestamp");if(A!=""){B.SearchStatus.timestamp=A}},"SearchResults":function(D,B){this.readChildNodes(D,B);var E=D.attributes;var A={};for(var C=0,F=E.length;C<F;++C){if((E[C].name=="numberOfRecordsMatched")||(E[C].name=="numberOfRecordsReturned")||(E[C].name=="nextRecord")){A[E[C].name]=parseInt(E[C].nodeValue)}else{A[E[C].name]=E[C].nodeValue}}B.SearchResults=A},"SummaryRecord":function(B,A){var C={type:"SummaryRecord"};this.readChildNodes(B,C);A.records.push(C)},"BriefRecord":function(B,A){var C={type:"BriefRecord"};this.readChildNodes(B,C);A.records.push(C)},"DCMIRecord":function(B,A){var C={type:"DCMIRecord"};this.readChildNodes(B,C);A.records.push(C)},"Record":function(B,A){var C={type:"Record"};this.readChildNodes(B,C);A.records.push(C)},"*":function(B,A){var C=B.localName||B.nodeName.split(":").pop();A[C]=this.getChildValue(B)}},"geonet":{"info":function(B,A){var C={};this.readChildNodes(B,C);A.gninfo=C}},"dc":{"*":function(D,B){var E=D.localName||D.nodeName.split(":").pop();if(!(OpenLayers.Util.isArray(B[E]))){B[E]=[]}var C={};var F=D.attributes;for(var A=0,G=F.length;A<G;++A){C[F[A].name]=F[A].nodeValue}C.value=this.getChildValue(D);if(C.value!=""){B[E].push(C)}}},"dct":{"*":function(B,A){var C=B.localName||B.nodeName.split(":").pop();if(!(OpenLayers.Util.isArray(A[C]))){A[C]=[]}A[C].push(this.getChildValue(B))}},"ows":OpenLayers.Util.applyDefaults({"BoundingBox":function(B,A){if(A.bounds){A.BoundingBox=[{crs:A.projection,value:[A.bounds.left,A.bounds.bottom,A.bounds.right,A.bounds.top]}];delete A.projection;delete A.bounds}OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers["ows"]["BoundingBox"].apply(this,arguments)}},OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers["ows"])},write:function(B){var A=this.writeNode("csw:GetRecords",B);A.setAttribute("xmlns:gmd",this.namespaces.gmd);return OpenLayers.Format.XML.prototype.write.apply(this,[A])},writers:{"csw":{"GetRecords":function(D){if(!D){D={}}var C=this.createElementNSPlus("csw:GetRecords",{attributes:{service:"CSW",version:this.version,requestId:D.requestId||this.requestId,resultType:D.resultType||this.resultType,outputFormat:D.outputFormat||this.outputFormat,outputSchema:D.outputSchema||this.outputSchema,startPosition:D.startPosition||this.startPosition,maxRecords:D.maxRecords||this.maxRecords}});if(D.DistributedSearch||this.DistributedSearch){this.writeNode("csw:DistributedSearch",D.DistributedSearch||this.DistributedSearch,C)}var B=D.ResponseHandler||this.ResponseHandler;if(OpenLayers.Util.isArray(B)&&B.length>0){for(var A=0,E=B.length;A<E;A++){this.writeNode("csw:ResponseHandler",B[A],C)}}this.writeNode("Query",D.Query||this.Query,C);return C},"DistributedSearch":function(B){var A=this.createElementNSPlus("csw:DistributedSearch",{attributes:{hopCount:B.hopCount}});return A},"ResponseHandler":function(B){var A=this.createElementNSPlus("csw:ResponseHandler",{value:B.value});return A},"Query":function(D){if(!D){D={}}var C=this.createElementNSPlus("csw:Query",{attributes:{typeNames:D.typeNames||"csw:Record"}});var B=D.ElementName;if(OpenLayers.Util.isArray(B)&&B.length>0){for(var A=0,E=B.length;A<E;A++){this.writeNode("csw:ElementName",B[A],C)}}else{this.writeNode("csw:ElementSetName",D.ElementSetName||{value:"summary"},C)}if(D.Constraint){this.writeNode("csw:Constraint",D.Constraint,C)}if(D.SortBy){this.writeNode("ogc:SortBy",D.SortBy,C)}return C},"ElementName":function(B){var A=this.createElementNSPlus("csw:ElementName",{value:B.value});return A},"ElementSetName":function(B){var A=this.createElementNSPlus("csw:ElementSetName",{attributes:{typeNames:B.typeNames},value:B.value});return A},"Constraint":function(D){var C=this.createElementNSPlus("csw:Constraint",{attributes:{version:D.version}});if(D.Filter){var B=new OpenLayers.Format.Filter({version:D.version});C.appendChild(B.write(D.Filter))}else{if(D.CqlText){var A=this.createElementNSPlus("CqlText",{value:D.CqlText.value});C.appendChild(A)}}return C}},"ogc":OpenLayers.Format.Filter.v1_1_0.prototype.writers["ogc"]},CLASS_NAME:"OpenLayers.Format.CSWGetRecords.v2_0_2"});OpenLayers.Marker.Box=OpenLayers.Class(OpenLayers.Marker,{bounds:null,div:null,initialize:function(A,B,C){this.bounds=A;this.div=OpenLayers.Util.createDiv();this.div.style.overflow="hidden";this.events=new OpenLayers.Events(this,this.div);this.setBorder(B,C)},destroy:function(){this.bounds=null;this.div=null;OpenLayers.Marker.prototype.destroy.apply(this,arguments)},setBorder:function(B,A){if(!B){B="red"}if(!A){A=2}this.div.style.border=A+"px solid "+B},draw:function(B,A){OpenLayers.Util.modifyDOMElement(this.div,null,B,A);return this.div},onScreen:function(){var B=false;if(this.map){var A=this.map.getExtent();B=A.containsBounds(this.bounds,true,true)}return B},display:function(A){this.div.style.display=(A)?"":"none"},CLASS_NAME:"OpenLayers.Marker.Box"});OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:true,initialize:function(A){A=A||{};if(A.extractStyles!==false){A.defaultStyle={"externalGraphic":OpenLayers.Util.getImageLocation("marker.png"),"graphicWidth":21,"graphicHeight":25,"graphicXOffset":-10.5,"graphicYOffset":-12.5}}OpenLayers.Format.prototype.initialize.apply(this,[A])},read:function(H){var K=H.split("\n");var I;var S=[];for(var Q=0;Q<(K.length-1);Q++){var P=K[Q].replace(/^\s*/,"").replace(/\s*$/,"");if(P.charAt(0)!="#"){if(!I){I=P.split("\t")}else{var E=P.split("\t");var O=new OpenLayers.Geometry.Point(0,0);var N={};var T=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null;var F,L,B,G;var D=false;for(var A=0;A<E.length;A++){if(E[A]){if(I[A]=="point"){var M=E[A].split(",");O.y=parseFloat(M[0]);O.x=parseFloat(M[1]);D=true}else{if(I[A]=="lat"){O.y=parseFloat(E[A]);D=true}else{if(I[A]=="lon"){O.x=parseFloat(E[A]);D=true}else{if(I[A]=="title"){N["title"]=E[A]}else{if(I[A]=="image"||I[A]=="icon"&&T){T["externalGraphic"]=E[A]}else{if(I[A]=="iconSize"&&T){var C=E[A].split(",");T["graphicWidth"]=parseFloat(C[0]);T["graphicHeight"]=parseFloat(C[1])}else{if(I[A]=="iconOffset"&&T){var R=E[A].split(",");T["graphicXOffset"]=parseFloat(R[0]);T["graphicYOffset"]=parseFloat(R[1])}else{if(I[A]=="description"){N["description"]=E[A]}else{if(I[A]=="overflow"){N["overflow"]=E[A]}else{N[I[A]]=E[A]}}}}}}}}}}}if(D){if(this.internalProjection&&this.externalProjection){O.transform(this.externalProjection,this.internalProjection)}var J=new OpenLayers.Feature.Vector(O,N,T);S.push(J)}}}}return S},CLASS_NAME:"OpenLayers.Format.Text"});OpenLayers.Layer.Text=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,initialize:function(B,A){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments);this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadText:function(){if(!this.loaded){if(this.location!=null){var A=function(B){this.events.triggerEvent("loadend")};this.events.triggerEvent("loadstart");OpenLayers.Request.GET({url:this.location,success:this.parseData,failure:A,scope:this});this.loaded=true}}},moveTo:function(B,A,C){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadText()}},parseData:function(M){var H=M.responseText;var F={};OpenLayers.Util.extend(F,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){F.externalProjection=this.projection;F.internalProjection=this.map.getProjectionObject()}var N=new OpenLayers.Format.Text(F);var C=N.read(H);for(var G=0,J=C.length;G<J;G++){var A={};var L=C[G];var K;var I,D;K=new OpenLayers.LonLat(L.geometry.x,L.geometry.y);if(L.style.graphicWidth&&L.style.graphicHeight){I=new OpenLayers.Size(L.style.graphicWidth,L.style.graphicHeight)}if(L.style.graphicXOffset!==undefined&&L.style.graphicYOffset!==undefined){D=new OpenLayers.Pixel(L.style.graphicXOffset,L.style.graphicYOffset)}if(L.style.externalGraphic!=null){A.icon=new OpenLayers.Icon(L.style.externalGraphic,I,D)}else{A.icon=OpenLayers.Marker.defaultIcon();if(I!=null){A.icon.setSize(I)}}if((L.attributes.title!=null)&&(L.attributes.description!=null)){A["popupContentHTML"]="<h2>"+L.attributes.title+"</h2><p>"+L.attributes.description+"</p>"}A["overflow"]=L.attributes.overflow||"auto";var E=new OpenLayers.Feature(this,K,A);this.features.push(E);var B=E.createMarker();if((L.attributes.title!=null)&&(L.attributes.description!=null)){B.events.register("click",E,this.markerClick)}this.addMarker(B)}this.events.triggerEvent("loadend")},markerClick:function(B){var C=(this==this.layer.selectedFeature);this.layer.selectedFeature=(!C)?this:null;for(var A=0,D=this.layer.map.popups.length;A<D;A++){this.layer.map.removePopup(this.layer.map.popups[A])}if(!C){this.layer.map.addPopup(this.createPopup())}OpenLayers.Event.stop(B)},clearFeatures:function(){if(this.features!=null){while(this.features.length>0){var A=this.features[0];OpenLayers.Util.removeItem(this.features,A);A.destroy()}}},CLASS_NAME:"OpenLayers.Layer.Text"});OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",layerOptions:null,persist:false,irregular:false,citeCompliant:false,angle:null,fixedRadius:false,feature:null,layer:null,origin:null,initialize:function(B,C,A){if(!(A&&A.layerOptions&&A.layerOptions.styleMap)){this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})}OpenLayers.Handler.Drag.prototype.initialize.apply(this,[B,C,A]);this.options=(A)?A:{}},setOptions:function(A){OpenLayers.Util.extend(this.options,A);OpenLayers.Util.extend(this,A)},activate:function(){var A=false;if(OpenLayers.Handler.Drag.prototype.activate.apply(this,arguments)){var B=OpenLayers.Util.extend({displayInLayerSwitcher:false,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,B);this.map.addLayer(this.layer);A=true}return A},deactivate:function(){var A=false;if(OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)){if(this.dragging){this.cancel()}if(this.layer.map!=null){this.layer.destroy(false);if(this.feature){this.feature.destroy()}}this.layer=null;this.feature=null;A=true}return A},down:function(B){this.fixedRadius=!!(this.radius);var A=this.layer.getLonLatFromViewPortPx(B.xy);this.origin=new OpenLayers.Geometry.Point(A.lon,A.lat);if(!this.fixedRadius||this.irregular){this.radius=this.map.getResolution()}if(this.persist){this.clear()}this.feature=new OpenLayers.Feature.Vector();this.createGeometry();this.callback("create",[this.origin,this.feature]);this.layer.addFeatures([this.feature],{silent:true});this.layer.drawFeature(this.feature,this.style)},move:function(D){var A=this.layer.getLonLatFromViewPortPx(D.xy);var C=new OpenLayers.Geometry.Point(A.lon,A.lat);if(this.irregular){var F=Math.sqrt(2)*Math.abs(C.y-this.origin.y)/2;this.radius=Math.max(this.map.getResolution()/2,F)}else{if(this.fixedRadius){this.origin=C}else{this.calculateAngle(C,D);this.radius=Math.max(this.map.getResolution()/2,C.distanceTo(this.origin))}}this.modifyGeometry();if(this.irregular){var B=C.x-this.origin.x;var G=C.y-this.origin.y;var E;if(G==0){E=B/(this.radius*Math.sqrt(2))}else{E=B/G}this.feature.geometry.resize(1,this.origin,E);this.feature.geometry.move(B/2,G/2)}this.layer.drawFeature(this.feature,this.style)},up:function(A){this.finalize();if(this.start==this.last){this.callback("done",[A.xy])}},out:function(A){this.finalize()},createGeometry:function(){this.angle=Math.PI*((1/this.sides)-(1/2));if(this.snapAngle){this.angle+=this.snapAngle*(Math.PI/180)}this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,this.sides,this.snapAngle)},modifyGeometry:function(){var D,B;var C=this.feature.geometry.components[0];if(C.components.length!=(this.sides+1)){this.createGeometry();C=this.feature.geometry.components[0]}for(var A=0;A<this.sides;++A){B=C.components[A];D=this.angle+(A*2*Math.PI/this.sides);B.x=this.origin.x+(this.radius*Math.cos(D));B.y=this.origin.y+(this.radius*Math.sin(D));B.clearBounds()}},calculateAngle:function(B,C){var D=Math.atan2(B.y-this.origin.y,B.x-this.origin.x);if(this.snapAngle&&(this.snapToggle&&!C[this.snapToggle])){var A=(Math.PI/180)*this.snapAngle;this.angle=Math.round(D/A)*A}else{this.angle=D}},cancel:function(){this.callback("cancel",null);this.finalize()},finalize:function(){this.origin=null;this.radius=this.options.radius},clear:function(){if(this.layer){this.layer.renderer.clear();this.layer.destroyFeatures()}},callback:function(A,B){if(this.callbacks[A]){this.callbacks[A].apply(this.control,[this.feature.geometry.clone()])}if(!this.persist&&(A=="done"||A=="cancel")){this.clear()}},CLASS_NAME:"OpenLayers.Handler.RegularPolygon"});OpenLayers.Control.SLDSelect=OpenLayers.Class(OpenLayers.Control,{clearOnDeactivate:false,layers:null,callbacks:null,selectionSymbolizer:{"Polygon":{fillColor:"#FF0000",stroke:false},"Line":{strokeColor:"#FF0000",strokeWidth:2},"Point":{graphicName:"square",fillColor:"#FF0000",pointRadius:5}},layerOptions:null,sketchStyle:null,wfsCache:{},layerCache:{},initialize:function(A,B){OpenLayers.Control.prototype.initialize.apply(this,[B]);this.callbacks=OpenLayers.Util.extend({done:this.select,click:this.select},this.callbacks);this.handlerOptions=this.handlerOptions||{};this.layerOptions=OpenLayers.Util.applyDefaults(this.layerOptions,{displayInLayerSwitcher:false,tileOptions:{maxGetUrlLength:2048}});if(this.sketchStyle){this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":this.sketchStyle})})}this.handler=new A(this,this.callbacks,this.handlerOptions)},destroy:function(){for(var A in this.layerCache){delete this.layerCache[A]}for(var A in this.wfsCache){delete this.wfsCache[A]}OpenLayers.Control.prototype.destroy.apply(this,arguments)},coupleLayerVisiblity:function(A){this.setVisibility(A.object.getVisibility())},createSelectionLayer:function(A){var B;if(!this.layerCache[A.id]){B=new OpenLayers.Layer.WMS(A.name,A.url,A.params,OpenLayers.Util.applyDefaults(this.layerOptions,A.getOptions()));this.layerCache[A.id]=B;if(this.layerOptions.displayInLayerSwitcher===false){A.events.on({"visibilitychanged":this.coupleLayerVisiblity,scope:B})}this.map.addLayer(B)}else{B=this.layerCache[A.id]}return B},createSLD:function(F,J,K){var C={version:"1.0.0",namedLayers:{}};var G=[F.params.LAYERS].join(",").split(",");for(var E=0,H=G.length;E<H;E++){var B=G[E];C.namedLayers[B]={name:B,userStyles:[]};var I=this.selectionSymbolizer;var A=K[E];if(A.type.indexOf("Polygon")>=0){I={Polygon:this.selectionSymbolizer["Polygon"]}}else{if(A.type.indexOf("LineString")>=0){I={Line:this.selectionSymbolizer["Line"]}}else{if(A.type.indexOf("Point")>=0){I={Point:this.selectionSymbolizer["Point"]}}}}var D=J[E];C.namedLayers[B].userStyles.push({name:"default",rules:[new OpenLayers.Rule({symbolizer:I,filter:D,maxScaleDenominator:F.options.minScale})]})}return new OpenLayers.Format.SLD({srsName:this.map.getProjection()}).write(C)},parseDescribeLayer:function(D){var C=new OpenLayers.Format.WMSDescribeLayer();var H=D.responseXML;if(!H||!H.documentElement){H=D.responseText}var B=C.read(H);var F=[];var I=null;for(var E=0,A=B.length;E<A;E++){if(B[E].owsType=="WFS"){F.push(B[E].typeName);I=B[E].owsURL}}var G={url:I,params:{SERVICE:"WFS",TYPENAME:F.toString(),REQUEST:"DescribeFeatureType",VERSION:"1.0.0"},callback:function(K){var J=new OpenLayers.Format.WFSDescribeFeatureType();var M=K.responseXML;if(!M||!M.documentElement){M=K.responseText}var L=J.read(M);this.control.wfsCache[this.layer.id]=L;this.control._queue&&this.control.applySelection()},scope:this};OpenLayers.Request.GET(G)},getGeometryAttributes:function(F){var A=[];var K=this.wfsCache[F.id];for(var E=0,I=K.featureTypes.length;E<I;E++){var G=K.featureTypes[E];var H=G.properties;for(var D=0,C=H.length;D<C;D++){var B=H[D];var J=B.type;if((J.indexOf("LineString")>=0)||(J.indexOf("GeometryAssociationType")>=0)||(J.indexOf("GeometryPropertyType")>=0)||(J.indexOf("Point")>=0)||(J.indexOf("Polygon")>=0)){A.push(B)}}}return A},activate:function(){var B=OpenLayers.Control.prototype.activate.call(this);if(B){for(var A=0,E=this.layers.length;A<E;A++){var D=this.layers[A];if(D&&!this.wfsCache[D.id]){var C={url:D.url,params:{SERVICE:"WMS",VERSION:D.params.VERSION,LAYERS:D.params.LAYERS,REQUEST:"DescribeLayer"},callback:this.parseDescribeLayer,scope:{layer:D,control:this}};OpenLayers.Request.GET(C)}}}return B},deactivate:function(){var D=OpenLayers.Control.prototype.deactivate.call(this);if(D){for(var B=0,E=this.layers.length;B<E;B++){var A=this.layers[B];if(A&&this.clearOnDeactivate===true){var C=this.layerCache;var F=C[A.id];if(F){A.events.un({"visibilitychanged":this.coupleLayerVisiblity,scope:F});F.destroy();delete C[A.id]}}}}return D},setLayers:function(A){if(this.active){this.deactivate();this.layers=A;this.activate()}else{this.layers=A}},createFilter:function(A,B){var C=null;if(this.handler instanceof OpenLayers.Handler.RegularPolygon){if(this.handler.irregular===true){C=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:A.name,value:B.getBounds()})}else{C=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:A.name,value:B})}}else{if(this.handler instanceof OpenLayers.Handler.Polygon){C=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:A.name,value:B})}else{if(this.handler instanceof OpenLayers.Handler.Path){if(A.type.indexOf("Point")>=0){C=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,property:A.name,distance:this.map.getExtent().getWidth()*0.01,distanceUnits:this.map.getUnits(),value:B})}else{C=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:A.name,value:B})}}else{if(this.handler instanceof OpenLayers.Handler.Click){if(A.type.indexOf("Polygon")>=0){C=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:A.name,value:B})}else{C=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,property:A.name,distance:this.map.getExtent().getWidth()*0.01,distanceUnits:this.map.getUnits(),value:B})}}}}}return C},select:function(A){this._queue=function(){for(var H=0,J=this.layers.length;H<J;H++){var I=this.layers[H];var M=this.getGeometryAttributes(I);var L=[];for(var G=0,E=M.length;G<E;G++){var C=M[G];if(C!==null){if(!(A instanceof OpenLayers.Geometry)){var K=this.map.getLonLatFromPixel(A.xy);A=new OpenLayers.Geometry.Point(K.lon,K.lat)}var F=this.createFilter(C,A);if(F!==null){L.push(F)}}}var B=this.createSelectionLayer(I);this.events.triggerEvent("selected",{layer:I,filters:L});var D=this.createSLD(I,L,M);B.mergeNewParams({SLD_BODY:D});delete this._queue}};this.applySelection()},applySelection:function(){var B=true;for(var A=0,C=this.layers.length;A<C;A++){if(!this.wfsCache[this.layers[A].id]){B=false;break}}B&&this._queue.call(this)},CLASS_NAME:"OpenLayers.Control.SLDSelect"});OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,geodesic:false,initialize:function(B,A){OpenLayers.Control.prototype.initialize.apply(this,[A]);this.element=OpenLayers.Util.getElement(B)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.element=document.createElement("div");this.div.appendChild(this.element)}this.map.events.register("moveend",this,this.updateScale);this.updateScale();return this.div},updateScale:function(){var C;if(this.geodesic===true){var A=this.map.getUnits();if(!A){return}var B=OpenLayers.INCHES_PER_UNIT;C=(this.map.getGeodesicPixelSize().w||1e-06)*B["km"]*OpenLayers.DOTS_PER_INCH}else{C=this.map.getScale()}if(!C){return}if(C>=9500&&C<=950000){C=Math.round(C/1000)+"K"}else{if(C>=950000){C=Math.round(C/1000000)+"M"}else{C=Math.round(C)}}this.element.innerHTML=OpenLayers.i18n("Scale = 1 : ${scaleDenom}",{"scaleDenom":C})},CLASS_NAME:"OpenLayers.Control.Scale"});OpenLayers.Layer.MapGuide=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,useHttpTile:false,singleTile:false,useOverlay:false,useAsyncOverlay:true,TILE_PARAMS:{operation:"GETTILEIMAGE",version:"1.2.0"},SINGLE_TILE_PARAMS:{operation:"GETMAPIMAGE",format:"PNG",locale:"en",clip:"1",version:"1.0.0"},OVERLAY_PARAMS:{operation:"GETDYNAMICMAPOVERLAYIMAGE",format:"PNG",locale:"en",clip:"1",version:"2.0.0"},FOLDER_PARAMS:{tileColumnsPerFolder:30,tileRowsPerFolder:30,format:"png",querystring:null},defaultSize:new OpenLayers.Size(300,300),tileOriginCorner:"tl",initialize:function(C,A,D,B){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);if(B==null||B.isBaseLayer==null){this.isBaseLayer=((this.transparent!="true")&&(this.transparent!=true))}if(B&&B.useOverlay!=null){this.useOverlay=B.useOverlay}if(this.singleTile){if(this.useOverlay){OpenLayers.Util.applyDefaults(this.params,this.OVERLAY_PARAMS);if(!this.useAsyncOverlay){this.params.version="1.0.0"}}else{OpenLayers.Util.applyDefaults(this.params,this.SINGLE_TILE_PARAMS)}}else{if(this.useHttpTile){OpenLayers.Util.applyDefaults(this.params,this.FOLDER_PARAMS)}else{OpenLayers.Util.applyDefaults(this.params,this.TILE_PARAMS)}this.setTileSize(this.defaultSize)}},clone:function(A){if(A==null){A=new OpenLayers.Layer.MapGuide(this.name,this.url,this.params,this.getOptions())}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);return A},getURL:function(C){var G;var A=C.getCenterLonLat();var B=this.map.getSize();if(this.singleTile){var E={setdisplaydpi:OpenLayers.DOTS_PER_INCH,setdisplayheight:B.h*this.ratio,setdisplaywidth:B.w*this.ratio,setviewcenterx:A.lon,setviewcentery:A.lat,setviewscale:this.map.getScale()};if(this.useOverlay&&!this.useAsyncOverlay){var F={};F=OpenLayers.Util.extend(F,E);F.operation="GETVISIBLEMAPEXTENT";F.version="1.0.0";F.session=this.params.session;F.mapName=this.params.mapName;F.format="text/xml";G=this.getFullRequestString(F);OpenLayers.Request.GET({url:G,async:false})}G=this.getFullRequestString(E)}else{var I=this.map.getResolution();var H=Math.floor((C.left-this.maxExtent.left)/I);H=Math.round(H/this.tileSize.w);var D=Math.floor((this.maxExtent.top-C.top)/I);D=Math.round(D/this.tileSize.h);if(this.useHttpTile){G=this.getImageFilePath({tilecol:H,tilerow:D,scaleindex:this.resolutions.length-this.map.zoom-1})}else{G=this.getFullRequestString({tilecol:H,tilerow:D,scaleindex:this.resolutions.length-this.map.zoom-1})}}return G},getFullRequestString:function(B,D){var G=(D==null)?this.url:D;if(typeof G=="object"){G=G[Math.floor(Math.random()*G.length)]}var I=G;var H=OpenLayers.Util.extend({},this.params);H=OpenLayers.Util.extend(H,B);var C=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(G));for(var E in H){if(E.toUpperCase() in C){delete H[E]}}var A=OpenLayers.Util.getParameterString(H);A=A.replace(/,/g,"+");if(A!=""){var F=G.charAt(G.length-1);if((F=="&")||(F=="?")){I+=A}else{if(G.indexOf("?")==-1){I+="?"+A}else{I+="&"+A}}}return I},getImageFilePath:function(D,E){var C=(E==null)?this.url:E;if(typeof C=="object"){C=C[Math.floor(Math.random()*C.length)]}var B=C;var G="";var F="";if(D.tilerow<0){G="-"}if(D.tilerow==0){G+="0"}else{G+=Math.floor(Math.abs(D.tilerow/this.params.tileRowsPerFolder))*this.params.tileRowsPerFolder}if(D.tilecol<0){F="-"}if(D.tilecol==0){F+="0"}else{F+=Math.floor(Math.abs(D.tilecol/this.params.tileColumnsPerFolder))*this.params.tileColumnsPerFolder}var A="/S"+Math.floor(D.scaleindex)+"/"+this.params.basemaplayergroupname+"/R"+G+"/C"+F+"/"+(D.tilerow%this.params.tileRowsPerFolder)+"_"+(D.tilecol%this.params.tileColumnsPerFolder)+"."+this.params.format;if(this.params.querystring){A+="?"+this.params.querystring}B+=A;return B},CLASS_NAME:"OpenLayers.Layer.MapGuide"});OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{callbacks:null,displaySystem:"metric",geodesic:false,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:false,immediate:false,initialize:function(A,B){OpenLayers.Control.prototype.initialize.apply(this,[B]);var C={done:this.measureComplete,point:this.measurePartial};if(this.immediate){C.modify=this.measureImmediate}this.callbacks=OpenLayers.Util.extend(C,this.callbacks);this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions);this.handler=new A(this,this.callbacks,this.handlerOptions)},deactivate:function(){this.cancelDelay();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},cancel:function(){this.cancelDelay();this.handler.cancel()},setImmediate:function(A){this.immediate=A;if(this.immediate){this.callbacks.modify=this.measureImmediate}else{delete this.callbacks.modify}},updateHandler:function(B,C){var A=this.active;if(A){this.deactivate()}this.handler=new B(this,this.callbacks,C);if(A){this.activate()}},measureComplete:function(A){this.cancelDelay();this.measure(A,"measure")},measurePartial:function(A,B){this.cancelDelay();B=B.clone();if(this.handler.freehandMode(this.handler.evt)){this.measure(B,"measurepartial")}else{this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.delayedTrigger=null;this.measure(B,"measurepartial")},this),this.partialDelay)}},measureImmediate:function(B,A,C){if(C&&!this.handler.freehandMode(this.handler.evt)){this.cancelDelay();this.measure(A.geometry,"measurepartial")}},cancelDelay:function(){if(this.delayedTrigger!==null){window.clearTimeout(this.delayedTrigger);this.delayedTrigger=null}},measure:function(C,A){var D,B;if(C.CLASS_NAME.indexOf("LineString")>-1){D=this.getBestLength(C);B=1}else{D=this.getBestArea(C);B=2}this.events.triggerEvent(A,{measure:D[0],units:D[1],order:B,geometry:C})},getBestArea:function(C){var E=this.displaySystemUnits[this.displaySystem];var B,F;for(var A=0,D=E.length;A<D;++A){B=E[A];F=this.getArea(C,B);if(F>1){break}}return[F,B]},getArea:function(C,E){var F,D;if(this.geodesic){F=C.getGeodesicArea(this.map.getProjectionObject());D="m"}else{F=C.getArea();D=this.map.getUnits()}var A=OpenLayers.INCHES_PER_UNIT[E];if(A){var B=OpenLayers.INCHES_PER_UNIT[D];F*=Math.pow((B/A),2)}return F},getBestLength:function(D){var F=this.displaySystemUnits[this.displaySystem];var C,A;for(var B=0,E=F.length;B<E;++B){C=F[B];A=this.getLength(D,C);if(A>1){break}}return[A,C]},getLength:function(C,E){var B,D;if(this.geodesic){B=C.getGeodesicLength(this.map.getProjectionObject());D="m"}else{B=C.getLength();D=this.map.getUnits()}var A=OpenLayers.INCHES_PER_UNIT[E];if(A){var F=OpenLayers.INCHES_PER_UNIT[D];B*=(F/A)}return B},CLASS_NAME:"OpenLayers.Control.Measure"});OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd",initialize:function(A){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[A])},read_wmc_SRS:function(F,C){var B=this.getChildValue(C);if(typeof F.projections!="object"){F.projections={}}var E=B.split(/ +/);for(var A=0,D=E.length;A<D;A++){F.projections[E[A]]=true}},write_wmc_Layer:function(A){var B=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[A]);if(A.srs){var D=[];for(var C in A.srs){D.push(C)}B.appendChild(this.createElementDefaultNS("SRS",D.join(" ")))}B.appendChild(this.write_wmc_FormatList(A));B.appendChild(this.write_wmc_StyleList(A));if(A.dimensions){B.appendChild(this.write_wmc_DimensionList(A))}B.appendChild(this.write_wmc_LayerExtension(A))},CLASS_NAME:"OpenLayers.Format.WMC.v1_0_0"});OpenLayers.Popup.AnchoredPopup=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,popupType:"popup",keepInMap:true,disableFirefoxOverflowHack:true,anchor:null,initialize:function(E,F,C,D,A,H,B){var G=[E,F,C,D,H,B];if(E==null){E=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")}this.id=E;this.lonlat=F;this.contentSize=(C!=null)?C:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT);if(D!=null){this.contentHTML=D}this.backgroundColor=OpenLayers.Popup.COLOR;this.opacity=OpenLayers.Popup.OPACITY;this.border=OpenLayers.Popup.BORDER;this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden");this.div.className=this.displayClass;this.div.innerHTML=D;if(H){this.addCloseBox(B)}this.registerEvents();this.anchor=(A!=null)?A:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.anchor=null;this.relativePosition=null;this.id=null;this.lonlat=null;this.size=null;this.contentHTML=null;this.backgroundColor=null;this.opacity=null;this.border=null;if(this.closeOnMove&&this.map){this.map.events.unregister("movestart",this,this.hide)}this.events.destroy();this.events=null;if(this.closeDiv){OpenLayers.Event.stopObservingElement(this.closeDiv)}this.closeDiv=null;if(this.map!=null){this.map.removePopup(this)}this.map=null;this.div=null;this.autoSize=null;this.minSize=null;this.maxSize=null;this.padding=null;this.panMapIfOutOfView=null},show:function(){this.updatePosition();OpenLayers.Popup.prototype.show.apply(this,arguments)},moveTo:function(C){var D=this.relativePosition;this.relativePosition=this.calculateRelativePosition(C);var B=this.calculateNewPx(C);var A=new Array(B);OpenLayers.Popup.prototype.moveTo.apply(this,A);if(this.relativePosition!=D){this.updateRelativePosition()}},setSize:function(B){OpenLayers.Popup.prototype.setSize.apply(this,arguments);if((this.lonlat)&&(this.map)){var A=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(A)}},calculateRelativePosition:function(C){var A=this.map.getLonLatFromLayerPx(C);var B=this.map.getExtent();var D=B.determineQuadrant(A);return OpenLayers.Bounds.oppositeQuadrant(D)},updateRelativePosition:function(){},calculateNewPx:function(B){var A=B.offset(this.anchor.offset);A.y+=this.anchor.size.h;A.x+=this.anchor.size.w;return A},CLASS_NAME:"OpenLayers.Popup.AnchoredPopup"});OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:true,anchor:null,initialize:function(E,F,C,D,A,H,B){var G=[E,F,C,D,H,B];OpenLayers.Popup.prototype.initialize.apply(this,G);this.anchor=(A!=null)?A:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.anchor=null;this.relativePosition=null;OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition();OpenLayers.Popup.prototype.show.apply(this,arguments)},moveTo:function(A){var B=this.relativePosition;this.relativePosition=this.calculateRelativePosition(A);OpenLayers.Popup.prototype.moveTo.call(this,this.calculateNewPx(A));if(this.relativePosition!=B){this.updateRelativePosition()}},setSize:function(B){OpenLayers.Popup.prototype.setSize.apply(this,arguments);if((this.lonlat)&&(this.map)){var A=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(A)}},calculateRelativePosition:function(C){var A=this.map.getLonLatFromLayerPx(C);var B=this.map.getExtent();var D=B.determineQuadrant(A);return OpenLayers.Bounds.oppositeQuadrant(D)},updateRelativePosition:function(){},calculateNewPx:function(E){var D=E.offset(this.anchor.offset);var A=this.size||this.contentSize;var C=(this.relativePosition.charAt(0)=="t");D.y+=(C)?-A.h:this.anchor.size.h;var B=(this.relativePosition.charAt(1)=="l");D.x+=(B)?-A.w:this.anchor.size.w;return D},CLASS_NAME:"OpenLayers.Popup.Anchored"});OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:false,positionBlocks:null,blocks:null,fixedRelativePosition:false,initialize:function(G,A,C,D,F,B,E){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments);if(this.fixedRelativePosition){this.updateRelativePosition();this.calculateRelativePosition=function(H){return this.relativePosition}}this.contentDiv.style.position="absolute";this.contentDiv.style.zIndex=1;if(B){this.closeDiv.style.zIndex=1}this.groupDiv.style.position="absolute";this.groupDiv.style.top="0px";this.groupDiv.style.left="0px";this.groupDiv.style.height="100%";this.groupDiv.style.width="100%"},destroy:function(){this.imageSrc=null;this.imageSize=null;this.isAlphaImage=null;this.fixedRelativePosition=false;this.positionBlocks=null;for(var A=0;A<this.blocks.length;A++){var B=this.blocks[A];if(B.div){this.groupDiv.removeChild(B.div)}B.div=null}this.blocks=null;OpenLayers.Popup.Anchored.prototype.destroy.apply(this,arguments)},setBackgroundColor:function(A){},setBorder:function(){},setOpacity:function(A){},setSize:function(A){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.updateBlocks()},updateRelativePosition:function(){this.padding=this.positionBlocks[this.relativePosition].padding;if(this.closeDiv){var A=this.getContentDivPadding();this.closeDiv.style.right=A.right+this.padding.right+"px";this.closeDiv.style.top=A.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(B){var A=OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);A=A.offset(this.positionBlocks[this.relativePosition].offset);return A},createBlocks:function(){this.blocks=[];var E=null;for(var A in this.positionBlocks){E=A;break}var D=this.positionBlocks[E];for(var B=0;B<D.blocks.length;B++){var F={};this.blocks.push(F);var C=this.id+"_FrameDecorationDiv_"+B;F.div=OpenLayers.Util.createDiv(C,null,null,null,"absolute",null,"hidden",null);F.div.className="olFrameDecoration";this.groupDiv.appendChild(F.div)}},updateBlocks:function(){if(!this.blocks){this.createBlocks()}if(this.size&&this.relativePosition){var H=this.positionBlocks[this.relativePosition];for(var E=0;E<H.blocks.length;E++){var G=H.blocks[E];var F=this.blocks[E];var J=G.anchor.left;var I=G.anchor.bottom;var A=G.anchor.right;var C=G.anchor.top;var B=(isNaN(G.size.w))?this.size.w-(A+J):G.size.w;var D=(isNaN(G.size.h))?this.size.h-(I+C):G.size.h;F.div.style.width=(B<0?0:B)+"px";F.div.style.height=(D<0?0:D)+"px";F.div.style.left=(J!=null)?J+"px":"";F.div.style.bottom=(I!=null)?I+"px":"";F.div.style.right=(A!=null)?A+"px":"";F.div.style.top=(C!=null)?C+"px":"";F.div.style.backgroundPosition=G.position.x+"px "+G.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px";this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"OpenLayers.Popup.Framed"});OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:true,panMapIfOutOfView:true,imageSize:new OpenLayers.Size(1276,736),isAlphaImage:false,fixedRelativePosition:false,positionBlocks:{"tl":{"offset":new OpenLayers.Pixel(44,-32),"padding":new OpenLayers.Bounds(8,8,8,9),"blocks":[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,19,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,18,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,-32,0,null),position:new OpenLayers.Pixel(0,-688)}]},"tr":{"offset":new OpenLayers.Pixel(-45,-32),"padding":new OpenLayers.Bounds(8,8,8,9),"blocks":[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,19,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,18,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0,-32,null,null),position:new OpenLayers.Pixel(-215,-687)}]},"bl":{"offset":new OpenLayers.Pixel(45,32),"padding":new OpenLayers.Bounds(8,9,8,8),"blocks":[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,-32),position:new OpenLayers.Pixel(-101,-674)}]},"br":{"offset":new OpenLayers.Pixel(-44,32),"padding":new OpenLayers.Bounds(8,9,8,8),"blocks":[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,-32),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(1200,660),initialize:function(G,A,C,D,F,B,E){this.imageSrc=OpenLayers.Util.getImageLocation("cloud-popup-relative.png");OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments);this.contentDiv.className=this.contentDisplayClass},CLASS_NAME:"OpenLayers.Popup.FramedCloud"});OpenLayers.Tile.Image.IFrame={useIFrame:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",draw:function(){var D=OpenLayers.Tile.Image.prototype.shouldDraw.call(this);if(D){var C=this.layer.getURL(this.bounds);var A=this.useIFrame;this.useIFrame=this.maxGetUrlLength!==null&&!this.layer.async&&C.length>this.maxGetUrlLength;var B=A&&!this.useIFrame;var E=!A&&this.useIFrame;if(B||E){if(this.imgDiv&&this.imgDiv.parentNode===this.frame){this.frame.removeChild(this.imgDiv)}this.imgDiv=null;if(B){this.frame.removeChild(this.frame.firstChild)}}}return OpenLayers.Tile.Image.prototype.draw.apply(this,arguments)},getImage:function(){if(this.useIFrame===true){if(!this.frame.childNodes.length){var C=document.createElement("div"),B=C.style;B.position="absolute";B.width="100%";B.height="100%";B.zIndex=1;B.backgroundImage="url("+this.blankImageUrl+")";this.frame.appendChild(C)}var D=this.id+"_iFrame",A;if(parseFloat(navigator.appVersion.split("MSIE")[1])<9){A=document.createElement('<iframe name="'+D+'">');A.style.backgroundColor="#FFFFFF";A.style.filter="chroma(color=#FFFFFF)"}else{A=document.createElement("iframe");A.style.backgroundColor="transparent";A.name=D}A.scrolling="no";A.marginWidth="0px";A.marginHeight="0px";A.frameBorder="0";A.style.position="absolute";A.style.width="100%";A.style.height="100%";if(this.layer.opacity<1){OpenLayers.Util.modifyDOMElement(A,null,null,null,null,null,null,this.layer.opacity)}this.frame.appendChild(A);this.imgDiv=A;return A}else{return OpenLayers.Tile.Image.prototype.getImage.apply(this,arguments)}},createRequestForm:function(){var B=document.createElement("form");B.method="POST";var A=this.layer.params["_OLSALT"];A=(A?A+"_":"")+this.bounds.toBBOX();B.action=OpenLayers.Util.urlAppend(this.layer.url,A);B.target=this.id+"_iFrame";var D=this.layer.getImageSize(),F=OpenLayers.Util.getParameters(this.url),E;for(var C in F){E=document.createElement("input");E.type="hidden";E.name=C;E.value=F[C];B.appendChild(E)}return B},setImgSrc:function(A){if(this.useIFrame===true){if(A){var B=this.createRequestForm();this.frame.appendChild(B);B.submit();this.frame.removeChild(B)}else{if(this.imgDiv.parentNode===this.frame){this.frame.removeChild(this.imgDiv);this.imgDiv=null}}}else{OpenLayers.Tile.Image.prototype.setImgSrc.apply(this,arguments)}},onImageLoad:function(){OpenLayers.Tile.Image.prototype.onImageLoad.apply(this,arguments);if(this.useIFrame===true){this.imgDiv.style.opacity=1;this.frame.style.opacity=this.layer.opacity}},createBackBuffer:function(){var A;if(this.useIFrame===false){A=OpenLayers.Tile.Image.prototype.createBackBuffer.call(this)}return A}};OpenLayers.Format.SOSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.SOSCapabilities"});OpenLayers.Format.SOSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.SOSCapabilities,{namespaces:{ows:"http://www.opengis.net/ows/1.1",sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},initialize:function(A){OpenLayers.Format.XML.prototype.initialize.apply(this,[A]);this.options=A},read:function(B){if(typeof B=="string"){B=OpenLayers.Format.XML.prototype.read.apply(this,[B])}if(B&&B.nodeType==9){B=B.documentElement}var A={};this.readNode(B,A);return A},readers:{"gml":OpenLayers.Util.applyDefaults({"name":function(B,A){A.name=this.getChildValue(B)},"TimePeriod":function(B,A){A.timePeriod={};this.readChildNodes(B,A.timePeriod)},"beginPosition":function(A,B){B.beginPosition=this.getChildValue(A)},"endPosition":function(A,B){B.endPosition=this.getChildValue(A)}},OpenLayers.Format.GML.v3.prototype.readers["gml"]),"sos":{"Capabilities":function(B,A){this.readChildNodes(B,A)},"Contents":function(B,A){A.contents={};this.readChildNodes(B,A.contents)},"ObservationOfferingList":function(A,B){B.offeringList={};this.readChildNodes(A,B.offeringList)},"ObservationOffering":function(A,B){var C=this.getAttributeNS(A,this.namespaces.gml,"id");B[C]={procedures:[],observedProperties:[],featureOfInterestIds:[],responseFormats:[],resultModels:[],responseModes:[]};this.readChildNodes(A,B[C])},"time":function(A,B){B.time={};this.readChildNodes(A,B.time)},"procedure":function(A,B){B.procedures.push(this.getAttributeNS(A,this.namespaces.xlink,"href"))},"observedProperty":function(A,B){B.observedProperties.push(this.getAttributeNS(A,this.namespaces.xlink,"href"))},"featureOfInterest":function(A,B){B.featureOfInterestIds.push(this.getAttributeNS(A,this.namespaces.xlink,"href"))},"responseFormat":function(A,B){B.responseFormats.push(this.getChildValue(A))},"resultModel":function(A,B){B.resultModels.push(this.getChildValue(A))},"responseMode":function(A,B){B.responseModes.push(this.getChildValue(A))}},"ows":OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers["ows"]},CLASS_NAME:"OpenLayers.Format.SOSCapabilities.v1_0_0"});OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,{started:false,stopDown:false,pinching:false,last:null,start:null,touchstart:function(B){var A=true;this.pinching=false;if(OpenLayers.Event.isMultiTouch(B)){this.started=true;this.last=this.start={distance:this.getDistance(B.touches),delta:0,scale:1};this.callback("start",[B,this.start]);A=!this.stopDown}else{if(this.started){return false}else{this.started=false;this.start=null;this.last=null}}OpenLayers.Event.preventDefault(B);return A},touchmove:function(A){if(this.started&&OpenLayers.Event.isMultiTouch(A)){this.pinching=true;var B=this.getPinchData(A);this.callback("move",[A,B]);this.last=B;OpenLayers.Event.stop(A)}else{if(this.started){return false}}return true},touchend:function(A){if(this.started&&!OpenLayers.Event.isMultiTouch(A)){this.started=false;this.pinching=false;this.callback("done",[A,this.start,this.last]);this.start=null;this.last=null;return false}return true},activate:function(){var A=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.pinching=false;A=true}return A},deactivate:function(){var A=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.started=false;this.pinching=false;this.start=null;this.last=null;A=true}return A},getDistance:function(A){var B=A[0];var C=A[1];return Math.sqrt(Math.pow(B.olClientX-C.olClientX,2)+Math.pow(B.olClientY-C.olClientY,2))},getPinchData:function(A){var C=this.getDistance(A.touches);var B=C/this.start.distance;return{distance:C,delta:this.last.distance-C,scale:B}},CLASS_NAME:"OpenLayers.Handler.Pinch"});OpenLayers.Control.NavToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(A){OpenLayers.Control.Panel.prototype.initialize.apply(this,[A]);this.addControls([new OpenLayers.Control.Navigation(),new OpenLayers.Control.ZoomBox()])},draw:function(){var A=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);if(this.defaultControl===null){this.defaultControl=this.controls[0]}return A},CLASS_NAME:"OpenLayers.Control.NavToolbar"});OpenLayers.Strategy.Refresh=OpenLayers.Class(OpenLayers.Strategy,{force:false,interval:0,timer:null,activate:function(){var A=OpenLayers.Strategy.prototype.activate.call(this);if(A){if(this.layer.visibility===true){this.start()}this.layer.events.on({"visibilitychanged":this.reset,scope:this})}return A},deactivate:function(){var A=OpenLayers.Strategy.prototype.deactivate.call(this);if(A){this.stop();this.layer.events.un({"visibilitychanged":this.reset,scope:this})}return A},reset:function(){if(this.layer.visibility===true){this.start()}else{this.stop()}},start:function(){if(this.interval&&typeof this.interval==="number"&&this.interval>0){this.timer=window.setInterval(OpenLayers.Function.bind(this.refresh,this),this.interval)}},refresh:function(){if(this.layer&&this.layer.refresh&&typeof this.layer.refresh=="function"){this.layer.refresh({force:this.force})}},stop:function(){if(this.timer!==null){window.clearInterval(this.timer);this.timer=null}},CLASS_NAME:"OpenLayers.Strategy.Refresh"});OpenLayers.Layer.ArcGIS93Rest=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{format:"png"},isBaseLayer:true,initialize:function(C,A,E,B){var D=[];E=OpenLayers.Util.upperCaseObject(E);D.push(C,A,E,B);OpenLayers.Layer.Grid.prototype.initialize.apply(this,D);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if((B==null)||(!B.isBaseLayer)){this.isBaseLayer=false}if(this.params.FORMAT=="jpg"){this.params.FORMAT=OpenLayers.Util.alphaHack()?"gif":"png"}}},clone:function(A){if(A==null){A=new OpenLayers.Layer.ArcGIS93Rest(this.name,this.url,this.params,this.getOptions())}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);return A},getURL:function(B){B=this.adjustBounds(B);var G=this.projection.getCode().split(":");var E=G[G.length-1];var D=this.getImageSize();var C={"BBOX":B.toBBOX(),"SIZE":D.w+","+D.h,"F":"image","BBOXSR":E,"IMAGESR":E};if(this.layerDefs){var F=[];var A;for(A in this.layerDefs){if(this.layerDefs.hasOwnProperty(A)){if(this.layerDefs[A]){F.push(A);F.push(":");F.push(this.layerDefs[A]);F.push(";")}}}if(F.length>0){C["LAYERDEFS"]=F.join("")}}var H=this.getFullRequestString(C);return H},setLayerFilter:function(B,A){if(!this.layerDefs){this.layerDefs={}}if(A){this.layerDefs[B]=A}else{delete this.layerDefs[B]}},clearLayerFilter:function(A){if(A){delete this.layerDefs[A]}else{delete this.layerDefs}},mergeNewParams:function(B){var A=OpenLayers.Util.upperCaseObject(B);var C=[A];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,C)},CLASS_NAME:"OpenLayers.Layer.ArcGIS93Rest"});OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:false,px:null,timerId:null,mousemove:function(A){if(this.passesTolerance(A.xy)){this.clearTimer();this.callback("move",[A]);this.px=A.xy;A=OpenLayers.Util.extend({},A);this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,A),this.delay)}return !this.stopMove},mouseout:function(A){if(OpenLayers.Util.mouseLeft(A,this.map.viewPortDiv)){this.clearTimer();this.callback("move",[A])}return true},passesTolerance:function(C){var A=true;if(this.pixelTolerance&&this.px){var B=Math.sqrt(Math.pow(this.px.x-C.x,2)+Math.pow(this.px.y-C.y,2));if(B<this.pixelTolerance){A=false}}return A},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null}},delayedCall:function(A){this.callback("pause",[A])},deactivate:function(){var A=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();A=true}return A},CLASS_NAME:"OpenLayers.Handler.Hover"});OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,{protocol:null,multipleKey:null,toggleKey:null,modifiers:null,multiple:false,click:true,single:true,clickout:true,toggle:false,clickTolerance:5,hover:false,box:false,maxFeatures:10,features:null,hoverFeature:null,handlers:null,hoverResponse:null,filterType:OpenLayers.Filter.Spatial.BBOX,initialize:function(A){A.handlerOptions=A.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[A]);this.features={};this.handlers={};if(this.click){this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.selectClick},this.handlerOptions.click||{})}if(this.box){this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},OpenLayers.Util.extend(this.handlerOptions.box,{boxDivClassName:"olHandlerBoxSelectFeature"}))}if(this.hover){this.handlers.hover=new OpenLayers.Handler.Hover(this,{"move":this.cancelHover,"pause":this.selectHover},OpenLayers.Util.extend(this.handlerOptions.hover,{"delay":250,"pixelTolerance":2}))}},activate:function(){if(!this.active){for(var A in this.handlers){this.handlers[A].activate()}}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active){for(var A in this.handlers){this.handlers[A].deactivate()}}return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},selectClick:function(B){var A=this.pixelToBounds(B.xy);this.setModifiers(B);this.request(A,{single:this.single})},selectBox:function(C){var B;if(C instanceof OpenLayers.Bounds){var A=this.map.getLonLatFromPixel({x:C.left,y:C.bottom});var D=this.map.getLonLatFromPixel({x:C.right,y:C.top});B=new OpenLayers.Bounds(A.lon,A.lat,D.lon,D.lat)}else{if(this.click){return}B=this.pixelToBounds(C)}this.setModifiers(this.handlers.box.dragHandler.evt);this.request(B)},selectHover:function(B){var A=this.pixelToBounds(B.xy);this.request(A,{single:true,hover:true})},cancelHover:function(){if(this.hoverResponse){this.protocol.abort(this.hoverResponse);this.hoverResponse=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")}},request:function(A,B){B=B||{};var C=new OpenLayers.Filter.Spatial({type:this.filterType,value:A});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");var D=this.protocol.read({maxFeatures:B.single==true?this.maxFeatures:undefined,filter:C,callback:function(E){if(E.success()){if(E.features.length){if(B.single==true){this.selectBestFeature(E.features,A.getCenterLonLat(),B)}else{this.select(E.features)}}else{if(B.hover){this.hoverSelect()}else{this.events.triggerEvent("clickout");if(this.clickout){this.unselectAll()}}}}OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},scope:this});if(B.hover==true){this.hoverResponse=D}},selectBestFeature:function(B,C,E){E=E||{};if(B.length){var H=new OpenLayers.Geometry.Point(C.lon,C.lat);var I,A,G;var F=Number.MAX_VALUE;for(var D=0;D<B.length;++D){I=B[D];if(I.geometry){G=H.distanceTo(I.geometry,{edge:false});if(G<F){F=G;A=I;if(F==0){break}}}}if(E.hover==true){this.hoverSelect(A)}else{this.select(A||B)}}},setModifiers:function(A){this.modifiers={multiple:this.multiple||(this.multipleKey&&A[this.multipleKey]),toggle:this.toggle||(this.toggleKey&&A[this.toggleKey])}},select:function(A){if(!this.modifiers.multiple&&!this.modifiers.toggle){this.unselectAll()}if(!(OpenLayers.Util.isArray(A))){A=[A]}var D=this.events.triggerEvent("beforefeaturesselected",{features:A});if(D!==false){var F=[];var B;for(var C=0,E=A.length;C<E;++C){B=A[C];if(this.features[B.fid||B.id]){if(this.modifiers.toggle){this.unselect(this.features[B.fid||B.id])}}else{D=this.events.triggerEvent("beforefeatureselected",{feature:B});if(D!==false){this.features[B.fid||B.id]=B;F.push(B);this.events.triggerEvent("featureselected",{feature:B})}}}this.events.triggerEvent("featuresselected",{features:F})}},hoverSelect:function(A){var C=A?A.fid||A.id:null;var B=this.hoverFeature?this.hoverFeature.fid||this.hoverFeature.id:null;if(B&&B!=C){this.events.triggerEvent("outfeature",{feature:this.hoverFeature});this.hoverFeature=null}if(C&&C!=B){this.events.triggerEvent("hoverfeature",{feature:A});this.hoverFeature=A}},unselect:function(A){delete this.features[A.fid||A.id];this.events.triggerEvent("featureunselected",{feature:A})},unselectAll:function(){for(var A in this.features){this.unselect(this.features[A])}},setMap:function(B){for(var A in this.handlers){this.handlers[A].setMap(B)}OpenLayers.Control.prototype.setMap.apply(this,arguments)},pixelToBounds:function(A){var C=A.add(-this.clickTolerance/2,this.clickTolerance/2);var E=A.add(this.clickTolerance/2,-this.clickTolerance/2);var B=this.map.getLonLatFromPixel(C);var D=this.map.getLonLatFromPixel(E);return new OpenLayers.Bounds(B.lon,B.lat,D.lon,D.lat)},CLASS_NAME:"OpenLayers.Control.GetFeature"});OpenLayers.Format.QueryStringFilter=(function(){var B={};B[OpenLayers.Filter.Comparison.EQUAL_TO]="eq";B[OpenLayers.Filter.Comparison.NOT_EQUAL_TO]="ne";B[OpenLayers.Filter.Comparison.LESS_THAN]="lt";B[OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO]="lte";B[OpenLayers.Filter.Comparison.GREATER_THAN]="gt";B[OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO]="gte";B[OpenLayers.Filter.Comparison.LIKE]="ilike";function A(C){C=C.replace(/%/g,"\\%");C=C.replace(/\\\\\.(\*)?/g,function(E,D){return D?E:"\\\\_"});C=C.replace(/\\\\\.\*/g,"\\\\%");C=C.replace(/(\\)?\.(\*)?/g,function(F,D,E){return D||E?F:"_"});C=C.replace(/(\\)?\.\*/g,function(E,D){return D?E:"%"});C=C.replace(/\\\./g,".");C=C.replace(/(\\)?\\\*/g,function(E,D){return D?E:"*"});return C}return OpenLayers.Class(OpenLayers.Format,{wildcarded:false,srsInBBOX:false,write:function(E,H){H=H||{};var D=E.CLASS_NAME;var C=D.substring(D.lastIndexOf(".")+1);switch(C){case"Spatial":switch(E.type){case OpenLayers.Filter.Spatial.BBOX:H.bbox=E.value.toArray();if(this.srsInBBOX&&E.projection){H.bbox.push(E.projection.getCode())}break;case OpenLayers.Filter.Spatial.DWITHIN:H.tolerance=E.distance;case OpenLayers.Filter.Spatial.WITHIN:H.lon=E.value.x;H.lat=E.value.y;break;default:OpenLayers.Console.warn("Unknown spatial filter type "+E.type)}break;case"Comparison":var J=B[E.type];if(J!==undefined){var F=E.value;if(E.type==OpenLayers.Filter.Comparison.LIKE){F=A(F);if(this.wildcarded){F="%"+F+"%"}}H[E.property+"__"+J]=F;H.queryable=H.queryable||[];H.queryable.push(E.property)}else{OpenLayers.Console.warn("Unknown comparison filter type "+E.type)}break;case"Logical":if(E.type===OpenLayers.Filter.Logical.AND){for(var G=0,I=E.filters.length;G<I;G++){H=this.write(E.filters[G],H)}}else{OpenLayers.Console.warn("Unsupported logical filter type "+E.type)}break;default:OpenLayers.Console.warn("Unknown filter type "+C)}return H},CLASS_NAME:"OpenLayers.Format.QueryStringFilter"})})();OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{autoActivate:true,element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,emptyString:null,lastXy:null,displayProjection:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.map.events.register("mousemove",this,this.redraw);this.map.events.register("mouseout",this,this.reset);this.redraw();return true}else{return false}},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.map.events.unregister("mousemove",this,this.redraw);this.map.events.unregister("mouseout",this,this.reset);this.element.innerHTML="";return true}else{return false}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.div.left="";this.div.top="";this.element=this.div}return this.div},redraw:function(B){var A;if(B==null){this.reset();return}else{if(this.lastXy==null||Math.abs(B.xy.x-this.lastXy.x)>this.granularity||Math.abs(B.xy.y-this.lastXy.y)>this.granularity){this.lastXy=B.xy;return}A=this.map.getLonLatFromPixel(B.xy);if(!A){return}if(this.displayProjection){A.transform(this.map.getProjectionObject(),this.displayProjection)}this.lastXy=B.xy}var C=this.formatOutput(A);if(C!=this.element.innerHTML){this.element.innerHTML=C}},reset:function(A){if(this.emptyString!=null){this.element.innerHTML=this.emptyString}},formatOutput:function(A){var C=parseInt(this.numDigits);var B=this.prefix+A.lon.toFixed(C)+this.separator+A.lat.toFixed(C)+this.suffix;return B},CLASS_NAME:"OpenLayers.Control.MousePosition"});OpenLayers.Control.Geolocate=OpenLayers.Class(OpenLayers.Control,{geolocation:null,available:("geolocation" in navigator),bind:true,watch:false,geolocationOptions:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){if(this.available&&!this.geolocation){this.geolocation=navigator.geolocation}if(!this.geolocation){this.events.triggerEvent("locationuncapable");return false}if(OpenLayers.Control.prototype.activate.apply(this,arguments)){if(this.watch){this.watchId=this.geolocation.watchPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions)}else{this.getCurrentLocation()}return true}return false},deactivate:function(){if(this.active&&this.watchId!==null){this.geolocation.clearWatch(this.watchId)}return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},geolocate:function(B){var A=new OpenLayers.LonLat(B.coords.longitude,B.coords.latitude).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject());if(this.bind){this.map.setCenter(A)}this.events.triggerEvent("locationupdated",{position:B,point:new OpenLayers.Geometry.Point(A.lon,A.lat)})},getCurrentLocation:function(){if(!this.active||this.watch){return false}this.geolocation.getCurrentPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions);return true},failure:function(A){this.events.triggerEvent("locationfailed",{error:A})},CLASS_NAME:"OpenLayers.Control.Geolocate"});OpenLayers.Tile.UTFGrid=OpenLayers.Class(OpenLayers.Tile,{url:null,utfgridResolution:2,json:null,format:null,destroy:function(){this.clear();OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var B=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(B){if(this.isLoading){this.abortLoading();this.events.triggerEvent("reload")}else{this.isLoading=true;this.events.triggerEvent("loadstart")}this.url=this.layer.getURL(this.bounds);if(this.layer.useJSONP){var A=new OpenLayers.Protocol.Script({url:this.url,callback:function(C){this.isLoading=false;this.events.triggerEvent("loadend");this.json=C.data},scope:this});A.read();this.request=A}else{this.request=OpenLayers.Request.GET({url:this.url,callback:function(C){this.isLoading=false;this.events.triggerEvent("loadend");if(C.status===200){this.parseData(C.responseText)}},scope:this})}}else{this.unload()}return B},abortLoading:function(){if(this.request){this.request.abort();delete this.request}this.isLoading=false},getFeatureInfo:function(A,C){var B=null;if(this.json){var D=this.getFeatureId(A,C);if(D!==null){B={id:D,data:this.json.data[D]}}}return B},getFeatureId:function(E,C){var G=null;if(this.json){var H=this.utfgridResolution;var F=Math.floor(C/H);var I=Math.floor(E/H);var D=this.json.grid[F].charCodeAt(I);var A=this.indexFromCharCode(D);var B=this.json.keys;if(!isNaN(A)&&(A in B)){G=B[A]}}return G},indexFromCharCode:function(A){if(A>=93){A--}if(A>=35){A--}return A-32},parseData:function(A){if(!this.format){this.format=new OpenLayers.Format.JSON()}this.json=this.format.read(A)},clear:function(){this.json=null},CLASS_NAME:"OpenLayers.Tile.UTFGrid"});OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:false,updateWithPOST:false,deleteWithPOST:false,wildcarded:false,srsInBBOX:false,initialize:function(B){B=B||{};this.params={};this.headers={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var A=new OpenLayers.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams=function(C,D){return A.write(C,D)}}},destroy:function(){this.params=null;this.headers=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(B){OpenLayers.Protocol.prototype.read.apply(this,arguments);B=B||{};B.params=OpenLayers.Util.applyDefaults(B.params,this.options.params);B=OpenLayers.Util.applyDefaults(B,this.options);if(B.filter&&this.filterToParams){B.params=this.filterToParams(B.filter,B.params)}var C=(B.readWithPOST!==undefined)?B.readWithPOST:this.readWithPOST;var D=new OpenLayers.Protocol.Response({requestType:"read"});if(C){var A=B.headers||{};A["Content-Type"]="application/x-www-form-urlencoded";D.priv=OpenLayers.Request.POST({url:B.url,callback:this.createCallback(this.handleRead,D,B),data:OpenLayers.Util.getParameterString(B.params),headers:A})}else{D.priv=OpenLayers.Request.GET({url:B.url,callback:this.createCallback(this.handleRead,D,B),params:B.params,headers:B.headers})}return D},handleRead:function(B,A){this.handleResponse(B,A)},create:function(A,B){B=OpenLayers.Util.applyDefaults(B,this.options);var C=new OpenLayers.Protocol.Response({reqFeatures:A,requestType:"create"});C.priv=OpenLayers.Request.POST({url:B.url,callback:this.createCallback(this.handleCreate,C,B),headers:B.headers,data:this.format.write(A)});return C},handleCreate:function(B,A){this.handleResponse(B,A)},update:function(A,C){C=C||{};var B=C.url||A.url||this.options.url+"/"+A.fid;C=OpenLayers.Util.applyDefaults(C,this.options);var E=new OpenLayers.Protocol.Response({reqFeatures:A,requestType:"update"});var D=this.updateWithPOST?"POST":"PUT";E.priv=OpenLayers.Request[D]({url:B,callback:this.createCallback(this.handleUpdate,E,C),headers:C.headers,data:this.format.write(A)});return E},handleUpdate:function(B,A){this.handleResponse(B,A)},"delete":function(A,D){D=D||{};var B=D.url||A.url||this.options.url+"/"+A.fid;D=OpenLayers.Util.applyDefaults(D,this.options);var F=new OpenLayers.Protocol.Response({reqFeatures:A,requestType:"delete"});var E=this.deleteWithPOST?"POST":"DELETE";var C={url:B,callback:this.createCallback(this.handleDelete,F,D),headers:D.headers};if(this.deleteWithPOST){C.data=this.format.write(A)}F.priv=OpenLayers.Request[E](C);return F},handleDelete:function(B,A){this.handleResponse(B,A)},handleResponse:function(C,B){var A=C.priv;if(B.callback){if(A.status>=200&&A.status<300){if(C.requestType!="delete"){C.features=this.parseFeatures(A)}C.code=OpenLayers.Protocol.Response.SUCCESS}else{C.code=OpenLayers.Protocol.Response.FAILURE}B.callback.call(B.scope,C)}},parseFeatures:function(A){var B=A.responseXML;if(!B||!B.documentElement){B=A.responseText}if(!B||B.length<=0){return null}return this.format.read(B)},commit:function(P,K){K=OpenLayers.Util.applyDefaults(K,this.options);var L=[],F=0;var I={};I[OpenLayers.State.INSERT]=[];I[OpenLayers.State.UPDATE]=[];I[OpenLayers.State.DELETE]=[];var O,E,C=[];for(var J=0,N=P.length;J<N;++J){O=P[J];E=I[O.state];if(E){E.push(O);C.push(O)}}var B=(I[OpenLayers.State.INSERT].length>0?1:0)+I[OpenLayers.State.UPDATE].length+I[OpenLayers.State.DELETE].length;var H=true;var D=new OpenLayers.Protocol.Response({reqFeatures:C});function M(T){var S=T.features?T.features.length:0;var R=new Array(S);for(var Q=0;Q<S;++Q){R[Q]=T.features[Q].fid}D.insertIds=R;A.apply(this,[T])}function A(Q){this.callUserCallback(Q,K);H=H&&Q.success();F++;if(F>=B){if(K.callback){D.code=H?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE;K.callback.apply(K.scope,[D])}}}var G=I[OpenLayers.State.INSERT];if(G.length>0){L.push(this.create(G,OpenLayers.Util.applyDefaults({callback:M,scope:this},K.create)))}G=I[OpenLayers.State.UPDATE];for(var J=G.length-1;J>=0;--J){L.push(this.update(G[J],OpenLayers.Util.applyDefaults({callback:A,scope:this},K.update)))}G=I[OpenLayers.State.DELETE];for(var J=G.length-1;J>=0;--J){L.push(this["delete"](G[J],OpenLayers.Util.applyDefaults({callback:A,scope:this},K["delete"])))}return L},abort:function(A){if(A){A.priv.abort()}},callUserCallback:function(C,B){var A=B[C.requestType];if(A&&A.callback){A.callback.call(A.scope,C)}},CLASS_NAME:"OpenLayers.Protocol.HTTP"});OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:false,resolution:null,activate:function(){var A=OpenLayers.Strategy.prototype.activate.call(this);if(A){this.layer.events.on({"beforefeaturesadded":this.cacheFeatures,"featuresremoved":this.clearCache,"moveend":this.cluster,scope:this})}return A},deactivate:function(){var A=OpenLayers.Strategy.prototype.deactivate.call(this);if(A){this.clearCache();this.layer.events.un({"beforefeaturesadded":this.cacheFeatures,"featuresremoved":this.clearCache,"moveend":this.cluster,scope:this})}return A},cacheFeatures:function(B){var A=true;if(!this.clustering){this.clearCache();this.features=B.features;this.cluster();A=false}return A},clearCache:function(){if(!this.clustering){this.features=null}},cluster:function(D){if((!D||D.zoomChanged)&&this.features){var H=this.layer.map.getResolution();if(H!=this.resolution||!this.clustersExist()){this.resolution=H;var F=[];var J,A,B;for(var E=0;E<this.features.length;++E){J=this.features[E];if(J.geometry){A=false;for(var G=F.length-1;G>=0;--G){B=F[G];if(this.shouldCluster(B,J)){this.addToCluster(B,J);A=true;break}}if(!A){F.push(this.createCluster(this.features[E]))}}}this.clustering=true;this.layer.removeAllFeatures();this.clustering=false;if(F.length>0){if(this.threshold>1){var C=F.slice();F=[];var K;for(var E=0,I=C.length;E<I;++E){K=C[E];if(K.attributes.count<this.threshold){Array.prototype.push.apply(F,K.cluster)}else{F.push(K)}}}this.clustering=true;this.layer.addFeatures(F);this.clustering=false}this.clusters=F}}},clustersExist:function(){var B=false;if(this.clusters&&this.clusters.length>0&&this.clusters.length==this.layer.features.length){B=true;for(var A=0;A<this.clusters.length;++A){if(this.clusters[A]!=this.layer.features[A]){B=false;break}}}return B},shouldCluster:function(C,A){var B=C.geometry.getBounds().getCenterLonLat();var D=A.geometry.getBounds().getCenterLonLat();var E=(Math.sqrt(Math.pow((B.lon-D.lon),2)+Math.pow((B.lat-D.lat),2))/this.resolution);return(E<=this.distance)},addToCluster:function(B,A){B.cluster.push(A);B.attributes.count+=1},createCluster:function(A){var B=A.geometry.getBounds().getCenterLonLat();var C=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(B.lon,B.lat),{count:1});C.cluster=[A];return C},CLASS_NAME:"OpenLayers.Strategy.Cluster"});OpenLayers.Strategy.Filter=OpenLayers.Class(OpenLayers.Strategy,{filter:null,cache:null,caching:false,activate:function(){var A=OpenLayers.Strategy.prototype.activate.apply(this,arguments);if(A){this.cache=[];this.layer.events.on({"beforefeaturesadded":this.handleAdd,"beforefeaturesremoved":this.handleRemove,scope:this})}return A},deactivate:function(){this.cache=null;if(this.layer&&this.layer.events){this.layer.events.un({"beforefeaturesadded":this.handleAdd,"beforefeaturesremoved":this.handleRemove,scope:this})}return OpenLayers.Strategy.prototype.deactivate.apply(this,arguments)},handleAdd:function(E){if(!this.caching&&this.filter){var A=E.features;E.features=[];var B;for(var C=0,D=A.length;C<D;++C){B=A[C];if(this.filter.evaluate(B)){E.features.push(B)}else{this.cache.push(B)}}}},handleRemove:function(A){if(!this.caching){this.cache=[]}},setFilter:function(B){this.filter=B;var A=this.cache;this.cache=[];this.handleAdd({features:this.layer.features});if(this.cache.length>0){this.caching=true;this.layer.removeFeatures(this.cache.slice());this.caching=false}if(A.length>0){var C={features:A};this.handleAdd(C);if(C.features.length>0){this.caching=true;this.layer.addFeatures(C.features);this.caching=false}}},CLASS_NAME:"OpenLayers.Strategy.Filter"});OpenLayers.Protocol.SOS=function(B){B=OpenLayers.Util.applyDefaults(B,OpenLayers.Protocol.SOS.DEFAULTS);var A=OpenLayers.Protocol.SOS["v"+B.version.replace(/\./g,"_")];if(!A){throw"Unsupported SOS version: "+B.version}return new A(B)};OpenLayers.Protocol.SOS.DEFAULTS={"version":"1.0.0"};OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:(/^\s*|\s*$/g)},namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},readers:{"xsd":{"schema":function(I,J){var L=[];var E={};var A={complexTypes:L,customTypes:E};var G,K;this.readChildNodes(I,A);var H=I.attributes;var F,B;for(G=0,K=H.length;G<K;++G){F=H[G];B=F.name;if(B.indexOf("xmlns")===0){this.setNamespace(B.split(":")[1]||"",F.value)}else{J[B]=F.value}}J.featureTypes=L;J.targetPrefix=this.namespaceAlias[J.targetNamespace];var D,C;for(G=0,K=L.length;G<K;++G){D=L[G];C=E[D.typeName];if(E[D.typeName]){D.typeName=C.name}}},"complexType":function(B,A){var C={"typeName":B.getAttribute("name")};this.readChildNodes(B,C);A.complexTypes.push(C)},"complexContent":function(B,A){this.readChildNodes(B,A)},"extension":function(B,A){this.readChildNodes(B,A)},"sequence":function(C,B){var A={elements:[]};this.readChildNodes(C,A);B.properties=A.elements},"element":function(G,H){var J;if(H.elements){var A={};var F=G.attributes;var C;for(var E=0,I=F.length;E<I;++E){C=F[E];A[C.name]=C.value}J=A.type;if(!J){J={};this.readChildNodes(G,J);A.restriction=J;A.type=J.base}var B=J.base||J;A.localType=B.split(":").pop();H.elements.push(A);this.readChildNodes(G,A)}if(H.complexTypes){J=G.getAttribute("type");var D=J.split(":").pop();H.customTypes[D]={"name":G.getAttribute("name"),"type":J}}},"annotation":function(B,A){A.annotation={};this.readChildNodes(B,A.annotation)},"appinfo":function(B,A){if(!A.appinfo){A.appinfo=[]}A.appinfo.push(this.getChildValue(B))},"documentation":function(B,A){if(!A.documentation){A.documentation=[]}var C=this.getChildValue(B);A.documentation.push({lang:B.getAttribute("xml:lang"),textContent:C.replace(this.regExes.trimSpace,"")})},"simpleType":function(B,A){this.readChildNodes(B,A)},"restriction":function(B,A){A.base=B.getAttribute("base");this.readRestriction(B,A)}}},readRestriction:function(F,G){var C=F.childNodes;var A,B,D;for(var E=0,H=C.length;E<H;++E){A=C[E];if(A.nodeType==1){B=A.nodeName.split(":").pop();D=A.getAttribute("value");if(!G[B]){G[B]=D}else{if(typeof G[B]=="string"){G[B]=[G[B]]}G[B].push(D)}}}},read:function(C){if(typeof C=="string"){C=OpenLayers.Format.XML.prototype.read.apply(this,[C])}if(C&&C.nodeType==9){C=C.documentElement}var A={};if(C.nodeName.split(":").pop()==="ExceptionReport"){var B=new OpenLayers.Format.OGCExceptionReport();A.error=B.read(C)}else{this.readNode(C,A)}return A},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"});OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:"http://backend.userland.com/rss2",featureNS:"http://mapserver.gis.umn.edu/mapserver",georssns:"http://www.georss.org/georss",geons:"http://www.w3.org/2003/01/geo/wgs84_pos#",featureTitle:"Untitled",featureDescription:"No Description",gmlParser:null,xy:false,createGeometryFromItem:function(O){var M=this.getElementsByTagNameNS(O,this.georssns,"point");var A=this.getElementsByTagNameNS(O,this.geons,"lat");var E=this.getElementsByTagNameNS(O,this.geons,"long");var B=this.getElementsByTagNameNS(O,this.georssns,"line");var I=this.getElementsByTagNameNS(O,this.georssns,"polygon");var C=this.getElementsByTagNameNS(O,this.georssns,"where");var G=this.getElementsByTagNameNS(O,this.georssns,"box");if(M.length>0||(A.length>0&&E.length>0)){var L;if(M.length>0){L=OpenLayers.String.trim(M[0].firstChild.nodeValue).split(/\s+/);if(L.length!=2){L=OpenLayers.String.trim(M[0].firstChild.nodeValue).split(/\s*,\s*/)}}else{L=[parseFloat(A[0].firstChild.nodeValue),parseFloat(E[0].firstChild.nodeValue)]}var N=new OpenLayers.Geometry.Point(L[1],L[0])}else{if(B.length>0){var K=OpenLayers.String.trim(this.getChildValue(B[0])).split(/\s+/);var H=[];var M;for(var J=0,F=K.length;J<F;J+=2){M=new OpenLayers.Geometry.Point(K[J+1],K[J]);H.push(M)}N=new OpenLayers.Geometry.LineString(H)}else{if(I.length>0){var K=OpenLayers.String.trim(this.getChildValue(I[0])).split(/\s+/);var H=[];var M;for(var J=0,F=K.length;J<F;J+=2){M=new OpenLayers.Geometry.Point(K[J+1],K[J]);H.push(M)}N=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(H)])}else{if(C.length>0){if(!this.gmlParser){this.gmlParser=new OpenLayers.Format.GML({"xy":this.xy})}var D=this.gmlParser.parseFeature(C[0]);N=D.geometry}else{if(G.length>0){var K=OpenLayers.String.trim(G[0].firstChild.nodeValue).split(/\s+/);var H=[];var M;if(K.length>3){M=new OpenLayers.Geometry.Point(K[1],K[0]);H.push(M);M=new OpenLayers.Geometry.Point(K[1],K[2]);H.push(M);M=new OpenLayers.Geometry.Point(K[3],K[2]);H.push(M);M=new OpenLayers.Geometry.Point(K[3],K[0]);H.push(M);M=new OpenLayers.Geometry.Point(K[1],K[0]);H.push(M)}N=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(H)])}}}}}if(N&&this.internalProjection&&this.externalProjection){N.transform(this.externalProjection,this.internalProjection)}return N},createFeatureFromItem:function(I){var D=this.createGeometryFromItem(I);var F=this._getChildValue(I,"*","title",this.featureTitle);var H=this._getChildValue(I,"*","description",this._getChildValue(I,"*","content",this._getChildValue(I,"*","summary",this.featureDescription)));var B=this._getChildValue(I,"*","link");if(!B){try{B=this.getElementsByTagNameNS(I,"*","link")[0].getAttribute("href")}catch(A){B=null}}var E=this._getChildValue(I,"*","id",null);var C={"title":F,"description":H,"link":B};var G=new OpenLayers.Feature.Vector(D,C);G.fid=E;return G},_getChildValue:function(A,C,B,F){var D;var E=this.getElementsByTagNameNS(A,C,B);if(E&&E[0]&&E[0].firstChild&&E[0].firstChild.nodeValue){D=this.getChildValue(E[0])}else{D=(F==undefined)?"":F}return D},read:function(E){if(typeof E=="string"){E=OpenLayers.Format.XML.prototype.read.apply(this,[E])}var D=null;D=this.getElementsByTagNameNS(E,"*","item");if(D.length==0){D=this.getElementsByTagNameNS(E,"*","entry")}var C=D.length;var A=new Array(C);for(var B=0;B<C;B++){A[B]=this.createFeatureFromItem(D[B])}return A},write:function(A){var C;if(OpenLayers.Util.isArray(A)){C=this.createElementNS(this.rssns,"rss");for(var B=0,D=A.length;B<D;B++){C.appendChild(this.createFeatureXML(A[B]))}}else{C=this.createFeatureXML(A)}return OpenLayers.Format.XML.prototype.write.apply(this,[C])},createFeatureXML:function(H){var A=this.buildGeometryNode(H.geometry);var G=this.createElementNS(this.rssns,"item");var I=this.createElementNS(this.rssns,"title");I.appendChild(this.createTextNode(H.attributes.title?H.attributes.title:""));var B=this.createElementNS(this.rssns,"description");B.appendChild(this.createTextNode(H.attributes.description?H.attributes.description:""));G.appendChild(I);G.appendChild(B);if(H.attributes.link){var C=this.createElementNS(this.rssns,"link");C.appendChild(this.createTextNode(H.attributes.link));G.appendChild(C)}for(var E in H.attributes){if(E=="link"||E=="title"||E=="description"){continue}var J=this.createTextNode(H.attributes[E]);var F=E;if(E.search(":")!=-1){F=E.split(":")[1]}var D=this.createElementNS(this.featureNS,"feature:"+F);D.appendChild(J);G.appendChild(D)}G.appendChild(A);return G},buildGeometryNode:function(B){if(this.internalProjection&&this.externalProjection){B=B.clone();B.transform(this.internalProjection,this.externalProjection)}var A;if(B.CLASS_NAME=="OpenLayers.Geometry.Polygon"){A=this.createElementNS(this.georssns,"georss:polygon");A.appendChild(this.buildCoordinatesNode(B.components[0]))}else{if(B.CLASS_NAME=="OpenLayers.Geometry.LineString"){A=this.createElementNS(this.georssns,"georss:line");A.appendChild(this.buildCoordinatesNode(B))}else{if(B.CLASS_NAME=="OpenLayers.Geometry.Point"){A=this.createElementNS(this.georssns,"georss:point");A.appendChild(this.buildCoordinatesNode(B))}else{throw"Couldn't parse "+B.CLASS_NAME}}}return A},buildCoordinatesNode:function(E){var D=null;if(E.components){D=E.components}var F;if(D){var C=D.length;var A=new Array(C);for(var B=0;B<C;B++){A[B]=D[B].y+" "+D[B].x}F=A.join(" ")}else{F=E.y+" "+E.x}return this.createTextNode(F)},CLASS_NAME:"OpenLayers.Format.GeoRSS"});OpenLayers.Format.WPSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.WPSCapabilities"});OpenLayers.Format.WPSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wps:"http://www.opengis.net/wps/1.0.0",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},initialize:function(A){OpenLayers.Format.XML.prototype.initialize.apply(this,[A])},read:function(B){if(typeof B=="string"){B=OpenLayers.Format.XML.prototype.read.apply(this,[B])}if(B&&B.nodeType==9){B=B.documentElement}var A={};this.readNode(B,A);return A},readers:{"wps":{"Capabilities":function(B,A){this.readChildNodes(B,A)},"ProcessOfferings":function(B,A){A.processOfferings={};this.readChildNodes(B,A.processOfferings)},"Process":function(A,B){var C=this.getAttributeNS(A,this.namespaces.wps,"processVersion");var D={processVersion:C};this.readChildNodes(A,D);B[D.identifier]=D},"Languages":function(B,A){A.languages=[];this.readChildNodes(B,A.languages)},"Default":function(C,A){var B={isDefault:true};this.readChildNodes(C,B);A.push(B)},"Supported":function(C,A){var B={};this.readChildNodes(C,B);A.push(B)}},"ows":OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers["ows"]},CLASS_NAME:"OpenLayers.Format.WPSCapabilities.v1_0_0"});OpenLayers.Control.PinchZoom=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,pinchOrigin:null,currentCenter:null,autoActivate:true,preserveCenter:false,initialize:function(A){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.handler=new OpenLayers.Handler.Pinch(this,{start:this.pinchStart,move:this.pinchMove,done:this.pinchDone},this.handlerOptions)},pinchStart:function(B,C){var A=(this.preserveCenter)?this.map.getPixelFromLonLat(this.map.getCenter()):B.xy;this.pinchOrigin=A;this.currentCenter=A},pinchMove:function(B,G){var C=G.scale;var D=this.map.layerContainerOriginPx;var A=this.pinchOrigin;var H=(this.preserveCenter)?this.map.getPixelFromLonLat(this.map.getCenter()):B.xy;var E=Math.round((D.x+H.x-A.x)+(C-1)*(D.x-A.x));var F=Math.round((D.y+H.y-A.y)+(C-1)*(D.y-A.y));this.map.applyTransform(E,F,C);this.currentCenter=H},pinchDone:function(A,B,E){this.map.applyTransform();var C=this.map.getZoomForResolution(this.map.getResolution()/E.scale,true);if(C!==this.map.getZoom()||!this.currentCenter.equals(this.pinchOrigin)){var G=this.map.getResolutionForZoom(C);var H=this.map.getLonLatFromPixel(this.pinchOrigin);var F=this.currentCenter;var D=this.map.getSize();H.lon+=G*((D.w/2)-F.x);H.lat-=G*((D.h/2)-F.y);this.map.div.clientWidth=this.map.div.clientWidth;this.map.setCenter(H,C)}},CLASS_NAME:"OpenLayers.Control.PinchZoom"});OpenLayers.Control.TouchNavigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,clickHandlerOptions:null,documentDrag:false,autoActivate:true,initialize:function(A){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();if(this.dragPan){this.dragPan.destroy()}this.dragPan=null;if(this.pinchZoom){this.pinchZoom.destroy();delete this.pinchZoom}OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.dragPan.activate();this.handlers.click.activate();this.pinchZoom.activate();return true}return false},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.dragPan.deactivate();this.handlers.click.deactivate();this.pinchZoom.deactivate();return true}return false},draw:function(){var B={click:this.defaultClick,dblclick:this.defaultDblClick};var A=OpenLayers.Util.extend({"double":true,stopDouble:true,pixelTolerance:2},this.clickHandlerOptions);this.handlers.click=new OpenLayers.Handler.Click(this,B,A);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.dragPan.draw();this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(A){if(A.lastTouches&&A.lastTouches.length==2){this.map.zoomOut()}},defaultDblClick:function(A){this.map.zoomTo(this.map.zoom+1,A.xy)},CLASS_NAME:"OpenLayers.Control.TouchNavigation"});OpenLayers.Console.warn("OpenLayers.Rico is deprecated");OpenLayers.Rico=OpenLayers.Rico||{};OpenLayers.Rico.Color=OpenLayers.Class({initialize:function(A,C,B){this.rgb={r:A,g:C,b:B}},setRed:function(A){this.rgb.r=A},setGreen:function(A){this.rgb.g=A},setBlue:function(A){this.rgb.b=A},setHue:function(A){var B=this.asHSB();B.h=A;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(B.h,B.s,B.b)},setSaturation:function(B){var A=this.asHSB();A.s=B;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(A.h,A.s,A.b)},setBrightness:function(B){var A=this.asHSB();A.b=B;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(A.h,A.s,A.b)},darken:function(A){var B=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(B.h,B.s,Math.max(B.b-A,0))},brighten:function(A){var B=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(B.h,B.s,Math.min(B.b+A,1))},blend:function(A){this.rgb.r=Math.floor((this.rgb.r+A.rgb.r)/2);this.rgb.g=Math.floor((this.rgb.g+A.rgb.g)/2);this.rgb.b=Math.floor((this.rgb.b+A.rgb.b)/2)},isBright:function(){var A=this.asHSB();return this.asHSB().b>0.5},isDark:function(){return !this.isBright()},asRGB:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return OpenLayers.Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}});OpenLayers.Rico.Color.createFromHex=function(E){if(E.length==4){var D=E;var E="#";for(var A=1;A<4;A++){E+=(D.charAt(A)+D.charAt(A))}}if(E.indexOf("#")==0){E=E.substring(1)}var C=E.substring(0,2);var F=E.substring(2,4);var B=E.substring(4,6);return new OpenLayers.Rico.Color(parseInt(C,16),parseInt(F,16),parseInt(B,16))};OpenLayers.Rico.Color.createColorFromBackground=function(B){var A=OpenLayers.Element.getStyle(OpenLayers.Util.getElement(B),"backgroundColor");if(A=="transparent"&&B.parentNode){return OpenLayers.Rico.Color.createColorFromBackground(B.parentNode)}if(A==null){return new OpenLayers.Rico.Color(255,255,255)}if(A.indexOf("rgb(")==0){var D=A.substring(4,A.length-1);var C=D.split(",");return new OpenLayers.Rico.Color(parseInt(C[0]),parseInt(C[1]),parseInt(C[2]))}else{if(A.indexOf("#")==0){return OpenLayers.Rico.Color.createFromHex(A)}else{return new OpenLayers.Rico.Color(255,255,255)}}};OpenLayers.Rico.Color.HSBtoRGB=function(G,A,C){var J=0;var F=0;var I=0;if(A==0){J=parseInt(C*255+0.5);F=J;I=J}else{var H=(G-Math.floor(G))*6;var K=H-Math.floor(H);var D=C*(1-A);var B=C*(1-A*K);var E=C*(1-(A*(1-K)));switch(parseInt(H)){case 0:J=(C*255+0.5);F=(E*255+0.5);I=(D*255+0.5);break;case 1:J=(B*255+0.5);F=(C*255+0.5);I=(D*255+0.5);break;case 2:J=(D*255+0.5);F=(C*255+0.5);I=(E*255+0.5);break;case 3:J=(D*255+0.5);F=(B*255+0.5);I=(C*255+0.5);break;case 4:J=(E*255+0.5);F=(D*255+0.5);I=(C*255+0.5);break;case 5:J=(C*255+0.5);F=(D*255+0.5);I=(B*255+0.5);break}}return{r:parseInt(J),g:parseInt(F),b:parseInt(I)}};OpenLayers.Rico.Color.RGBtoHSB=function(A,K,H){var G;var B;var D;var I=(A>K)?A:K;if(H>I){I=H}var J=(A<K)?A:K;if(H<J){J=H}D=I/255;if(I!=0){B=(I-J)/I}else{B=0}if(B==0){G=0}else{var F=(I-A)/(I-J);var C=(I-K)/(I-J);var E=(I-H)/(I-J);if(A==I){G=E-C}else{if(K==I){G=2+F-E}else{G=4+C-F}}G=G/6;if(G<0){G=G+1}}return{h:G,s:B,b:D}};OpenLayers.Style2=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:false,rules:null,initialize:function(A){OpenLayers.Util.extend(this,A);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var A=0,B=this.rules.length;A<B;A++){this.rules[A].destroy()}delete this.rules},clone:function(){var B=OpenLayers.Util.extend({},this);if(this.rules){B.rules=[];for(var A=0,C=this.rules.length;A<C;++A){B.rules.push(this.rules[A].clone())}}return new OpenLayers.Style2(B)},CLASS_NAME:"OpenLayers.Style2"});OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,{layer:null,wfsns:"http://www.opengis.net/wfs",ogcns:"http://www.opengis.net/ogc",initialize:function(B,A){OpenLayers.Format.GML.prototype.initialize.apply(this,[B]);this.layer=A;if(this.layer.featureNS){this.featureNS=this.layer.featureNS}if(this.layer.options.geometry_column){this.geometryName=this.layer.options.geometry_column}if(this.layer.options.typename){this.featureName=this.layer.options.typename}},write:function(A){var C=this.createElementNS(this.wfsns,"wfs:Transaction");C.setAttribute("version","1.0.0");C.setAttribute("service","WFS");for(var B=0;B<A.length;B++){switch(A[B].state){case OpenLayers.State.INSERT:C.appendChild(this.insert(A[B]));break;case OpenLayers.State.UPDATE:C.appendChild(this.update(A[B]));break;case OpenLayers.State.DELETE:C.appendChild(this.remove(A[B]));break}}return OpenLayers.Format.XML.prototype.write.apply(this,[C])},createFeatureXML:function(G){var A=this.buildGeometryNode(G.geometry);var F=this.createElementNS(this.featureNS,"feature:"+this.geometryName);F.appendChild(A);var B=this.createElementNS(this.featureNS,"feature:"+this.featureName);B.appendChild(F);for(var D in G.attributes){var H=this.createTextNode(G.attributes[D]);var E=D;if(D.search(":")!=-1){E=D.split(":")[1]}var C=this.createElementNS(this.featureNS,"feature:"+E);C.appendChild(H);B.appendChild(C)}return B},insert:function(A){var B=this.createElementNS(this.wfsns,"wfs:Insert");B.appendChild(this.createFeatureXML(A));return B},update:function(J){if(!J.fid){OpenLayers.Console.userError(OpenLayers.i18n("noFID"))}var G=this.createElementNS(this.wfsns,"wfs:Update");G.setAttribute("typeName",this.featurePrefix+":"+this.featureName);G.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var E=this.createElementNS(this.wfsns,"wfs:Property");var F=this.createElementNS(this.wfsns,"wfs:Name");var H=this.createTextNode(this.geometryName);F.appendChild(H);E.appendChild(F);var B=this.createElementNS(this.wfsns,"wfs:Value");var A=this.buildGeometryNode(J.geometry);if(J.layer){A.setAttribute("srsName",J.layer.projection.getCode())}B.appendChild(A);E.appendChild(B);G.appendChild(E);for(var C in J.attributes){E=this.createElementNS(this.wfsns,"wfs:Property");F=this.createElementNS(this.wfsns,"wfs:Name");F.appendChild(this.createTextNode(C));E.appendChild(F);B=this.createElementNS(this.wfsns,"wfs:Value");B.appendChild(this.createTextNode(J.attributes[C]));E.appendChild(B);G.appendChild(E)}var D=this.createElementNS(this.ogcns,"ogc:Filter");var I=this.createElementNS(this.ogcns,"ogc:FeatureId");I.setAttribute("fid",J.fid);D.appendChild(I);G.appendChild(D);return G},remove:function(A){if(!A.fid){OpenLayers.Console.userError(OpenLayers.i18n("noFID"));return false}var B=this.createElementNS(this.wfsns,"wfs:Delete");B.setAttribute("typeName",this.featurePrefix+":"+this.featureName);B.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var C=this.createElementNS(this.ogcns,"ogc:Filter");var D=this.createElementNS(this.ogcns,"ogc:FeatureId");D.setAttribute("fid",A.fid);C.appendChild(D);B.appendChild(C);return B},destroy:function(){this.layer=null},CLASS_NAME:"OpenLayers.Format.WFS"});OpenLayers.Format.SLD.v1_0_0_GeoServer=OpenLayers.Class(OpenLayers.Format.SLD.v1_0_0,{version:"1.0.0",profile:"GeoServer",readers:OpenLayers.Util.applyDefaults({"sld":OpenLayers.Util.applyDefaults({"Priority":function(B,A){var C=this.readers.ogc._expression.call(this,B);if(C){A.priority=C}},"VendorOption":function(B,A){if(!A.vendorOptions){A.vendorOptions={}}A.vendorOptions[B.getAttribute("name")]=this.getChildValue(B)},"TextSymbolizer":function(B,A){OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld.TextSymbolizer.apply(this,arguments);var C=this.multipleSymbolizers?A.symbolizers[A.symbolizers.length-1]:A.symbolizer["Text"];if(C.graphic===undefined){C.graphic=false}}},OpenLayers.Format.SLD.v1_0_0.prototype.readers["sld"])},OpenLayers.Format.SLD.v1_0_0.prototype.readers),writers:OpenLayers.Util.applyDefaults({"sld":OpenLayers.Util.applyDefaults({"Priority":function(A){return this.writers.sld._OGCExpression.call(this,"sld:Priority",A)},"VendorOption":function(A){return this.createElementNSPlus("sld:VendorOption",{attributes:{name:A.name},value:A.value})},"TextSymbolizer":function(A){var C=OpenLayers.Format.SLD.v1_0_0.prototype.writers;var B=C["sld"]["TextSymbolizer"].apply(this,arguments);if(A.graphic!==false&&(A.externalGraphic||A.graphicName)){this.writeNode("Graphic",A,B)}if("priority" in A){this.writeNode("Priority",A.priority,B)}return this.addVendorOptions(B,A)},"PointSymbolizer":function(A){var C=OpenLayers.Format.SLD.v1_0_0.prototype.writers;var B=C["sld"]["PointSymbolizer"].apply(this,arguments);return this.addVendorOptions(B,A)},"LineSymbolizer":function(A){var C=OpenLayers.Format.SLD.v1_0_0.prototype.writers;var B=C["sld"]["LineSymbolizer"].apply(this,arguments);return this.addVendorOptions(B,A)},"PolygonSymbolizer":function(A){var C=OpenLayers.Format.SLD.v1_0_0.prototype.writers;var B=C["sld"]["PolygonSymbolizer"].apply(this,arguments);return this.addVendorOptions(B,A)}},OpenLayers.Format.SLD.v1_0_0.prototype.writers["sld"])},OpenLayers.Format.SLD.v1_0_0.prototype.writers),addVendorOptions:function(C,B){var D=B.vendorOptions;if(D){for(var A in B.vendorOptions){this.writeNode("VendorOption",{name:A,value:B.vendorOptions[A]},C)}}return C},CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0_GeoServer"});OpenLayers.Layer.Boxes=OpenLayers.Class(OpenLayers.Layer.Markers,{drawMarker:function(C){var D=this.map.getLayerPxFromLonLat({lon:C.bounds.left,lat:C.bounds.top});var B=this.map.getLayerPxFromLonLat({lon:C.bounds.right,lat:C.bounds.bottom});if(B==null||D==null){C.display(false)}else{var A=C.draw(D,{w:Math.max(1,B.x-D.x),h:Math.max(1,B.y-D.y)});if(!C.drawn){this.div.appendChild(A);C.drawn=true}}},removeMarker:function(A){OpenLayers.Util.removeItem(this.markers,A);if((A.div!=null)&&(A.div.parentNode==this.div)){this.div.removeChild(A.div)}},CLASS_NAME:"OpenLayers.Layer.Boxes"});OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{readers:{"wfs":OpenLayers.Util.applyDefaults({"Service":function(A,B){B.service={};this.readChildNodes(A,B.service)},"Fees":function(B,C){var A=this.getChildValue(B);if(A&&A.toLowerCase()!="none"){C.fees=A}},"AccessConstraints":function(A,B){var C=this.getChildValue(A);if(C&&C.toLowerCase()!="none"){B.accessConstraints=C}},"OnlineResource":function(B,C){var A=this.getChildValue(B);if(A&&A.toLowerCase()!="none"){C.onlineResource=A}},"Keywords":function(A,B){var C=this.getChildValue(A);if(C&&C.toLowerCase()!="none"){B.keywords=C.split(", ")}},"Capability":function(A,B){B.capability={};this.readChildNodes(A,B.capability)},"Request":function(B,A){A.request={};this.readChildNodes(B,A.request)},"GetFeature":function(B,A){A.getfeature={href:{},formats:[]};this.readChildNodes(B,A.getfeature)},"ResultFormat":function(C,B){var E=C.childNodes;var D;for(var A=0;A<E.length;A++){D=E[A];if(D.nodeType==1){B.formats.push(D.nodeName)}}},"DCPType":function(B,A){this.readChildNodes(B,A)},"HTTP":function(B,A){this.readChildNodes(B,A.href)},"Get":function(B,A){A.get=B.getAttribute("onlineResource")},"Post":function(B,A){A.post=B.getAttribute("onlineResource")},"SRS":function(B,A){var C=this.getChildValue(B);if(C){A.srs=C}}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers["wfs"])},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_0_0"});OpenLayers.Format.WMSCapabilities.v1_3=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{"wms":OpenLayers.Util.applyDefaults({"WMS_Capabilities":function(B,A){this.readChildNodes(B,A)},"LayerLimit":function(B,A){A.layerLimit=parseInt(this.getChildValue(B))},"MaxWidth":function(B,A){A.maxWidth=parseInt(this.getChildValue(B))},"MaxHeight":function(B,A){A.maxHeight=parseInt(this.getChildValue(B))},"BoundingBox":function(B,A){var C=OpenLayers.Format.WMSCapabilities.v1.prototype.readers["wms"].BoundingBox.apply(this,[B,A]);C.srs=B.getAttribute("CRS");A.bbox[C.srs]=C},"CRS":function(B,A){this.readers.wms.SRS.apply(this,[B,A])},"EX_GeographicBoundingBox":function(B,A){A.llbbox=[];this.readChildNodes(B,A.llbbox)},"westBoundLongitude":function(B,A){A[0]=this.getChildValue(B)},"eastBoundLongitude":function(B,A){A[2]=this.getChildValue(B)},"southBoundLatitude":function(B,A){A[1]=this.getChildValue(B)},"northBoundLatitude":function(B,A){A[3]=this.getChildValue(B)},"MinScaleDenominator":function(B,A){A.maxScale=parseFloat(this.getChildValue(B)).toPrecision(16)},"MaxScaleDenominator":function(B,A){A.minScale=parseFloat(this.getChildValue(B)).toPrecision(16)},"Dimension":function(B,A){var C=B.getAttribute("name").toLowerCase();var D={name:C,units:B.getAttribute("units"),unitsymbol:B.getAttribute("unitSymbol"),nearestVal:B.getAttribute("nearestValue")==="1",multipleVal:B.getAttribute("multipleValues")==="1","default":B.getAttribute("default")||"",current:B.getAttribute("current")==="1",values:this.getChildValue(B).split(",")};A.dimensions[D.name]=D},"Keyword":function(B,A){var C={value:this.getChildValue(B),vocabulary:B.getAttribute("vocabulary")};if(A.keywords){A.keywords.push(C)}}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers["wms"]),"sld":{"UserDefinedSymbolization":function(B,A){this.readers.wms.UserDefinedSymbolization.apply(this,[B,A]);A.userSymbols.inlineFeature=parseInt(B.getAttribute("InlineFeature"))==1;A.userSymbols.remoteWCS=parseInt(B.getAttribute("RemoteWCS"))==1},"DescribeLayer":function(B,A){this.readers.wms.DescribeLayer.apply(this,[B,A])},"GetLegendGraphic":function(B,A){this.readers.wms.GetLegendGraphic.apply(this,[B,A])}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3"});OpenLayers.Layer.Zoomify=OpenLayers.Class(OpenLayers.Layer.Grid,{size:null,isBaseLayer:true,standardTileSize:256,tileOriginCorner:"tl",numberOfTiers:0,tileCountUpToTier:null,tierSizeInTiles:null,tierImageSize:null,initialize:function(D,B,A,C){this.initializeZoomify(A);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[D,B,A,{},C])},initializeZoomify:function(A){var D=A.clone();this.size=A.clone();var C=new OpenLayers.Size(Math.ceil(D.w/this.standardTileSize),Math.ceil(D.h/this.standardTileSize));this.tierSizeInTiles=[C];this.tierImageSize=[D];while(D.w>this.standardTileSize||D.h>this.standardTileSize){D=new OpenLayers.Size(Math.floor(D.w/2),Math.floor(D.h/2));C=new OpenLayers.Size(Math.ceil(D.w/this.standardTileSize),Math.ceil(D.h/this.standardTileSize));this.tierSizeInTiles.push(C);this.tierImageSize.push(D)}this.tierSizeInTiles.reverse();this.tierImageSize.reverse();this.numberOfTiers=this.tierSizeInTiles.length;var E=[1];this.tileCountUpToTier=[0];for(var B=1;B<this.numberOfTiers;B++){E.unshift(Math.pow(2,B));this.tileCountUpToTier.push(this.tierSizeInTiles[B-1].w*this.tierSizeInTiles[B-1].h+this.tileCountUpToTier[B-1])}if(!this.serverResolutions){this.serverResolutions=E}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments);this.tileCountUpToTier.length=0;this.tierSizeInTiles.length=0;this.tierImageSize.length=0},clone:function(A){if(A==null){A=new OpenLayers.Layer.Zoomify(this.name,this.url,this.size,this.options)}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);return A},getURL:function(B){B=this.adjustBounds(B);var F=this.getServerResolution();var D=Math.round((B.left-this.tileOrigin.lon)/(F*this.tileSize.w));var E=Math.round((this.tileOrigin.lat-B.top)/(F*this.tileSize.h));var H=this.getZoomForResolution(F);var G=D+E*this.tierSizeInTiles[H].w+this.tileCountUpToTier[H];var C="TileGroup"+Math.floor((G)/256)+"/"+H+"-"+D+"-"+E+".jpg";var A=this.url;if(OpenLayers.Util.isArray(A)){A=this.selectUrl(C,A)}return A+C},getImageSize:function(){if(arguments.length>0){var B=this.adjustBounds(arguments[0]);var D=this.getServerResolution();var E=Math.round((B.left-this.tileOrigin.lon)/(D*this.tileSize.w));var F=Math.round((this.tileOrigin.lat-B.top)/(D*this.tileSize.h));var C=this.getZoomForResolution(D);var G=this.standardTileSize;var A=this.standardTileSize;if(E==this.tierSizeInTiles[C].w-1){var G=this.tierImageSize[C].w%this.standardTileSize}if(F==this.tierSizeInTiles[C].h-1){var A=this.tierImageSize[C].h%this.standardTileSize}return(new OpenLayers.Size(G,A))}else{return this.tileSize}},setMap:function(A){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.top)},CLASS_NAME:"OpenLayers.Layer.Zoomify"});OpenLayers.Layer.MapServer=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{mode:"map",map_imagetype:"png"},initialize:function(C,A,D,B){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS);if(B==null||B.isBaseLayer==null){this.isBaseLayer=((this.params.transparent!="true")&&(this.params.transparent!=true))}},clone:function(A){if(A==null){A=new OpenLayers.Layer.MapServer(this.name,this.url,this.params,this.getOptions())}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);return A},getURL:function(B){B=this.adjustBounds(B);var C=[B.left,B.bottom,B.right,B.top];var D=this.getImageSize();var A=this.getFullRequestString({mapext:C,imgext:C,map_size:[D.w,D.h],imgx:D.w/2,imgy:D.h/2,imgxy:[D.w,D.h]});return A},getFullRequestString:function(A,C){var G=(C==null)?this.url:C;var H=OpenLayers.Util.extend({},this.params);H=OpenLayers.Util.extend(H,A);var D=OpenLayers.Util.getParameterString(H);if(OpenLayers.Util.isArray(G)){G=this.selectUrl(D,G)}var B=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(G));for(var E in H){if(E.toUpperCase() in B){delete H[E]}}D=OpenLayers.Util.getParameterString(H);var I=G;D=D.replace(/,/g,"+");if(D!=""){var F=G.charAt(G.length-1);if((F=="&")||(F=="?")){I+=D}else{if(G.indexOf("?")==-1){I+="?"+D}else{I+="&"+D}}}return I},CLASS_NAME:"OpenLayers.Layer.MapServer"});OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(A){if(!this.supported()){return}if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);var D=document.createStyleSheet();var C=["shape","rect","oval","fill","stroke","imagedata","group","textbox"];for(var B=0,E=C.length;B<E;B++){D.addRule("olv\\:"+C[B],"behavior: url(#default#VML); position: absolute; display: inline-block;")}}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments)},supported:function(){return !!(document.namespaces)},setExtent:function(D,L){var H=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var J=this.getResolution();var F=(D.left/J)|0;var E=(D.top/J-this.size.h)|0;if(L||!this.offset){this.offset={x:F,y:E};F=0;E=0}else{F=F-this.offset.x;E=E-this.offset.y}var B=(F-this.xOffset)+" "+E;this.root.coordorigin=B;var C=[this.root,this.vectorRoot,this.textRoot];var A;for(var G=0,K=C.length;G<K;++G){A=C[G];var I=this.size.w+" "+this.size.h;A.coordsize=I}this.root.style.flip="y";return H},setSize:function(A){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);var D=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot];var F=this.size.w+"px";var B=this.size.h+"px";var C;for(var E=0,G=D.length;E<G;++E){C=D[E];C.style.width=F;C.style.height=B}},getNodeType:function(C,B){var A=null;switch(C.CLASS_NAME){case"OpenLayers.Geometry.Point":if(B.externalGraphic){A="olv:rect"}else{if(this.isComplexSymbol(B.graphicName)){A="olv:shape"}else{A="olv:oval"}}break;case"OpenLayers.Geometry.Rectangle":A="olv:rect";break;case"OpenLayers.Geometry.LineString":case"OpenLayers.Geometry.LinearRing":case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":A="olv:shape";break;default:break}return A},setStyle:function(K,Q,L,M){Q=Q||K._style;L=L||K._options;var C=Q.fillColor;var G=Q.title||Q.graphicTitle;if(G){K.title=G}if(K._geometryClass==="OpenLayers.Geometry.Point"){if(Q.externalGraphic){L.isFilled=true;var I=Q.graphicWidth||Q.graphicHeight;var O=Q.graphicHeight||Q.graphicWidth;I=I?I:Q.pointRadius*2;O=O?O:Q.pointRadius*2;var J=this.getResolution();var E=(Q.graphicXOffset!=undefined)?Q.graphicXOffset:-(0.5*I);var P=(Q.graphicYOffset!=undefined)?Q.graphicYOffset:-(0.5*O);K.style.left=((((M.x-this.featureDx)/J-this.offset.x)+E)|0)+"px";K.style.top=(((M.y/J-this.offset.y)-(P+O))|0)+"px";K.style.width=I+"px";K.style.height=O+"px";K.style.flip="y";C="none";L.isStroked=false}else{if(this.isComplexSymbol(Q.graphicName)){var B=this.importSymbol(Q.graphicName);K.path=B.path;K.coordorigin=B.left+","+B.bottom;var D=B.size;K.coordsize=D+","+D;this.drawCircle(K,M,Q.pointRadius);K.style.flip="y"}else{this.drawCircle(K,M,Q.pointRadius)}}}if(L.isFilled){K.fillcolor=C}else{K.filled="false"}var N=K.getElementsByTagName("fill");var R=(N.length==0)?null:N[0];if(!L.isFilled){if(R){K.removeChild(R)}}else{if(!R){R=this.createNode("olv:fill",K.id+"_fill")}R.opacity=Q.fillOpacity;if(K._geometryClass==="OpenLayers.Geometry.Point"&&Q.externalGraphic){if(Q.graphicOpacity){R.opacity=Q.graphicOpacity}R.src=Q.externalGraphic;R.type="frame";if(!(Q.graphicWidth&&Q.graphicHeight)){R.aspect="atmost"}}if(R.parentNode!=K){K.appendChild(R)}}var F=Q.rotation;if((F!==undefined||K._rotation!==undefined)){K._rotation=F;if(Q.externalGraphic){this.graphicRotate(K,E,P,Q);R.opacity=0}else{if(K._geometryClass==="OpenLayers.Geometry.Point"){K.style.rotation=F||0}}}var A=K.getElementsByTagName("stroke");var H=(A.length==0)?null:A[0];if(!L.isStroked){K.stroked=false;if(H){H.on=false}}else{if(!H){H=this.createNode("olv:stroke",K.id+"_stroke");K.appendChild(H)}H.on=true;H.color=Q.strokeColor;H.weight=Q.strokeWidth+"px";H.opacity=Q.strokeOpacity;H.endcap=Q.strokeLinecap=="butt"?"flat":(Q.strokeLinecap||"round");if(Q.strokeDashstyle){H.dashstyle=this.dashStyle(Q)}}if(Q.cursor!="inherit"&&Q.cursor!=null){K.style.cursor=Q.cursor}return K},graphicRotate:function(L,D,R,S){var S=S||L._style;var F=S.rotation||0;var H,E;if(!(S.graphicWidth&&S.graphicHeight)){var P=new Image();P.onreadystatechange=OpenLayers.Function.bind(function(){if(P.readyState=="complete"||P.readyState=="interactive"){H=P.width/P.height;E=Math.max(S.pointRadius*2,S.graphicWidth||0,S.graphicHeight||0);D=D*H;S.graphicWidth=E*H;S.graphicHeight=E;this.graphicRotate(L,D,R,S)}},this);P.src=S.externalGraphic;return}else{E=Math.max(S.graphicWidth,S.graphicHeight);H=S.graphicWidth/S.graphicHeight}var J=Math.round(S.graphicWidth||E*H);var Q=Math.round(S.graphicHeight||E);L.style.width=J+"px";L.style.height=Q+"px";var K=document.getElementById(L.id+"_image");if(!K){K=this.createNode("olv:imagedata",L.id+"_image");L.appendChild(K)}K.style.width=J+"px";K.style.height=Q+"px";K.src=S.externalGraphic;K.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";var O=F*Math.PI/180;var C=Math.sin(O);var M=Math.cos(O);var N="progid:DXImageTransform.Microsoft.Matrix(M11="+M+",M12="+(-C)+",M21="+C+",M22="+M+",SizingMethod='auto expand')\n";var G=S.graphicOpacity||S.fillOpacity;if(G&&G!=1){N+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+G+")\n"}L.style.filter=N;var A=new OpenLayers.Geometry.Point(-D,-R);var B=new OpenLayers.Bounds(0,0,J,Q).toGeometry();B.rotate(S.rotation,A);var I=B.getBounds();L.style.left=Math.round(parseInt(L.style.left)+I.left)+"px";L.style.top=Math.round(parseInt(L.style.top)-I.bottom)+"px"},postDraw:function(A){A.style.visibility="visible";var B=A._style.fillColor;var C=A._style.strokeColor;if(B=="none"&&A.fillcolor!=B){A.fillcolor=B}if(C=="none"&&A.strokecolor!=C){A.strokecolor=C}},setNodeDimension:function(B,C){var E=C.getBounds();if(E){var D=this.getResolution();var A=new OpenLayers.Bounds(((E.left-this.featureDx)/D-this.offset.x)|0,(E.bottom/D-this.offset.y)|0,((E.right-this.featureDx)/D-this.offset.x)|0,(E.top/D-this.offset.y)|0);B.style.left=A.left+"px";B.style.top=A.top+"px";B.style.width=A.getWidth()+"px";B.style.height=A.getHeight()+"px";B.coordorigin=A.left+" "+A.top;B.coordsize=A.getWidth()+" "+A.getHeight()}},dashStyle:function(B){var C=B.strokeDashstyle;switch(C){case"solid":case"dot":case"dash":case"dashdot":case"longdash":case"longdashdot":return C;default:var A=C.split(/[ ,]/);if(A.length==2){if(1*A[0]>=2*A[1]){return"longdash"}return(A[0]==1||A[1]==1)?"dot":"dash"}else{if(A.length==4){return(1*A[0]>=2*A[1])?"longdashdot":"dashdot"}}return"solid"}},createNode:function(A,C){var B=document.createElement(A);if(C){B.id=C}B.unselectable="on";B.onselectstart=OpenLayers.Function.False;return B},nodeTypeCompare:function(C,A){var D=A;var B=D.indexOf(":");if(B!=-1){D=D.substr(B+1)}var E=C.nodeName;B=E.indexOf(":");if(B!=-1){E=E.substr(B+1)}return(D==E)},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(A){return this.nodeFactory(this.container.id+A,"olv:group")},drawPoint:function(A,B){return this.drawCircle(A,B,1)},drawCircle:function(B,C,E){if(!isNaN(C.x)&&!isNaN(C.y)){var D=this.getResolution();B.style.left=((((C.x-this.featureDx)/D-this.offset.x)|0)-E)+"px";B.style.top=(((C.y/D-this.offset.y)|0)-E)+"px";var A=E*2;B.style.width=A+"px";B.style.height=A+"px";return B}return false},drawLineString:function(A,B){return this.drawLine(A,B,false)},drawLinearRing:function(A,B){return this.drawLine(A,B,true)},drawLine:function(F,C,B){this.setNodeDimension(F,C);var G=this.getResolution();var A=C.components.length;var J=new Array(A);var E,H,I;for(var D=0;D<A;D++){E=C.components[D];H=((E.x-this.featureDx)/G-this.offset.x)|0;I=(E.y/G-this.offset.y)|0;J[D]=" "+H+","+I+" l "}var K=(B)?" x e":" e";F.path="m"+J.join("")+K;return F},drawPolygon:function(K,I){this.setNodeDimension(K,I);var M=this.getResolution();var L=[];var G,F,N,D,C,A,J,B,H,E,P,O;for(G=0,F=I.components.length;G<F;G++){L.push("m");N=I.components[G].components;D=(G===0);C=null;A=null;for(J=0,B=N.length;J<B;J++){H=N[J];P=((H.x-this.featureDx)/M-this.offset.x)|0;O=(H.y/M-this.offset.y)|0;E=" "+P+","+O;L.push(E);if(J==0){L.push(" l")}if(!D){if(!C){C=E}else{if(C!=E){if(!A){A=E}else{if(A!=E){D=true}}}}}}L.push(D?" x ":" ")}L.push("e");K.path=L.join("");return K},drawRectangle:function(A,B){var C=this.getResolution();A.style.left=(((B.x-this.featureDx)/C-this.offset.x)|0)+"px";A.style.top=((B.y/C-this.offset.y)|0)+"px";A.style.width=((B.width/C)|0)+"px";A.style.height=((B.height/C)|0)+"px";return A},drawText:function(B,E,H){var F=this.nodeFactory(B+this.LABEL_ID_SUFFIX,"olv:rect");var A=this.nodeFactory(B+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox");var G=this.getResolution();F.style.left=(((H.x-this.featureDx)/G-this.offset.x)|0)+"px";F.style.top=((H.y/G-this.offset.y)|0)+"px";F.style.flip="y";A.innerText=E.label;if(E.cursor!="inherit"&&E.cursor!=null){A.style.cursor=E.cursor}if(E.fontColor){A.style.color=E.fontColor}if(E.fontOpacity){A.style.filter="alpha(opacity="+(E.fontOpacity*100)+")"}if(E.fontFamily){A.style.fontFamily=E.fontFamily}if(E.fontSize){A.style.fontSize=E.fontSize}if(E.fontWeight){A.style.fontWeight=E.fontWeight}if(E.fontStyle){A.style.fontStyle=E.fontStyle}if(E.labelSelect===true){F._featureId=B;A._featureId=B;A._geometry=H;A._geometryClass=H.CLASS_NAME}A.style.whiteSpace="nowrap";A.inset="1px,0px,0px,0px";if(!F.parentNode){F.appendChild(A);this.textRoot.appendChild(F)}var D=E.labelAlign||"cm";if(D.length==1){D+="m"}var C=A.clientWidth*(OpenLayers.Renderer.VML.LABEL_SHIFT[D.substr(0,1)]);var I=A.clientHeight*(OpenLayers.Renderer.VML.LABEL_SHIFT[D.substr(1,1)]);F.style.left=parseInt(F.style.left)-C-1+"px";F.style.top=parseInt(F.style.top)+I+"px"},moveRoot:function(B){var A=this.map.getLayer(B.container.id);if(A instanceof OpenLayers.Layer.Vector.RootContainer){A=this.map.getLayer(this.container.id)}A&&A.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments);A&&A.redraw()},importSymbol:function(E){var F=this.container.id+"-"+E;var I=this.symbolCache[F];if(I){return I}var D=OpenLayers.Renderer.symbol[E];if(!D){throw new Error(E+" is not a valid symbol name")}var K=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);var B=["m"];for(var C=0;C<D.length;C=C+2){var G=D[C];var H=D[C+1];K.left=Math.min(K.left,G);K.bottom=Math.min(K.bottom,H);K.right=Math.max(K.right,G);K.top=Math.max(K.top,H);B.push(G);B.push(H);if(C==0){B.push("l")}}B.push("x e");var J=B.join(" ");var A=(K.getWidth()-K.getHeight())/2;if(A>0){K.bottom=K.bottom-A;K.top=K.top+A}else{K.left=K.left+A;K.right=K.right-A}I={path:J,size:K.getWidth(),left:K.left,bottom:K.bottom};this.symbolCache[F]=I;return I},CLASS_NAME:"OpenLayers.Renderer.VML"});OpenLayers.Renderer.VML.LABEL_SHIFT={"l":0,"c":0.5,"r":1,"t":0,"m":0.5,"b":1};OpenLayers.Control.CacheRead=OpenLayers.Class(OpenLayers.Control,{fetchEvent:"tileloadstart",layers:null,autoActivate:true,setMap:function(B){OpenLayers.Control.prototype.setMap.apply(this,arguments);var A,C=this.layers||B.layers;for(A=C.length-1;A>=0;--A){this.addLayer({layer:C[A]})}if(!this.layers){B.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})}},addLayer:function(A){A.layer.events.register(this.fetchEvent,this,this.fetch)},removeLayer:function(A){A.layer.events.unregister(this.fetchEvent,this,this.fetch)},fetch:function(C){if(this.active&&window.localStorage&&C.tile instanceof OpenLayers.Tile.Image){var D=C.tile,B=D.url;if(!D.layer.crossOriginKeyword&&OpenLayers.ProxyHost&&B.indexOf(OpenLayers.ProxyHost)===0){B=OpenLayers.Control.CacheWrite.urlMap[B]}var A=window.localStorage.getItem("olCache_"+B);if(A){D.url=A;if(C.type==="tileerror"){D.setImgSrc(A)}}}},destroy:function(){if(this.layers||this.map){var A,B=this.layers||this.map.layers;for(A=B.length-1;A>=0;--A){this.removeLayer({layer:B[A]})}}if(this.map){this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})}OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheRead"});OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"});OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:"_layer",featureIdentifier:"_feature",regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},gmlFormat:null,read:function(E){var B;if(typeof E=="string"){E=OpenLayers.Format.XML.prototype.read.apply(this,[E])}var A=E.documentElement;if(A){var C=this;var D=this["read_"+A.nodeName];if(D){B=D.call(this,A)}else{B=new OpenLayers.Format.GML((this.options?this.options:{})).read(E)}}else{B=E}return B},read_msGMLOutput:function(B){var M=[];var A=this.getSiblingNodesByTagCriteria(B,this.layerIdentifier);if(A){for(var F=0,J=A.length;F<J;++F){var H=A[F];var E=H.nodeName;if(H.prefix){E=E.split(":")[1]}var E=E.replace(this.layerIdentifier,"");var K=this.getSiblingNodesByTagCriteria(H,this.featureIdentifier);if(K){for(var D=0;D<K.length;D++){var I=K[D];var C=this.parseGeometry(I);var G=this.parseAttributes(I);var L=new OpenLayers.Feature.Vector(C.geometry,G,null);L.bounds=C.bounds;L.type=E;M.push(L)}}}}return M},read_FeatureInfoResponse:function(B){var M=[];var L=this.getElementsByTagNameNS(B,"*","FIELDS");for(var G=0,K=L.length;G<K;G++){var J=L[G];var H=null;var F={};var D;var E=J.attributes.length;if(E>0){for(D=0;D<E;D++){var A=J.attributes[D];F[A.nodeName]=A.nodeValue}}else{var C=J.childNodes;for(D=0,E=C.length;D<E;++D){var I=C[D];if(I.nodeType!=3){F[I.getAttribute("name")]=I.getAttribute("value")}}}M.push(new OpenLayers.Feature.Vector(H,F,null))}return M},getSiblingNodesByTagCriteria:function(E,A){var I=[];var B,H,D,G,F;if(E&&E.hasChildNodes()){B=E.childNodes;D=B.length;for(var C=0;C<D;C++){F=B[C];while(F&&F.nodeType!=1){F=F.nextSibling;C++}H=(F?F.nodeName:"");if(H.length>0&&H.indexOf(A)>-1){I.push(F)}else{G=this.getSiblingNodesByTagCriteria(F,A);if(G.length>0){(I.length==0)?I=G:I.push(G)}}}}return I},parseAttributes:function(H){var G={};if(H.nodeType==1){var D=H.childNodes;var I=D.length;for(var F=0;F<I;++F){var J=D[F];if(J.nodeType==1){var A=J.childNodes;var B=(J.prefix)?J.nodeName.split(":")[1]:J.nodeName;if(A.length==0){G[B]=null}else{if(A.length==1){var E=A[0];if(E.nodeType==3||E.nodeType==4){var C=E.nodeValue.replace(this.regExes.trimSpace,"");G[B]=C}}}}}}return G},parseGeometry:function(C){if(!this.gmlFormat){this.gmlFormat=new OpenLayers.Format.GML()}var A=this.gmlFormat.parseFeature(C);var D,B=null;if(A){D=A.geometry&&A.geometry.clone();B=A.bounds&&A.bounds.clone();A.destroy()}return{geometry:D,bounds:B}},CLASS_NAME:"OpenLayers.Format.WMSGetFeatureInfo"});OpenLayers.Control.WMTSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:false,requestEncoding:"KVP",drillDown:false,maxFeatures:10,clickCallback:"click",layers:null,queryVisible:true,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handler:null,hoverRequest:null,pending:0,initialize:function(A){A=A||{};A.handlerOptions=A.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[A]);if(!this.format){this.format=new OpenLayers.Format.WMSGetFeatureInfo(A.formatOptions)}if(this.drillDown===true){this.hover=false}if(this.hover){this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250}))}else{var B={};B[this.clickCallback]=this.getInfoForClick;this.handler=new OpenLayers.Handler.Click(this,B,this.handlerOptions.click||{})}},getInfoForClick:function(A){this.request(A.xy,{})},getInfoForHover:function(A){this.request(A.xy,{hover:true})},cancelHover:function(){if(this.hoverRequest){--this.pending;if(this.pending<=0){OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait");this.pending=0}this.hoverRequest.abort();this.hoverRequest=null}},findLayers:function(){var D=this.layers||this.map.layers;var C=[];var A;for(var B=D.length-1;B>=0;--B){A=D[B];if(A instanceof OpenLayers.Layer.WMTS&&A.requestEncoding===this.requestEncoding&&(!this.queryVisible||A.getVisibility())){C.push(A);if(!this.drillDown||this.hover){break}}}return C},buildRequestOptions:function(C,A){var F=this.map.getLonLatFromPixel(A);var D=C.getURL(new OpenLayers.Bounds(F.lon,F.lat,F.lon,F.lat));var E=OpenLayers.Util.getParameters(D);var B=C.getTileInfo(F);OpenLayers.Util.extend(E,{service:"WMTS",version:C.version,request:"GetFeatureInfo",infoFormat:this.infoFormat,i:B.i,j:B.j});OpenLayers.Util.applyDefaults(E,this.vendorParams);return{url:OpenLayers.Util.isArray(C.url)?C.url[0]:C.url,params:OpenLayers.Util.upperCaseObject(E),callback:function(G){this.handleResponse(A,G,C)},scope:this}},request:function(B,E){E=E||{};var H=this.findLayers();if(H.length>0){var C,I;for(var D=0,F=H.length;D<F;D++){I=H[D];C=this.events.triggerEvent("beforegetfeatureinfo",{xy:B,layer:I});if(C!==false){++this.pending;var G=this.buildRequestOptions(I,B);var A=OpenLayers.Request.GET(G);if(E.hover===true){this.hoverRequest=A}}}if(this.pending>0){OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait")}}},handleResponse:function(A,C,D){--this.pending;if(this.pending<=0){OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait");this.pending=0}if(C.status&&(C.status<200||C.status>=300)){this.events.triggerEvent("exception",{xy:A,request:C,layer:D})}else{var G=C.responseXML;if(!G||!G.documentElement){G=C.responseText}var B,E;try{B=this.format.read(G)}catch(F){E=true;this.events.triggerEvent("exception",{xy:A,request:C,error:F,layer:D})}if(!E){this.events.triggerEvent("getfeatureinfo",{text:C.responseText,features:B,request:C,xy:A,layer:D})}}},CLASS_NAME:"OpenLayers.Control.WMTSGetFeatureInfo"});OpenLayers.Protocol.CSW.v2_0_2=OpenLayers.Class(OpenLayers.Protocol,{formatOptions:null,initialize:function(A){OpenLayers.Protocol.prototype.initialize.apply(this,[A]);if(!A.format){this.format=new OpenLayers.Format.CSWGetRecords.v2_0_2(OpenLayers.Util.extend({},this.formatOptions))}},destroy:function(){if(this.options&&!this.options.format){this.format.destroy()}this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(A){A=OpenLayers.Util.extend({},A);OpenLayers.Util.applyDefaults(A,this.options||{});var B=new OpenLayers.Protocol.Response({requestType:"read"});var C=this.format.write(A.params||A);B.priv=OpenLayers.Request.POST({url:A.url,callback:this.createCallback(this.handleRead,B,A),params:A.params,headers:A.headers,data:C});return B},handleRead:function(C,B){if(B.callback){var A=C.priv;if(A.status>=200&&A.status<300){C.data=this.parseData(A);C.code=OpenLayers.Protocol.Response.SUCCESS}else{C.code=OpenLayers.Protocol.Response.FAILURE}B.callback.call(B.scope,C)}},parseData:function(A){var B=A.responseXML;if(!B||!B.documentElement){B=A.responseText}if(!B||B.length<=0){return null}return this.format.read(B)},CLASS_NAME:"OpenLayers.Protocol.CSW.v2_0_2"});OpenLayers.Format.WCSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WCSCapabilities.v1,{namespaces:{wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows/1.1"},errorProperty:"operationsMetadata",readers:{"wcs":OpenLayers.Util.applyDefaults({"Capabilities":function(B,A){this.readChildNodes(B,A)},"Contents":function(B,A){A.contentMetadata=[];this.readChildNodes(B,A.contentMetadata)},"CoverageSummary":function(B,A){var C={};this.readChildNodes(B,C);A.push(C)},"Identifier":function(B,A){A.identifier=this.getChildValue(B)},"Title":function(B,A){A.title=this.getChildValue(B)},"Abstract":function(B,A){A["abstract"]=this.getChildValue(B)},"SupportedCRS":function(B,A){var C=this.getChildValue(B);if(C){if(!A.supportedCRS){A.supportedCRS=[]}A.supportedCRS.push(C)}},"SupportedFormat":function(C,B){var A=this.getChildValue(C);if(A){if(!B.supportedFormat){B.supportedFormat=[]}B.supportedFormat.push(A)}}},OpenLayers.Format.WCSCapabilities.v1.prototype.readers["wcs"]),"ows":OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers["ows"]},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1_1_0"});OpenLayers.Control.Graticule=OpenLayers.Class(OpenLayers.Control,{autoActivate:true,intervals:[45,30,20,10,5,2,1,0.5,0.2,0.1,0.05,0.01,0.005,0.002,0.001],displayInLayerSwitcher:true,visible:true,numPoints:50,targetSize:200,layerName:null,labelled:true,labelFormat:"dm",lineSymbolizer:{strokeColor:"#333",strokeWidth:1,strokeOpacity:0.5},labelSymbolizer:{},gratLayer:null,initialize:function(A){A=A||{};A.layerName=A.layerName||OpenLayers.i18n("Graticule");OpenLayers.Control.prototype.initialize.apply(this,[A]);this.labelSymbolizer.stroke=false;this.labelSymbolizer.fill=false;this.labelSymbolizer.label="${label}";this.labelSymbolizer.labelAlign="${labelAlign}";this.labelSymbolizer.labelXOffset="${xOffset}";this.labelSymbolizer.labelYOffset="${yOffset}"},destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments);if(this.gratLayer){this.gratLayer.destroy();this.gratLayer=null}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.gratLayer){var A=new OpenLayers.Style({},{rules:[new OpenLayers.Rule({"symbolizer":{"Point":this.labelSymbolizer,"Line":this.lineSymbolizer}})]});this.gratLayer=new OpenLayers.Layer.Vector(this.layerName,{styleMap:new OpenLayers.StyleMap({"default":A}),visibility:this.visible,displayInLayerSwitcher:this.displayInLayerSwitcher})}return this.div},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.map.addLayer(this.gratLayer);this.map.events.register("moveend",this,this.update);this.update();return true}else{return false}},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.map.events.unregister("moveend",this,this.update);this.map.removeLayer(this.gratLayer);return true}else{return false}},update:function(){var b=this.map.getExtent();if(!b){return}this.gratLayer.destroyFeatures();var P=new OpenLayers.Projection("EPSG:4326");var N=this.map.getProjectionObject();var J=this.map.getResolution();if(N.proj&&N.proj.projName=="longlat"){this.numPoints=1}var R=this.map.getCenter();var M=new OpenLayers.Pixel(R.lon,R.lat);OpenLayers.Projection.transform(M,N,P);var E=this.targetSize*J;E*=E;var G;for(var g=0;g<this.intervals.length;++g){G=this.intervals[g];var W=G/2;var O=M.offset({x:-W,y:-W});var F=M.offset({x:W,y:W});OpenLayers.Projection.transform(O,P,N);OpenLayers.Projection.transform(F,P,N);var X=(O.x-F.x)*(O.x-F.x)+(O.y-F.y)*(O.y-F.y);if(X<=E){break}}M.x=Math.floor(M.x/G)*G;M.y=Math.floor(M.y/G)*G;var L=0;var D=[M.clone()];var c=M.clone();var H;do{c=c.offset({x:0,y:G});H=OpenLayers.Projection.transform(c.clone(),P,N);D.unshift(c)}while(b.containsPixel(H)&&++L<1000);c=M.clone();do{c=c.offset({x:0,y:-G});H=OpenLayers.Projection.transform(c.clone(),P,N);D.push(c)}while(b.containsPixel(H)&&++L<1000);L=0;var I=[M.clone()];c=M.clone();do{c=c.offset({x:-G,y:0});H=OpenLayers.Projection.transform(c.clone(),P,N);I.unshift(c)}while(b.containsPixel(H)&&++L<1000);c=M.clone();do{c=c.offset({x:G,y:0});H=OpenLayers.Projection.transform(c.clone(),P,N);I.push(c)}while(b.containsPixel(H)&&++L<1000);var Y=[];for(var g=0;g<I.length;++g){var a=I[g].x;var d=[];var f=null;var B=Math.min(D[0].y,90);var S=Math.max(D[D.length-1].y,-90);var A=(B-S)/this.numPoints;var Z=S;for(var e=0;e<=this.numPoints;++e){var V=new OpenLayers.Geometry.Point(a,Z);V.transform(P,N);d.push(V);Z+=A;if(V.y>=b.bottom&&!f){f=V}}if(this.labelled){var Q=new OpenLayers.Geometry.Point(f.x,b.bottom);var C={value:a,label:this.labelled?OpenLayers.Util.getFormattedLonLat(a,"lon",this.labelFormat):"",labelAlign:"cb",xOffset:0,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(Q,C))}var U=new OpenLayers.Geometry.LineString(d);Y.push(new OpenLayers.Feature.Vector(U))}for(var e=0;e<D.length;++e){Z=D[e].y;if(Z<-90||Z>90){continue}var d=[];var K=I[0].x;var T=I[I.length-1].x;var h=(T-K)/this.numPoints;var a=K;var f=null;for(var g=0;g<=this.numPoints;++g){var V=new OpenLayers.Geometry.Point(a,Z);V.transform(P,N);d.push(V);a+=h;if(V.x<b.right){f=V}}if(this.labelled){var Q=new OpenLayers.Geometry.Point(b.right,f.y);var C={value:Z,label:this.labelled?OpenLayers.Util.getFormattedLonLat(Z,"lat",this.labelFormat):"",labelAlign:"rb",xOffset:-2,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(Q,C))}var U=new OpenLayers.Geometry.LineString(d);Y.push(new OpenLayers.Feature.Vector(U))}this.gratLayer.addFeatures(Y)},CLASS_NAME:"OpenLayers.Control.Graticule"});OpenLayers.Console.warn("OpenLayers.Rico is deprecated");OpenLayers.Rico=OpenLayers.Rico||{};OpenLayers.Rico.Corner={round:function(A,C){A=OpenLayers.Util.getElement(A);this._setOptions(C);var D=this.options.color;if(this.options.color=="fromElement"){D=this._background(A)}var B=this.options.bgColor;if(this.options.bgColor=="fromParent"){B=this._background(A.offsetParent)}this._roundCornersImpl(A,D,B)},changeColor:function(B,A){B.style.backgroundColor=A;var D=B.parentNode.getElementsByTagName("span");for(var C=0;C<D.length;C++){D[C].style.backgroundColor=A}},changeOpacity:function(B,D){var A=D;var C="alpha(opacity="+D*100+")";B.style.opacity=A;B.style.filter=C;var F=B.parentNode.getElementsByTagName("span");for(var E=0;E<F.length;E++){F[E].style.opacity=A;F[E].style.filter=C}},reRound:function(A,C){var B=A.parentNode.childNodes[0];var D=A.parentNode.childNodes[2];A.parentNode.removeChild(B);A.parentNode.removeChild(D);this.round(A.parentNode,C)},_roundCornersImpl:function(A,C,B){if(this.options.border){this._renderBorder(A,B)}if(this._isTopRounded()){this._roundTopCorners(A,C,B)}if(this._isBottomRounded()){this._roundBottomCorners(A,C,B)}},_renderBorder:function(A,C){var F="1px solid "+this._borderColor(C);var D="border-left: "+F;var B="border-right: "+F;var E="style='"+D+";"+B+"'";A.innerHTML="<div "+E+">"+A.innerHTML+"</div>"},_roundTopCorners:function(A,E,C){var D=this._createCorner(C);for(var B=0;B<this.options.numSlices;B++){D.appendChild(this._createCornerSlice(E,C,B,"top"))}A.style.paddingTop=0;A.insertBefore(D,A.firstChild)},_roundBottomCorners:function(A,E,C){var D=this._createCorner(C);for(var B=(this.options.numSlices-1);B>=0;B--){D.appendChild(this._createCornerSlice(E,C,B,"bottom"))}A.style.paddingBottom=0;A.appendChild(D)},_createCorner:function(A){var B=document.createElement("div");B.style.backgroundColor=(this._isTransparent()?"transparent":A);return B},_createCornerSlice:function(F,C,A,D){var G=document.createElement("span");var B=G.style;B.backgroundColor=F;B.display="block";B.height="1px";B.overflow="hidden";B.fontSize="1px";var E=this._borderColor(F,C);if(this.options.border&&A==0){B.borderTopStyle="solid";B.borderTopWidth="1px";B.borderLeftWidth="0px";B.borderRightWidth="0px";B.borderBottomWidth="0px";B.height="0px";B.borderColor=E}else{if(E){B.borderColor=E;B.borderStyle="solid";B.borderWidth="0px 1px"}}if(!this.options.compact&&(A==(this.options.numSlices-1))){B.height="2px"}this._setMargin(G,A,D);this._setBorder(G,A,D);return G},_setOptions:function(A){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:true,border:false,compact:false};OpenLayers.Util.extend(this.options,A||{});this.options.numSlices=this.options.compact?2:4;if(this._isTransparent()){this.options.blend=false}},_whichSideTop:function(){if(this._hasString(this.options.corners,"all","top")){return""}if(this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0){return""}if(this.options.corners.indexOf("tl")>=0){return"left"}else{if(this.options.corners.indexOf("tr")>=0){return"right"}}return""},_whichSideBottom:function(){if(this._hasString(this.options.corners,"all","bottom")){return""}if(this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0){return""}if(this.options.corners.indexOf("bl")>=0){return"left"}else{if(this.options.corners.indexOf("br")>=0){return"right"}}return""},_borderColor:function(B,A){if(B=="transparent"){return A}else{if(this.options.border){return this.options.border}else{if(this.options.blend){return this._blend(A,B)}else{return""}}}},_setMargin:function(A,C,D){var E=this._marginSize(C);var B=D=="top"?this._whichSideTop():this._whichSideBottom();if(B=="left"){A.style.marginLeft=E+"px";A.style.marginRight="0px"}else{if(B=="right"){A.style.marginRight=E+"px";A.style.marginLeft="0px"}else{A.style.marginLeft=E+"px";A.style.marginRight=E+"px"}}},_setBorder:function(A,C,D){var E=this._borderSize(C);var B=D=="top"?this._whichSideTop():this._whichSideBottom();if(B=="left"){A.style.borderLeftWidth=E+"px";A.style.borderRightWidth="0px"}else{if(B=="right"){A.style.borderRightWidth=E+"px";A.style.borderLeftWidth="0px"}else{A.style.borderLeftWidth=E+"px";A.style.borderRightWidth=E+"px"}}if(this.options.border!=false){A.style.borderLeftWidth=E+"px";A.style.borderRightWidth=E+"px"}},_marginSize:function(A){if(this._isTransparent()){return 0}var D=[5,3,2,1];var E=[3,2,1,0];var C=[2,1];var B=[1,0];if(this.options.compact&&this.options.blend){return B[A]}else{if(this.options.compact){return C[A]}else{if(this.options.blend){return E[A]}else{return D[A]}}}},_borderSize:function(A){var C=[5,3,2,1];var B=[2,1,1,1];var D=[1,0];var E=[0,2,0,0];if(this.options.compact&&(this.options.blend||this._isTransparent())){return 1}else{if(this.options.compact){return D[A]}else{if(this.options.blend){return B[A]}else{if(this.options.border){return E[A]}else{if(this._isTransparent()){return C[A]}}}}}return 0},_hasString:function(B){for(var A=1;A<arguments.length;A++){if(B.indexOf(arguments[A])>=0){return true}}return false},_blend:function(C,A){var B=OpenLayers.Rico.Color.createFromHex(C);B.blend(OpenLayers.Rico.Color.createFromHex(A));return B},_background:function(A){try{return OpenLayers.Rico.Color.createColorFromBackground(A).asHex()}catch(B){return"#ffffff"}},_isTransparent:function(){return this.options.color=="transparent"},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(A){return A.childNodes.length==1&&A.childNodes[0].nodeType==3}};OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,autoActivate:true,clearOnDeactivate:false,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:false,initialize:function(B){OpenLayers.Control.prototype.initialize.apply(this,[B]);this.registry=OpenLayers.Util.extend({"moveend":this.getState},this.registry);var A={trigger:OpenLayers.Function.bind(this.previousTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Previous"};OpenLayers.Util.extend(A,this.previousOptions);this.previous=new OpenLayers.Control.Button(A);var C={trigger:OpenLayers.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Next"};OpenLayers.Util.extend(C,this.nextOptions);this.next=new OpenLayers.Control.Button(C);this.clear()},onPreviousChange:function(B,A){if(B&&!this.previous.active){this.previous.activate()}else{if(!B&&this.previous.active){this.previous.deactivate()}}},onNextChange:function(B,A){if(B&&!this.next.active){this.next.activate()}else{if(!B&&this.next.active){this.next.deactivate()}}},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this);this.previous.destroy();this.next.destroy();this.deactivate();for(var A in this){this[A]=null}},setMap:function(A){this.map=A;this.next.setMap(A);this.previous.setMap(A)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.next.draw();this.previous.draw()},previousTrigger:function(){var A=this.previousStack.shift();var B=this.previousStack.shift();if(B!=undefined){this.nextStack.unshift(A);this.previousStack.unshift(B);this.restoring=true;this.restore(B);this.restoring=false;this.onNextChange(this.nextStack[0],this.nextStack.length);this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)}else{this.previousStack.unshift(A)}return B},nextTrigger:function(){var A=this.nextStack.shift();if(A!=undefined){this.previousStack.unshift(A);this.restoring=true;this.restore(A);this.restoring=false;this.onNextChange(this.nextStack[0],this.nextStack.length);this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)}return A},clear:function(){this.previousStack=[];this.previous.deactivate();this.nextStack=[];this.next.deactivate()},getState:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution(),projection:this.map.getProjectionObject(),units:this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units}},restore:function(F){var C,E;if(this.map.getProjectionObject()==F.projection){E=this.map.getZoomForResolution(F.resolution);C=F.center}else{C=F.center.clone();C.transform(F.projection,this.map.getProjectionObject());var B=F.units;var A=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;var D=B&&A?OpenLayers.INCHES_PER_UNIT[B]/OpenLayers.INCHES_PER_UNIT[A]:1;E=this.map.getZoomForResolution(D*F.resolution)}this.map.setCenter(C,E)},setListeners:function(){this.listeners={};for(var A in this.registry){this.listeners[A]=OpenLayers.Function.bind(function(){if(!this.restoring){var B=this.registry[A].apply(this,arguments);this.previousStack.unshift(B);if(this.previousStack.length>1){this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)}if(this.previousStack.length>(this.limit+1)){this.previousStack.pop()}if(this.nextStack.length>0){this.nextStack=[];this.onNextChange(null,0)}}return true},this)}},activate:function(){var B=false;if(this.map){if(OpenLayers.Control.prototype.activate.apply(this)){if(this.listeners==null){this.setListeners()}for(var A in this.listeners){this.map.events.register(A,this,this.listeners[A])}B=true;if(this.previousStack.length==0){this.initStack()}}}return B},initStack:function(){if(this.map.getCenter()){this.listeners.moveend()}},deactivate:function(){var B=false;if(this.map){if(OpenLayers.Control.prototype.deactivate.apply(this)){for(var A in this.listeners){this.map.events.unregister(A,this,this.listeners[A])}if(this.clearOnDeactivate){this.clear()}B=true}}return B},CLASS_NAME:"OpenLayers.Control.NavigationHistory"});OpenLayers.Layer.UTFGrid=OpenLayers.Class(OpenLayers.Layer.XYZ,{isBaseLayer:false,projection:new OpenLayers.Projection("EPSG:900913"),useJSONP:false,tileClass:OpenLayers.Tile.UTFGrid,initialize:function(A){OpenLayers.Layer.Grid.prototype.initialize.apply(this,[A.name,A.url,{},A]);this.tileOptions=OpenLayers.Util.extend({utfgridResolution:this.utfgridResolution},this.tileOptions)},createBackBuffer:function(){},clone:function(A){if(A==null){A=new OpenLayers.Layer.UTFGrid(this.getOptions())}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);return A},getFeatureInfo:function(A){var C=null;var B=this.getTileData(A);if(B&&B.tile){C=B.tile.getFeatureInfo(B.i,B.j)}return C},getFeatureId:function(A){var C=null;var B=this.getTileData(A);if(B.tile){C=B.tile.getFeatureId(B.i,B.j)}return C},CLASS_NAME:"OpenLayers.Layer.UTFGrid"});OpenLayers.TileManager=OpenLayers.Class({cacheSize:256,tilesPerFrame:2,frameDelay:16,moveDelay:100,zoomDelay:200,maps:null,tileQueueId:null,tileQueue:null,tileCache:null,tileCacheIndex:null,initialize:function(A){OpenLayers.Util.extend(this,A);this.maps=[];this.tileQueueId={};this.tileQueue={};this.tileCache={};this.tileCacheIndex=[]},addMap:function(B){if(this._destroyed||!OpenLayers.Layer.Grid){return}this.maps.push(B);this.tileQueue[B.id]=[];for(var A=0,C=B.layers.length;A<C;++A){this.addLayer({layer:B.layers[A]})}B.events.on({move:this.move,zoomend:this.zoomEnd,changelayer:this.changeLayer,addlayer:this.addLayer,preremovelayer:this.removeLayer,scope:this})},removeMap:function(B){if(this._destroyed||!OpenLayers.Layer.Grid){return}window.clearTimeout(this.tileQueueId[B.id]);if(B.layers){for(var A=0,C=B.layers.length;A<C;++A){this.removeLayer({layer:B.layers[A]})}}if(B.events){B.events.un({move:this.move,zoomend:this.zoomEnd,changelayer:this.changeLayer,addlayer:this.addLayer,preremovelayer:this.removeLayer,scope:this})}delete this.tileQueue[B.id];delete this.tileQueueId[B.id];OpenLayers.Util.removeItem(this.maps,B)},move:function(A){this.updateTimeout(A.object,this.moveDelay,true)},zoomEnd:function(A){this.updateTimeout(A.object,this.zoomDelay)},changeLayer:function(A){if(A.property==="visibility"||A.property==="params"){this.updateTimeout(A.object,0)}},addLayer:function(B){var C=B.layer;if(C instanceof OpenLayers.Layer.Grid){C.events.on({addtile:this.addTile,retile:this.clearTileQueue,scope:this});var A,E,D;for(A=C.grid.length-1;A>=0;--A){for(E=C.grid[A].length-1;E>=0;--E){D=C.grid[A][E];this.addTile({tile:D});if(D.url&&!D.imgDiv){this.manageTileCache({object:D})}}}}},removeLayer:function(B){var C=B.layer;if(C instanceof OpenLayers.Layer.Grid){this.clearTileQueue({object:C});if(C.events){C.events.un({addtile:this.addTile,retile:this.clearTileQueue,scope:this})}if(C.grid){var A,E,D;for(A=C.grid.length-1;A>=0;--A){for(E=C.grid[A].length-1;E>=0;--E){D=C.grid[A][E];this.unloadTile({object:D})}}}}},updateTimeout:function(A,C,B){window.clearTimeout(this.tileQueueId[A.id]);var D=this.tileQueue[A.id];if(!B||D.length){this.tileQueueId[A.id]=window.setTimeout(OpenLayers.Function.bind(function(){this.drawTilesFromQueue(A);if(D.length){this.updateTimeout(A,this.frameDelay)}},this),C)}},addTile:function(A){if(A.tile instanceof OpenLayers.Tile.Image){A.tile.events.on({beforedraw:this.queueTileDraw,beforeload:this.manageTileCache,loadend:this.addToCache,unload:this.unloadTile,scope:this})}else{this.removeLayer({layer:A.tile.layer})}},unloadTile:function(A){var B=A.object;B.events.un({beforedraw:this.queueTileDraw,beforeload:this.manageTileCache,loadend:this.addToCache,unload:this.unloadTile,scope:this});OpenLayers.Util.removeItem(this.tileQueue[B.layer.map.id],B)},queueTileDraw:function(D){var E=D.object;var B=false;var A=E.layer;var C=A.getURL(E.bounds);var F=this.tileCache[C];if(F&&F.className!=="olTileImage"){delete this.tileCache[C];OpenLayers.Util.removeItem(this.tileCacheIndex,C);F=null}if(A.url&&(A.async||!F)){var G=this.tileQueue[A.map.id];if(!~OpenLayers.Util.indexOf(G,E)){G.push(E)}B=true}return !B},drawTilesFromQueue:function(A){var D=this.tileQueue[A.id];var C=this.tilesPerFrame;var B=A.zoomTween&&A.zoomTween.playing;while(!B&&D.length&&C){D.shift().draw(true);--C}},manageTileCache:function(A){var B=A.object;var C=this.tileCache[B.url];if(C){if(C.parentNode&&OpenLayers.Element.hasClass(C.parentNode,"olBackBuffer")){C.parentNode.removeChild(C);C.id=null}if(!C.parentNode){C.style.visibility="hidden";C.style.opacity=0;B.setImage(C);OpenLayers.Util.removeItem(this.tileCacheIndex,B.url);this.tileCacheIndex.push(B.url)}}},addToCache:function(A){var B=A.object;if(!this.tileCache[B.url]){if(!OpenLayers.Element.hasClass(B.imgDiv,"olImageLoadError")){if(this.tileCacheIndex.length>=this.cacheSize){delete this.tileCache[this.tileCacheIndex[0]];this.tileCacheIndex.shift()}this.tileCache[B.url]=B.imgDiv;this.tileCacheIndex.push(B.url)}}},clearTileQueue:function(B){var C=B.object;var D=this.tileQueue[C.map.id];for(var A=D.length-1;A>=0;--A){if(D[A].layer===C){D.splice(A,1)}}},destroy:function(){for(var A=this.maps.length-1;A>=0;--A){this.removeMap(this.maps[A])}this.maps=null;this.tileQueue=null;this.tileQueueId=null;this.tileCache=null;this.tileCacheIndex=null;this._destroyed=true}});OpenLayers.Layer.ArcGISCache=OpenLayers.Class(OpenLayers.Layer.XYZ,{url:null,tileOrigin:null,tileSize:new OpenLayers.Size(256,256),useArcGISServer:true,type:"png",useScales:false,overrideDPI:false,initialize:function(K,J,G){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);if(this.resolutions){this.serverResolutions=this.resolutions;this.maxExtent=this.getMaxExtentForResolution(this.resolutions[0])}if(this.layerInfo){var I=this.layerInfo;var E=new OpenLayers.Bounds(I.fullExtent.xmin,I.fullExtent.ymin,I.fullExtent.xmax,I.fullExtent.ymax);this.projection="EPSG:"+I.spatialReference.wkid;this.sphericalMercator=(I.spatialReference.wkid==102100);this.units=(I.units=="esriFeet")?"ft":"m";if(!!I.tileInfo){this.tileSize=new OpenLayers.Size(I.tileInfo.width||I.tileInfo.cols,I.tileInfo.height||I.tileInfo.rows);this.tileOrigin=new OpenLayers.LonLat(I.tileInfo.origin.x,I.tileInfo.origin.y);var H=new OpenLayers.Geometry.Point(E.left,E.top);var C=new OpenLayers.Geometry.Point(E.right,E.bottom);if(this.useScales){this.scales=[]}else{this.resolutions=[]}this.lods=[];for(var F in I.tileInfo.lods){if(I.tileInfo.lods.hasOwnProperty(F)){var A=I.tileInfo.lods[F];if(this.useScales){this.scales.push(A.scale)}else{this.resolutions.push(A.resolution)}var B=this.getContainingTileCoords(H,A.resolution);A.startTileCol=B.x;A.startTileRow=B.y;var D=this.getContainingTileCoords(C,A.resolution);A.endTileCol=D.x;A.endTileRow=D.y;this.lods.push(A)}}this.maxExtent=this.calculateMaxExtentWithLOD(this.lods[0]);this.serverResolutions=this.resolutions;if(this.overrideDPI&&I.tileInfo.dpi){OpenLayers.DOTS_PER_INCH=I.tileInfo.dpi}}}},getContainingTileCoords:function(A,B){return new OpenLayers.Pixel(Math.max(Math.floor((A.x-this.tileOrigin.lon)/(this.tileSize.w*B)),0),Math.max(Math.floor((this.tileOrigin.lat-A.y)/(this.tileSize.h*B)),0))},calculateMaxExtentWithLOD:function(F){var E=(F.endTileCol-F.startTileCol)+1;var G=(F.endTileRow-F.startTileRow)+1;var D=this.tileOrigin.lon+(F.startTileCol*this.tileSize.w*F.resolution);var B=D+(E*this.tileSize.w*F.resolution);var A=this.tileOrigin.lat-(F.startTileRow*this.tileSize.h*F.resolution);var C=A-(G*this.tileSize.h*F.resolution);return new OpenLayers.Bounds(D,C,B,A)},calculateMaxExtentWithExtent:function(C,E){var A=new OpenLayers.Geometry.Point(C.left,C.top);var F=new OpenLayers.Geometry.Point(C.right,C.bottom);var G=this.getContainingTileCoords(A,E);var D=this.getContainingTileCoords(F,E);var B={resolution:E,startTileCol:G.x,startTileRow:G.y,endTileCol:D.x,endTileRow:D.y};return this.calculateMaxExtentWithLOD(B)},getUpperLeftTileCoord:function(B){var A=new OpenLayers.Geometry.Point(this.maxExtent.left,this.maxExtent.top);return this.getContainingTileCoords(A,B)},getLowerRightTileCoord:function(A){var B=new OpenLayers.Geometry.Point(this.maxExtent.right,this.maxExtent.bottom);return this.getContainingTileCoords(B,A)},getMaxExtentForResolution:function(I){var A=this.getUpperLeftTileCoord(I);var B=this.getLowerRightTileCoord(I);var E=(B.x-A.x)+1;var C=(B.y-A.y)+1;var F=this.tileOrigin.lon+(A.x*this.tileSize.w*I);var H=F+(E*this.tileSize.w*I);var D=this.tileOrigin.lat-(A.y*this.tileSize.h*I);var G=D-(C*this.tileSize.h*I);return new OpenLayers.Bounds(F,G,H,D)},clone:function(A){if(A==null){A=new OpenLayers.Layer.ArcGISCache(this.name,this.url,this.options)}return OpenLayers.Layer.XYZ.prototype.clone.apply(this,[A])},initGriddedTiles:function(A){delete this._tileOrigin;OpenLayers.Layer.XYZ.prototype.initGriddedTiles.apply(this,arguments)},getMaxExtent:function(){var A=this.map.getResolution();return this.maxExtent=this.getMaxExtentForResolution(A)},getTileOrigin:function(){if(!this._tileOrigin){var A=this.getMaxExtent();this._tileOrigin=new OpenLayers.LonLat(A.left,A.bottom)}return this._tileOrigin},getURL:function(D){var F=this.getResolution();var G=(this.tileOrigin.lon+(F*this.tileSize.w/2));var H=(this.tileOrigin.lat-(F*this.tileSize.h/2));var A=D.getCenterLonLat();var M={x:A.lon,y:A.lat};var K=(Math.round(Math.abs((A.lon-G)/(F*this.tileSize.w))));var L=(Math.round(Math.abs((H-A.lat)/(F*this.tileSize.h))));var J=this.map.getZoom();if(this.lods){var I=this.lods[this.map.getZoom()];if((K<I.startTileCol||K>I.endTileCol)||(L<I.startTileRow||L>I.endTileRow)){return null}}else{var C=this.getUpperLeftTileCoord(F);var E=this.getLowerRightTileCoord(F);if((K<C.x||K>=E.x)||(L<C.y||L>=E.y)){return null}}var N=this.url;var B=""+K+L+J;if(OpenLayers.Util.isArray(N)){N=this.selectUrl(B,N)}if(this.useArcGISServer){N=N+"/tile/${z}/${y}/${x}"}else{K="C"+OpenLayers.Number.zeroPad(K,8,16);L="R"+OpenLayers.Number.zeroPad(L,8,16);J="L"+OpenLayers.Number.zeroPad(J,2,10);N=N+"/${z}/${y}/${x}."+this.type}N=OpenLayers.String.format(N,{"x":K,"y":L,"z":J});return OpenLayers.Util.urlAppend(N,OpenLayers.Util.getParameterString(this.params))},CLASS_NAME:"OpenLayers.Layer.ArcGISCache"});OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:false,drillDown:false,maxFeatures:10,clickCallback:"click",output:"features",layers:null,queryVisible:false,url:null,layerUrls:null,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handler:null,hoverRequest:null,initialize:function(A){A=A||{};A.handlerOptions=A.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[A]);if(!this.format){this.format=new OpenLayers.Format.WMSGetFeatureInfo(A.formatOptions)}if(this.drillDown===true){this.hover=false}if(this.hover){this.handler=new OpenLayers.Handler.Hover(this,{"move":this.cancelHover,"pause":this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{"delay":250}))}else{var B={};B[this.clickCallback]=this.getInfoForClick;this.handler=new OpenLayers.Handler.Click(this,B,this.handlerOptions.click||{})}},getInfoForClick:function(A){this.events.triggerEvent("beforegetfeatureinfo",{xy:A.xy});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");this.request(A.xy,{})},getInfoForHover:function(A){this.events.triggerEvent("beforegetfeatureinfo",{xy:A.xy});this.request(A.xy,{hover:true})},cancelHover:function(){if(this.hoverRequest){this.hoverRequest.abort();this.hoverRequest=null}},findLayers:function(){var E=this.layers||this.map.layers;var D=[];var A,C;for(var B=E.length-1;B>=0;--B){A=E[B];if(A instanceof OpenLayers.Layer.WMS&&(!this.queryVisible||A.getVisibility())){C=OpenLayers.Util.isArray(A.url)?A.url[0]:A.url;if(this.drillDown===false&&!this.url){this.url=C}if(this.drillDown===true||this.urlMatches(C)){D.push(A)}}}return D},urlMatches:function(C){var A=OpenLayers.Util.isEquivalentUrl(this.url,C);if(!A&&this.layerUrls){for(var B=0,D=this.layerUrls.length;B<D;++B){if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[B],C)){A=true;break}}}return A},buildWMSOptions:function(K,L,F,C){var J=[],G=[];for(var I=0,A=L.length;I<A;I++){if(L[I].params.LAYERS!=null){J=J.concat(L[I].params.LAYERS);G=G.concat(this.getStyleNames(L[I]))}}var B=L[0];var D=this.map.getProjection();var E=B.projection;if(E&&E.equals(this.map.getProjectionObject())){D=E.getCode()}var H=OpenLayers.Util.extend({service:"WMS",version:B.params.VERSION,request:"GetFeatureInfo",exceptions:B.params.EXCEPTIONS,bbox:this.map.getExtent().toBBOX(null,B.reverseAxisOrder()),feature_count:this.maxFeatures,height:this.map.getSize().h,width:this.map.getSize().w,format:C,info_format:B.params.INFO_FORMAT||this.infoFormat},(parseFloat(B.params.VERSION)>=1.3)?{crs:D,i:parseInt(F.x),j:parseInt(F.y)}:{srs:D,x:parseInt(F.x),y:parseInt(F.y)});if(J.length!=0){H=OpenLayers.Util.extend({layers:J,query_layers:J,styles:G},H)}OpenLayers.Util.applyDefaults(H,this.vendorParams);return{url:K,params:OpenLayers.Util.upperCaseObject(H),callback:function(M){this.handleResponse(F,M,K)},scope:this}},getStyleNames:function(A){var B;if(A.params.STYLES){B=A.params.STYLES}else{if(OpenLayers.Util.isArray(A.params.LAYERS)){B=new Array(A.params.LAYERS.length)}else{B=A.params.LAYERS.replace(/[^,]/g,"")}}return B},request:function(F,I){var K=this.findLayers();if(K.length==0){this.events.triggerEvent("nogetfeatureinfo");OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait");return}I=I||{};if(this.drillDown===false){var E=this.buildWMSOptions(this.url,K,F,K[0].params.FORMAT);var D=OpenLayers.Request.GET(E);if(I.hover===true){this.hoverRequest=D}}else{this._requestCount=0;this._numRequests=0;this.features=[];var C={},J;for(var G=0,A=K.length;G<A;G++){var L=K[G];var B,H=false;J=OpenLayers.Util.isArray(L.url)?L.url[0]:L.url;if(J in C){C[J].push(L)}else{this._numRequests++;C[J]=[L]}}var K;for(var J in C){K=C[J];var E=this.buildWMSOptions(J,K,F,K[0].params.FORMAT);OpenLayers.Request.GET(E)}}},triggerGetFeatureInfo:function(C,A,B){this.events.triggerEvent("getfeatureinfo",{text:C.responseText,features:B,request:C,xy:A});OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},handleResponse:function(A,D,C){var E=D.responseXML;if(!E||!E.documentElement){E=D.responseText}var B=this.format.read(E);if(this.drillDown===false){this.triggerGetFeatureInfo(D,A,B)}else{this._requestCount++;if(this.output==="object"){this._features=(this._features||[]).concat({url:C,features:B})}else{this._features=(this._features||[]).concat(B)}if(this._requestCount===this._numRequests){this.triggerGetFeatureInfo(D,A,this._features.concat());delete this._features;delete this._requestCount;delete this._numRequests}}},CLASS_NAME:"OpenLayers.Control.WMSGetFeatureInfo"});OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3,{version:"1.3.0",CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3_0"});OpenLayers.Format.SOSGetFeatureOfInterest=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",sa:"http://www.opengis.net/sampling/1.0",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosAll.xsd",defaultPrefix:"sos",regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},read:function(G){if(typeof G=="string"){G=OpenLayers.Format.XML.prototype.read.apply(this,[G])}if(G&&G.nodeType==9){G=G.documentElement}var F={features:[]};this.readNode(G,F);var A=[];for(var B=0,E=F.features.length;B<E;B++){var D=F.features[B];if(this.internalProjection&&this.externalProjection&&D.components[0]){D.components[0].transform(this.externalProjection,this.internalProjection)}var C=new OpenLayers.Feature.Vector(D.components[0],D.attributes);A.push(C)}return A},readers:{"sa":{"SamplingPoint":function(C,B){if(!B.attributes){var A={attributes:{}};B.features.push(A);B=A}B.attributes.id=this.getAttributeNS(C,this.namespaces.gml,"id");this.readChildNodes(C,B)},"position":function(B,A){this.readChildNodes(B,A)}},"gml":OpenLayers.Util.applyDefaults({"FeatureCollection":function(B,A){this.readChildNodes(B,A)},"featureMember":function(C,B){var A={attributes:{}};B.features.push(A);this.readChildNodes(C,A)},"name":function(B,A){A.attributes.name=this.getChildValue(B)},"pos":function(B,A){if(!this.externalProjection){this.externalProjection=new OpenLayers.Projection(B.getAttribute("srsName"))}OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[B,A])}},OpenLayers.Format.GML.v3.prototype.readers.gml)},writers:{"sos":{"GetFeatureOfInterest":function(C){var B=this.createElementNSPlus("GetFeatureOfInterest",{attributes:{version:this.VERSION,service:"SOS","xsi:schemaLocation":this.schemaLocation}});for(var A=0,D=C.fois.length;A<D;A++){this.writeNode("FeatureOfInterestId",{foi:C.fois[A]},B)}return B},"FeatureOfInterestId":function(B){var A=this.createElementNSPlus("FeatureOfInterestId",{value:B.foi});return A}}},CLASS_NAME:"OpenLayers.Format.SOSGetFeatureOfInterest"});OpenLayers.Format.SOSGetObservation=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows",gml:"http://www.opengis.net/gml",sos:"http://www.opengis.net/sos/1.0",ogc:"http://www.opengis.net/ogc",om:"http://www.opengis.net/om/1.0",sa:"http://www.opengis.net/sampling/1.0",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosGetObservation.xsd",defaultPrefix:"sos",read:function(B){if(typeof B=="string"){B=OpenLayers.Format.XML.prototype.read.apply(this,[B])}if(B&&B.nodeType==9){B=B.documentElement}var A={measurements:[],observations:[]};this.readNode(B,A);return A},write:function(B){var A=this.writeNode("sos:GetObservation",B);A.setAttribute("xmlns:om",this.namespaces.om);A.setAttribute("xmlns:ogc",this.namespaces.ogc);this.setAttributeNS(A,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[A])},readers:{"om":{"ObservationCollection":function(B,A){A.id=this.getAttributeNS(B,this.namespaces.gml,"id");this.readChildNodes(B,A)},"member":function(A,B){this.readChildNodes(A,B)},"Measurement":function(B,C){var A={};C.measurements.push(A);this.readChildNodes(B,A)},"Observation":function(B,C){var A={};C.observations.push(A);this.readChildNodes(B,A)},"samplingTime":function(B,A){var C={};A.samplingTime=C;this.readChildNodes(B,C)},"observedProperty":function(B,A){A.observedProperty=this.getAttributeNS(B,this.namespaces.xlink,"href");this.readChildNodes(B,A)},"procedure":function(B,A){A.procedure=this.getAttributeNS(B,this.namespaces.xlink,"href");this.readChildNodes(B,A)},"featureOfInterest":function(D,C){var F={features:[]};C.fois=[];C.fois.push(F);this.readChildNodes(D,F);var A=[];for(var B=0,E=F.features.length;B<E;B++){var G=F.features[B];A.push(new OpenLayers.Feature.Vector(G.components[0],G.attributes))}F.features=A},"result":function(C,A){var B={};A.result=B;if(this.getChildValue(C)!==""){B.value=this.getChildValue(C);B.uom=C.getAttribute("uom")}else{this.readChildNodes(C,B)}}},"sa":OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.sa,"gml":OpenLayers.Util.applyDefaults({"TimeInstant":function(A,B){var C={};B.timeInstant=C;this.readChildNodes(A,C)},"timePosition":function(A,B){B.timePosition=this.getChildValue(A)}},OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.gml)},writers:{"sos":{"GetObservation":function(D){var C=this.createElementNSPlus("GetObservation",{attributes:{version:this.VERSION,service:"SOS"}});this.writeNode("offering",D,C);if(D.eventTime){this.writeNode("eventTime",D,C)}for(var B in D.procedures){this.writeNode("procedure",D.procedures[B],C)}for(var A in D.observedProperties){this.writeNode("observedProperty",D.observedProperties[A],C)}if(D.foi){this.writeNode("featureOfInterest",D.foi,C)}this.writeNode("responseFormat",D,C);if(D.resultModel){this.writeNode("resultModel",D,C)}if(D.responseMode){this.writeNode("responseMode",D,C)}return C},"featureOfInterest":function(B){var A=this.createElementNSPlus("featureOfInterest");this.writeNode("ObjectID",B.objectId,A);return A},"ObjectID":function(A){return this.createElementNSPlus("ObjectID",{value:A})},"responseFormat":function(A){return this.createElementNSPlus("responseFormat",{value:A.responseFormat})},"procedure":function(A){return this.createElementNSPlus("procedure",{value:A})},"offering":function(A){return this.createElementNSPlus("offering",{value:A.offering})},"observedProperty":function(A){return this.createElementNSPlus("observedProperty",{value:A})},"eventTime":function(B){var A=this.createElementNSPlus("eventTime");if(B.eventTime==="latest"){this.writeNode("ogc:TM_Equals",B,A)}return A},"resultModel":function(A){return this.createElementNSPlus("resultModel",{value:A.resultModel})},"responseMode":function(A){return this.createElementNSPlus("responseMode",{value:A.responseMode})}},"ogc":{"TM_Equals":function(B){var A=this.createElementNSPlus("ogc:TM_Equals");this.writeNode("ogc:PropertyName",{property:"urn:ogc:data:time:iso8601"},A);if(B.eventTime==="latest"){this.writeNode("gml:TimeInstant",{value:"latest"},A)}return A},"PropertyName":function(A){return this.createElementNSPlus("ogc:PropertyName",{value:A.property})}},"gml":{"TimeInstant":function(B){var A=this.createElementNSPlus("gml:TimeInstant");this.writeNode("gml:timePosition",B,A);return A},"timePosition":function(B){var A=this.createElementNSPlus("gml:timePosition",{value:B.value});return A}}},CLASS_NAME:"OpenLayers.Format.SOSGetObservation"});OpenLayers.Control.UTFGrid=OpenLayers.Class(OpenLayers.Control,{autoActivate:true,layers:null,defaultHandlerOptions:{"delay":300,"pixelTolerance":4,"stopMove":false,"single":true,"double":false,"stopSingle":false,"stopDouble":false},handlerMode:"click",setHandler:function(A){this.handlerMode=A;this.resetHandler()},resetHandler:function(){if(this.handler){this.handler.deactivate();this.handler.destroy();this.handler=null}if(this.handlerMode=="hover"){this.handler=new OpenLayers.Handler.Hover(this,{"pause":this.handleEvent,"move":this.reset},this.handlerOptions)}else{if(this.handlerMode=="click"){this.handler=new OpenLayers.Handler.Click(this,{"click":this.handleEvent},this.handlerOptions)}else{if(this.handlerMode=="move"){this.handler=new OpenLayers.Handler.Hover(this,{"pause":this.handleEvent,"move":this.handleEvent},this.handlerOptions)}}}if(this.handler){return true}else{return false}},initialize:function(A){A=A||{};A.handlerOptions=A.handlerOptions||this.defaultHandlerOptions;OpenLayers.Control.prototype.initialize.apply(this,[A]);this.resetHandler()},handleEvent:function(A){if(A==null){this.reset();return}var B=this.map.getLonLatFromPixel(A.xy);if(!B){return}var H=this.findLayers();if(H.length>0){var F={};var E,C;for(var D=0,G=H.length;D<G;D++){E=H[D];C=OpenLayers.Util.indexOf(this.map.layers,E);F[C]=E.getFeatureInfo(B)}this.callback(F,B,A.xy)}},callback:function(A){},reset:function(A){this.callback(null)},findLayers:function(){var D=this.layers||this.map.layers;var C=[];var A;for(var B=D.length-1;B>=0;--B){A=D[B];if(A instanceof OpenLayers.Layer.UTFGrid){C.push(A)}}return C},CLASS_NAME:"OpenLayers.Control.UTFGrid"});OpenLayers.Format.CQL=(function(){var F=["PROPERTY","COMPARISON","VALUE","LOGICAL"],C={PROPERTY:/^[_a-zA-Z]\w*/,COMPARISON:/^(=|<>|<=|<|>=|>|LIKE)/i,IS_NULL:/^IS NULL/i,COMMA:/^,/,LOGICAL:/^(AND|OR)/i,VALUE:/^('([^']|'')*'|\d+(\.\d*)?|\.\d+)/,LPAREN:/^\(/,RPAREN:/^\)/,SPATIAL:/^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i,NOT:/^NOT/i,BETWEEN:/^BETWEEN/i,GEOMETRY:function(P){var N=/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/.exec(P);if(N){var Q=P.length;var R=P.indexOf("(",N[0].length);if(R>-1){var O=1;while(R<Q&&O>0){R++;switch(P.charAt(R)){case"(":O++;break;case")":O--;break;default:}}}return[P.substr(0,R+1)]}},END:/^$/},M={LPAREN:["GEOMETRY","SPATIAL","PROPERTY","VALUE","LPAREN"],RPAREN:["NOT","LOGICAL","END","RPAREN"],PROPERTY:["COMPARISON","BETWEEN","COMMA","IS_NULL"],BETWEEN:["VALUE"],IS_NULL:["END"],COMPARISON:["VALUE"],COMMA:["GEOMETRY","VALUE","PROPERTY"],VALUE:["LOGICAL","COMMA","RPAREN","END"],SPATIAL:["LPAREN"],LOGICAL:["NOT","VALUE","SPATIAL","PROPERTY","LPAREN"],NOT:["PROPERTY","LPAREN"],GEOMETRY:["COMMA","RPAREN"]},J={"=":OpenLayers.Filter.Comparison.EQUAL_TO,"<>":OpenLayers.Filter.Comparison.NOT_EQUAL_TO,"<":OpenLayers.Filter.Comparison.LESS_THAN,"<=":OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,">":OpenLayers.Filter.Comparison.GREATER_THAN,">=":OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO,"LIKE":OpenLayers.Filter.Comparison.LIKE,"BETWEEN":OpenLayers.Filter.Comparison.BETWEEN,"IS NULL":OpenLayers.Filter.Comparison.IS_NULL},E={},I={"AND":OpenLayers.Filter.Logical.AND,"OR":OpenLayers.Filter.Logical.OR},B={},H={"RPAREN":3,"LOGICAL":2,"COMPARISON":1};var K;for(K in J){if(J.hasOwnProperty(K)){E[J[K]]=K}}for(K in I){if(I.hasOwnProperty(K)){B[I[K]]=K}}function L(N,O){if(O instanceof RegExp){return O.exec(N)}else{return O(N)}}function D(R,P){var Q,W,U=P.length;for(Q=0;Q<U;Q++){W=P[Q];var V=C[W];var S=L(R,V);if(S){var N=S[0];var T=R.substr(N.length).replace(/^\s*/,"");return{type:W,text:N,remainder:T}}}var O="ERROR: In parsing: ["+R+"], expected one of: ";for(Q=0;Q<U;Q++){W=P[Q];O+="\n    "+W+": "+C[W]}throw new Error(O)}function A(O){var P=[];var N,Q=["NOT","GEOMETRY","SPATIAL","PROPERTY","LPAREN"];do{N=D(O,Q);O=N.remainder;Q=M[N.type];if(N.type!="END"&&!Q){throw new Error("No follows list for "+N.type)}P.push(N)}while(N.type!="END");return P}function G(R){var U=[],P=[];while(R.length){var Q=R.shift();switch(Q.type){case"PROPERTY":case"GEOMETRY":case"VALUE":P.push(Q);break;case"COMPARISON":case"BETWEEN":case"IS_NULL":case"LOGICAL":var O=H[Q.type];while(U.length>0&&(H[U[U.length-1].type]<=O)){P.push(U.pop())}U.push(Q);break;case"SPATIAL":case"NOT":case"LPAREN":U.push(Q);break;case"RPAREN":while(U.length>0&&(U[U.length-1].type!="LPAREN")){P.push(U.pop())}U.pop();if(U.length>0&&U[U.length-1].type=="SPATIAL"){P.push(U.pop())}case"COMMA":case"END":break;default:throw new Error("Unknown token type "+Q.type)}}while(U.length>0){P.push(U.pop())}function T(){var a=P.pop();switch(a.type){case"LOGICAL":var e=T(),g=T();return new OpenLayers.Filter.Logical({filters:[g,e],type:I[a.text.toUpperCase()]});case"NOT":var j=T();return new OpenLayers.Filter.Logical({filters:[j],type:OpenLayers.Filter.Logical.NOT});case"BETWEEN":var Y,Z,X;P.pop();Z=T();Y=T();X=T();return new OpenLayers.Filter.Comparison({property:X,lowerBoundary:Y,upperBoundary:Z,type:OpenLayers.Filter.Comparison.BETWEEN});case"COMPARISON":var d=T(),X=T();return new OpenLayers.Filter.Comparison({property:X,value:d,type:J[a.text.toUpperCase()]});case"IS_NULL":var X=T();return new OpenLayers.Filter.Comparison({property:X,type:J[a.text.toUpperCase()]});case"VALUE":var k=a.text.match(/^'(.*)'$/);if(k){return k[1].replace(/''/g,"'")}else{return Number(a.text)}case"SPATIAL":switch(a.text.toUpperCase()){case"BBOX":var h=T(),W=T(),f=T(),c=T(),b=T();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:b,value:OpenLayers.Bounds.fromArray([c,f,W,h])});case"INTERSECTS":var d=T(),X=T();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:X,value:d});case"WITHIN":var d=T(),X=T();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.WITHIN,property:X,value:d});case"CONTAINS":var d=T(),X=T();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.CONTAINS,property:X,value:d});case"DWITHIN":var i=T(),d=T(),X=T();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,value:d,property:X,distance:Number(i)})}case"GEOMETRY":return OpenLayers.Geometry.fromWKT(a.text);default:return a.text}}var N=T();if(P.length>0){var V="Remaining tokens after building AST: \n";for(var S=P.length-1;S>=0;S--){V+=P[S].type+": "+P[S].text+"\n"}throw new Error(V)}return N}return OpenLayers.Class(OpenLayers.Format,{read:function(O){var N=G(A(O));if(this.keepData){this.data=N}return N},write:function(Q){if(Q instanceof OpenLayers.Geometry){return Q.toString()}switch(Q.CLASS_NAME){case"OpenLayers.Filter.Spatial":switch(Q.type){case OpenLayers.Filter.Spatial.BBOX:return"BBOX("+Q.property+","+Q.value.toBBOX()+")";case OpenLayers.Filter.Spatial.DWITHIN:return"DWITHIN("+Q.property+", "+this.write(Q.value)+", "+Q.distance+")";case OpenLayers.Filter.Spatial.WITHIN:return"WITHIN("+Q.property+", "+this.write(Q.value)+")";case OpenLayers.Filter.Spatial.INTERSECTS:return"INTERSECTS("+Q.property+", "+this.write(Q.value)+")";case OpenLayers.Filter.Spatial.CONTAINS:return"CONTAINS("+Q.property+", "+this.write(Q.value)+")";default:throw new Error("Unknown spatial filter type: "+Q.type)}case"OpenLayers.Filter.Logical":if(Q.type==OpenLayers.Filter.Logical.NOT){return"NOT ("+this.write(Q.filters[0])+")"}else{var P="(";var N=true;for(var O=0;O<Q.filters.length;O++){if(N){N=false}else{P+=") "+B[Q.type]+" ("}P+=this.write(Q.filters[O])}return P+")"}case"OpenLayers.Filter.Comparison":if(Q.type==OpenLayers.Filter.Comparison.BETWEEN){return Q.property+" BETWEEN "+this.write(Q.lowerBoundary)+" AND "+this.write(Q.upperBoundary)}else{return(Q.value!==null)?Q.property+" "+E[Q.type]+" "+this.write(Q.value):Q.property+" "+E[Q.type]}case undefined:if(typeof Q==="string"){return"'"+Q.replace(/'/g,"''")+"'"}else{if(typeof Q==="number"){return String(Q)}}default:throw new Error("Can't encode: "+Q.CLASS_NAME+" "+Q)}},CLASS_NAME:"OpenLayers.Format.CQL"})})();OpenLayers.Control.Split=OpenLayers.Class(OpenLayers.Control,{layer:null,source:null,sourceOptions:null,tolerance:null,edge:true,deferDelete:false,mutual:true,targetFilter:null,sourceFilter:null,handler:null,initialize:function(A){OpenLayers.Control.prototype.initialize.apply(this,[A]);this.options=A||{};if(this.options.source){this.setSource(this.options.source)}},setSource:function(A){if(this.active){this.deactivate();if(this.handler){this.handler.destroy();delete this.handler}this.source=A;this.activate()}else{this.source=A}},activate:function(){var A=OpenLayers.Control.prototype.activate.call(this);if(A){if(!this.source){if(!this.handler){this.handler=new OpenLayers.Handler.Path(this,{done:function(B){this.onSketchComplete({feature:new OpenLayers.Feature.Vector(B)})}},{layerOptions:this.sourceOptions})}this.handler.activate()}else{if(this.source.events){this.source.events.on({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this})}}}return A},deactivate:function(){var A=OpenLayers.Control.prototype.deactivate.call(this);if(A){if(this.source&&this.source.events){this.source.events.un({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this})}}return A},onSketchComplete:function(A){this.feature=null;return !this.considerSplit(A.feature)},afterFeatureModified:function(B){if(B.modified){var A=B.feature;if(typeof A.geometry.split==="function"){this.feature=B.feature;this.considerSplit(B.feature)}}},removeByGeometry:function(A,C){for(var B=0,D=A.length;B<D;++B){if(A[B].geometry===C){A.splice(B,1);break}}},isEligible:function(A){if(!A.geometry){return false}else{return(A.state!==OpenLayers.State.DELETE)&&(typeof A.geometry.split==="function")&&(this.feature!==A)&&(!this.targetFilter||this.targetFilter.evaluate(A.attributes))}},considerSplit:function(H){var M=false;var A=false;if(!this.sourceFilter||this.sourceFilter.evaluate(H.attributes)){var R=this.layer&&this.layer.features||[];var O,V,Q;var K=[],B=[];var D=(this.layer===this.source)&&this.mutual;var P={edge:this.edge,tolerance:this.tolerance,mutual:D};var L=[H.geometry];var S,E;var J,U;for(var T=0,I=R.length;T<I;++T){S=R[T];if(this.isEligible(S)){E=[S.geometry];for(var C=0;C<L.length;++C){J=L[C];for(var G=0;G<E.length;++G){O=E[G];if(J.getBounds().intersectsBounds(O.getBounds())){V=J.split(O,P);if(V){Q=this.events.triggerEvent("beforesplit",{source:H,target:S});if(Q!==false){if(D){U=V[0];if(U.length>1){U.unshift(C,1);Array.prototype.splice.apply(L,U);C+=U.length-3}V=V[1]}if(V.length>1){V.unshift(G,1);Array.prototype.splice.apply(E,V);G+=V.length-3}}}}}}if(E&&E.length>1){this.geomsToFeatures(S,E);this.events.triggerEvent("split",{original:S,features:E});Array.prototype.push.apply(K,E);B.push(S);A=true}}}if(L&&L.length>1){this.geomsToFeatures(H,L);this.events.triggerEvent("split",{original:H,features:L});Array.prototype.push.apply(K,L);B.push(H);M=true}if(M||A){if(this.deferDelete){var F,N=[];for(var T=0,I=B.length;T<I;++T){F=B[T];if(F.state===OpenLayers.State.INSERT){N.push(F)}else{F.state=OpenLayers.State.DELETE;this.layer.drawFeature(F)}}this.layer.destroyFeatures(N,{silent:true});for(var T=0,I=K.length;T<I;++T){K[T].state=OpenLayers.State.INSERT}}else{this.layer.destroyFeatures(B,{silent:true})}this.layer.addFeatures(K,{silent:true});this.events.triggerEvent("aftersplit",{source:H,features:K})}}return M},geomsToFeatures:function(B,E){var D=B.clone();delete D.geometry;var A;for(var C=0,F=E.length;C<F;++C){A=D.clone();A.geometry=E[C];A.state=OpenLayers.State.INSERT;E[C]=A}},destroy:function(){if(this.active){this.deactivate()}OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Split"});OpenLayers.Layer.WMTS=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,version:"1.0.0",requestEncoding:"KVP",url:null,layer:null,matrixSet:null,style:null,format:"image/jpeg",tileOrigin:null,tileFullExtent:null,formatSuffix:null,matrixIds:null,dimensions:null,params:null,zoomOffset:0,serverResolutions:null,formatSuffixMap:{"image/png":"png","image/png8":"png","image/png24":"png","image/png32":"png","png":"png","image/jpeg":"jpg","image/jpg":"jpg","jpeg":"jpg","jpg":"jpg"},matrix:null,initialize:function(B){var F={url:true,layer:true,style:true,matrixSet:true};for(var C in F){if(!(C in B)){throw new Error("Missing property '"+C+"' in layer configuration.")}}B.params=OpenLayers.Util.upperCaseObject(B.params);var G=[B.name,B.url,B.params,B];OpenLayers.Layer.Grid.prototype.initialize.apply(this,G);if(!this.formatSuffix){this.formatSuffix=this.formatSuffixMap[this.format]||this.format.split("/").pop()}if(this.matrixIds){var D=this.matrixIds.length;if(D&&typeof this.matrixIds[0]==="string"){var E=this.matrixIds;this.matrixIds=new Array(D);for(var A=0;A<D;++A){this.matrixIds[A]={identifier:E[A]}}}}},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments)},updateMatrixProperties:function(){this.matrix=this.getMatrix();if(this.matrix){if(this.matrix.topLeftCorner){this.tileOrigin=this.matrix.topLeftCorner}if(this.matrix.tileWidth&&this.matrix.tileHeight){this.tileSize=new OpenLayers.Size(this.matrix.tileWidth,this.matrix.tileHeight)}if(!this.tileOrigin){this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.top)}if(!this.tileFullExtent){this.tileFullExtent=this.maxExtent}}},moveTo:function(B,A,C){if(A||!this.matrix){this.updateMatrixProperties()}return OpenLayers.Layer.Grid.prototype.moveTo.apply(this,arguments)},clone:function(A){if(A==null){A=new OpenLayers.Layer.WMTS(this.options)}A=OpenLayers.Layer.Grid.prototype.clone.apply(this,[A]);return A},getIdentifier:function(){return this.getServerZoom()},getMatrix:function(){var A;if(!this.matrixIds||this.matrixIds.length===0){A={identifier:this.getIdentifier()}}else{if("scaleDenominator" in this.matrixIds[0]){var C=OpenLayers.METERS_PER_INCH*OpenLayers.INCHES_PER_UNIT[this.units]*this.getServerResolution()/0.00028;var F=Number.POSITIVE_INFINITY;var E;for(var B=0,D=this.matrixIds.length;B<D;++B){E=Math.abs(1-(this.matrixIds[B].scaleDenominator/C));if(E<F){F=E;A=this.matrixIds[B]}}}else{A=this.matrixIds[this.getIdentifier()]}}return A},getTileInfo:function(F){var D=this.getServerResolution();var A=(F.lon-this.tileOrigin.lon)/(D*this.tileSize.w);var C=(this.tileOrigin.lat-F.lat)/(D*this.tileSize.h);var E=Math.floor(A);var B=Math.floor(C);return{col:E,row:B,i:Math.floor((A-E)*this.tileSize.w),j:Math.floor((C-B)*this.tileSize.h)}},getURL:function(K){K=this.adjustBounds(K);var J="";if(!this.tileFullExtent||this.tileFullExtent.intersectsBounds(K)){var C=K.getCenterLonLat();var I=this.getTileInfo(C);var D=this.matrix.identifier;var A=this.dimensions,G;if(OpenLayers.Util.isArray(this.url)){J=this.selectUrl([this.version,this.style,this.matrixSet,this.matrix.identifier,I.row,I.col].join(","),this.url)}else{J=this.url}if(this.requestEncoding.toUpperCase()==="REST"){G=this.params;if(J.indexOf("{")!==-1){var B=J.replace(/\{/g,"${");var E={style:this.style,Style:this.style,TileMatrixSet:this.matrixSet,TileMatrix:this.matrix.identifier,TileRow:I.row,TileCol:I.col};if(A){var L,F;for(F=A.length-1;F>=0;--F){L=A[F];E[L]=G[L.toUpperCase()]}}J=OpenLayers.String.format(B,E)}else{var H=this.version+"/"+this.layer+"/"+this.style+"/";if(A){for(var F=0;F<A.length;F++){if(G[A[F]]){H=H+G[A[F]]+"/"}}}H=H+this.matrixSet+"/"+this.matrix.identifier+"/"+I.row+"/"+I.col+"."+this.formatSuffix;if(!J.match(/\/$/)){J=J+"/"}J=J+H}}else{if(this.requestEncoding.toUpperCase()==="KVP"){G={SERVICE:"WMTS",REQUEST:"GetTile",VERSION:this.version,LAYER:this.layer,STYLE:this.style,TILEMATRIXSET:this.matrixSet,TILEMATRIX:this.matrix.identifier,TILEROW:I.row,TILECOL:I.col,FORMAT:this.format};J=OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,[G])}}}return J},mergeNewParams:function(A){if(this.requestEncoding.toUpperCase()==="KVP"){return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,[OpenLayers.Util.upperCaseObject(A)])}},CLASS_NAME:"OpenLayers.Layer.WMTS"});OpenLayers.Protocol.SOS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol,{fois:null,formatOptions:null,initialize:function(A){OpenLayers.Protocol.prototype.initialize.apply(this,[A]);if(!A.format){this.format=new OpenLayers.Format.SOSGetFeatureOfInterest(this.formatOptions)}},destroy:function(){if(this.options&&!this.options.format){this.format.destroy()}this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(B){B=OpenLayers.Util.extend({},B);OpenLayers.Util.applyDefaults(B,this.options||{});var C=new OpenLayers.Protocol.Response({requestType:"read"});var A=this.format;var D=OpenLayers.Format.XML.prototype.write.apply(A,[A.writeNode("sos:GetFeatureOfInterest",{fois:this.fois})]);C.priv=OpenLayers.Request.POST({url:B.url,callback:this.createCallback(this.handleRead,C,B),data:D});return C},handleRead:function(C,B){if(B.callback){var A=C.priv;if(A.status>=200&&A.status<300){C.features=this.parseFeatures(A);C.code=OpenLayers.Protocol.Response.SUCCESS}else{C.code=OpenLayers.Protocol.Response.FAILURE}B.callback.call(B.scope,C)}},parseFeatures:function(A){var B=A.responseXML;if(!B||!B.documentElement){B=A.responseText}if(!B||B.length<=0){return null}return this.format.read(B)},CLASS_NAME:"OpenLayers.Protocol.SOS.v1_0_0"});OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,{IMAGE_EXTENSIONS:{"jpeg":"jpg","gif":"gif","png":"png","png8":"png","png24":"png","dithered":"png"},DEFAULT_FORMAT:"jpeg",initialize:function(C,A,D,B){OpenLayers.Layer.KaMap.prototype.initialize.apply(this,arguments);this.extension=this.IMAGE_EXTENSIONS[this.params.i.toLowerCase()||this.DEFAULT_FORMAT]},getURL:function(A){A=this.adjustBounds(A);var I=this.map.getResolution();var B=Math.round((this.map.getScale()*10000))/10000;var F=Math.round(A.left/I);var H=-Math.round(A.top/I);var D=Math.floor(F/this.tileSize.w/this.params.metaTileSize.w)*this.tileSize.w*this.params.metaTileSize.w;var C=Math.floor(H/this.tileSize.h/this.params.metaTileSize.h)*this.tileSize.h*this.params.metaTileSize.h;var E=["/",this.params.map,"/",B,"/",this.params.g.replace(/\s/g,"_"),"/def/t",C,"/l",D,"/t",H,"l",F,".",this.extension];var G=this.url;if(OpenLayers.Util.isArray(G)){G=this.selectUrl(E.join(""),G)}return G+E.join("")},CLASS_NAME:"OpenLayers.Layer.KaMapCache"});OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.1.0",initialize:function(A){OpenLayers.Protocol.WFS.v1.prototype.initialize.apply(this,arguments);if(this.outputFormat&&!this.readFormat){if(this.outputFormat.toLowerCase()=="gml2"){this.readFormat=new OpenLayers.Format.GML.v2({featureType:this.featureType,featureNS:this.featureNS,geometryName:this.geometryName})}else{if(this.outputFormat.toLowerCase()=="json"){this.readFormat=new OpenLayers.Format.GeoJSON()}}}},CLASS_NAME:"OpenLayers.Protocol.WFS.v1_1_0"});OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.1",readers:{"wms":OpenLayers.Util.applyDefaults({"SRS":function(B,A){A.srs[this.getChildValue(B)]=true}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers["wms"])},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1"});OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1_1,{version:"1.1.1",profile:"WMSC",readers:{"wms":OpenLayers.Util.applyDefaults({"VendorSpecificCapabilities":function(B,A){A.vendorSpecific={tileSets:[]};this.readChildNodes(B,A.vendorSpecific)},"TileSet":function(B,A){var C={srs:{},bbox:{},resolutions:[]};this.readChildNodes(B,C);A.tileSets.push(C)},"Resolutions":function(B,E){var C=this.getChildValue(B).split(" ");for(var A=0,D=C.length;A<D;A++){if(C[A]!=""){E.resolutions.push(parseFloat(C[A]))}}},"Width":function(A,B){B.width=parseInt(this.getChildValue(A))},"Height":function(A,B){B.height=parseInt(this.getChildValue(A))},"Layers":function(A,B){B.layers=this.getChildValue(A)},"Styles":function(A,B){B.styles=this.getChildValue(A)}},OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.readers["wms"])},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC"});OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:true,initialize:function(A){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.layerStates=[]},destroy:function(){this.clearLayersArray("base");this.clearLayersArray("data");this.map.events.un({buttonclick:this.onButtonClick,addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.events.unregister("buttonclick",this,this.onButtonClick);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(A){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});if(this.outsideViewport){this.events.attachToElement(this.div);this.events.register("buttonclick",this,this.onButtonClick)}else{this.map.events.register("buttonclick",this,this.onButtonClick)}},draw:function(){OpenLayers.Control.prototype.draw.apply(this);this.loadContents();if(!this.outsideViewport){this.minimizeControl()}this.redraw();return this.div},onButtonClick:function(B){var A=B.buttonElement;if(A===this.minimizeDiv){this.minimizeControl()}else{if(A===this.maximizeDiv){this.maximizeControl()}else{if(A._layerSwitcher===this.id){if(A["for"]){A=document.getElementById(A["for"])}if(!A.disabled){if(A.type=="radio"){A.checked=true;this.map.setBaseLayer(this.map.getLayer(A._layer))}else{A.checked=!A.checked;this.updateMap()}}}}}},clearLayersArray:function(A){this[A+"LayersDiv"].innerHTML="";this[A+"Layers"]=[]},checkRedraw:function(){if(!this.layerStates.length||(this.map.layers.length!=this.layerStates.length)){return true}for(var A=0,C=this.layerStates.length;A<C;A++){var D=this.layerStates[A];var B=this.map.layers[A];if((D.name!=B.name)||(D.inRange!=B.inRange)||(D.id!=B.id)||(D.visibility!=B.visibility)){return true}}return false},redraw:function(){if(!this.checkRedraw()){return this.div}this.clearLayersArray("base");this.clearLayersArray("data");var I=false;var N=false;var J=this.map.layers.length;this.layerStates=new Array(J);for(var F=0;F<J;F++){var G=this.map.layers[F];this.layerStates[F]={"name":G.name,"visibility":G.visibility,"inRange":G.inRange,"id":G.id}}var M=this.map.layers.slice();if(!this.ascending){M.reverse()}for(var F=0,J=M.length;F<J;F++){var G=M[F];var H=G.isBaseLayer;if(G.displayInLayerSwitcher){if(H){N=true}else{I=true}var K=(H)?(G==this.map.baseLayer):G.getVisibility();var D=document.createElement("input"),E=OpenLayers.Util.createUniqueID(this.id+"_input_");D.id=E;D.name=(H)?this.id+"_baseLayers":G.name;D.type=(H)?"radio":"checkbox";D.value=G.name;D.checked=K;D.defaultChecked=K;D.className="olButton";D._layer=G.id;D._layerSwitcher=this.id;if(!H&&!G.inRange){D.disabled=true}var L=document.createElement("label");L["for"]=D.id;OpenLayers.Element.addClass(L,"labelSpan olButton");L._layer=G.id;L._layerSwitcher=this.id;if(!H&&!G.inRange){L.style.color="gray"}L.innerHTML=G.name;L.style.verticalAlign=(H)?"bottom":"baseline";var C=document.createElement("br");var A=(H)?this.baseLayers:this.dataLayers;A.push({"layer":G,"inputElem":D,"labelSpan":L});var B=(H)?this.baseLayersDiv:this.dataLayersDiv;B.appendChild(D);B.appendChild(L);B.appendChild(C)}}this.dataLbl.style.display=(I)?"":"none";this.baseLbl.style.display=(N)?"":"none";return this.div},updateMap:function(){for(var A=0,C=this.baseLayers.length;A<C;A++){var B=this.baseLayers[A];if(B.inputElem.checked){this.map.setBaseLayer(B.layer,false)}}for(var A=0,C=this.dataLayers.length;A<C;A++){var B=this.dataLayers[A];B.layer.setVisibility(B.inputElem.checked)}},maximizeControl:function(A){this.div.style.width="";this.div.style.height="";this.showControls(false);if(A!=null){OpenLayers.Event.stop(A)}},minimizeControl:function(A){this.div.style.width="0px";this.div.style.height="0px";this.showControls(true);if(A!=null){OpenLayers.Event.stop(A)}},showControls:function(A){this.maximizeDiv.style.display=A?"":"none";this.minimizeDiv.style.display=A?"none":"";this.layersDiv.style.display=A?"none":""},loadContents:function(){this.layersDiv=document.createElement("div");this.layersDiv.id=this.id+"_layersDiv";OpenLayers.Element.addClass(this.layersDiv,"layersDiv");this.baseLbl=document.createElement("div");this.baseLbl.innerHTML=OpenLayers.i18n("Base Layer");OpenLayers.Element.addClass(this.baseLbl,"baseLbl");this.baseLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.baseLayersDiv,"baseLayersDiv");this.dataLbl=document.createElement("div");this.dataLbl.innerHTML=OpenLayers.i18n("Overlays");OpenLayers.Element.addClass(this.dataLbl,"dataLbl");this.dataLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.dataLayersDiv,"dataLayersDiv");if(this.ascending){this.layersDiv.appendChild(this.baseLbl);this.layersDiv.appendChild(this.baseLayersDiv);this.layersDiv.appendChild(this.dataLbl);this.layersDiv.appendChild(this.dataLayersDiv)}else{this.layersDiv.appendChild(this.dataLbl);this.layersDiv.appendChild(this.dataLayersDiv);this.layersDiv.appendChild(this.baseLbl);this.layersDiv.appendChild(this.baseLayersDiv)}this.div.appendChild(this.layersDiv);var A=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,null,A,"absolute");OpenLayers.Element.addClass(this.maximizeDiv,"maximizeDiv olButton");this.maximizeDiv.style.display="none";this.div.appendChild(this.maximizeDiv);var A=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,null,A,"absolute");OpenLayers.Element.addClass(this.minimizeDiv,"minimizeDiv olButton");this.minimizeDiv.style.display="none";this.div.appendChild(this.minimizeDiv)},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"});OpenLayers.Format.Atom=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{atom:"http://www.w3.org/2005/Atom",georss:"http://www.georss.org/georss"},feedTitle:"untitled",defaultEntryTitle:"untitled",gmlParser:null,xy:false,read:function(A){if(typeof A=="string"){A=OpenLayers.Format.XML.prototype.read.apply(this,[A])}return this.parseFeatures(A)},write:function(A){var D;if(OpenLayers.Util.isArray(A)){D=this.createElementNSPlus("atom:feed");D.appendChild(this.createElementNSPlus("atom:title",{value:this.feedTitle}));for(var B=0,C=A.length;B<C;B++){D.appendChild(this.buildEntryNode(A[B]))}}else{D=this.buildEntryNode(A)}return OpenLayers.Format.XML.prototype.write.apply(this,[D])},buildContentNode:function(B){var A=this.createElementNSPlus("atom:content",{attributes:{type:B.type||null}});if(B.src){A.setAttribute("src",B.src)}else{if(B.type=="text"||B.type==null){A.appendChild(this.createTextNode(B.value))}else{if(B.type=="html"){if(typeof B.value!="string"){throw"HTML content must be in form of an escaped string"}A.appendChild(this.createTextNode(B.value))}else{if(B.type=="xhtml"){A.appendChild(B.value)}else{if(B.type=="xhtml"||B.type.match(/(\+|\/)xml$/)){A.appendChild(B.value)}else{A.appendChild(this.createTextNode(B.value))}}}}}return A},buildEntryNode:function(L){var D=L.attributes;var E=D.atom||{};var H=this.createElementNSPlus("atom:entry");if(E.authors){var K=OpenLayers.Util.isArray(E.authors)?E.authors:[E.authors];for(var J=0,G=K.length;J<G;J++){H.appendChild(this.buildPersonConstructNode("author",K[J]))}}if(E.categories){var B=OpenLayers.Util.isArray(E.categories)?E.categories:[E.categories];var C;for(var J=0,G=B.length;J<G;J++){C=B[J];H.appendChild(this.createElementNSPlus("atom:category",{attributes:{term:C.term,scheme:C.scheme||null,label:C.label||null}}))}}if(E.content){H.appendChild(this.buildContentNode(E.content))}if(E.contributors){var F=OpenLayers.Util.isArray(E.contributors)?E.contributors:[E.contributors];for(var J=0,G=F.length;J<G;J++){H.appendChild(this.buildPersonConstructNode("contributor",F[J]))}}if(L.fid){H.appendChild(this.createElementNSPlus("atom:id",{value:L.fid}))}if(E.links){var A=OpenLayers.Util.isArray(E.links)?E.links:[E.links];var M;for(var J=0,G=A.length;J<G;J++){M=A[J];H.appendChild(this.createElementNSPlus("atom:link",{attributes:{href:M.href,rel:M.rel||null,type:M.type||null,hreflang:M.hreflang||null,title:M.title||null,length:M.length||null}}))}}if(E.published){H.appendChild(this.createElementNSPlus("atom:published",{value:E.published}))}if(E.rights){H.appendChild(this.createElementNSPlus("atom:rights",{value:E.rights}))}if(E.summary||D.description){H.appendChild(this.createElementNSPlus("atom:summary",{value:E.summary||D.description}))}H.appendChild(this.createElementNSPlus("atom:title",{value:E.title||D.title||this.defaultEntryTitle}));if(E.updated){H.appendChild(this.createElementNSPlus("atom:updated",{value:E.updated}))}if(L.geometry){var I=this.createElementNSPlus("georss:where");I.appendChild(this.buildGeometryNode(L.geometry));H.appendChild(I)}return H},initGmlParser:function(){this.gmlParser=new OpenLayers.Format.GML.v3({xy:this.xy,featureNS:"http://example.com#feature",internalProjection:this.internalProjection,externalProjection:this.externalProjection})},buildGeometryNode:function(B){if(!this.gmlParser){this.initGmlParser()}var A=this.gmlParser.writeNode("feature:_geometry",B);return A.firstChild},buildPersonConstructNode:function(D,E){var C=["uri","email"];var F=this.createElementNSPlus("atom:"+D);F.appendChild(this.createElementNSPlus("atom:name",{value:E.name}));for(var A=0,B=C.length;A<B;A++){if(E[C[A]]){F.appendChild(this.createElementNSPlus("atom:"+C[A],{value:E[C[A]]}))}}return F},getFirstChildValue:function(B,D,C,F){var E;var A=this.getElementsByTagNameNS(B,D,C);if(A&&A.length>0){E=this.getChildValue(A[0],F)}else{E=F}return E},parseFeature:function(I){var D={};var G=null;var N=null;var M=null;var H=this.namespaces.atom;this.parsePersonConstructs(I,"author",D);N=this.getElementsByTagNameNS(I,H,"category");if(N.length>0){D.categories=[]}for(var J=0,E=N.length;J<E;J++){G={};G.term=N[J].getAttribute("term");M=N[J].getAttribute("scheme");if(M){G.scheme=M}M=N[J].getAttribute("label");if(M){G.label=M}D.categories.push(G)}N=this.getElementsByTagNameNS(I,H,"content");if(N.length>0){G={};M=N[0].getAttribute("type");if(M){G.type=M}M=N[0].getAttribute("src");if(M){G.src=M}else{if(G.type=="text"||G.type=="html"||G.type==null){G.value=this.getFirstChildValue(I,H,"content",null)}else{if(G.type=="xhtml"||G.type.match(/(\+|\/)xml$/)){G.value=this.getChildEl(N[0])}else{G.value=this.getFirstChildValue(I,H,"content",null)}}D.content=G}}this.parsePersonConstructs(I,"contributor",D);D.id=this.getFirstChildValue(I,H,"id",null);N=this.getElementsByTagNameNS(I,H,"link");if(N.length>0){D.links=new Array(N.length)}var B=["rel","type","hreflang","title","length"];for(var J=0,E=N.length;J<E;J++){G={};G.href=N[J].getAttribute("href");for(var F=0,L=B.length;F<L;F++){M=N[J].getAttribute(B[F]);if(M){G[B[F]]=M}}D.links[J]=G}G=this.getFirstChildValue(I,H,"published",null);if(G){D.published=G}G=this.getFirstChildValue(I,H,"rights",null);if(G){D.rights=G}G=this.getFirstChildValue(I,H,"summary",null);if(G){D.summary=G}D.title=this.getFirstChildValue(I,H,"title",null);D.updated=this.getFirstChildValue(I,H,"updated",null);var C={title:D.title,description:D.summary,atom:D};var K=this.parseLocations(I)[0];var A=new OpenLayers.Feature.Vector(K,C);A.fid=D.id;return A},parseFeatures:function(C){var A=[];var D=this.getElementsByTagNameNS(C,this.namespaces.atom,"entry");if(D.length==0){D=[C]}for(var B=0,E=D.length;B<E;B++){A.push(this.parseFeature(D[B]))}return A},parseLocations:function(K){var G=this.namespaces.georss;var P={components:[]};var B=this.getElementsByTagNameNS(K,G,"where");if(B&&B.length>0){if(!this.gmlParser){this.initGmlParser()}for(var L=0,E=B.length;L<E;L++){this.gmlParser.readChildNodes(B[L],P)}}var I=P.components;var N=this.getElementsByTagNameNS(K,G,"point");if(N&&N.length>0){for(var L=0,E=N.length;L<E;L++){var F=OpenLayers.String.trim(N[L].firstChild.nodeValue).split(/\s+/);if(F.length!=2){F=OpenLayers.String.trim(N[L].firstChild.nodeValue).split(/\s*,\s*/)}I.push(new OpenLayers.Geometry.Point(F[1],F[0]))}}var A=this.getElementsByTagNameNS(K,G,"line");if(A&&A.length>0){var M;var D;var C;for(var L=0,E=A.length;L<E;L++){M=OpenLayers.String.trim(A[L].firstChild.nodeValue).split(/\s+/);C=[];for(var O=0,H=M.length;O<H;O+=2){D=new OpenLayers.Geometry.Point(M[O+1],M[O]);C.push(D)}I.push(new OpenLayers.Geometry.LineString(C))}}var J=this.getElementsByTagNameNS(K,G,"polygon");if(J&&J.length>0){var M;var D;var C;for(var L=0,E=J.length;L<E;L++){M=OpenLayers.String.trim(J[L].firstChild.nodeValue).split(/\s+/);C=[];for(var O=0,H=M.length;O<H;O+=2){D=new OpenLayers.Geometry.Point(M[O+1],M[O]);C.push(D)}I.push(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(C)]))}}if(this.internalProjection&&this.externalProjection){for(var L=0,E=I.length;L<E;L++){if(I[L]){I[L].transform(this.externalProjection,this.internalProjection)}}}return I},parsePersonConstructs:function(H,J,C){var A=[];var G=this.namespaces.atom;var M=this.getElementsByTagNameNS(H,G,J);var B=["uri","email"];for(var I=0,D=M.length;I<D;I++){var F={};F.name=this.getFirstChildValue(M[I],G,"name",null);for(var E=0,K=B.length;E<K;E++){var L=this.getFirstChildValue(M[I],G,B[E],null);if(L){F[B[E]]=L}}A.push(F)}if(A.length>0){C[J+"s"]=A}},CLASS_NAME:"OpenLayers.Format.Atom"});OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{autoActivate:true,slideFactor:75,observeElement:null,draw:function(){var A=this.observeElement||document;this.handler=new OpenLayers.Handler.Keyboard(this,{"keydown":this.defaultKeyPress},{observeElement:A})},defaultKeyPress:function(C){var A,B=true;var D=OpenLayers.Event.element(C);if(D&&(D.tagName=="INPUT"||D.tagName=="TEXTAREA"||D.tagName=="SELECT")){return}switch(C.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:A=this.map.getSize();this.map.pan(0,-0.75*A.h);break;case 34:A=this.map.getSize();this.map.pan(0,0.75*A.h);break;case 35:A=this.map.getSize();this.map.pan(0.75*A.w,0);break;case 36:A=this.map.getSize();this.map.pan(-0.75*A.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut();break;default:B=false}if(B){OpenLayers.Event.stop(C)}},CLASS_NAME:"OpenLayers.Control.KeyboardDefaults"});OpenLayers.Format.WMTSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1_1_0,{version:"1.0.0",namespaces:{ows:"http://www.opengis.net/ows/1.1",wmts:"http://www.opengis.net/wmts/1.0",xlink:"http://www.w3.org/1999/xlink"},yx:null,defaultPrefix:"wmts",initialize:function(A){OpenLayers.Format.XML.prototype.initialize.apply(this,[A]);this.options=A;var B=OpenLayers.Util.extend({},OpenLayers.Format.WMTSCapabilities.prototype.yx);this.yx=OpenLayers.Util.extend(B,this.yx)},read:function(B){if(typeof B=="string"){B=OpenLayers.Format.XML.prototype.read.apply(this,[B])}if(B&&B.nodeType==9){B=B.documentElement}var A={};this.readNode(B,A);A.version=this.version;return A},readers:{"wmts":{"Capabilities":function(B,A){this.readChildNodes(B,A)},"Contents":function(B,A){A.contents={};A.contents.layers=[];A.contents.tileMatrixSets={};this.readChildNodes(B,A.contents)},"Layer":function(B,A){var C={styles:[],formats:[],dimensions:[],tileMatrixSetLinks:[]};C.layers=[];this.readChildNodes(B,C);A.layers.push(C)},"Style":function(B,A){var C={};C.isDefault=(B.getAttribute("isDefault")==="true");this.readChildNodes(B,C);A.styles.push(C)},"Format":function(B,A){A.formats.push(this.getChildValue(B))},"TileMatrixSetLink":function(B,A){var C={};this.readChildNodes(B,C);A.tileMatrixSetLinks.push(C)},"TileMatrixSet":function(B,A){if(A.layers){var C={matrixIds:[]};this.readChildNodes(B,C);A.tileMatrixSets[C.identifier]=C}else{A.tileMatrixSet=this.getChildValue(B)}},"TileMatrix":function(C,A){var B={supportedCRS:A.supportedCRS};this.readChildNodes(C,B);A.matrixIds.push(B)},"ScaleDenominator":function(B,A){A.scaleDenominator=parseFloat(this.getChildValue(B))},"TopLeftCorner":function(D,B){var A=this.getChildValue(D);var E=A.split(" ");var F;if(B.supportedCRS){var C=B.supportedCRS.replace(/urn:ogc:def:crs:(\w+):.+:(\w+)$/,"urn:ogc:def:crs:$1::$2");F=!!this.yx[C]}if(F){B.topLeftCorner=new OpenLayers.LonLat(E[1],E[0])}else{B.topLeftCorner=new OpenLayers.LonLat(E[0],E[1])}},"TileWidth":function(B,A){A.tileWidth=parseInt(this.getChildValue(B))},"TileHeight":function(B,A){A.tileHeight=parseInt(this.getChildValue(B))},"MatrixWidth":function(B,A){A.matrixWidth=parseInt(this.getChildValue(B))},"MatrixHeight":function(B,A){A.matrixHeight=parseInt(this.getChildValue(B))},"ResourceURL":function(B,A){A.resourceUrl=A.resourceUrl||{};var D=B.getAttribute("resourceType");if(!A.resourceUrls){A.resourceUrls=[]}var C=A.resourceUrl[D]={format:B.getAttribute("format"),template:B.getAttribute("template"),resourceType:D};A.resourceUrls.push(C)},"WSDL":function(B,A){A.wsdl={};A.wsdl.href=B.getAttribute("xlink:href")},"ServiceMetadataURL":function(B,A){A.serviceMetadataUrl={};A.serviceMetadataUrl.href=B.getAttribute("xlink:href")},"LegendURL":function(B,A){A.legend={};A.legend.href=B.getAttribute("xlink:href");A.legend.format=B.getAttribute("format")},"Dimension":function(B,A){var C={values:[]};this.readChildNodes(B,C);A.dimensions.push(C)},"Default":function(B,A){A["default"]=this.getChildValue(B)},"Value":function(B,A){A.values.push(this.getChildValue(B))}},"ows":OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers["ows"]},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities.v1_0_0"});
OpenLayers.DOTS_PER_INCH=96;

var vecLayer = new OpenLayers.Layer.XYZ(
    "矢量",
    [
        "http://cut.tiler.591map.net/tiler/tdt--0-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt--1-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt--2-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt--3-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt--4-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt--5-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt--6-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt--7-${x}-${y}-${z}.html"
    ], {
        isBaseLayer: true,
        visibility: true,
        displayInLayerSwitcher: true
    }
);

var imgLayer = new OpenLayers.Layer.XYZ(
    "影像",
    [
        "http://cut.tiler.591map.net/tiler/tdt-img_w-0-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt-img_w-1-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt-img_w-2-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt-img_w-3-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt-img_w-4-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt-img_w-5-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt-img_w-6-${x}-${y}-${z}.html",
        "http://cut.tiler.591map.net/tiler/tdt-img_w-7-${x}-${y}-${z}.html"
    ], {
        isBaseLayer: true,
        visibility: true,
        displayInLayerSwitcher: true
    }
);
